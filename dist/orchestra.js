(function(){var t=this,e=t._,n={},i=Array.prototype,r=Object.prototype,o=Function.prototype,a=i.push,s=i.slice,l=i.concat,u=r.toString,c=r.hasOwnProperty,h=i.forEach,d=i.map,f=i.reduce,p=i.reduceRight,m=i.filter,g=i.every,v=i.some,y=i.indexOf,w=i.lastIndexOf,b=Array.isArray,_=Object.keys,E=o.bind,T=function(t){return t instanceof T?t:this instanceof T?void(this._wrapped=t):new T(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=T),exports._=T):t._=T,T.VERSION="1.6.0";var C=T.each=T.forEach=function(t,e,i){if(null==t)return t;if(h&&t.forEach===h)t.forEach(e,i);else if(t.length===+t.length){for(var r=0,o=t.length;o>r;r++)if(e.call(i,t[r],r,t)===n)return}else{var a=T.keys(t);for(r=0,o=a.length;o>r;r++)if(e.call(i,t[a[r]],a[r],t)===n)return}return t};T.map=T.collect=function(t,e,n){var i=[];return null==t?i:d&&t.map===d?t.map(e,n):(C(t,function(t,r,o){i.push(e.call(n,t,r,o))}),i)};var x="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return i&&(e=T.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(C(t,function(t,o,a){r?n=e.call(i,n,t,o,a):(n=t,r=!0)}),!r)throw new TypeError(x);return n},T.reduceRight=T.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return i&&(e=T.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var a=T.keys(t);o=a.length}if(C(t,function(s,l,u){l=a?a[--o]:--o,r?n=e.call(i,n,t[l],l,u):(n=t[l],r=!0)}),!r)throw new TypeError(x);return n},T.find=T.detect=function(t,e,n){var i;return S(t,function(t,r,o){return e.call(n,t,r,o)?(i=t,!0):void 0}),i},T.filter=T.select=function(t,e,n){var i=[];return null==t?i:m&&t.filter===m?t.filter(e,n):(C(t,function(t,r,o){e.call(n,t,r,o)&&i.push(t)}),i)},T.reject=function(t,e,n){return T.filter(t,function(t,i,r){return!e.call(n,t,i,r)},n)},T.every=T.all=function(t,e,i){e||(e=T.identity);var r=!0;return null==t?r:g&&t.every===g?t.every(e,i):(C(t,function(t,o,a){return(r=r&&e.call(i,t,o,a))?void 0:n}),!!r)};var S=T.some=T.any=function(t,e,i){e||(e=T.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,i):(C(t,function(t,o,a){return r||(r=e.call(i,t,o,a))?n:void 0}),!!r)};T.contains=T.include=function(t,e){return null!=t&&(y&&t.indexOf===y?-1!=t.indexOf(e):S(t,function(t){return t===e}))},T.invoke=function(t,e){var n=s.call(arguments,2),i=T.isFunction(e);return T.map(t,function(t){return(i?e:t[e]).apply(t,n)})},T.pluck=function(t,e){return T.map(t,T.property(e))},T.where=function(t,e){return T.filter(t,T.matches(e))},T.findWhere=function(t,e){return T.find(t,T.matches(e))},T.max=function(t,e,n){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var i=-1/0,r=-1/0;return C(t,function(t,o,a){var s=e?e.call(n,t,o,a):t;s>r&&(i=t,r=s)}),i},T.min=function(t,e,n){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var i=1/0,r=1/0;return C(t,function(t,o,a){var s=e?e.call(n,t,o,a):t;r>s&&(i=t,r=s)}),i},T.shuffle=function(t){var e,n=0,i=[];return C(t,function(t){e=T.random(n++),i[n-1]=i[e],i[e]=t}),i},T.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=T.values(t)),t[T.random(t.length-1)]):T.shuffle(t).slice(0,Math.max(0,e))};var M=function(t){return null==t?T.identity:T.isFunction(t)?t:T.property(t)};T.sortBy=function(t,e,n){return e=M(e),T.pluck(T.map(t,function(t,i,r){return{value:t,index:i,criteria:e.call(n,t,i,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var O=function(t){return function(e,n,i){var r={};return n=M(n),C(e,function(o,a){var s=n.call(i,o,a,e);t(r,s,o)}),r}};T.groupBy=O(function(t,e,n){T.has(t,e)?t[e].push(n):t[e]=[n]}),T.indexBy=O(function(t,e,n){t[e]=n}),T.countBy=O(function(t,e){T.has(t,e)?t[e]++:t[e]=1}),T.sortedIndex=function(t,e,n,i){for(var r=(n=M(n)).call(i,e),o=0,a=t.length;a>o;){var s=o+a>>>1;n.call(i,t[s])<r?o=s+1:a=s}return o},T.toArray=function(t){return t?T.isArray(t)?s.call(t):t.length===+t.length?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:t.length===+t.length?t.length:T.keys(t).length},T.first=T.head=T.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:s.call(t,0,e)},T.initial=function(t,e,n){return s.call(t,0,t.length-(null==e||n?1:e))},T.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},T.rest=T.tail=T.drop=function(t,e,n){return s.call(t,null==e||n?1:e)},T.compact=function(t){return T.filter(t,T.identity)};var R=function(t,e,n){return e&&T.every(t,T.isArray)?l.apply(n,t):(C(t,function(t){T.isArray(t)||T.isArguments(t)?e?a.apply(n,t):R(t,e,n):n.push(t)}),n)};T.flatten=function(t,e){return R(t,e,[])},T.without=function(t){return T.difference(t,s.call(arguments,1))},T.partition=function(t,e){var n=[],i=[];return C(t,function(t){(e(t)?n:i).push(t)}),[n,i]},T.uniq=T.unique=function(t,e,n,i){T.isFunction(e)&&(i=n,n=e,e=!1);var r=n?T.map(t,n,i):t,o=[],a=[];return C(r,function(n,i){(e?i&&a[a.length-1]===n:T.contains(a,n))||(a.push(n),o.push(t[i]))}),o},T.union=function(){return T.uniq(T.flatten(arguments,!0))},T.intersection=function(t){var e=s.call(arguments,1);return T.filter(T.uniq(t),function(t){return T.every(e,function(e){return T.contains(e,t)})})},T.difference=function(t){var e=l.apply(i,s.call(arguments,1));return T.filter(t,function(t){return!T.contains(e,t)})},T.zip=function(){for(var t=T.max(T.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=T.pluck(arguments,""+n);return e},T.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},T.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=T.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},T.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(w&&t.lastIndexOf===w)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var r=i?n:t.length;r--;)if(t[r]===e)return r;return-1},T.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,o=new Array(i);i>r;)o[r++]=t,t+=n;return o};var A=function(){};T.bind=function(t,e){var n,i;if(E&&t.bind===E)return E.apply(t,s.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return n=s.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(s.call(arguments)));A.prototype=t.prototype;var r=new A;A.prototype=null;var o=t.apply(r,n.concat(s.call(arguments)));return Object(o)===o?o:r}},T.partial=function(t){var e=s.call(arguments,1);return function(){for(var n=0,i=e.slice(),r=0,o=i.length;o>r;r++)i[r]===T&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},T.bindAll=function(t){var e=s.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return C(e,function(e){t[e]=T.bind(t[e],t)}),t},T.memoize=function(t,e){var n={};return e||(e=T.identity),function(){var i=e.apply(this,arguments);return T.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},T.delay=function(t,e){var n=s.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},T.defer=function(t){return T.delay.apply(T,[t,1].concat(s.call(arguments,1)))},T.throttle=function(t,e,n){var i,r,o,a=null,s=0;n||(n={});var l=function(){s=!1===n.leading?0:T.now(),a=null,o=t.apply(i,r),i=r=null};return function(){var u=T.now();s||!1!==n.leading||(s=u);var c=e-(u-s);return i=this,r=arguments,0>=c?(clearTimeout(a),a=null,s=u,o=t.apply(i,r),i=r=null):a||!1===n.trailing||(a=setTimeout(l,c)),o}},T.debounce=function(t,e,n){var i,r,o,a,s,l=function(){var u=T.now()-a;e>u?i=setTimeout(l,e-u):(i=null,n||(s=t.apply(o,r),o=r=null))};return function(){o=this,r=arguments,a=T.now();var u=n&&!i;return i||(i=setTimeout(l,e)),u&&(s=t.apply(o,r),o=r=null),s}},T.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},T.wrap=function(t,e){return T.partial(e,t)},T.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},T.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},T.keys=function(t){if(!T.isObject(t))return[];if(_)return _(t);var e=[];for(var n in t)T.has(t,n)&&e.push(n);return e},T.values=function(t){for(var e=T.keys(t),n=e.length,i=new Array(n),r=0;n>r;r++)i[r]=t[e[r]];return i},T.pairs=function(t){for(var e=T.keys(t),n=e.length,i=new Array(n),r=0;n>r;r++)i[r]=[e[r],t[e[r]]];return i},T.invert=function(t){for(var e={},n=T.keys(t),i=0,r=n.length;r>i;i++)e[t[n[i]]]=n[i];return e},T.functions=T.methods=function(t){var e=[];for(var n in t)T.isFunction(t[n])&&e.push(n);return e.sort()},T.extend=function(t){return C(s.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},T.pick=function(t){var e={},n=l.apply(i,s.call(arguments,1));return C(n,function(n){n in t&&(e[n]=t[n])}),e},T.omit=function(t){var e={},n=l.apply(i,s.call(arguments,1));for(var r in t)T.contains(n,r)||(e[r]=t[r]);return e},T.defaults=function(t){return C(s.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,e){return e(t),t};var P=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof T&&(t=t._wrapped),e instanceof T&&(e=e._wrapped);var r=u.call(t);if(r!=u.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return i[o]==e;var a=t.constructor,s=e.constructor;if(a!==s&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1;n.push(t),i.push(e);var l=0,c=!0;if("[object Array]"==r){if(l=t.length,c=l==e.length)for(;l--&&(c=P(t[l],e[l],n,i)););}else{for(var h in t)if(T.has(t,h)&&(l++,!(c=T.has(e,h)&&P(t[h],e[h],n,i))))break;if(c){for(h in e)if(T.has(e,h)&&!l--)break;c=!l}}return n.pop(),i.pop(),c};T.isEqual=function(t,e){return P(t,e,[],[])},T.isEmpty=function(t){if(null==t)return!0;if(T.isArray(t)||T.isString(t))return 0===t.length;for(var e in t)if(T.has(t,e))return!1;return!0},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=b||function(t){return"[object Array]"==u.call(t)},T.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],function(t){T["is"+t]=function(e){return u.call(e)=="[object "+t+"]"}}),T.isArguments(arguments)||(T.isArguments=function(t){return!(!t||!T.has(t,"callee"))}),"function"!=typeof/./&&(T.isFunction=function(t){return"function"==typeof t}),T.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&t!=+t},T.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==u.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,e){return c.call(t,e)},T.noConflict=function(){return t._=e,this},T.identity=function(t){return t},T.constant=function(t){return function(){return t}},T.property=function(t){return function(e){return e[t]}},T.matches=function(t){return function(e){if(e===t)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0}},T.times=function(t,e,n){for(var i=Array(Math.max(0,t)),r=0;t>r;r++)i[r]=e.call(n,r);return i},T.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},T.now=Date.now||function(){return(new Date).getTime()};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};N.unescape=T.invert(N.escape);var k={escape:new RegExp("["+T.keys(N.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(N.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(t){T[t]=function(e){return null==e?"":(""+e).replace(k[t],function(e){return N[t][e]})}}),T.result=function(t,e){if(null!=t){var n=t[e];return T.isFunction(n)?n.call(t):n}},T.mixin=function(t){C(T.functions(t),function(e){var n=T[e]=t[e];T.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),U.call(this,n.apply(T,t))}})};var L=0;T.uniqueId=function(t){var e=++L+"";return t?t+e:e},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(t,e,n){var i;n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(r,function(e,n,i,r,s){return a+=t.slice(o,s).replace(H,function(t){return"\\"+I[t]}),n&&(a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(a+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(a+="';\n"+r+"\n__p+='"),o=s+e.length,e}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(n.variable||"obj","_",a)}catch(t){throw t.source=a,t}if(e)return i(e,T);var s=function(t){return i.call(this,t,T)};return s.source="function("+(n.variable||"obj")+"){\n"+a+"}",s},T.chain=function(t){return T(t).chain()};var U=function(t){return this._chain?T(t).chain():t};T.mixin(T),C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];T.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],U.call(this,n)}}),C(["concat","join","slice"],function(t){var e=i[t];T.prototype[t]=function(){return U.call(this,e.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return T})}).call(this),function(t,e){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,r){t.Backbone=e(t,r,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,n,i){var r=t.Backbone,o=[],a=o.slice;e.VERSION="1.1.2",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=e.Events={on:function(t,e,n){if(!u(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});return(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,i){if(!u(this,"once",t,[e,i])||!e)return this;var r=this,o=n.once(function(){r.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,i)},off:function(t,e,i){var r,o,a,s,l,c,h,d;if(!this._events||!u(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(l=0,c=(s=t?[t]:n.keys(this._events)).length;l<c;l++)if(t=s[l],a=this._events[t]){if(this._events[t]=r=[],e||i)for(h=0,d=a.length;h<d;h++)o=a[h],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&r.push(o);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!u(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&c(n,e),i&&c(i,arguments),this},stopListening:function(t,e,i){var r=this._listeningTo;if(!r)return this;var o=!e&&!i;i||"object"!=typeof e||(i=this),t&&((r={})[t._listenId]=t);for(var a in r)(t=r[a]).off(e,i,this),(o||n.isEmpty(t._events))&&delete this._listeningTo[a];return this}},l=/\s+/,u=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(l.test(n)){for(var o=n.split(l),a=0,s=o.length;a<s;a++)t[e].apply(t,[o[a]].concat(i));return!1}return!0},c=function(t,e){var n,i=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}};n.each({listenTo:"on",listenToOnce:"once"},function(t,e){s[e]=function(e,i,r){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=n.uniqueId("l"))]=e,r||"object"!=typeof i||(r=this),e[t](i,r,this),this}}),s.bind=s.on,s.unbind=s.off,n.extend(e,s);var h=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,s,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var r,o,a,s,l,u,c,h;if(null==t)return this;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;a=i.unset,l=i.silent,s=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={}),h=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(r in o)e=o[r],n.isEqual(h[r],e)||s.push(r),n.isEqual(c[r],e)?delete this.changed[r]:this.changed[r]=e,a?delete h[r]:h[r]=e;if(!l){s.length&&(this._pending=i);for(var d=0,f=s.length;d<f;d++)this.trigger("change:"+s[d],this,h[s[d]],i)}if(u)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in t)n.isEqual(r[o],e=t[o])||((i||(i={}))[o]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){void 0===(t=t?n.clone(t):{}).parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){if(!e.set(e.parse(n,t),t))return!1;i&&i(e,n,t),e.trigger("sync",e,n,t)},N(this,t),this.sync("read",this,t)},save:function(t,e,i){var r,o,a,s=this.attributes;if(null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},s,r)),void 0===i.parse&&(i.parse=!0);var l=this,u=i.success;return i.success=function(t){l.attributes=s;var e=l.parse(t,i);if(i.wait&&(e=n.extend(r||{},e)),n.isObject(e)&&!l.set(e,i))return!1;u&&u(l,t,i),l.trigger("sync",l,t,i)},N(this,i),"patch"===(o=this.isNew()?"create":i.patch?"patch":"update")&&(i.attrs=r),a=this.sync(o,this,i),r&&i.wait&&(this.attributes=s),a},destroy:function(t){var e=this,i=(t=t?n.clone(t):{}).success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&r(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;N(this,t);var o=this.sync("delete",this,t);return t.wait||r(),o},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||P();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1)}});n.each(["keys","values","pairs","invert","pick","omit"],function(t){h.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}});var d=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},f={add:!0,remove:!0,merge:!0},p={add:!0,remove:!1};n.extend(d.prototype,s,{model:h,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,p))},remove:function(t,e){var i=!n.isArray(t);t=i?[t]:n.clone(t),e||(e={});var r,o,a,s;for(r=0,o=t.length;r<o;r++)(s=t[r]=this.get(t[r]))&&(delete this._byId[s.id],delete this._byId[s.cid],a=this.indexOf(s),this.models.splice(a,1),this.length--,e.silent||(e.index=a,s.trigger("remove",s,this,e)),this._removeReference(s,e));return i?t[0]:t},set:function(t,e){(e=n.defaults({},e,f)).parse&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?t?[t]:[]:n.clone(t);var r,o,a,s,l,u,c,d=e.at,p=this.model,m=this.comparator&&null==d&&!1!==e.sort,g=n.isString(this.comparator)?this.comparator:null,v=[],y=[],w={},b=e.add,_=e.merge,E=e.remove,T=!(m||!b||!E)&&[];for(r=0,o=t.length;r<o;r++){if(l=t[r]||{},a=l instanceof h?s=l:l[p.prototype.idAttribute||"id"],u=this.get(a))E&&(w[u.cid]=!0),_&&(l=l===s?s.attributes:l,e.parse&&(l=u.parse(l,e)),u.set(l,e),m&&!c&&u.hasChanged(g)&&(c=!0)),t[r]=u;else if(b){if(!(s=t[r]=this._prepareModel(l,e)))continue;v.push(s),this._addReference(s,e)}s=u||s,!T||!s.isNew()&&w[s.id]||T.push(s),w[s.id]=!0}if(E){for(r=0,o=this.length;r<o;++r)w[(s=this.models[r]).cid]||y.push(s);y.length&&this.remove(y,e)}if(v.length||T&&T.length)if(m&&(c=!0),this.length+=v.length,null!=d)for(r=0,o=v.length;r<o;r++)this.models.splice(d+r,0,v[r]);else{T&&(this.models.length=0);var C=T||v;for(r=0,o=C.length;r<o;r++)this.models.push(C[r])}if(c&&this.sort({silent:!0}),!e.silent){for(r=0,o=v.length;r<o;r++)(s=v[r]).trigger("add",s,this,e);(c||T&&T.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;i<r;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){void 0===(t=t?n.clone(t):{}).parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},N(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,r=e.success;return e.success=function(t,n){e.wait&&i.add(t,e),r&&r(t,n,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof h)return t;(e=e?n.clone(e):{}).collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});n.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"],function(t){d.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}});n.each(["groupBy","countBy","sortBy","indexBy"],function(t){d.prototype[t]=function(e,i){var r=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,r,i)}});var m=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,v)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},g=/^(\S+)\s*(.*)$/,v=["model","collection","el","id","attributes","className","tagName","events"];n.extend(m.prototype,s,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==n&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var r=e.match(g),o=r[1],a=r[2];i=n.bind(i,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,i):this.$el.on(o,a,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t.class=n.result(this,"className"));var i=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,r){var o=w[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:o,dataType:"json"};if(r.url||(a.url=n.result(i,"url")||P()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",r.emulateJSON&&(a.data._method=o);var s=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),s)return s.apply(this,arguments)}}"GET"===a.type||r.emulateJSON||(a.processData=!1),"PATCH"===a.type&&y&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=e.ajax(n.extend(a,r));return i.trigger("request",i,l,r),l};var y=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),w={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var b=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},_=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,T=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(b.prototype,s,{initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return e.history.route(t,function(n){var a=o._extractParameters(t,n);o.execute(r,a),o.trigger.apply(o,["route:"+i].concat(a)),o.trigger("route",i,a),e.history.trigger("route",o,i,a)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(C,"\\$&").replace(_,"(?:$1)?").replace(E,function(t,e){return e?t:"([^/?]+)"}).replace(T,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var x=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},S=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,O=/msie [\w.]+/,R=/\/$/,A=/#.*$/;x.started=!1,n.extend(x.prototype,s,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(R,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(S,"")},start:function(t){if(x.started)throw new Error("Backbone.history has already been started");x.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,o=O.exec(navigator.userAgent.toLowerCase())&&(!r||r<=7);if(this.root=("/"+this.root+"/").replace(M,"/"),o&&this._wantsHashChange){var a=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var s=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&s.hash&&(this.fragment=this.getHash().replace(S,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),x.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(t,e){if(!x.started)return!1;e&&!0!==e||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(A,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new x;h.extend=d.extend=b.extend=m.extend=x.extend=function(t,e){var i,r=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,t&&n.extend(i.prototype,t),i.__super__=r.prototype,i};var P=function(){throw new Error('A "url" property or function must be specified')},N=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}};return e}),define("dataFlow/dataTree",["underscore"],function(t){function e(e){this.init(),delete this.pathId,delete this.data,t.isUndefined(e)||this.addChildAtPath(e,[0]),t.bindAll(this,"dataAtPath","setDataAtPath","recurseTree","flattenedTree","graftedTree","remappedTree")}function n(t,e){this.init(t,e)}return e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.recurseTree=function(e){if("function"!=typeof e)throw new Error("recurseTree must be called with an iterator: function(data[,node])");!function n(i){t.isEmpty(i.data)||e(i.data,i);var r=t.keys(i.children);r.length>0&&t.each(r,function(t){n(i.children[t])})}(this)},e.prototype.fromJSON=function(e){var n=this;t.each(e,function(e,i){var r=t.map(i.split(";"),function(t){return Number(t)});n.setDataAtPath(e,r)})},e.prototype.toJSON=function(){var t={};return this.recurseTree(function(e,n){var i=n.getPath().join(";");t[i]=e}),t},e.prototype.flattenedTree=function(n){var i=[];if(this.recurseTree(function(e){t.each(e,function(t){i.push(t)})}),!n)return new e(i);this.data=i},e.prototype.dataAtPath=function(t,e){try{for(var n=t.slice(),i=this;n.length>0;)i=i.children[n.shift()];return!0===e?i.getFilteredData():i.data}catch(t){return[]}},e.prototype.copy=function(){return this.map()},e.prototype.map=function(n){var i=new e;return this.recurseTree(function(e,r){if("function"==typeof n){var o=t.map(e,function(t){return n(t)});o.length>0&&t.isArray(o[0])?t.each(o,function(t,e){var n=r.getPath();n.push(e),i.addChildAtPath(t,n,!0)}):i.addChildAtPath(o,r.getPath(),!0)}else i.addChildAtPath(e,r.getPath(),!0)}),i},e.prototype.setDataAtPath=function(t,e){return this.addChildAtPath(t,e,!0)},e.prototype.log=function(){var t=!0;this.recurseTree(function(e,n){t=!1,console.log("Path: ",n.getPath(),"      Data: ",e)}),t&&console.log("(Tree has no data)")},e.prototype.getMaxPathLength=function(){var e=1;return function n(i){var r=t.keys(i.children);r.length>0?t.each(r,function(t){n(i.children[t])}):e=Math.max(e,i.getPath().length)}(this),e},e.prototype.isEmpty=function(){var e=!0;return this.recurseTree(function(n){t.isEmpty(n)||(e=!1)}),e},e.prototype.graftedTree=function(){var n=new e;return this.recurseTree(function(e,i){var r=i.getPath().slice();t.each(e,function(t,e){var i=r.slice();i.push(e),n.addChildAtPath([t],i)})}),n},e.prototype.remappedTree=function(n,i){function r(t){return t.match(/(^.*\})/)[0].replace(/[^A-Za-z]/g," ").trim().split(" ")}function o(t){return t.match(/(\(.*$)/)[0].replace(/[^A-Za-z]/g," ").trim().split(" ")[0]}-1===n.indexOf("(")&&(n+="(i)"),-1===i.indexOf("(")&&(i+="(i)");var a=r(n),s=r(i),l=o(n),u=o(i),c=l!==u,h=t.map(a,function(e){var n=t.indexOf(a,e);return t.indexOf(s,e)-n}).slice(),d=new e;return c?(a.push(l),s.push(u),this.recurseTree(function(e,n){var i=n.getPath();t.each(n.data,function(e,n){var r=i.slice();r.push(n);var o={};t.each(a,function(t,e){o[t]=r[e]});var l=[];t.each(s,function(t,e){l[e]=o[t]});var u=l.pop();d.addSingleDataItemAtPathAndIndex(e,l,u)})})):this.recurseTree(function(t,e){for(var n=e.getPath().slice(),i=[],r=0;r<n.length;r++)i[r]=n[r+h[r]];d.addChildAtPath(e.data,i)}),d},n.prototype.init=function(e,n){var i=!t.isUndefined(e),r=t.isArray(e);if(i&&!r)throw new Error("Tried to assign a non-array to a Node in a Data Tree");i||(e=[]),this.data=e,this.children={},this.parent=n},n.prototype.isRoot=function(){return t.isUndefined(this.parent)},n.prototype.addChildAtPath=function(e,i,r){if(!t.isArray(i))throw new Error("must pass pathArray to addChildAtPath");var o=i.slice();t.each(o,function(t){if(parseInt(t)!==t)throw new Error("Encountered non-integer array path: "+t)});return function t(i,o){var a=o.shift(),s=i.children[a]||new n([],i);return i.children[a]=s,s.pathId=a,o.length>0?t(s,o):(s.data=!0===r?e:s.data.concat(e),s)}(this,o)},n.prototype.addSingleDataItemAtPathAndIndex=function(t,e,n){var i=this.addChildAtPath([],e);return i.data[parseInt(n)]=t,i},n.prototype.getChildAtPath=function(e){var n=e.slice(0);return n.reverse(),function e(i){var r=n.pop();return t.isUndefined(r)?i:e(i.children[r])}(this)},n.prototype.getPathForChildNode=function(e){var n=this;t.each(t.keys(this.children),function(t){if(n.children[t]===e)return t})},n.prototype.getPath=function(){var e=[];return function n(i){t.isUndefined(i.pathId)||e.push(i.pathId),i.isRoot()||n(i.parent)}(this),e.reverse()},n.prototype.getFilteredData=function(){return t.filter(this.data,function(e){return!t.isNaN(e)&&!t.isNull(e)&&!t.isUndefined(e)})},e}),define("dataFlow/enums",[],function(){return{INTERPRET_AS:{ITEM:0,LIST:1,TREE:2},OUTPUT_TYPES:{NUMBER:0,BOOLEAN:1,NUMPY_ARR:2,STRING:3,DATAFRAME:4,WILD:5,NULL:6,UNUSED1:7,ARRAY:8},KEYS:{SHIFT:16},DISPLAY_NAMES:{INTERPRET_AS:{0:"Item",1:"List",2:"Tree"},OUTPUT_TYPES:{0:"Number",1:"Boolean",2:"Numpy Array",3:"String",4:"Pandas Dataframe",5:"(Any Data Type)",6:"Null",7:"Unused",8:"List / Array"}}}}),define("dataFlow/pulse",["underscore","backbone","dataFlow/enums"],function(t,e,n){return e.Model.extend({defaults:function(){return{pathsOpened:0,pathsClosed:0,state:"GRAPH_DISCOVERY",componentPulseCounts:{}}},shouldPropagate:function(e){return!t.contains(t.keys(this.get("componentPulseCounts")),e.cid)},updatePathCounts:function(t){var e=!1,n=this.get("componentPulseCounts");if("GRAPH_DISCOVERY"==this.get("state")){if(this.set("pathsClosed",this.get("pathsClosed")+1),(e=this.shouldPropagate(t))?(this.setOpenPathCountBasedOnComponentOutputs(t),n[t.cid]=1):n[t.cid]=n[t.cid]+1,this.get("pathsClosed")===this.get("pathsOpened")){this.set("state","RECALCULATION");var i=this.get("startPoint");"function"==typeof i.processIncomingChange?i.processIncomingChange(this):i.trigger("pulse",this)}}else"RECALCULATION"==this.get("state")&&(n[t.cid]=n[t.cid]-1,0===n[t.cid]&&(e=!0));return e},setOpenPathCountBasedOnComponentOutputs:function(e){var n=0;t.each(e.outputs,function(e){"object"==typeof e._events&&t.isArray(e._events.pulse)&&(n+=e._events.pulse.length)}),this.set("pathsOpened",this.get("pathsOpened")+n)},cancel:function(){this.set("state","CANCELLED")},initialize:function(e){if(t.bindAll(this,"cancel","updatePathCounts","shouldPropagate","setOpenPathCountBasedOnComponentOutputs"),!e||!e.startPoint)throw new Error("Pulse must be initialized with a starting Input, Output, or Component");"Input"===e.startPoint.modelType&&this.set("pathsOpened",1)}})}),define("dataFlow/core_IOModels",["underscore","backbone","dataFlow/dataTree","dataFlow/enums","dataFlow/pulse"],function(t,e,n,i,r){var o=e.Model.extend({defaults:function(){return{persistedData:new n,invisible:!1}},initialize:function(e){var r=t.extend(e||{},{});if(t.isUndefined(r.type))throw new Error("No type specified for Output");if(!t.has(t.values(i.OUTPUT_TYPES),r.type))throw new Error("Invalid Output Type Specified: "+r.type);if(t.isUndefined(r.shortName))throw new Error("No shortName specified for Output");this.required=!!t.isUndefined(r.required)||r.required,this.type=r.type,this.default=t.isUndefined(r.default)?null:r.default,this.containsNewData=!!t.isUndefined(r.containsNewData),this.shortName=r.shortName,this.values=new n([]),this.desc=r.desc,t.isUndefined(r.invisible)||this.set({invisible:r.invisible});var o=i.INTERPRET_AS.ITEM;if(t.isUndefined(r.interpretAs)||(t.has(t.keys(i.INTERPRET_AS),r.interpretAs)?o=r.interpretAs:console.warn("Invalid list interpretation type passed to an input. Using default ITEM interpretation. See ENUMS.INTERPRET_AS")),this.interpretAs=o,this.isMaster=r.isMaster,!t.isUndefined(r.persistedData)){var a=new n;a.fromJSON(r.persistedData),this.assignPersistedData(a)}"function"==typeof this._initialize&&this._initialize()},replaceData:function(t){if("DataTree"!==t.constructor.name)throw new Error("Attempt to replace Data Tree with something that's not a Data Tree.");this.clearValues(),this.values=t},assignPersistedData:function(t){throw new Error("Cannot call assignPersistedData() on base io class")},getTree:function(){if(this.hasConnectedOutputs())return this.applyTreeTransform(this.values);if(t.isUndefined(this.get("persistedData"))||this.get("persistedData").isEmpty()){if(t.isNull(this.default))return new n;var e=new n;return e.setDataAtPath([this.default],[0]),e}return this.applyTreeTransform(this.get("persistedData"))},applyTreeTransform:function(t){return t.copy()},getDefaultValue:function(){return console.warn("getDefaultValue() is deprecated. Use getTree() instead, but assume that the default value will appear inside a data tree."),this.default},getFirstValueOrDefault:function(){return this.getTree().dataAtPath([0])[0]},clearValues:function(){"Output"===this.modelType&&!0===this.containsNewData&&this.values.recurseTree(function(e,n){t.each(e,function(e){t.isEmpty(e)||"function"!=typeof e.destroy?t.isEmpty(e)||t.isNumber(e)||t.isArray(e)||console.warn("Can't destroy object type: "+typeof e+" / constructor: "+e.constructor.name):e.destroy()}),n.data=[]}),this.values=new n},_destroy:function(){this.disconnectAll(),this.stopListening()},toJSON:function(){var e={shortName:this.shortName,desc:this.desc,default:this.default,required:this.required,interpretAs:this.interpretAs,id:this.id||this.cid,connections:t.map(this._listeningTo,function(t){return t.id||t.cid}),type:this.type};return t.isUndefined(this.get("persistedData"))||this.get("persistedData").isEmpty()||(e.persistedData=this.get("persistedData").toJSON()),e}}),a=o.extend({modelType:"Input",validateOutput:function(t){var e=i.OUTPUT_TYPES.WILD;if(this.type!==t.type&&this.type!==e&&t.type!==e)throw new Error("Incongruent output connected to an input");return!0},connectOutput:function(t){this.disconnectAll(!0);try{this.connectAdditionalOutput(t,!1)}catch(t){this.trigger("pulse",new r({startPoint:this})),console.warn("Caught an error during connection: ",t.message,t.stack)}},disconnectOutput:function(t,e){this.stopListening(t),this.trigger("disconnectedOutput",t),!0!==e&&this.trigger("pulse",new r({startPoint:this}))},disconnectAll:function(e){var n=this;t.each(t.clone(this._listeningTo),function(t){n.disconnectOutput.call(n,t,!0)}),!0!==e&&(this.trigger("pulse",new r({startPoint:this})),this.trigger("disconnectAll",this))},processIncomingChange:function(e){var n=!1,i=e||new r({startPoint:this}),o=this;"RECALCULATION"===i.get("state")&&t.each(this._listeningTo,function(t){!1===n?(o.values=t.getTree().copy(),n=!0):t.getTree().recurseTree(function(t,e){var n=e.getPath(),i=o.values.dataAtPath(n).concat(t);o.values.setDataAtPath(i,n)})}),this.trigger("pulse",i)},connectAdditionalOutput:function(e,n){!1!==n&&this.validateOutput(e);var i=this;t.each(this._listeningTo,function(t){e===t&&i.disconnectOutput.call(i,t)}),this.listenTo(e,"pulse",function(t){i.processIncomingChange.call(i,t)}),this.listenTo(e,"disconnectAll",function(t){i.disconnectOutput.call(i,t)}),this.trigger("connectedOutput",e),this.processIncomingChange()},assignPersistedData:function(e){var i=e;t.isArray(e)&&(i=new n).setDataAtPath(e,[0]),this.set("persistedData",i),this.trigger("pulse",new r({startPoint:this}))},hasConnectedOutputs:function(){return!(0===t.keys(this._listeningTo).length)},destroy:function(){this._destroy()}});return{Output:o.extend({_initialize:function(){},modelType:"Output",destroy:function(){this.clearValues(),this._destroy()},disconnectAll:function(){this.trigger("disconnectAll",this)},assignPersistedData:function(t){this.set("persistedData",t),this.trigger("pulse",new r({startPoint:this}))},hasConnectedOutputs:function(){return!0}}),Input:a}}),define("dataFlow/dataMatcher",["underscore","dataFlow/dataTree","dataFlow/enums"],function(t,e,n){function i(i,o,a,s,l){var u=new e,c=t.isObject(s)?t.keys(s):void 0,h=!1,d=[],f=t.indexOf(i,o);t.each(i,function(t){d.push(function(t){var e=[],i=t.getTree().copy();return t.interpretAs===n.INTERPRET_AS.LIST&&(t.isMaster&&(h=!0),t.getTree().recurseTree(function(t,e){i.setDataAtPath([t],e.getPath())})),i.recurseTree(function(t,n){e.push(n)}),e}(t))}),d=r(d);for(var p=[],m=!1,g=0;g<d[0].length;g++){var v,y,w=[];!0===m||t.isEqual(d[f][g].getPath(),p)?(p=y=function(t){var e=t.slice(0);return e[e.length-1]=e[e.length-1]+1,e}(p),m=!0):p=y=d[f][g].getPath();for(var b=0;b<d.length;b++)w.push(d[b][g].data);w=r(w);try{v=function(e,n){for(var i=[],r=0;r<e[0].length;r++){var o=t.map(e,function(t){return t[r]});i[r]=n.apply(this,o)}return i}(w,a)}catch(t){v=null,l.push(t.stack)}u.setDataAtPath(v,y)}return h&&s[c[0]].interpretAs!==n.INTERPRET_AS.LIST&&u.copy().recurseTree(function(t,e){u.setDataAtPath(t[0],e.getPath())}),t.each(s,function(t,e){t.replaceData(u.map(function(t){return t[e]}))}),u}function r(e){var n=[],i=t.max(t.map(e,function(t){return t.length}));return t.each(e,function(t){for(var e=[],r=0;r<i;)r<t.length?e[r]=t[r]:e[r]=e[r-1],r++;n.push(e)}),n}return function(e,r,o){if(!t.isFunction(r))throw new Error("DataMatcher requires a calculation function");if(!t.isArray(e))throw new Error("DataMatcher expects an array of inputs");if(!t.isArray(o))throw new Error("'outputs' parameter for dataMatcher must be an array of outputs corresponding to each result generated by .recalculate()");var a={};t.each(o,function(t){a[t.shortName]=t});var s=[],l=function(e){var i;if(t.each(e,function(t){!0===t.isMaster&&(i=t)}),i)return i;var r=t.map(e,function(e){return t.isNull(e.getTree())?1:e.getTree().getMaxPathLength()}),o=t.max(r),a=[];if(t.each(r,function(t,n){t===o&&a.push(e[n])}),1===a.length)return a[0];var s=t.filter(a,function(t){return t.interpretAs===n.INTERPRET_AS.ITEM});if(1===s.length)return s[0];if(0===s.length){var l=t.filter(a,function(t){return t.interpretAs===n.INTERPRET_AS.LIST});return 0===l.length?a[0]:(l.length,l[0])}return s[0]}(e);return{errors:s,tree:i(e,l,r,a,s),masterInput:l}}}),define("dataFlow/components/engine",[],function(){return new function(){this.setupComplete=!1,this.Jupyter=null,this.executionQueue=[],this.transcript="";var t=this,e="import numpy as np\nimport pandas as pd\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\n%matplotlib inline\n";this.resetTranscript=function(){t.transcript=e},this.getTranscript=function(){var e=t.transcript.match(/# (GET|POST|DELETE|PUT) \/.*\n/g);return e&&(t.transcript=e[0]+t.transcript),t.transcript},this.setup=function(n){t.Jupyter=n,t.execute(e,{success:function(){console.log("Python Engine Successfully Initialized"),t.setupComplete=!0,t.executionQueue.length>0&&t._executeNext()},error:function(t){throw console.error("ERROR IMPORTING REQUIRED PYTHON LIBRARIES."),new Error(t)}},{force:!0})},this._executeNext=function(){console.warn("EXECUTE NEXT IS PROBABLY BROKEN. IT HAS NOT BEEN TESTED YET");var e=t.executionQueue.shift();t.execute.apply(this,e)},this.execute=function(e,n,i){var r=n.statusSet||function(){},o=n.success||function(){},a=n.error||function(){},s=n.setOutput||function(){},l=i&&!0===i.force;t.setupComplete||!0===l?(r("RUNNING"),console.log("Executing Python: ",e),t.transcript+=e,Jupyter.notebook.kernel.execute(e,{shell:{reply:function(t){"ok"===t.content.status?(r("DONE"),o(t.content)):"error"===t.content.status&&(r("ERROR"),a(t.content))}},iopub:{output:function(t){s(t.content)}}},{silent:!1,store_history:!1,stop_on_error:!1})):t.executionQueue.push(arguments)}}}),define("dataFlow/freezeCalculations",[],function(){var t=!1;return{setFrozen:function(e){t=e},getFrozen:function(){return t}}}),define("dataFlow/core_ComponentModel",["underscore","backbone","dataFlow/core_IOModels","dataFlow/pulse","dataFlow/enums","dataFlow/dataMatcher","dataFlow/components/engine","dataFlow/freezeCalculations"],function(t,e,n,i,r,o,a,s){return e.Model.extend({modelType:"Component",initialize:function(){var t="function"==typeof this.recalculateTrees,e="function"==typeof this.recalculate;if(!t&&!e||t&&e)throw new Error(this.get("componentPrettyName")+" needs either .recalculate() or .recalculateTrees(), but not both!");this.base_init.apply(this,arguments)},createIObjectsFromJSON:function(e,i,r){var o=[],a=(r="output"===r?"outputs":r,{outputs:n.Output,inputs:n.Input}),s=this,l=t.isUndefined(i)?{}:t.isUndefined(i[r])?{}:i[r];return t.each(t.values(e),function(e){var n=t.findWhere(l,{shortName:e.shortName});t.isEmpty(n)||n.type===e.type||console.warn("Datatype mismatch between persisted datatype and "+s.componentName+" definition. This indicates a namespace collision, or a change to a component's definition after it was used to persist data. Saved connections to this component may fail!");var i=new a[r](t.extend(n||{},e));o.push(i)}),o},base_init:function(e){if(t.isUndefined(e)||t.isUndefined(e.inputs)||t.isUndefined(e.output)&&t.isUndefined(e.outputs))throw new Error("Insufficient specifications for a Component");this._sufficient=!1,t.bindAll(this,"_handleInputChange","_propagatePulse","recalculate","getOutputVariableName","validatePythonTemplate"),this.outputs=this.initializeOutputs(t.isUndefined(e.outputs)?[e.output]:e.outputs),this.inputs=this.initializeInputs(e.inputs),this.position=e.position||{x:0,y:0},this.set("componentPrettyName",e.componentPrettyName),this.set("preview",e.preview||!1),this.set("pythonTemplate",e.pythonTemplate),e.pythonTemplate&&(this.validatePythonTemplate(e.pythonTemplate),this.pythonTemplateFn=t.template(e.pythonTemplate),t.bindAll(this,"pythonTemplateFn")),this.previews=[],this.on("change:preview",function(){this.clearPreviews(),!0===this.get("preview")&&this.drawPreviews()})},validatePythonTemplate:function(){var e=[],n=this;t.each(this.inputs,function(t){e.push("IN_"+t.shortName)}),e.push("RESULT"),t.each(e,function(t){if(n.get("pythonTemplate").indexOf(t)<0)throw new Error("Component is badly coded. Its inputs and outputs are not referenced by its python template, so they'll never be used.")})},getOutputVariableName:function(){var e=this.get("componentPrettyName");return e.length<1&&(e=this.componentName),e+="_",t.uniqueId(e.toLowerCase().replace(/[^a-z]/g,"_"))},initializeOutputs:function(e){var n=this;return t.each(e,function(t){n.on("pulse",function(e){t.trigger("pulse",e)})}),e},initializeInputs:function(e){var n=this;return t.each(e,function(t){n[t.shortName]=t,n.listenTo(t,"pulse",n._propagatePulse)}),e},_propagatePulse:function(t){if("GRAPH_DISCOVERY"===t.get("state"))t.updatePathCounts(this)&&this.trigger("pulse",t);else if("RECALCULATION"===t.get("state")){t.updatePathCounts(this)&&(this._handleInputChange(),this.trigger("pulse",t))}},assignInput:function(e,n){if(t.isUndefined(e)||t.isUndefined(n))throw new Error("Unspecified Input");if(!t.has(this,e))throw new Error("Tried to specify an input that does not exist");if(this[e].type!==n.type)throw new Error("Tried to specify an input of the wrong type");this[e].connectOutput(n)},getOutput:function(e){return e&&1!==this.outputs.length?t.findWhere(this.outputs,{shortName:e}):this.outputs[0]},getInput:function(e){return t.findWhere(this.inputs,{shortName:e})},destroy:function(){t.each(this.outputs,function(t){t.destroy()}),this.trigger("removed",this),t.each(this.inputs,function(t){t.destroy()}),this.off(),this.stopListening(),delete this.inputs,delete this.outputs},_windowFrozenWarnOnce:t.throttle(function(){console.warn("WINDOW FROZEN. CALCULATION SKIPPED.")},5e3),_handleInputChange:function(){if(!0===s.getFrozen())return this._windowFrozenWarnOnce();var e=!t.every(this.inputs,function(t){return!0!==t.getTree().isEmpty()});if(this.set({sufficient:!e}),this.errors=[],!e)if(this.simulatedRecalculate(),"function"==typeof this.recalculateTrees)this.recalculateTrees();else{var n=o(this.inputs,this.recalculate,this.outputs);n.errors.length>0&&(this.set({sufficient:"error"}),console.log(n.errors))}!0===this.get("preview")&&(e?this.clearPreviews():this.drawPreviews()),e&&this.clear(!1)},clear:function(e){if(t.each(this.outputs,function(t){t.clearValues()}),!0===e){var n=new i({startPoint:this,pathsOpened:1});this.trigger("pulse",n)}},isNull:function(){return t.every(this.outputs,function(t){return t.getTree().isEmpty()})},recalculate:function(){var e=this,n=[],i=t.map(arguments,function(e){var i=t.isArray(e);return i?t.each(e,function(t){n.push(t)}):n.push(e),i?e.length:0});n=t.map(n,function(t){return"string"==typeof t?'"'+t+'"':t});var r=Promise.all(n).then(function(e){return new Promise(function(n,r){var o=[];t.each(i,function(t){0===t?o.push(e.shift()):(o.push(e.slice(0,t)),e=e.slice(t))}),n(o)})}).then(function(){var n=arguments[0];return new Promise(function(i,r){var o=e.getOutputVariableName(),s={RESULT:o};t.each(e.inputs,function(t,e){s["IN_"+t.shortName]=n[e]});var l=e.pythonTemplateFn(s);a.execute(l,{statusSet:function(t){},success:function(){i(o)},error:function(t){r(t)},setOutput:function(t){}})})}),o={};return 1===this.outputs.length?o[this.outputs[0].shortName]=r.catch(function(t){e.set({sufficient:"error"})}):t.each(this.outputs,function(t,n){o[t.shortName]=r.catch(function(t){e.set({sufficient:"error"})}).then(function(t){return new Promise(function(e){return e(t+"["+n+"]")})})}),r.catch(function(t){e.errors.push({type:t.ename,message:t.evalue}),e.set({sufficient:"error"})}),o},simulatedRecalculate:function(){},fetchOutputs:function(){return this.getOutput().getTree().flattenedTree().dataAtPath([0])},getPreviewOutputs:function(){return[this.getOutput()]},drawPreviews:function(){var e=this.getGeometry(),n=this.getPreviewOutputs()[0].type,i={};if(i[r.OUTPUT_TYPES.CURVE]="CurveListPreview",i[r.OUTPUT_TYPES.POINT]="PointListPreview",n===r.OUTPUT_TYPES.WILD&&(e[0].constructor===Geometry.Curve?(n=r.OUTPUT_TYPES.CURVE,e=t.filter(e,function(t){return t.constructor===Geometry.Curve})):e[0].constructor===Geometry.Point&&(n=r.OUTPUT_TYPES.POINT,e=t.filter(e,function(t){return t.constructor===Geometry.Point}))),this.previews[0]&&this.previews[0].constructor===Preview[i[n]])this.previews[0].updateGeometry(e);else{console.warn("New preview type mismatches previous preview type. Destroy old previews?");var o=Preview[i[n]];"function"==typeof o&&(this.previews[0]=new o(e))}},exportGeometry:function(e){if(!t.contains(["SVG"],e))throw new Error("Unrecognized export type: "+e);this.trigger("requestFileExport",{type:e,geometry:this.getGeometry()})},getGeometry:function(){var t=this.getPreviewOutputs(),e=t[0].getTree().flattenedTree().dataAtPath([0]);if(t.length>1)for(var n=1;n<t.length;n++)e=e.concat(t[n].getTree().flattenedTree().dataAtPath([0]));return e},destroyPreviews:function(){this.clearPreviews(),this.previews.splice(0,this.previews.length)},clearPreviews:function(){t.each(this.previews,function(t){t.hide()})},toJSON:function(){var e=[],n=[];return t.each(this.inputs,function(t){e.push(t.toJSON())}),t.each(this.outputs,function(t){n.push(t.toJSON())}),{componentPrettyName:this.attributes.componentPrettyName,componentName:this.componentName,position:this.position,preview:this.attributes.preview,inputs:e,outputs:n,id:this.id||this.cid}}})}),define("dataFlow/core",["dataFlow/core_IOModels","dataFlow/core_ComponentModel","dataFlow/enums","dataFlow/pulse"],function(t,e,n,i){var r={};return r.OUTPUT_TYPES=n.OUTPUT_TYPES,r.INTERPRET_AS=n.INTERPRET_AS,r.Output=t.Output,r.Input=t.Input,r.Component=e,r.Pulse=i,r}),define("dataFlow/components/outputComponents",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher","dataFlow/components/engine"],function(t,e,n,i,r){var o={};return o.PrintComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.WILD,desc:"Data to be viewed"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),o=t.extend({componentPrettyName:"Print"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = print(<%= IN_D %>)\n"});this.base_init(o)},recalculate:function(){var e=this,n=Promise.all(arguments).then(function(){var n=arguments[0];return new Promise(function(i,o){var a={RESULT:e.getOutputVariableName()};t.each(e.inputs,function(t,e){a["IN_"+t.shortName]=n[e]});var s=e.pythonTemplateFn(a);r.execute(s,{statusSet:function(t){},success:function(){},error:function(t){console.log("python status ERROR: ",t),o()},setOutput:function(t){e.getOutput("D").trigger("change"),i(t)}})})}).catch(function(t){console.warn("Some inputs resolved as errors. This behavior should be defined... it can either 'show what we have' or error out, in which case prior data should be cleared.")}),i={};return 1===this.outputs.length?i[this.outputs[0].shortName]=n:t.each(this.outputs,function(t,e){i[t.shortName]=n.then(function(t){return new Promise(function(n){return n(t+"["+e+"]")})})}),i}},{label:"Print",desc:"View the value of a variable"}),o.LinePlot=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"X",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"X-Axis Values",interpretAs:e.INTERPRET_AS.LIST},{required:!0,shortName:"Y",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Y-Axis Values",interpretAs:e.INTERPRET_AS.LIST}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"P",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),o=t.extend({componentPrettyName:"LinePlot"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = plt.figure()\n<% _.each(IN_X , function(x,index) { %>plt.plot(<%= x %>, <%= IN_Y[index] %>)\n<% }) %>"});this.base_init(o)},recalculate:function(){var e=this,n=Promise.all(arguments).then(function(t){var e=Promise.all(t[0]),n=Promise.all(t[1]);return new Promise(function(t,i){var r;e.then(function(t){return r=t,n}).then(function(e){for(;r.length<e.length;)r.push(r[r.length-1]);t({x:r,y:e})})})}).then(function(n){var i=[n.x,n.y];return new Promise(function(n,o){var a=[],s={RESULT:e.getOutputVariableName()};t.each(e.inputs,function(t,e){s["IN_"+t.shortName]=i[e]});var l=e.pythonTemplateFn(s);r.execute(l,{statusSet:function(t){},error:function(t){console.log("python status ERROR: ",t),o()},success:function(t){e.getOutput("P").trigger("change"),n(a)},setOutput:function(t){t.data&&t.data["image/png"]&&a.push(t.data["image/png"])}})})}).catch(function(t){console.warn("Some inputs resolved as errors. This behavior should be defined... it can either 'show what we have' or error out, in which case prior data should be cleared.")}),i={};return 1===this.outputs.length?i[this.outputs[0].shortName]=n:t.each(this.outputs,function(t,e){i[t.shortName]=n.then(function(t){return new Promise(function(n){return n(t+"["+e+"]")})})}),i}},{label:"Line Plot",desc:"Plot two variables against each other using connecting lines"}),o.ExportPythonVariable=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.WILD,desc:"Data for export"},{required:!0,shortName:"N",type:e.OUTPUT_TYPES.STRING,desc:"Variable Names"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"P",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),o=t.extend({componentPrettyName:"Export Vars"},n||{},{inputs:i,outputs:r,pythonTemplate:"<% print(IN_N.replace(/[\"]+/g, '')); %> = <%= IN_D %> #<%= RESULT %>\n"});this.base_init(o)}},{label:"Export a variable for use in your Jupyter Document",desc:"Makes a Python object available in the Jupyter Context"}),o.ExportCSVFile=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe for export"},{required:!0,shortName:"P",type:e.OUTPUT_TYPES.STRING,desc:"Output path (use absolute paths)"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"P",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),o=t.extend({componentPrettyName:"Export CSV"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_D %>.to_csv(<%= IN_P %>)\n"});this.base_init(o)}},{label:"Export a Dataframe as a CSV File",desc:"Serialize a Pandas Dataframe into CSV format, and save the file to a local path on your computer"}),o.ExposeAPIEndpoint=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"E",type:e.OUTPUT_TYPES.STRING,desc:"Endpoint Name"},{required:!0,shortName:"A",type:e.OUTPUT_TYPES.STRING,desc:"Arguments for endpoint",interpretAs:e.INTERPRET_AS.LIST},{required:!1,default:"",shortName:"T",type:e.OUTPUT_TYPES.STRING,desc:"Argument Test Values",interpretAs:e.INTERPRET_AS.LIST}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.STRING,desc:"Argument Values"}],n,"output"),o=t.extend({componentPrettyName:"API"},n||{},{inputs:i,outputs:r,pythonTemplate:"# GET /<% print(IN_E.replace(/[\"]+/g, '')); %>\nimport json\ntry:\n  req = json.loads(REQUEST)\n  args = req['args']\n  <%= RESULT %> = (<% _.each(IN_A , function(argVariable,idx) { %>  <% if (idx != 0) { print(','); } %>  args[<%= argVariable %>][0]  <% }) %>)\nexcept:\n  <%= RESULT %> = (<% _.each(IN_A , function(argVariable,idx) { %>  <% if (idx != 0) { print(','); } %>  <% if (IN_T[idx] && typeof IN_T[idx] == 'string' && IN_T[idx].length > 2) { %><%= IN_T[idx] %> <% }  else { print(argVariable); } %>  <% }) %>)\n"});this.base_init(o)}},{label:"Expose this Orchestra Definition as an API via Jupyter Kernel Gateway",desc:"Create a web microservice based on your Jupyter definition. Accept inputs using this component, and include a single 'print' component to send output to the response."}),o.SpreadsheetComponent=o.PrintComponent.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe for viewing"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),o=t.extend({componentPrettyName:"Spreadsheet"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = print(<%= IN_D %>.to_json())\n"});this.base_init(o)}},{label:"View a Pandas Dataframe in a Spreadsheet",desc:"To conveniently view a whole dataframe in the browser, regardless of size, plug it into this component and single-click the component."}),o}),define("dataFlow/components/number",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var r={};return r.NumberComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{shortName:"N",type:e.OUTPUT_TYPES.NUMBER}],n,"output"),r=this.createIObjectsFromJSON([{required:!1,shortName:"N",type:e.OUTPUT_TYPES.NUMBER}],n,"inputs"),o=t.extend({componentPrettyName:"Number"},n||{},{inputs:r,outputs:i,pythonTemplate:"<%= RESULT %> = <%= IN_N %>\n"});this.base_init(o)}},{label:"Number",desc:"Holds a list of numbers. For short lists, you can enter the numbers directly into the component"}),r.SeriesComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{shortName:"S",type:e.OUTPUT_TYPES.NUMBER,desc:"Series"}],n,"output"),r=this.createIObjectsFromJSON([{shortName:"S",required:!1,default:0,type:e.OUTPUT_TYPES.NUMBER,desc:"First number in series"},{shortName:"N",required:!1,default:1,type:e.OUTPUT_TYPES.NUMBER,desc:"Step size"},{shortName:"C",required:!1,default:10,type:e.OUTPUT_TYPES.NUMBER,desc:"Count of numbers in series"}],n,"inputs"),o=t.extend({componentPrettyName:"Series",preview:!1},n||{},{inputs:r,outputs:i});this.base_init(o),this.recalculate()},recalculate:function(t,e,n){for(var i=[],r=0;r<n;)i.push(t+e*r),r++;return{S:i}}},{label:"Series",desc:"Generates a list of numbers. You can control the start of the list, the increment, and the number of values"}),r.SliderComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{shortName:"N",type:e.OUTPUT_TYPES.NUMBER,desc:"Value"}],n,"output"),r=this.createIObjectsFromJSON([{shortName:"S",required:!1,default:0,type:e.OUTPUT_TYPES.NUMBER,desc:"Start"},{shortName:"E",required:!1,default:1,type:e.OUTPUT_TYPES.NUMBER,desc:"End"},{shortName:"I",required:!1,default:!1,type:e.OUTPUT_TYPES.BOOLEAN,desc:"Integers"},{shortName:"N",required:!1,default:.5,type:e.OUTPUT_TYPES.NUMBER,invisible:!0,desc:"Value"}],n,"inputs"),o=t.extend({componentPrettyName:"Slider",preview:!1},n||{},{inputs:r,outputs:i});this.base_init(o)},storeUserData:function(t){var e=new n;e.setDataAtPath([t],[0]),this.getInput("N").assignPersistedData(e)},recalculateTrees:function(){var t=this.getInput("N").getFirstValueOrDefault(),e=this.getInput("S").getFirstValueOrDefault(),n=this.getInput("E").getFirstValueOrDefault();!0===this.getInput("I").getFirstValueOrDefault()&&Math.floor(t)!=t&&(t=Math.floor(t)),t>n&&(t=n),t<e&&(t=e),this.getOutput("N").values.setDataAtPath([t],[0])}},{label:"Slider",desc:"A convenient way to change numerical values on the fly. Shows a touch/mouse-enabled slider"}),r}),define("dataFlow/components/simplemath",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var r={};return r.NumberAdditionComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMBER},{required:!0,shortName:"B",type:e.OUTPUT_TYPES.NUMBER}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"N",type:e.OUTPUT_TYPES.NUMBER}],n,"output"),o=t.extend({componentPrettyName:"Number Addition"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_A %> + <%= IN_B %>\n"});this.base_init(o)}},{label:"Add",desc:"Add two numbers together"}),r.NumberSubtractComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMBER},{required:!0,shortName:"B",type:e.OUTPUT_TYPES.NUMBER}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"N",type:e.OUTPUT_TYPES.NUMBER}],n,"output"),o=t.extend({componentPrettyName:"Number Subtraction"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_A %> - <%= IN_B %>\n"});this.base_init(o)}},{label:"Subtract",desc:"Subtract A - B"}),r}),define("dataFlow/components/treeComponents",["underscore","dataFlow/core","dataFlow/dataMatcher"],function(t,e,n){var i={};return i.GraftComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Graft"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"T",type:e.OUTPUT_TYPES.WILD}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"T",type:e.OUTPUT_TYPES.WILD,containsNewData:!1}],n,"output")}))},recalculateTrees:function(){this.getOutput("T").replaceData(this.getInput("T").getTree().graftedTree())}},{label:"Graft Tree",desc:"Creates a separate branch for each data item in the supplied tree"}),i.ShiftComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Shift"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0},{required:!1,shortName:"S",default:1,type:e.OUTPUT_TYPES.NUMBER},{required:!1,shortName:"W",default:!0,type:e.OUTPUT_TYPES.BOOLEAN}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(t,e,n){var i=t.slice(e);return n&&(i=i.concat(t.slice(0,e))),{L:i}}},{label:"Shift List",desc:"Removes items from the beginning of a data list, and optionally tacks them back onto the end"}),i.CullIndexComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Cull i"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"List to Cull"},{required:!0,shortName:"i",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Culling indices"},{required:!1,shortName:"W",default:!0,type:e.OUTPUT_TYPES.BOOLEAN,desc:"Wrap indices to list range"}],n,"inputs"),outputs:output=this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n,i){var r=[];return t.each(e,function(e,i){t.contains(n,i)||r.push(e)}),{L:r}}},{label:"Cull Index",desc:"Cull (remove) indexed elements from a list"}),i.CullPatternComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Cull"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"List to Cull"},{required:!0,shortName:"P",type:e.OUTPUT_TYPES.BOOLEAN,interpretAs:e.INTERPRET_AS.LIST,desc:"Culling pattern"}],n,"inputs"),outputs:output=this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n){var i=n.length;return{L:t.filter(e,function(t,e){return n[e%i]})}}},{label:"Cull Pattern",desc:"Cull (remove) indexed elements from a list using a repeating bit mask"}),i.CullFrequencyComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({componentPrettyName:"CullN",preview:!1},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"List to Cull"},{required:!1,default:2,shortName:"N",type:e.OUTPUT_TYPES.NUMBER,desc:"Cull frequency"}],n,"inputs"),outputs:output=this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n){return{L:t.filter(e,function(t,e){return(e+1)%n!=0})}}},{label:"Cull Nth",desc:"Cull (remove) every Nth element in a list"}),i.InsertItemsComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Ins"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"List to modify"},{required:!0,shortName:"I",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"Items to insert. If no items are supplied, nulls will be inserted"},{required:!0,shortName:"i",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Insertion index for each item"},{required:!1,shortName:"W",default:!0,type:e.OUTPUT_TYPES.BOOLEAN,desc:"If true, indices will be wrapped"}],n,"inputs"),outputs:output=this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n,i,r){console.warn("TODO: Support 'wrap' option on insert-items component");var o=e.slice(0),a=n.slice(0).reverse();return t.each(i.slice(0).reverse(),function(t,e){o.splice(t,0,a[e])}),{L:o}}},{label:"Insert Items",desc:"Insert a collection of items into a list"}),i.FlattenComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Flatten"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"T",type:e.OUTPUT_TYPES.WILD},{required:!1,shortName:"P",default:[0],type:e.OUTPUT_TYPES.ARRAY}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"T",type:e.OUTPUT_TYPES.WILD,containsNewData:!1}],n,"output")}))},recalculateTrees:function(){console.warn("PATH input is ignored for now");var t=this.getInput("T").getTree().flattenedTree(!1);this.getOutput("T").replaceData(t)}},{label:"Flatten Tree Data",desc:"Flatten a data tree by removing all branching information"}),i.ListItemComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Item"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST},{required:!1,shortName:"i",default:0,type:e.OUTPUT_TYPES.NUMBER},{required:!1,shortName:"W",default:!0,type:e.OUTPUT_TYPES.BOOLEAN}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"i",type:e.OUTPUT_TYPES.WILD,containsNewData:!1}],n,"output")}))},recalculate:function(e,n,i){return t.isArray(e)?!i&&e.length<=n?null:{i:e[n%e.length]}:null}},{label:"Extract Item from List",desc:"Retrieve a specific item from a list"}),i.DuplicateDataComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Dup"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST},{required:!1,shortName:"N",default:2,type:e.OUTPUT_TYPES.NUMBER},{required:!1,shortName:"O",default:!0,type:e.OUTPUT_TYPES.BOOLEAN}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n,i){if(!t.isArray(e))return null;console.warn("RETAIN ORDER FALSE NOT SUPPORTED");for(var r=[],o=0;o<n;o++)r=r.concat(e);return{D:r}}},{label:"Duplicate Data",desc:"Duplicate data a predefined number of times"}),i.ListLengthComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Lng"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.NUMBER}],n,"output")}))},recalculate:function(e){return t.isArray(e)?{L:e.length}:null}},{label:"List Length",desc:"Measure the length of a List"}),i}),define("dataFlow/components/numpy_create",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var r={};return r.NumpyZeros=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 0 Length"},{required:!1,default:0,shortName:"R",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 1 Length"},{required:!1,default:0,shortName:"W",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 2 Length"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"Zeros"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = np.zeros((<%= IN_C %><% if (IN_R) { %>, <%= IN_R %><% } %><% if (IN_W) { %>, <%= IN_W %><% } %> ))\n"});this.base_init(o)}},{label:"Zeros Array",desc:"Create a NumPy Zeros Array, up to 3 dimensions"}),r.NumpyFullNDimensions=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Dimensions of numpy array"},{required:!1,default:0,shortName:"V",type:e.OUTPUT_TYPES.NUMBER,desc:"Value to fill the array with"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"Full N-D Array"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = np.full((<%= IN_D %>), <%= IN_V %>)\n"});this.base_init(o)}},{label:"Full N-Dimensional Array",desc:"Create a full Numpy array of unlimited dimensions"}),r.NumpyFullRandom=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Shape of Numpy Array"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"Random Array"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = np.random.rand(<%= IN_D %>)\n"});this.base_init(o)}},{label:"Create a Numpy Array Full of Random Values",desc:"Create a new Numpy Array (of shape specified) full of random values"}),r.NumpyFull=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 0 Length"},{required:!1,default:0,shortName:"R",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 1 Length"},{required:!1,default:0,shortName:"W",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 2 Length"},{required:!1,default:0,shortName:"V",type:e.OUTPUT_TYPES.NUMBER,desc:"Value"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"Full"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = np.full((<%= IN_C %><% if (IN_R) { %>, <%= IN_R %><% } %><% if (IN_W) { %>, <%= IN_W %><% } %>), <%= IN_V %>)\n"});this.base_init(o)}},{label:"Full Array",desc:"Create a NumPy Array with every value set to a particular value"}),r.NumpyRange=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!1,default:0,shortName:"S",type:e.OUTPUT_TYPES.NUMBER,desc:"Start"},{required:!1,default:10,shortName:"E",type:e.OUTPUT_TYPES.NUMBER,desc:"End"},{required:!1,default:1,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Step"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"Range"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = np.arange(<%= IN_S %>, <%= IN_E %>, <%= IN_C %> )\n"});this.base_init(o)}},{label:"Range",desc:"Create a 1D NumPy Range Array"}),r.NumpyLinspace=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!1,default:0,shortName:"S",type:e.OUTPUT_TYPES.NUMBER,desc:"Start, the array's first value"},{required:!1,default:10,shortName:"E",type:e.OUTPUT_TYPES.NUMBER,desc:"End, the array's last value"},{required:!1,default:1,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Count, number of items in the array"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"Linspace"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = np.linspace(<%= IN_S %>, <%= IN_E %>, <%= IN_C %>)\n"});this.base_init(o)}},{label:"Linspace",desc:"Create a 1D NumPy Linear Space as a function of Start, End, and Count of Values"}),r}),define("dataFlow/components/numpy_simplemath",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var r={};return r.NumpySin=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"sin(A)"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = np.sin(<%= IN_A %>)\n"});this.base_init(o)}},{label:"Numpy Vectorized Sin(x)",desc:"Return a numpy array whose members are the sine of the values of the members of the input array"}),r.NumpyCos=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"cos(A)"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = np.cos(<%= IN_A %>)\n"});this.base_init(o)}},{label:"Numpy Vectorized Cos(x)",desc:"Return a numpy array whose members are the cosine of the values of the members of the input array"}),r}),define("dataFlow/components/numpy_basics",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var r={};return r.NumpySlice=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array to Slice"},{required:!1,default:"null",shortName:"S",type:e.OUTPUT_TYPES.NUMBER,desc:"Start Index of Slice"},{required:!1,default:"null",shortName:"E",type:e.OUTPUT_TYPES.NUMBER,desc:"End Index of Slice"},{required:!1,default:"null",shortName:"N",type:e.OUTPUT_TYPES.NUMBER,desc:"Step"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"1D Sub Array"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_A %>[ <% if (IN_S != 'null'){ %><%= IN_S %><% } %> : <% if (IN_E != 'null'){ %><%= IN_E %><% } %> : <% if (IN_N != 'null'){ %><%= IN_N %><% } %>]\n"});this.base_init(o)}},{label:"Slice a Numpy Array",desc:"Create a slice (sub-array) of a numpy array based on a start index, end index, and number of steps between each index."}),r.NumpyExtractItem=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array"},{required:!1,default:0,shortName:"I",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Index of Item to Extract, <= Array Dimension"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR},{shortName:"N",type:e.OUTPUT_TYPES.WILD}],n,"output"),o=t.extend({componentPrettyName:"Extract Item"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = (<%= IN_A %>[<%= IN_I %>], <%= IN_A %>[<%= IN_I %>])\n"});this.base_init(o)}},{label:"Extract an Item from a Numpy Array",desc:"Extract an Item from Numpy array using Indexing. Position in a multi-dimensional array can be specified by subsequent items in the 'Index' input, which will be interpreted as a list."}),r.NumpyExtractColumn=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array, 2+ Dimensions"},{required:!1,default:0,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Index of Column to Extract"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"Extract Column"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_A %>[:,<%= IN_C %>]\n"});this.base_init(o)}},{label:"Extract the first column of a Numpy Array With 2 or more dimensions",desc:"Extract the first column of a Numpy array using a combination of index and slice methods eg, array[:,(column number)]"}),r.NumpyExtractRow=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array, 2+ Dimensions"},{required:!1,default:0,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Index of Row to Extract"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),o=t.extend({componentPrettyName:"Extract Row"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_A %>[<%= IN_C %>,:]\n"});this.base_init(o)}},{label:"Extract the first row of a Numpy Array With 2 or more dimensions",desc:"Extract the first row of a Numpy array using a combination of index and slice methods eg, array[(row number),:]"}),r.NumpyShape=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"S",type:e.OUTPUT_TYPES.ARRAY,desc:"Shape"},{shortName:"N",type:e.OUTPUT_TYPES.NUMBER,desc:"Number of Dimensions"},{shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Size"},{shortName:"D",type:e.OUTPUT_TYPES.STRING,desc:"Data Type"}],n,"output"),o=t.extend({componentPrettyName:"Shape"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = (<%= IN_A %>.shape, <%= IN_A %>.ndim, <%= IN_A %>.size, <%= IN_A %>.dtype)\n"});this.base_init(o)}},{label:"Shape of a Numpy Array",desc:"Retrieve the dimensions and data type of a Numpy Array"}),r}),define("dataFlow/components/dataframe_create",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var r={};return r.DataFrameFromCSV=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.STRING,desc:"Location of the source CSV"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME}],n,"output"),o=t.extend({componentPrettyName:"Read CSV"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = pd.read_csv(<%= IN_L %>)\n"});this.base_init(o)}},{label:"Pandas DataFrame From CSV",desc:"Read a CSV from a local file path or URL. Accepts http, s3, file, and ftp URLs. For file, a host is expected."}),r}),define("dataFlow/components/dataframe_basics",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var r={};return r.DataframeExtractColumn=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe from which columns should be selected"},{required:!0,shortName:"I",type:e.OUTPUT_TYPES.STRING,desc:"Indexes of Column to Extract",interpretAs:e.INTERPRET_AS.LIST}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME}],n,"output"),o=t.extend({componentPrettyName:"Extract Columns"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_D %>[[<%= IN_I %>]]\n"});this.base_init(o)}},{label:"Extract Named Columns from a Pandas Dataframe",desc:"Supply a list of column names (strings) to extract from a dataframe for more convenient manipulation."}),r.DataframeInsertColumn=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe into which a new column will be inserted"},{required:!1,shortName:"I",default:0,type:e.OUTPUT_TYPES.NUMBER,desc:"Index of location of new Column. Must be 0 <= Index <= len(columns)"},{required:!1,shortName:"L",default:"0",type:e.OUTPUT_TYPES.STRING,desc:"Label / name of the new column"},{required:!0,shortName:"V",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Values to insert"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME}],n,"output"),o=t.extend({componentPrettyName:"Insert Columns"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_D %>.copy()\n<%= RESULT %>.insert(<%= IN_I %>, <%= IN_L %>, <%= IN_V %>, allow_duplicates=False)\n"});this.base_init(o)}},{label:"Insert a new column into a pandas dataframe",desc:"Supply the position, label, and values for a new column that will be inserted into an existing Pandas Dataframe"}),r.DataframeShape=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe to learn the shape of"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"S",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Shape, a touple representing the dimensionality of the data frame"},{shortName:"N",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Number of Dimensions in each axis"},{shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Size, the number of elements in the dataframe"},{shortName:"D",type:e.OUTPUT_TYPES.STRING,desc:"Data Types"}],n,"output"),o=t.extend({componentPrettyName:"Shape"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = (<%= IN_D %>.shape, <%= IN_D %>.ndim, <%= IN_D %>.size, <%= IN_D %>.dtypes)\n"});this.base_init(o)}},{label:"Shape of a Pandas Dataframe",desc:"Retrieve the dimensions and data types of a Dataframe"}),r.DataframeCopy=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe to copy"}],n,"inputs"),r=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"A copy of the data frame"}],n,"output"),o=t.extend({componentPrettyName:"DF Copy"},n||{},{inputs:i,outputs:r,pythonTemplate:"<%= RESULT %> = <%= IN_D %>.copy()\n"});this.base_init(o)}},{label:"Copy a Pandas Dataframe",desc:"Make a copy of a pandas dataframe"}),r}),define("dataFlow/components/string",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var r={};return r.StringComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{shortName:"S",type:e.OUTPUT_TYPES.STRING,required:!0}],n,"output"),r=this.createIObjectsFromJSON([{required:!1,shortName:"S",type:e.OUTPUT_TYPES.STRING}],n,"inputs"),o=t.extend({componentPrettyName:"String"},n||{},{inputs:r,outputs:i,pythonTemplate:"<%= RESULT %> = <%= IN_S %>\n"});this.base_init(o)}},{label:"String",desc:"Holds a list of strings. You can use this to copy/paste string data from Google Docs or Excel"}),r}),define("dataFlow/dataFlow_loader",["underscore","dataFlow/core","dataFlow/components/outputComponents","dataFlow/components/number","dataFlow/components/simplemath","dataFlow/components/treeComponents","dataFlow/components/numpy_create","dataFlow/components/numpy_simplemath","dataFlow/components/numpy_basics","dataFlow/components/dataframe_create","dataFlow/components/dataframe_basics","dataFlow/components/string"],function(t,e,n,i,r,o,a,s,l,u,c,h){function d(e,n){t.each(e,function(t,e){t.module=n}),f.components[n]=f.components[n]||{},t.extend(f.components[n],e)}var f={};return f=t.extend(f,e),f.components={},d(o,"tree"),d(i,"number"),d(r,"simplemath"),d(a,"numpy_create"),d(n,"outputComponents"),d(s,"numpy_simplemath"),d(l,"numpy_basics"),d(u,"dataframe_create"),d(c,"dataframe_basics"),d(h,"string"),f.iterateComponents=function(e){return function n(i){for(var r=t.keys(i),o=0;o<r.length;o++){var a=r[o];"function"==typeof i[a]?e(a,i[a]):n(i[a])}}(f.components)},f.findComponentConstructorByName=function(t){var e=null;return f.iterateComponents(function(n,i){t===n&&(e=i)}),e},f.createComponentByName=function(e,n){var i=f.findComponentConstructorByName(e);return t.isNull(i)?(console.warn("Couldn't find component by name: "+e),null):new i(n)},f.iterateComponents(function(t,e){e.prototype.componentName=t}),f}),define("dataFlow/UI/contextMenuJupyter",["jquery","underscore","backbone","dataFlow/dataFlow_loader"],function(t,e,n,i){var r=null,o=e.template('<div class="context-menu">        <ul class="dropdown-menu" role="menu">        <li class="comp_Name"><span><%= componentName %></span></li>        <li><a tabindex="-1"><input type="text" placeholder="Component Name" value="<%= componentPrettyName %>"/></a></li>        <li class="divider"></li>            <li><a class="deleteComponent" tabindex="-1"><span class="fa fa-remove icongutter"></span>Delete</a></li>            <li><a class="helpTooltip" tabindex="-1"><span class="fa fa-question-circle icongutter"></span>Help: <%= componentName %> </a></li>        </ul>        </div>');return n.View.extend({events:{"click input":"keepMenu","contextmenu input":"keepMenu","click a.previewToggle":"togglePreview","click a.deleteComponent":"deleteComponent","keyup input":"editComponentPrettyName"},template:o,initialize:function(t){e.isNull(r)||r.destroy(),r=this;var n=t.x,i=t.y;this.registerCleanup(),this.render(n,i)},registerCleanup:function(){e.bindAll(this,"destroy"),this.hideEventHandlers={click:this.destroy,contextmenu:this.destroy,mousewheel:this.destroy},t(document).on(this.hideEventHandlers)},keepMenu:function(t){t.stopPropagation()},editComponentPrettyName:function(e){this.model.set("componentPrettyName",t(e.target).val())},togglePreview:function(){this.model.set("preview",!this.model.get("preview"))},deleteComponent:function(){this.model.destroy()},exportSVG:function(){this.model.exportGeometry("SVG")},render:function(e,n){var i=this.template(this.model.toJSON());t("body").append(this.$el),this.$el.append(t(i)).find("div.context-menu").css({display:"block",top:n+"px",left:e+"px"})},destroy:function(){t(document).off(this.hideEventHandlers),this.$el.empty(),this.remove(),r=null}})}),define("dataFlow/UI/helpTooltips",["jquery","underscore","dataFlow/enums","backbone"],function(t,e,n,i){function r(){l&&(l.popover&&l.popover("destroy"),l.off("show.bs.popover"),l.remove(),l=null)}function o(){this.mouseDown=0,e.bindAll(this,"incrementMousedown","decrementMousedown","mouseEnter"),t(s).on("mouseenter","div.draggable",this.mouseEnter),t(s).on("mousedown",this.incrementMousedown),t(s).on("mouseup",this.decrementMousedown)}function a(t){var i=t.toJSON();return i.defaultValue=e.isUndefined(i.default)||e.isNull(i.default)?"(none)":i.default,i.desc=e.isUndefined(i.desc)?"":i.desc,i.interpretAs=n.DISPLAY_NAMES.INTERPRET_AS[i.interpretAs]||"Item",i.required=!!e.isUndefined(i.required)||i.required,i.type=n.DISPLAY_NAMES.OUTPUT_TYPES[t.get("type")],i}var s="div.TOP",l=null;e.once(function(){document.addEventListener("mousewheel",r,!1),document.addEventListener("DOMMouseScroll",r,!1)})(),o.prototype.incrementMousedown=function(){r(),this.mouseDown=this.mouseDown+1},o.prototype.decrementMousedown=function(){this.mouseDown=this.mouseDown-1};e.template("<ul class='io_tooltip'><% if (desc != '') { %><li><span class='io_description'><%= desc %><% if (required) { %>*<% } %></span></li><% } %><li><span class='io_isRequired'><% if (required) { %>*<% } %>(<% if (!required) { %>Not <% } %>Required)</span></li><% if (defaultValue != '(none)') { %><li><span class='io_tooltip_field_title'>Default Value: </span> <span class='io_tooltip_field_value'><%= defaultValue %></span></li><% } %><li><span class='io_tooltip_field_title'>Interpreted as: </span><span class='io_tooltip_field_value'><%= interpretAs %></span></li></ul>"),e.template("<ul class='io_tooltip'><% if (desc == '') { %><li><span class='io_tooltip_field_title'>(no description)</span></li><% } else { %><li><span class='io_description'><%= desc %></span></li><% } %></ul>"),e.template("<%= shortName %>: <%= type %>");var u=e.template("<%= componentPrettyName %> <span class='cmpt_tooltip_title_modulename'>(<%= module %>.<%= componentName %>)</span>"),c=e.template("<% _.each(errors,function(e,idx){ %>        <div class='cmpt_error_line'>           <span class='err_type'><%= e.type %>:</span>           <span class='err_msg'><%= e.message %></span>       <div> <% }) %>"),h=e.template("<div class='cmpt_tooltip'>   <div class='cmpt_description'><%= description %></div>        <div class='cmpt_io_container'>           <span class='cmpt_io_title'>Inputs:</span><% _.each(inputs,function(i){ %>        <div class='cmpt_io'>           <span class='cmpt_io_name'><%= i.shortName %><% if (i.required) { %>*<% } %></span>           <span class='cmpt_io_details'>(<%= i.type %>, as <%= i.interpretAs %>) <%= i.desc %>               <% if (i.defaultValue != '(none)') { %>Default: <%= i.defaultValue %><% } %>           </span></span>       </div> <% }) %>           <span class='cmpt_io_title'>Outputs:</span><% _.each(outputs,function(i){ %>        <div class='cmpt_io'>           <span class='cmpt_io_name'><%= i.shortName %></span>           <span class='cmpt_io_details'>(<%= i.type %>, as <%= i.interpretAs %>) <%= i.desc %></span>       </div> <% }) %>           <span class='cmpt_io_required_legend'>* = required</span>       </div> </div>");return o.prototype.mouseEnter=function(n){if(0===this.mouseDown){n.stopPropagation(),n.preventDefault();try{var i=t(n.currentTarget).data("viewObject"),o=i.constructor.name}catch(n){return}r();var s=t(i.cssObject.element),d=(s=s.find(".componentLabel").size()>0?s.find(".componentLabel").get(0):s.get(0)).getBoundingClientRect(),f=e.template("<div class='locationAnchor' style='position: absolute;z-index:0; opacity: 0; width: <%= width %>px; height: <%= height %>px;top: <%= top %>px; left: <%= left %>px;'></div>");if(l=t(f(d)),t("body").append(l),!o||"OutputView"!=o&&"InputView"!=o){if(o&&o.indexOf("ComponentView")>-1){var p=function(t){var n=t.toJSON();return n.errors=t.errors,n.description=t.constructor.desc,n.label=t.constructor.label,n.module=t.constructor.module,n.inputs=e.map(t.inputs,function(t){return a(t)}),n.outputs=e.map(t.outputs,function(t){return a(t)}),n}(i.component),m="error"===i.component.get("sufficient");!function(e,n,i,o,a){var s=setTimeout(function(){l&&(o&&l.on("show.bs.popover",function(){t(this).data("bs.popover").tip().css(o)}),l.popover({title:e,html:!0,content:n,trigger:"manual",container:"body",placement:"auto "+i}).popover("show"),t(a).one("mouseleave",r))},600);t(a).one("mouseleave",function(){clearTimeout(s)})}(u(p),m?c(p):h(p),"top",{"max-width":"600px"},n.currentTarget)}}else;}},o.prototype.destroy=function(){r(),t(s).off("mouseenter","div.draggable",this.mouseEnter),t(s).off("mousedown",this.incrementMousedown),t(s).off("mouseup",this.decrementMousedown)},o}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define("threemin",["exports"],e):e(t.THREE={})}(this,function(t){function e(){}function n(t,e){this.x=t||0,this.y=e||0}function i(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function r(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1}function o(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function a(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function s(t,e,i,r,o,l,u,c,h,d){Object.defineProperty(this,"id",{value:br++}),this.uuid=wr.generateUUID(),this.name="",this.image=void 0!==t?t:s.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:s.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:1001,this.wrapT=void 0!==r?r:1001,this.magFilter=void 0!==o?o:1006,this.minFilter=void 0!==l?l:1008,this.anisotropy=void 0!==h?h:1,this.format=void 0!==u?u:1023,this.type=void 0!==c?c:1009,this.offset=new n(0,0),this.repeat=new n(1,1),this.center=new n(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new a,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==d?d:3e3,this.version=0,this.onUpdate=null}function l(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}function u(t,e,n){this.uuid=wr.generateUUID(),this.width=t,this.height=e,this.scissor=new l(0,0,t,e),this.scissorTest=!1,this.viewport=new l(0,0,t,e),void 0===(n=n||{}).minFilter&&(n.minFilter=1006),this.texture=new s(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function c(t,e,n){u.call(this,t,e,n),this.activeMipMapLevel=this.activeCubeFace=0}function h(t,e,n,i,r,o,a,l,u,c,h,d){s.call(this,null,o,a,l,u,c,i,r,h,d),this.image={data:t,width:e,height:n},this.magFilter=void 0!==u?u:1003,this.minFilter=void 0!==c?c:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function d(t,e,n,i,r,o,a,l,u,c){s.call(this,t=void 0!==t?t:[],void 0!==e?e:301,n,i,r,o,a,l,u,c),this.flipY=!1}function f(t,e,n){var i=t[0];if(0>=i||0<i)return t;var r=e*n,o=Tr[r];if(void 0===o&&(o=new Float32Array(r),Tr[r]=o),0!==e)for(i.toArray(o,0),i=1,r=0;i!==e;++i)r+=n,t[i].toArray(o,r);return o}function p(t,e){var n=Cr[e];void 0===n&&(n=new Int32Array(e),Cr[e]=n);for(var i=0;i!==e;++i)n[i]=t.allocTextureUnit();return n}function m(t,e){t.uniform1f(this.addr,e)}function g(t,e){t.uniform1i(this.addr,e)}function v(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function y(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function w(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function b(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function _(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(Sr.set(e.elements),t.uniformMatrix3fv(this.addr,!1,Sr))}function E(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(xr.set(e.elements),t.uniformMatrix4fv(this.addr,!1,xr))}function T(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTexture2D(e||_r,i)}function C(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTextureCube(e||Er,i)}function x(t,e){t.uniform2iv(this.addr,e)}function S(t,e){t.uniform3iv(this.addr,e)}function M(t,e){t.uniform4iv(this.addr,e)}function O(t,e){t.uniform1fv(this.addr,e)}function R(t,e){t.uniform1iv(this.addr,e)}function A(t,e){t.uniform2fv(this.addr,f(e,this.size,2))}function P(t,e){t.uniform3fv(this.addr,f(e,this.size,3))}function N(t,e){t.uniform4fv(this.addr,f(e,this.size,4))}function k(t,e){t.uniformMatrix2fv(this.addr,!1,f(e,this.size,4))}function L(t,e){t.uniformMatrix3fv(this.addr,!1,f(e,this.size,9))}function D(t,e){t.uniformMatrix4fv(this.addr,!1,f(e,this.size,16))}function I(t,e,n){var i=e.length,r=p(n,i);for(t.uniform1iv(this.addr,r),t=0;t!==i;++t)n.setTexture2D(e[t]||_r,r[t])}function H(t,e,n){var i=e.length,r=p(n,i);for(t.uniform1iv(this.addr,r),t=0;t!==i;++t)n.setTextureCube(e[t]||Er,r[t])}function U(t,e,n){this.id=t,this.addr=n,this.setValue=function(t){switch(t){case 5126:return m;case 35664:return v;case 35665:return y;case 35666:return w;case 35674:return b;case 35675:return _;case 35676:return E;case 35678:case 36198:return T;case 35680:return C;case 5124:case 35670:return g;case 35667:case 35671:return x;case 35668:case 35672:return S;case 35669:case 35673:return M}}(e.type)}function F(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return O;case 35664:return A;case 35665:return P;case 35666:return N;case 35674:return k;case 35675:return L;case 35676:return D;case 35678:return I;case 35680:return H;case 5124:case 35670:return R;case 35667:case 35671:return x;case 35668:case 35672:return S;case 35669:case 35673:return M}}(e.type)}function B(t){this.id=t,this.seq=[],this.map={}}function j(t,e,n){this.seq=[],this.map={},this.renderer=n,n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(var i=0;i<n;++i){var r=t.getActiveUniform(e,i),o=t.getUniformLocation(e,r.name),a=this,s=r.name,l=s.length;for(Mr.lastIndex=0;;){var u=Mr.exec(s),c=Mr.lastIndex,h=u[1],d=u[3];if("]"===u[2]&&(h|=0),void 0===d||"["===d&&c+2===l){s=a,r=void 0===d?new U(h,r,o):new F(h,r,o),s.seq.push(r),s.map[r.id]=r;break}void 0===(d=a.map[h])&&(d=new B(h),h=a,a=d,h.seq.push(a),h.map[a.id]=a),a=d}}}function z(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function V(t,e){this.min=void 0!==t?t:new n(1/0,1/0),this.max=void 0!==e?e:new n(-1/0,-1/0)}function W(t,e,n,i,r,o,a,l,u){s.call(this,t,e,n,i,r,o,a,l,u),this.needsUpdate=!0}function G(){Object.defineProperty(this,"id",{value:kr++}),this.uuid=wr.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Y(t){G.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(t)}function X(t){G.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new o,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.lights=this.fog=!1,this.setValues(t)}function q(t,e){this.min=void 0!==t?t:new o(1/0,1/0,1/0),this.max=void 0!==e?e:new o(-1/0,-1/0,-1/0)}function J(t,e){this.center=void 0!==t?t:new o,this.radius=void 0!==e?e:0}function K(t,e){this.normal=void 0!==t?t:new o(1,0,0),this.constant=void 0!==e?e:0}function Z(t,e,n,i,r,o){this.planes=[void 0!==t?t:new K,void 0!==e?e:new K,void 0!==n?n:new K,void 0!==i?i:new K,void 0!==r?r:new K,void 0!==o?o:new K]}function $(t,e,r){function a(e,n,i,r,o,a){var s=e.geometry,l=g,u=e.customDepthMaterial;return i&&(l=v,u=e.customDistanceMaterial),u?l=u:(u=!1,n.morphTargets&&(s&&s.isBufferGeometry?u=s.morphAttributes&&s.morphAttributes.position&&0<s.morphAttributes.position.length:s&&s.isGeometry&&(u=s.morphTargets&&0<s.morphTargets.length)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e),e=e.isSkinnedMesh&&n.skinning,s=0,u&&(s|=1),e&&(s|=2),l=l[s]),t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length&&(s=l.uuid,u=n.uuid,void 0===(e=y[s])&&(e={},y[s]=e),void 0===(s=e[u])&&(s=l.clone(),e[u]=s),l=s),l.visible=n.visible,l.wireframe=n.wireframe,u=n.side,x.renderSingleSided&&2==u&&(u=0),x.renderReverseSided&&(0===u?u=1:1===u&&(u=0)),l.side=u,l.clipShadows=n.clipShadows,l.clippingPlanes=n.clippingPlanes,l.clipIntersection=n.clipIntersection,l.wireframeLinewidth=n.wireframeLinewidth,l.linewidth=n.linewidth,i&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(r),l.nearDistance=o,l.farDistance=a),l}function s(n,i,r,o){var l;if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||c.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,n.matrixWorld);var u=e.update(n),h=n.material;if(Array.isArray(h))for(var d=u.groups,f=0,p=d.length;f<p;f++){var g=d[f];(l=h[g.materialIndex])&&l.visible&&(l=a(n,l,o,m,r.near,r.far),t.renderBufferDirect(r,null,u,l,n,g))}else h.visible&&(l=a(n,h,o,m,r.near,r.far),t.renderBufferDirect(r,null,u,l,n,null))}for(u=0,h=(n=n.children).length;u<h;u++)s(n[u],i,r,o)}}var c=new Z,h=new i,d=new n,f=new n(r,r),p=new o,m=new o,g=Array(4),v=Array(4),y={},w=[new o(1,0,0),new o(-1,0,0),new o(0,0,1),new o(0,0,-1),new o(0,1,0),new o(0,-1,0)],b=[new o(0,1,0),new o(0,1,0),new o(0,1,0),new o(0,1,0),new o(0,0,1),new o(0,0,-1)],_=[new l,new l,new l,new l,new l,new l];for(r=0;4!==r;++r){var E=0!=(1&r),T=0!=(2&r),C=new Y({depthPacking:3201,morphTargets:E,skinning:T});g[r]=C,E=new X({morphTargets:E,skinning:T}),v[r]=E}var x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.renderSingleSided=this.renderReverseSided=!0,this.render=function(e,n,i){if(!1!==x.enabled&&(!1!==x.autoUpdate||!1!==x.needsUpdate)&&0!==e.length){var r=t.state;r.disable(t.context.BLEND),r.buffers.color.setClear(1,1,1,1),r.buffers.depth.setTest(!0),r.setScissorTest(!1);for(var o,a=0,l=e.length;a<l;a++){var g=e[a];o=g.shadow;var v=g&&g.isPointLight;if(void 0===o)console.warn("THREE.WebGLShadowMap:",g,"has no shadow.");else{var y=o.camera;if(d.copy(o.mapSize),d.min(f),v){var E=d.x,T=d.y;_[0].set(2*E,T,E,T),_[1].set(0,T,E,T),_[2].set(3*E,T,E,T),_[3].set(E,T,E,T),_[4].set(3*E,0,E,T),_[5].set(E,0,E,T),d.x*=4,d.y*=2}for(null===o.map&&(o.map=new u(d.x,d.y,{minFilter:1003,magFilter:1003,format:1023}),o.map.texture.name=g.name+".shadowMap",y.updateProjectionMatrix()),o.isSpotLightShadow&&o.update(g),E=o.map,T=o.matrix,m.setFromMatrixPosition(g.matrixWorld),y.position.copy(m),v?(o=6,T.makeTranslation(-m.x,-m.y,-m.z)):(o=1,p.setFromMatrixPosition(g.target.matrixWorld),y.lookAt(p),y.updateMatrixWorld(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(y.projectionMatrix),T.multiply(y.matrixWorldInverse)),t.setRenderTarget(E),t.clear(),g=0;g<o;g++)v&&(p.copy(y.position),p.add(w[g]),y.up.copy(b[g]),y.lookAt(p),y.updateMatrixWorld(),r.viewport(_[g])),h.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),c.setFromMatrix(h),s(n,i,y,v)}}x.needsUpdate=!1}}}function Q(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._order=i||Q.DefaultOrder}function tt(){this.mask=1}function et(){Object.defineProperty(this,"id",{value:Lr++}),this.uuid=wr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=et.DefaultUp.clone();var t=new o,e=new Q,n=new r,s=new o(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:s},modelViewMatrix:{value:new i},normalMatrix:{value:new a}}),this.matrix=new i,this.matrixWorld=new i,this.matrixAutoUpdate=et.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new tt,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function nt(){et.call(this),this.type="Camera",this.matrixWorldInverse=new i,this.projectionMatrix=new i}function it(t,e,n,i,r,o){nt.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function rt(t,e,n,i,r,a){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new o,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new z,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}function ot(){Object.defineProperty(this,"id",{value:Dr+=2}),this.uuid=wr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function at(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=wr.generateUUID(),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function st(t,e,n){at.call(this,new Int8Array(t),e,n)}function lt(t,e,n){at.call(this,new Uint8Array(t),e,n)}function ut(t,e,n){at.call(this,new Uint8ClampedArray(t),e,n)}function ct(t,e,n){at.call(this,new Int16Array(t),e,n)}function ht(t,e,n){at.call(this,new Uint16Array(t),e,n)}function dt(t,e,n){at.call(this,new Int32Array(t),e,n)}function ft(t,e,n){at.call(this,new Uint32Array(t),e,n)}function pt(t,e,n){at.call(this,new Float32Array(t),e,n)}function mt(t,e,n){at.call(this,new Float64Array(t),e,n)}function gt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function vt(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}function yt(){Object.defineProperty(this,"id",{value:Ir+=2}),this.uuid=wr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}}function wt(t,e,n,i,r,o){ot.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new bt(t,e,n,i,r,o)),this.mergeVertices()}function bt(t,e,n,i,r,a){function s(t,e,n,i,r,a,s,m,g,v,y){var w=a/g,b=s/v,_=a/2,E=s/2,T=m/2;s=g+1;var C,x,S=v+1,M=a=0,O=new o;for(x=0;x<S;x++){var R=x*b-E;for(C=0;C<s;C++)O[t]=(C*w-_)*i,O[e]=R*r,O[n]=T,c.push(O.x,O.y,O.z),O[t]=0,O[e]=0,O[n]=0<m?1:-1,h.push(O.x,O.y,O.z),d.push(C/g),d.push(1-x/v),a+=1}for(x=0;x<v;x++)for(C=0;C<g;C++)t=f+C+s*(x+1),e=f+(C+1)+s*(x+1),n=f+(C+1)+s*x,u.push(f+C+s*x,t,n),u.push(t,e,n),M+=6;l.addGroup(p,M,y),p+=M,f+=a}yt.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:a};var l=this;t=t||1,e=e||1,n=n||1,i=Math.floor(i)||1,r=Math.floor(r)||1;var u=[],c=[],h=[],d=[],f=0,p=0;s("z","y","x",-1,-1,n,e,t,a=Math.floor(a)||1,r,0),s("z","y","x",1,-1,n,e,-t,a,r,1),s("x","z","y",1,1,t,n,e,i,a,2),s("x","z","y",1,-1,t,n,-e,i,a,3),s("x","y","z",1,-1,t,e,n,i,r,4),s("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(u),this.addAttribute("position",new pt(c,3)),this.addAttribute("normal",new pt(h,3)),this.addAttribute("uv",new pt(d,2))}function _t(t,e,n,i){ot.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new Et(t,e,n,i)),this.mergeVertices()}function Et(t,e,n,i){yt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};var r=(t=t||1)/2,o=(e=e||1)/2,a=(n=Math.floor(n)||1)+1,s=(i=Math.floor(i)||1)+1,l=t/n,u=e/i,c=[],h=[],d=[],f=[];for(t=0;t<s;t++){var p=t*u-o;for(e=0;e<a;e++)h.push(e*l-r,-p,0),d.push(0,0,1),f.push(e/n),f.push(1-t/i)}for(t=0;t<i;t++)for(e=0;e<n;e++)r=e+a*(t+1),o=e+1+a*(t+1),s=e+1+a*t,c.push(e+a*t,r,s),c.push(r,o,s);this.setIndex(c),this.addAttribute("position",new pt(h,3)),this.addAttribute("normal",new pt(d,3)),this.addAttribute("uv",new pt(f,2))}function Tt(t){G.call(this),this.type="MeshBasicMaterial",this.color=new z(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(t)}function Ct(t){G.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function xt(t,e){this.origin=void 0!==t?t:new o,this.direction=void 0!==e?e:new o}function St(t,e){this.start=void 0!==t?t:new o,this.end=void 0!==e?e:new o}function Mt(t,e,n){this.a=void 0!==t?t:new o,this.b=void 0!==e?e:new o,this.c=void 0!==n?n:new o}function Ot(t,e){et.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new yt,this.material=void 0!==e?e:new Tt({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function Rt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function At(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Pt(){var t={};return{get:function(e,n){return e=e.id+","+n.id,void 0===(n=t[e])&&(n=new function(){var t=[],e=0,n=[],i=[];return{opaque:n,transparent:i,init:function(){e=0,n.length=0,i.length=0},push:function(r,o,a,s,l){var u=t[e];void 0===u?(u={id:r.id,object:r,geometry:o,material:a,program:a.program,renderOrder:r.renderOrder,z:s,group:l},t[e]=u):(u.id=r.id,u.object=r,u.geometry=o,u.material=a,u.program=a.program,u.renderOrder=r.renderOrder,u.z=s,u.group=l),(!0===a.transparent?i:n).push(u),e++},sort:function(){1<n.length&&n.sort(Rt),1<i.length&&i.sort(At)}}},t[e]=n),n},dispose:function(){t={}}}}function Nt(t,e){return Math.abs(e[1])-Math.abs(t[1])}function kt(){var t=new function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];switch(e.type){case"DirectionalLight":var i={direction:new o,color:new z,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"SpotLight":i={position:new o,direction:new o,color:new z,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"PointLight":i={position:new o,color:new z,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":i={direction:new o,skyColor:new z,groundColor:new z};break;case"RectAreaLight":i={color:new z,position:new o,halfWidth:new o,halfHeight:new o}}return t[e.id]=i}}},e={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new o,a=new i,s=new i;return{setup:function(n,i,o){for(var l,u=0,c=0,h=0,d=0,f=0,p=0,m=0,g=0,v=o.matrixWorldInverse,y=0,w=n.length;y<w;y++){var b=n[y];l=b.color;var _=b.intensity,E=b.distance,T=b.shadow&&b.shadow.map?b.shadow.map.texture:null;b.isAmbientLight?(u+=l.r*_,c+=l.g*_,h+=l.b*_):b.isDirectionalLight?((o=t.get(b)).color.copy(b.color).multiplyScalar(b.intensity),o.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),o.direction.sub(r),o.direction.transformDirection(v),(o.shadow=b.castShadow)&&(l=b.shadow,o.shadowBias=l.bias,o.shadowRadius=l.radius,o.shadowMapSize=l.mapSize),e.directionalShadowMap[d]=T,e.directionalShadowMatrix[d]=b.shadow.matrix,e.directional[d]=o,d++):b.isSpotLight?((o=t.get(b)).position.setFromMatrixPosition(b.matrixWorld),o.position.applyMatrix4(v),o.color.copy(l).multiplyScalar(_),o.distance=E,o.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),o.direction.sub(r),o.direction.transformDirection(v),o.coneCos=Math.cos(b.angle),o.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),o.decay=0===b.distance?0:b.decay,(o.shadow=b.castShadow)&&(l=b.shadow,o.shadowBias=l.bias,o.shadowRadius=l.radius,o.shadowMapSize=l.mapSize),e.spotShadowMap[p]=T,e.spotShadowMatrix[p]=b.shadow.matrix,e.spot[p]=o,p++):b.isRectAreaLight?((o=t.get(b)).color.copy(l).multiplyScalar(_/(b.width*b.height)),o.position.setFromMatrixPosition(b.matrixWorld),o.position.applyMatrix4(v),s.identity(),a.copy(b.matrixWorld),a.premultiply(v),s.extractRotation(a),o.halfWidth.set(.5*b.width,0,0),o.halfHeight.set(0,.5*b.height,0),o.halfWidth.applyMatrix4(s),o.halfHeight.applyMatrix4(s),e.rectArea[m]=o,m++):b.isPointLight?((o=t.get(b)).position.setFromMatrixPosition(b.matrixWorld),o.position.applyMatrix4(v),o.color.copy(b.color).multiplyScalar(b.intensity),o.distance=b.distance,o.decay=0===b.distance?0:b.decay,(o.shadow=b.castShadow)&&(l=b.shadow,o.shadowBias=l.bias,o.shadowRadius=l.radius,o.shadowMapSize=l.mapSize,o.shadowCameraNear=l.camera.near,o.shadowCameraFar=l.camera.far),e.pointShadowMap[f]=T,e.pointShadowMatrix[f]=b.shadow.matrix,e.point[f]=o,f++):b.isHemisphereLight&&((o=t.get(b)).direction.setFromMatrixPosition(b.matrixWorld),o.direction.transformDirection(v),o.direction.normalize(),o.skyColor.copy(b.color).multiplyScalar(_),o.groundColor.copy(b.groundColor).multiplyScalar(_),e.hemi[g]=o,g++)}e.ambient[0]=u,e.ambient[1]=c,e.ambient[2]=h,e.directional.length=d,e.spot.length=p,e.rectArea.length=m,e.point.length=f,e.hemi.length=g,e.hash=d+","+f+","+p+","+m+","+g+","+i.length},state:e}}function Lt(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),!1===t.getShaderParameter(i,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(i),function(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(n)),i}function Dt(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+t)}}function It(t,e){return e=Dt(e),"vec4 "+t+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function Ht(t){return""!==t}function Ut(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Ft(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){if(void 0===(t=Pr[e]))throw Error("Can not resolve #include <"+e+">");return Ft(t)})}function Bt(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,n,i){for(t="",e=parseInt(e);e<parseInt(n);e++)t+=i.replace(/\[ i \]/g,"[ "+e+" ]");return t})}function jt(t,e,n,i,r,o){var a=t.context,s=i.defines,l=r.vertexShader,u=r.fragmentShader,c="SHADOWMAP_TYPE_BASIC";1===o.shadowMapType?c="SHADOWMAP_TYPE_PCF":2===o.shadowMapType&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",f="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(i.envMap.mapping){case 301:case 302:h="ENVMAP_TYPE_CUBE";break;case 306:case 307:h="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:h="ENVMAP_TYPE_EQUIREC";break;case 305:h="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case 302:case 304:d="ENVMAP_MODE_REFRACTION"}switch(i.combine){case 0:f="ENVMAP_BLENDING_MULTIPLY";break;case 1:f="ENVMAP_BLENDING_MIX";break;case 2:f="ENVMAP_BLENDING_ADD"}}var p=0<t.gammaFactor?t.gammaFactor:1,m=function(t,e,n){return t=t||{},[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ht).join("\n")}(i.extensions,o,e),g=function(t){var e,n=[];for(e in t){var i=t[e];!1!==i&&n.push("#define "+e+" "+i)}return n.join("\n")}(s),v=a.createProgram();i.isRawShaderMaterial?(0<(s=[g].filter(Ht).join("\n")).length&&(s+="\n"),0<(e=[m,g].filter(Ht).join("\n")).length&&(e+="\n")):(s=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,g,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+o.numClippingPlanes,o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ht).join("\n"),e=[m,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,g,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+p,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+d:"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+o.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(o.numClippingPlanes-o.numClipIntersection),o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==o.toneMapping?"#define TONE_MAPPING":"",0!==o.toneMapping?Pr.tonemapping_pars_fragment:"",0!==o.toneMapping?function(t,e){switch(e){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="Uncharted2";break;case 4:e="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Pr.encodings_pars_fragment:"",o.mapEncoding?It("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?It("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?It("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?function(t,e){return e=Dt(e),"vec4 "+t+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(Ht).join("\n")),l=Ut(l=Ft(l),o),u=Ut(u=Ft(u),o),i.isShaderMaterial||(l=Bt(l),u=Bt(u)),u=e+u,l=Lt(a,a.VERTEX_SHADER,s+l),u=Lt(a,a.FRAGMENT_SHADER,u),a.attachShader(v,l),a.attachShader(v,u),void 0!==i.index0AttributeName?a.bindAttribLocation(v,0,i.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(v,0,"position"),a.linkProgram(v),o=a.getProgramInfoLog(v),r=a.getShaderInfoLog(l),c=a.getShaderInfoLog(u),d=h=!0,!1===a.getProgramParameter(v,a.LINK_STATUS)?(h=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(v,a.VALIDATE_STATUS),"gl.getProgramInfoLog",o,r,c)):""!==o?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",o):""!==r&&""!==c||(d=!1),d&&(this.diagnostics={runnable:h,material:i,programLog:o,vertexShader:{log:r,prefix:s},fragmentShader:{log:c,prefix:e}}),a.deleteShader(l),a.deleteShader(u);var y;this.getUniforms=function(){return void 0===y&&(y=new j(a,v,t)),y};var w;return this.getAttributes=function(){if(void 0===w){for(var t={},e=a.getProgramParameter(v,a.ACTIVE_ATTRIBUTES),n=0;n<e;n++){var i=a.getActiveAttrib(v,n).name;t[i]=a.getAttribLocation(v,i)}w=t}return w},this.destroy=function(){a.deleteProgram(v),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Hr++,this.code=n,this.usedTimes=1,this.program=v,this.vertexShader=l,this.fragmentShader=u,this}function zt(t,e,n,i){nt.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Vt(t){zt.call(this),this.cameras=t||[]}function Wt(t){function e(){if(null!==r&&r.isPresenting){var e=(i=r.getEyeParameters("left")).renderWidth,i=i.renderHeight;f=t.getPixelRatio(),d=t.getSize(),t.setDrawingBufferSize(2*e,i,1)}else n.enabled&&t.setDrawingBufferSize(d.width,d.height,f)}var n=this,r=null,o=null,a=null;"undefined"!=typeof window&&"VRFrameData"in window&&(o=new window.VRFrameData);var s=new i,u=new zt;u.bounds=new l(0,0,.5,1),u.layers.enable(1);var c=new zt;c.bounds=new l(.5,0,.5,1),c.layers.enable(2);var h=new Vt([u,c]);h.layers.enable(1),h.layers.enable(2);var d,f;"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",e,!1),this.enabled=!1,this.getDevice=function(){return r},this.setDevice=function(t){void 0!==t&&(r=t)},this.setPoseTarget=function(t){void 0!==t&&(a=t)},this.getCamera=function(t){if(null===r)return t;r.depthNear=t.near,r.depthFar=t.far,r.getFrameData(o);var e=o.pose,n=null!==a?a:t;return null!==e.position?n.position.fromArray(e.position):n.position.set(0,0,0),null!==e.orientation&&n.quaternion.fromArray(e.orientation),n.updateMatrixWorld(),!1===r.isPresenting?t:(u.near=t.near,c.near=t.near,u.far=t.far,c.far=t.far,h.matrixWorld.copy(t.matrixWorld),h.matrixWorldInverse.copy(t.matrixWorldInverse),u.matrixWorldInverse.fromArray(o.leftViewMatrix),c.matrixWorldInverse.fromArray(o.rightViewMatrix),null!==(t=n.parent)&&(s.getInverse(t.matrixWorld),u.matrixWorldInverse.multiply(s),c.matrixWorldInverse.multiply(s)),u.matrixWorld.getInverse(u.matrixWorldInverse),c.matrixWorld.getInverse(c.matrixWorldInverse),u.projectionMatrix.fromArray(o.leftProjectionMatrix),c.projectionMatrix.fromArray(o.rightProjectionMatrix),h.projectionMatrix.copy(u.projectionMatrix),(t=r.getLayers()).length&&(null!==(t=t[0]).leftBounds&&4===t.leftBounds.length&&u.bounds.fromArray(t.leftBounds),null!==t.rightBounds&&4===t.rightBounds.length&&c.bounds.fromArray(t.rightBounds)),h)},this.submitFrame=function(){r&&r.isPresenting&&r.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",e)}}function Gt(t,e){return{convert:function(n){if(1e3===n)return t.REPEAT;if(1001===n)return t.CLAMP_TO_EDGE;if(1002===n)return t.MIRRORED_REPEAT;if(1003===n)return t.NEAREST;if(1004===n)return t.NEAREST_MIPMAP_NEAREST;if(1005===n)return t.NEAREST_MIPMAP_LINEAR;if(1006===n)return t.LINEAR;if(1007===n)return t.LINEAR_MIPMAP_NEAREST;if(1008===n)return t.LINEAR_MIPMAP_LINEAR;if(1009===n)return t.UNSIGNED_BYTE;if(1017===n)return t.UNSIGNED_SHORT_4_4_4_4;if(1018===n)return t.UNSIGNED_SHORT_5_5_5_1;if(1019===n)return t.UNSIGNED_SHORT_5_6_5;if(1010===n)return t.BYTE;if(1011===n)return t.SHORT;if(1012===n)return t.UNSIGNED_SHORT;if(1013===n)return t.INT;if(1014===n)return t.UNSIGNED_INT;if(1015===n)return t.FLOAT;if(1016===n){var i=e.get("OES_texture_half_float");if(null!==i)return i.HALF_FLOAT_OES}if(1021===n)return t.ALPHA;if(1022===n)return t.RGB;if(1023===n)return t.RGBA;if(1024===n)return t.LUMINANCE;if(1025===n)return t.LUMINANCE_ALPHA;if(1026===n)return t.DEPTH_COMPONENT;if(1027===n)return t.DEPTH_STENCIL;if(100===n)return t.FUNC_ADD;if(101===n)return t.FUNC_SUBTRACT;if(102===n)return t.FUNC_REVERSE_SUBTRACT;if(200===n)return t.ZERO;if(201===n)return t.ONE;if(202===n)return t.SRC_COLOR;if(203===n)return t.ONE_MINUS_SRC_COLOR;if(204===n)return t.SRC_ALPHA;if(205===n)return t.ONE_MINUS_SRC_ALPHA;if(206===n)return t.DST_ALPHA;if(207===n)return t.ONE_MINUS_DST_ALPHA;if(208===n)return t.DST_COLOR;if(209===n)return t.ONE_MINUS_DST_COLOR;if(210===n)return t.SRC_ALPHA_SATURATE;if((2001===n||2002===n||2003===n||2004===n)&&null!==(i=e.get("WEBGL_compressed_texture_s3tc"))){if(2001===n)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===n)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===n)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===n)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((2100===n||2101===n||2102===n||2103===n)&&null!==(i=e.get("WEBGL_compressed_texture_pvrtc"))){if(2100===n)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===n)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===n)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===n)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(2151===n&&null!==(i=e.get("WEBGL_compressed_texture_etc1")))return i.COMPRESSED_RGB_ETC1_WEBGL;if((103===n||104===n)&&null!==(i=e.get("EXT_blend_minmax"))){if(103===n)return i.MIN_EXT;if(104===n)return i.MAX_EXT}return 1020===n&&null!==(i=e.get("WEBGL_depth_texture"))?i.UNSIGNED_INT_24_8_WEBGL:0}}}function Yt(t){function e(){(_t=new function(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];switch(n){case"WEBGL_depth_texture":var i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=t.getExtension("WEBGL_compressed_texture_etc1");break;default:i=t.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i}}}(wt)).get("WEBGL_depth_texture"),_t.get("OES_texture_float"),_t.get("OES_texture_float_linear"),_t.get("OES_texture_half_float"),_t.get("OES_texture_half_float_linear"),_t.get("OES_standard_derivatives"),_t.get("OES_element_index_uint"),_t.get("ANGLE_instanced_arrays"),qt=new Gt(wt,_t),xt=new function(t,e,n){function i(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var r,o=void 0!==n.precision?n.precision:"highp";(a=i(o))!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a),n=!0===n.logarithmicDepthBuffer;var a=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),s=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_TEXTURE_SIZE),u=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),c=t.getParameter(t.MAX_VERTEX_ATTRIBS),h=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),d=t.getParameter(t.MAX_VARYING_VECTORS),f=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),p=0<s,m=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:n,maxTextures:a,maxVertexTextures:s,maxTextureSize:l,maxCubemapSize:u,maxAttributes:c,maxVertexUniforms:h,maxVaryings:d,maxFragmentUniforms:f,vertexTextures:p,floatFragmentTextures:m,floatVertexTextures:p&&m}}(wt,_t,t),(St=new function(t,e,n){function i(e,n,i){var r=new Uint8Array(4),o=t.createTexture();for(t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST),e=0;e<i;e++)t.texImage2D(n+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return o}function r(e){!0!==w[e]&&(t.enable(e),w[e]=!0)}function o(e){!1!==w[e]&&(t.disable(e),w[e]=!1)}function a(e,i,a,s,l,u,c,h){if(0!==e?r(t.BLEND):o(t.BLEND),5!==e){if(e!==E||h!==R)switch(e){case 2:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case 3:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case 4:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}O=M=S=x=C=T=null}else l=l||i,u=u||a,c=c||s,i===T&&l===S||(t.blendEquationSeparate(n.convert(i),n.convert(l)),T=i,S=l),a===C&&s===x&&u===M&&c===O||(t.blendFuncSeparate(n.convert(a),n.convert(s),n.convert(u),n.convert(c)),C=a,x=s,M=u,O=c);E=e,R=h}function s(e){A!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),A=e)}function u(e){0!==e?(r(t.CULL_FACE),e!==P&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):o(t.CULL_FACE),P=e}function c(e,n,i){e?(r(t.POLYGON_OFFSET_FILL),(k!==n||L!==i)&&(t.polygonOffset(n,i),k=n,L=i)):o(t.POLYGON_OFFSET_FILL)}function h(e){void 0===e&&(e=t.TEXTURE0+D-1),H!==e&&(t.activeTexture(e),H=e)}var d=new function(){var e=!1,n=new l,i=null,r=new l(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,o,a,s){!0===s&&(e*=a,i*=a,o*=a),n.set(e,i,o,a),!1===r.equals(n)&&(t.clearColor(e,i,o,a),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},f=new function(){var e=!1,n=null,i=null,a=null;return{setTest:function(e){e?r(t.DEPTH_TEST):o(t.DEPTH_TEST)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);i=e}},setLocked:function(t){e=t},setClear:function(e){a!==e&&(t.clearDepth(e),a=e)},reset:function(){e=!1,a=i=n=null}}},p=new function(){var e=!1,n=null,i=null,a=null,s=null,l=null,u=null,c=null,h=null;return{setTest:function(e){e?r(t.STENCIL_TEST):o(t.STENCIL_TEST)},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,r){i===e&&a===n&&s===r||(t.stencilFunc(e,n,r),i=e,a=n,s=r)},setOp:function(e,n,i){l===e&&u===n&&c===i||(t.stencilOp(e,n,i),l=e,u=n,c=i)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,h=c=u=l=s=a=i=n=null}}},m=t.getParameter(t.MAX_VERTEX_ATTRIBS),g=new Uint8Array(m),v=new Uint8Array(m),y=new Uint8Array(m),w={},b=null,_=null,E=null,T=null,C=null,x=null,S=null,M=null,O=null,R=!1,A=null,P=null,N=null,k=null,L=null,D=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),I=(m=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),1<=parseFloat(m)),H=null,U={},F=new l,B=new l,j={};return j[t.TEXTURE_2D]=i(t.TEXTURE_2D,t.TEXTURE_2D,1),j[t.TEXTURE_CUBE_MAP]=i(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),d.setClear(0,0,0,1),f.setClear(1),p.setClear(0),r(t.DEPTH_TEST),f.setFunc(3),s(!1),u(1),r(t.CULL_FACE),r(t.BLEND),a(1),{buffers:{color:d,depth:f,stencil:p},initAttributes:function(){for(var t=0,e=g.length;t<e;t++)g[t]=0},enableAttribute:function(n){g[n]=1,0===v[n]&&(t.enableVertexAttribArray(n),v[n]=1),0!==y[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),y[n]=0)},enableAttributeAndDivisor:function(n,i){g[n]=1,0===v[n]&&(t.enableVertexAttribArray(n),v[n]=1),y[n]!==i&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,i),y[n]=i)},disableUnusedAttributes:function(){for(var e=0,n=v.length;e!==n;++e)v[e]!==g[e]&&(t.disableVertexAttribArray(e),v[e]=0)},enable:r,disable:o,getCompressedTextureFormats:function(){if(null===b&&(b=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),i=0;i<n.length;i++)b.push(n[i]);return b},useProgram:function(e){return _!==e&&(t.useProgram(e),_=e,!0)},setBlending:a,setMaterial:function(e,n){2===e.side?o(t.CULL_FACE):r(t.CULL_FACE);var i=1===e.side;n&&(i=!i),s(i),!0===e.transparent?a(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):a(0),f.setFunc(e.depthFunc),f.setTest(e.depthTest),f.setMask(e.depthWrite),d.setMask(e.colorWrite),c(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:s,setCullFace:u,setLineWidth:function(e){e!==N&&(I&&t.lineWidth(e),N=e)},setPolygonOffset:c,setScissorTest:function(e){e?r(t.SCISSOR_TEST):o(t.SCISSOR_TEST)},activeTexture:h,bindTexture:function(e,n){null===H&&h();var i=U[H];void 0===i&&(i={type:void 0,texture:void 0},U[H]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||j[e]),i.type=e,i.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===F.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),F.copy(e))},viewport:function(e){!1===B.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),B.copy(e))},reset:function(){for(var e=0;e<v.length;e++)1===v[e]&&(t.disableVertexAttribArray(e),v[e]=0);w={},H=b=null,U={},P=A=E=_=null,d.reset(),f.reset(),p.reset()}}}(wt,_t,qt)).scissor(q.copy(ot).multiplyScalar(nt)),St.viewport(X.copy(rt).multiplyScalar(nt)),Mt=new function(){var t={};return{get:function(e){e=e.uuid;var n=t[e];return void 0===n&&(n={},t[e]=n),n},remove:function(e){delete t[e.uuid]},clear:function(){t={}}}},Rt=new function(t,e,n,i,r,o,a){function s(t,e){if(t.width>e||t.height>e){e/=Math.max(t.width,t.height);var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(t.width*e),n.height=Math.floor(t.height*e),n.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height,t),n}return t}function l(t){return wr.isPowerOfTwo(t.width)&&wr.isPowerOfTwo(t.height)}function u(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function c(e){return 1003===e||1004===e||1005===e?t.NEAREST:t.LINEAR}function h(e){(e=e.target).removeEventListener("dispose",h);t:{var n=i.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)break t;t.deleteTexture(n.__webglTexture)}i.remove(e)}e.isVideoTexture&&delete y[e.id],a.textures--}function d(e){(e=e.target).removeEventListener("dispose",d);var n=i.get(e),r=i.get(e.texture);if(e){if(void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(r=0;6>r;r++)t.deleteFramebuffer(n.__webglFramebuffer[r]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[r]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);i.remove(e.texture),i.remove(e)}a.textures--}function f(e,c){var d=i.get(e);if(0<e.version&&d.__version!==e.version)if(void 0===(m=e.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==m.complete){void 0===d.__webglInit&&(d.__webglInit=!0,e.addEventListener("dispose",h),d.__webglTexture=t.createTexture(),e.isVideoTexture&&(y[e.id]=e),a.textures++),n.activeTexture(t.TEXTURE0+c),n.bindTexture(t.TEXTURE_2D,d.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,e.unpackAlignment);var f=s(e.image,r.maxTextureSize);(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter)&&!1===l(f)&&((c=f)instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof ImageBitmap?(m=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),m.width=wr.floorPowerOfTwo(c.width),m.height=wr.floorPowerOfTwo(c.height),m.getContext("2d").drawImage(c,0,0,m.width,m.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+c.width+"x"+c.height+"). Resized to "+m.width+"x"+m.height,c),f=m):f=c),c=l(f);var m=o.convert(e.format),g=o.convert(e.type);p(t.TEXTURE_2D,e,c);var w=e.mipmaps;if(e.isDepthTexture){if(w=t.DEPTH_COMPONENT,1015===e.type){if(!v)throw Error("Float Depth Texture only supported in WebGL2.0");w=t.DEPTH_COMPONENT32F}else v&&(w=t.DEPTH_COMPONENT16);1026===e.format&&w===t.DEPTH_COMPONENT&&1012!==e.type&&1014!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=1012,g=o.convert(e.type)),1027===e.format&&(w=t.DEPTH_STENCIL,1020!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=1020,g=o.convert(e.type))),n.texImage2D(t.TEXTURE_2D,0,w,f.width,f.height,0,m,g,null)}else if(e.isDataTexture)if(0<w.length&&c){for(var b=0,_=w.length;b<_;b++)f=w[b],n.texImage2D(t.TEXTURE_2D,b,m,f.width,f.height,0,m,g,f.data);e.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,m,f.width,f.height,0,m,g,f.data);else if(e.isCompressedTexture)for(b=0,_=w.length;b<_;b++)f=w[b],1023!==e.format&&1022!==e.format?-1<n.getCompressedTextureFormats().indexOf(m)?n.compressedTexImage2D(t.TEXTURE_2D,b,m,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,b,m,f.width,f.height,0,m,g,f.data);else if(0<w.length&&c){for(b=0,_=w.length;b<_;b++)f=w[b],n.texImage2D(t.TEXTURE_2D,b,m,m,g,f);e.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,m,m,g,f);return u(e,c)&&t.generateMipmap(t.TEXTURE_2D),d.__version=e.version,void(e.onUpdate&&e.onUpdate(e))}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}n.activeTexture(t.TEXTURE0+c),n.bindTexture(t.TEXTURE_2D,d.__webglTexture)}function p(n,a,s){s?(t.texParameteri(n,t.TEXTURE_WRAP_S,o.convert(a.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o.convert(a.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),1001===a.wrapS&&1001===a.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(n,t.TEXTURE_MAG_FILTER,c(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,c(a.minFilter)),1003!==a.minFilter&&1006!==a.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),!(s=e.get("EXT_texture_filter_anisotropic"))||1015===a.type&&null===e.get("OES_texture_float_linear")||1016===a.type&&null===e.get("OES_texture_half_float_linear")||!(1<a.anisotropy||i.get(a).__currentAnisotropy)||(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),i.get(a).__currentAnisotropy=a.anisotropy)}function m(e,r,a,s){var l=o.convert(r.texture.format),u=o.convert(r.texture.type);n.texImage2D(s,0,l,r.width,r.height,0,l,u,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,i.get(r.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function g(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}var v="undefined"!=typeof WebGL2RenderingContext&&t instanceof window.WebGL2RenderingContext,y={};this.setTexture2D=f,this.setTextureCube=function(e,c){var d=i.get(e);if(6===e.image.length)if(0<e.version&&d.__version!==e.version){d.__image__webglTextureCube||(e.addEventListener("dispose",h),d.__image__webglTextureCube=t.createTexture(),a.textures++),n.activeTexture(t.TEXTURE0+c),n.bindTexture(t.TEXTURE_CUBE_MAP,d.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),c=e&&e.isCompressedTexture;for(var f=e.image[0]&&e.image[0].isDataTexture,m=[],g=0;6>g;g++)m[g]=c||f?f?e.image[g].image:e.image[g]:s(e.image[g],r.maxCubemapSize);var v=l(m[0]),y=o.convert(e.format),w=o.convert(e.type);for(p(t.TEXTURE_CUBE_MAP,e,v),g=0;6>g;g++)if(c)for(var b,_=m[g].mipmaps,E=0,T=_.length;E<T;E++)b=_[E],1023!==e.format&&1022!==e.format?-1<n.getCompressedTextureFormats().indexOf(y)?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,E,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,E,y,b.width,b.height,0,y,w,b.data);else f?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,y,m[g].width,m[g].height,0,y,w,m[g].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,y,y,w,m[g]);u(e,v)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),d.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+c),n.bindTexture(t.TEXTURE_CUBE_MAP,d.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,r){n.activeTexture(t.TEXTURE0+r),n.bindTexture(t.TEXTURE_CUBE_MAP,i.get(e).__webglTexture)},this.setupRenderTarget=function(e){var r=i.get(e),o=i.get(e.texture);e.addEventListener("dispose",d),o.__webglTexture=t.createTexture(),a.textures++;var s=!0===e.isWebGLRenderTargetCube,c=l(e);if(s){r.__webglFramebuffer=[];for(var h=0;6>h;h++)r.__webglFramebuffer[h]=t.createFramebuffer()}else r.__webglFramebuffer=t.createFramebuffer();if(s){for(n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),p(t.TEXTURE_CUBE_MAP,e.texture,c),h=0;6>h;h++)m(r.__webglFramebuffer[h],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+h);u(e.texture,c)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),p(t.TEXTURE_2D,e.texture,c),m(r.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),u(e.texture,c)&&t.generateMipmap(t.TEXTURE_2D),n.bindTexture(t.TEXTURE_2D,null);if(e.depthBuffer){if(r=i.get(e),o=!0===e.isWebGLRenderTargetCube,e.depthTexture){if(o)throw Error("target.depthTexture not supported in Cube render targets");if(e&&e.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),!e.depthTexture||!e.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(i.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),f(e.depthTexture,0),r=i.get(e.depthTexture).__webglTexture,1026===e.depthTexture.format)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,r,0);else{if(1027!==e.depthTexture.format)throw Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,r,0)}}else if(o)for(r.__webglDepthbuffer=[],o=0;6>o;o++)t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=t.createRenderbuffer(),g(r.__webglDepthbuffer[o],e);else t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),g(r.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}},this.updateRenderTargetMipmap=function(e){var r=e.texture;u(r,l(e))&&(e=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,r=i.get(r).__webglTexture,n.bindTexture(e,r),t.generateMipmap(e),n.bindTexture(e,null))},this.updateVideoTextures=function(){for(var t in y)y[t].update()}}(wt,_t,St,Mt,xt,qt,mt),At=new function(t){var e={};return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e[t.uuid]},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var i=e[n.uuid];i&&(t.deleteBuffer(i.buffer),delete e[n.uuid])},update:function(n,i){if(n.isInterleavedBufferAttribute&&(n=n.data),void 0===(r=e[n.uuid])){var r=n.uuid,o=n.array,a=n.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,s=t.createBuffer();t.bindBuffer(i,s),t.bufferData(i,o,a),n.onUploadCallback(),i=t.FLOAT,o instanceof Float32Array?i=t.FLOAT:o instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):o instanceof Uint16Array?i=t.UNSIGNED_SHORT:o instanceof Int16Array?i=t.SHORT:o instanceof Uint32Array?i=t.UNSIGNED_INT:o instanceof Int32Array?i=t.INT:o instanceof Int8Array?i=t.BYTE:o instanceof Uint8Array&&(i=t.UNSIGNED_BYTE),e[r]={buffer:s,type:i,bytesPerElement:o.BYTES_PER_ELEMENT,version:n.version}}else r.version<n.version&&(o=n,s=o.array,a=o.updateRange,t.bindBuffer(i,r.buffer),!1===o.dynamic?t.bufferData(i,s,t.STATIC_DRAW):-1===a.count?t.bufferSubData(i,0,s):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(i,a.offset*s.BYTES_PER_ELEMENT,s.subarray(a.offset,a.offset+a.count)),a.count=-1),r.version=n.version)}}}(wt),Lt=new function(t,e,n){function i(t){t=t.target;var a=r[t.id];null!==a.index&&e.remove(a.index);for(var s in a.attributes)e.remove(a.attributes[s]);t.removeEventListener("dispose",i),delete r[t.id],(s=o[t.id])&&(e.remove(s),delete o[t.id]),(s=o[a.id])&&(e.remove(s),delete o[a.id]),n.geometries--}var r={},o={};return{get:function(t,e){var o=r[e.id];return o||(e.addEventListener("dispose",i),e.isBufferGeometry?o=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new yt).setFromObject(t)),o=e._bufferGeometry),r[e.id]=o,n.geometries++,o)},update:function(n){var i=n.index,r=n.attributes;null!==i&&e.update(i,t.ELEMENT_ARRAY_BUFFER);for(var o in r)e.update(r[o],t.ARRAY_BUFFER);n=n.morphAttributes;for(o in n){i=n[o],r=0;for(var a=i.length;r<a;r++)e.update(i[r],t.ARRAY_BUFFER)}},getWireframeAttribute:function(n){var i=o[n.id];if(i)return i;i=[];var r=n.index,a=n.attributes;if(null!==r)for(var s=r.array,l=0,u=s.length;l<u;l+=3){var c=s[l+0];a=s[l+1],r=s[l+2],i.push(c,a,a,r,r,c)}else for(s=a.position.array,l=0,u=s.length/3-1;l<u;l+=3)c=l+0,a=l+1,r=l+2,i.push(c,a,a,r,r,c);return i=new(65535<vt(i)?ft:ht)(i,1),e.update(i,t.ELEMENT_ARRAY_BUFFER),o[n.id]=i}}}(wt,At,mt),Dt=new function(t,e){var n={};return{update:function(i){var r=e.frame,o=i.geometry,a=t.get(i,o);return n[a.id]!==r&&(o.isGeometry&&a.updateFromObject(i),t.update(a),n[a.id]=r),a},clear:function(){n={}}}}(Lt,gt),Bt=new function(t){var e={},n=new Float32Array(8);return{update:function(i,r,o,a){var s=i.morphTargetInfluences,l=s.length;if(void 0===(i=e[r.id])){i=[];for(var u=0;u<l;u++)i[u]=[u,0];e[r.id]=i}var c=o.morphTargets&&r.morphAttributes.position;for(o=o.morphNormals&&r.morphAttributes.normal,u=0;u<l;u++){var h=i[u];0!==h[1]&&(c&&r.removeAttribute("morphTarget"+u),o&&r.removeAttribute("morphNormal"+u))}for(u=0;u<l;u++)h=i[u],h[0]=u,h[1]=s[u];for(i.sort(Nt),u=0;8>u;u++)(h=i[u])&&(s=h[0],h=h[1])?(c&&r.addAttribute("morphTarget"+u,c[s]),o&&r.addAttribute("morphNormal"+u,o[s]),n[u]=h):n[u]=0;a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}(wt),Ht=new function(t,e,n){function i(t,e){if(t)t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding);else var n=3e3;return 3e3===n&&e&&(n=3007),n}var r=[],o={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},a="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");this.getParameters=function(e,r,a,s,l,u,c){var h=o[e.type];if(c.isSkinnedMesh){var d=c.skeleton.bones;if(n.floatVertexTextures)d=1024;else{var f=Math.min(Math.floor((n.maxVertexUniforms-20)/4),d.length);f<d.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+d.length+" bones. This GPU supports "+f+"."),d=0):d=f}}else d=0;f=n.precision,null!==e.precision&&(f=n.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",f,"instead.");var p=t.getRenderTarget();return{shaderID:h,precision:f,supportsVertexTextures:n.vertexTextures,outputEncoding:i(p?p.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:i(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:i(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(306===e.envMap.mapping||307===e.envMap.mapping),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:i(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!s,useFog:e.fog,fogExp:s&&s.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:e.skinning&&0<d,maxBones:d,useVertexTexture:n.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:l,numClipIntersection:u,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&0<a.length,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:2===e.side,flipSided:1===e.side,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,n){var i=[];if(n.shaderID?i.push(n.shaderID):(i.push(e.fragmentShader),i.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)i.push(r),i.push(e.defines[r]);for(r=0;r<a.length;r++)i.push(n[a[r]]);return i.push(e.onBeforeCompile.toString()),i.push(t.gammaOutput),i.join()},this.acquireProgram=function(n,i,o,a){for(var s,l=0,u=r.length;l<u;l++){var c=r[l];if(c.code===a){++(s=c).usedTimes;break}}return void 0===s&&(s=new jt(t,e,a,n,i,o),r.push(s)),s},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}(D,_t,xt),It=new kt,Ut=new Pt,Ft=new function(t,e,n,i){function r(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,i)}var o,a,s,l=new z(0),u=0;return{getClearColor:function(){return l},setClearColor:function(t,e){l.set(t),r(l,u=void 0!==e?e:1)},getClearAlpha:function(){return u},setClearAlpha:function(t){r(l,u=t)},render:function(e,i,c,h){null===(i=i.background)?r(l,u):i&&i.isColor&&(r(i,1),h=!0),(t.autoClear||h)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),i&&i.isCubeTexture?(void 0===s&&((s=new Ot(new bt(1,1,1),new Ct({uniforms:Nr.cube.uniforms,vertexShader:Nr.cube.vertexShader,fragmentShader:Nr.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),s.geometry.removeAttribute("uv"),s.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(s.geometry)),s.material.uniforms.tCube.value=i,e.push(s,s.geometry,s.material,0,null)):i&&i.isTexture&&(void 0===o&&(o=new it(-1,1,1,-1,0,1),a=new Ot(new Et(2,2),new Tt({depthTest:!1,depthWrite:!1,fog:!1})),n.update(a.geometry)),a.material.map=i,t.renderBufferDirect(o,null,a.geometry,a.material,a,null))}}}(D,St,Lt,M),zt=new function(t,e,n){var i;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.calls++,n.vertices+=r,i===t.TRIANGLES?n.faces+=r/3:i===t.POINTS&&(n.points+=r)},this.renderInstances=function(r,o,a){var s=e.get("ANGLE_instanced_arrays");if(null===s)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var l=r.attributes.position;l.isInterleavedBufferAttribute?(a=l.data.count,s.drawArraysInstancedANGLE(i,0,a,r.maxInstancedCount)):s.drawArraysInstancedANGLE(i,o,a,r.maxInstancedCount),n.calls++,n.vertices+=a*r.maxInstancedCount,i===t.TRIANGLES?n.faces+=r.maxInstancedCount*a/3:i===t.POINTS&&(n.points+=r.maxInstancedCount*a)}}}(wt,_t,gt),Vt=new function(t,e,n){var i,r,o;this.setMode=function(t){i=t},this.setIndex=function(t){r=t.type,o=t.bytesPerElement},this.render=function(e,a){t.drawElements(i,a,r,e*o),n.calls++,n.vertices+=a,i===t.TRIANGLES?n.faces+=a/3:i===t.POINTS&&(n.points+=a)},this.renderInstances=function(a,s,l){var u=e.get("ANGLE_instanced_arrays");null===u?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(u.drawElementsInstancedANGLE(i,l,r,s*o,a.maxInstancedCount),n.calls++,n.vertices+=l*a.maxInstancedCount,i===t.TRIANGLES?n.faces+=a.maxInstancedCount*l/3:i===t.POINTS&&(n.points+=a.maxInstancedCount*l))}}(wt,_t,gt),Yt=new function(t,e,i,r,a){var s,l,u,c,h,d,f,p,m,g,v,y,w,b,_;this.render=function(t,E,T,C){if(0!==t.length){E=new o;var x=C.w/C.z,S=.5*C.z,M=.5*C.w,O=new n((N=16/C.w)*x,N),R=new o(1,1,0),A=new n(1,1),P=new V;if(P.min.set(C.x,C.y),P.max.set(C.x+(C.z-16),C.y+(C.w-16)),void 0===w){var N=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),k=new Uint16Array([0,1,2,0,2,3]);v=e.createBuffer(),y=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,N,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,y),e.bufferData(e.ELEMENT_ARRAY_BUFFER,k,e.STATIC_DRAW),b=e.createTexture(),_=e.createTexture(),i.bindTexture(e.TEXTURE_2D,b),e.texImage2D(e.TEXTURE_2D,0,e.RGB,16,16,0,e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),i.bindTexture(e.TEXTURE_2D,_),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,16,16,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),N={vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\n\tvUV = uv;\n\tvec2 pos = position;\n\tif ( renderType == 2 ) {\n\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\n\t\tvVisibility =        visibility.r / 9.0;\n\t\tvVisibility *= 1.0 - visibility.g / 9.0;\n\t\tvVisibility *=       visibility.b / 9.0;\n\t\tvVisibility *= 1.0 - visibility.a / 9.0;\n\t\tpos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\n\t\tpos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n\t}\n\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\n\tif ( renderType == 0 ) {\n\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n\t} else if ( renderType == 1 ) {\n\t\tgl_FragColor = texture2D( map, vUV );\n\t} else {\n\t\tvec4 texture = texture2D( map, vUV );\n\t\ttexture.a *= opacity * vVisibility;\n\t\tgl_FragColor = texture;\n\t\tgl_FragColor.rgb *= color;\n\t}\n}"},k=e.createProgram();var L=e.createShader(e.FRAGMENT_SHADER),D=e.createShader(e.VERTEX_SHADER),I="precision "+a.precision+" float;\n";e.shaderSource(L,I+N.fragmentShader),e.shaderSource(D,I+N.vertexShader),e.compileShader(L),e.compileShader(D),e.attachShader(k,L),e.attachShader(k,D),e.linkProgram(k),w=k,m=e.getAttribLocation(w,"position"),g=e.getAttribLocation(w,"uv"),s=e.getUniformLocation(w,"renderType"),l=e.getUniformLocation(w,"map"),u=e.getUniformLocation(w,"occlusionMap"),c=e.getUniformLocation(w,"opacity"),h=e.getUniformLocation(w,"color"),d=e.getUniformLocation(w,"scale"),f=e.getUniformLocation(w,"rotation"),p=e.getUniformLocation(w,"screenPosition")}for(i.useProgram(w),i.initAttributes(),i.enableAttribute(m),i.enableAttribute(g),i.disableUnusedAttributes(),e.uniform1i(u,0),e.uniform1i(l,1),e.bindBuffer(e.ARRAY_BUFFER,v),e.vertexAttribPointer(m,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(g,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,y),i.disable(e.CULL_FACE),i.buffers.depth.setMask(!1),k=0,L=t.length;k<L;k++)if(N=16/C.w,O.set(N*x,N),D=t[k],E.set(D.matrixWorld.elements[12],D.matrixWorld.elements[13],D.matrixWorld.elements[14]),E.applyMatrix4(T.matrixWorldInverse),E.applyMatrix4(T.projectionMatrix),R.copy(E),A.x=C.x+R.x*S+S-8,A.y=C.y+R.y*M+M-8,!0===P.containsPoint(A)){i.activeTexture(e.TEXTURE0),i.bindTexture(e.TEXTURE_2D,null),i.activeTexture(e.TEXTURE1),i.bindTexture(e.TEXTURE_2D,b),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGB,A.x,A.y,16,16,0),e.uniform1i(s,0),e.uniform2f(d,O.x,O.y),e.uniform3f(p,R.x,R.y,R.z),i.disable(e.BLEND),i.enable(e.DEPTH_TEST),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),i.activeTexture(e.TEXTURE0),i.bindTexture(e.TEXTURE_2D,_),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,A.x,A.y,16,16,0),e.uniform1i(s,1),i.disable(e.DEPTH_TEST),i.activeTexture(e.TEXTURE1),i.bindTexture(e.TEXTURE_2D,b),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),D.positionScreen.copy(R),D.customUpdateCallback?D.customUpdateCallback(D):D.updateLensFlares(),e.uniform1i(s,2),i.enable(e.BLEND),I=0;for(var H=D.lensFlares.length;I<H;I++){var U=D.lensFlares[I];.001<U.opacity&&.001<U.scale&&(R.x=U.x,R.y=U.y,R.z=U.z,N=U.size*U.scale/C.w,O.x=N*x,O.y=N,e.uniform3f(p,R.x,R.y,R.z),e.uniform2f(d,O.x,O.y),e.uniform1f(f,U.rotation),e.uniform1f(c,U.opacity),e.uniform3f(h,U.color.r,U.color.g,U.color.b),i.setBlending(U.blending,U.blendEquation,U.blendSrc,U.blendDst),r.setTexture2D(U.texture,1),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}}i.enable(e.CULL_FACE),i.enable(e.DEPTH_TEST),i.buffers.depth.setMask(!0),i.reset()}}}(D,wt,St,Rt,xt),Xt=new function(t,e,n,i,a){function s(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var l,u,c,h,d,f,p,m,g,v,y,w,b,_,E,T,C,x,S,M,O,R=new o,A=new r,P=new o;this.render=function(r,o,N){if(0!==r.length){if(void 0===M){var k=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),L=new Uint16Array([0,1,2,0,2,3]);x=e.createBuffer(),S=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,x),e.bufferData(e.ARRAY_BUFFER,k,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,S),e.bufferData(e.ELEMENT_ARRAY_BUFFER,L,e.STATIC_DRAW),k=e.createProgram(),L=e.createShader(e.VERTEX_SHADER);var D=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(L,["precision "+a.precision+" float;","#define SHADER_NAME SpriteMaterial\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvUV = uvOffset + uv * uvScale;\n\tvec2 alignedPosition = position * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\tfogDepth = - mvPosition.z;\n}"].join("\n")),e.shaderSource(D,["precision "+a.precision+" float;","#define SHADER_NAME SpriteMaterial\nuniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvec4 texture = texture2D( map, vUV );\n\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\n\tif ( gl_FragColor.a < alphaTest ) discard;\n\tif ( fogType > 0 ) {\n\t\tfloat fogFactor = 0.0;\n\t\tif ( fogType == 1 ) {\n\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t\t} else {\n\t\t\tconst float LOG2 = 1.442695;\n\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );\n\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\t\t}\n\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\t}\n}"].join("\n")),e.compileShader(L),e.compileShader(D),e.attachShader(k,L),e.attachShader(k,D),e.linkProgram(k),M=k,T=e.getAttribLocation(M,"position"),C=e.getAttribLocation(M,"uv"),l=e.getUniformLocation(M,"uvOffset"),u=e.getUniformLocation(M,"uvScale"),c=e.getUniformLocation(M,"rotation"),h=e.getUniformLocation(M,"scale"),d=e.getUniformLocation(M,"color"),f=e.getUniformLocation(M,"map"),p=e.getUniformLocation(M,"opacity"),m=e.getUniformLocation(M,"modelViewMatrix"),g=e.getUniformLocation(M,"projectionMatrix"),v=e.getUniformLocation(M,"fogType"),y=e.getUniformLocation(M,"fogDensity"),w=e.getUniformLocation(M,"fogNear"),b=e.getUniformLocation(M,"fogFar"),_=e.getUniformLocation(M,"fogColor"),e.getUniformLocation(M,"fogDepth"),E=e.getUniformLocation(M,"alphaTest"),(k=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=8,k.height=8,(L=k.getContext("2d")).fillStyle="white",L.fillRect(0,0,8,8),O=new W(k)}n.useProgram(M),n.initAttributes(),n.enableAttribute(T),n.enableAttribute(C),n.disableUnusedAttributes(),n.disable(e.CULL_FACE),n.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,x),e.vertexAttribPointer(T,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(C,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,S),e.uniformMatrix4fv(g,!1,N.projectionMatrix.elements),n.activeTexture(e.TEXTURE0),e.uniform1i(f,0),L=k=0,(D=o.fog)?(e.uniform3f(_,D.color.r,D.color.g,D.color.b),D.isFog?(e.uniform1f(w,D.near),e.uniform1f(b,D.far),e.uniform1i(v,1),L=k=1):D.isFogExp2&&(e.uniform1f(y,D.density),e.uniform1i(v,2),L=k=2)):(e.uniform1i(v,0),L=k=0);for(var I=0,H=r.length;I<H;I++)(D=r[I]).modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,D.matrixWorld),D.z=-D.modelViewMatrix.elements[14];r.sort(s);var U=[];for(I=0,H=r.length;I<H;I++){var F=(D=r[I]).material;if(!1!==F.visible){D.onBeforeRender(t,o,N,void 0,F,void 0),e.uniform1f(E,F.alphaTest),e.uniformMatrix4fv(m,!1,D.modelViewMatrix.elements),D.matrixWorld.decompose(R,A,P),U[0]=P.x,U[1]=P.y;var B=0;o.fog&&F.fog&&(B=L),k!==B&&(e.uniform1i(v,B),k=B),null!==F.map?(e.uniform2f(l,F.map.offset.x,F.map.offset.y),e.uniform2f(u,F.map.repeat.x,F.map.repeat.y)):(e.uniform2f(l,0,0),e.uniform2f(u,1,1)),e.uniform1f(p,F.opacity),e.uniform3f(d,F.color.r,F.color.g,F.color.b),e.uniform1f(c,F.rotation),e.uniform2fv(h,U),n.setBlending(F.blending,F.blendEquation,F.blendSrc,F.blendDst,F.blendEquationAlpha,F.blendSrcAlpha,F.blendDstAlpha,F.premultipliedAlpha),n.buffers.depth.setTest(F.depthTest),n.buffers.depth.setMask(F.depthWrite),n.buffers.color.setMask(F.colorWrite),i.setTexture2D(F.map||O,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),D.onAfterRender(t,o,N,void 0,F,void 0)}}n.enable(e.CULL_FACE),n.reset()}}}(D,wt,St,Rt,xt),D.info.programs=Ht.programs,D.context=wt,D.capabilities=xt,D.extensions=_t,D.properties=Mt,D.renderLists=Ut,D.state=St}function s(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function u(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1,e()}function c(t){(t=t.target).removeEventListener("dispose",c),d(t),Mt.remove(t)}function d(t){var e=Mt.get(t).program;t.program=void 0,void 0!==e&&Ht.releaseProgram(e)}function f(t){null!==$t&&$t(t),(t=Jt.getDevice())&&t.isPresenting?t.requestAnimationFrame(f):window.requestAnimationFrame(f)}function p(t,e,n){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isLight)A.push(t),t.castShadow&&P.push(t);else if(t.isSprite)t.frustumCulled&&!st.intersectsSprite(t)||k.push(t);else if(t.isLensFlare)L.push(t);else if(t.isImmediateRenderObject)n&&pt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(dt),N.push(t,null,t.material,pt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||st.intersectsObject(t))){n&&pt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(dt);var i=Dt.update(t),r=t.material;if(Array.isArray(r))for(var o=i.groups,a=0,s=o.length;a<s;a++){var l=o[a],u=r[l.materialIndex];u&&u.visible&&N.push(t,i,u,pt.z,l)}else r.visible&&N.push(t,i,r,pt.z,null)}for(a=0,s=(t=t.children).length;a<s;a++)p(t[a],e,n)}}function m(t,e,n,i){for(var r=0,o=t.length;r<o;r++){var a=(u=t[r]).object,s=u.geometry,l=void 0===i?u.material:i,u=u.group;if(n.isArrayCamera){Y=n;for(var c=n.cameras,h=0,d=c.length;h<d;h++){var f=c[h];if(a.layers.test(f.layers)){var p=f.bounds;St.viewport(X.set(p.x*tt,p.y*et,p.z*tt,p.w*et).multiplyScalar(nt)),g(a,e,f,s,l,u)}}}else Y=null,g(a,e,n,s,l,u)}}function g(t,e,n,i,r,o){if(t.onBeforeRender(D,e,n,i,r,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=t.isMesh&&0>t.matrixWorld.determinant();St.setMaterial(r,a),a=y(n,e.fog,r,t),B="",function(t,e,n){t.render(function(t){D.renderBufferImmediate(t,e,n)})}(t,a,r)}else D.renderBufferDirect(n,e.fog,i,r,t,o);t.onAfterRender(D,e,n,i,r,o)}function v(t,e,n){var i=Mt.get(t);n=Ht.getParameters(t,It.state,P,e,lt.numPlanes,lt.numIntersection,n);var r=Ht.getProgramCode(t,n),o=i.program,a=!0;if(void 0===o)t.addEventListener("dispose",c);else if(o.code!==r)d(t);else{if(void 0!==n.shaderID)return;a=!1}if(a&&(n.shaderID?(o=Nr[n.shaderID],i.shader={name:t.type,uniforms:Ar.clone(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader}):i.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.onBeforeCompile(i.shader),o=Ht.acquireProgram(t,i.shader,n,r),i.program=o,t.program=o),n=o.getAttributes(),t.morphTargets)for(r=t.numSupportedMorphTargets=0;r<D.maxMorphTargets;r++)0<=n["morphTarget"+r]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(r=t.numSupportedMorphNormals=0;r<D.maxMorphNormals;r++)0<=n["morphNormal"+r]&&t.numSupportedMorphNormals++;n=i.shader.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(i.numClippingPlanes=lt.numPlanes,i.numIntersection=lt.numIntersection,n.clippingPlanes=lt.uniform),i.fog=e,i.lightsHash=It.state.hash,t.lights&&(n.ambientLightColor.value=It.state.ambient,n.directionalLights.value=It.state.directional,n.spotLights.value=It.state.spot,n.rectAreaLights.value=It.state.rectArea,n.pointLights.value=It.state.point,n.hemisphereLights.value=It.state.hemi,n.directionalShadowMap.value=It.state.directionalShadowMap,n.directionalShadowMatrix.value=It.state.directionalShadowMatrix,n.spotShadowMap.value=It.state.spotShadowMap,n.spotShadowMatrix.value=It.state.spotShadowMatrix,n.pointShadowMap.value=It.state.pointShadowMap,n.pointShadowMatrix.value=It.state.pointShadowMatrix),t=i.program.getUniforms(),t=j.seqWithValue(t.seq,n),i.uniformsList=t}function y(t,e,n,i){Q=0;var r=Mt.get(n);ut&&(ct||t!==G)&&lt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,r,t===G&&n.id===F),!1===n.needsUpdate&&(void 0===r.program?n.needsUpdate=!0:n.fog&&r.fog!==e?n.needsUpdate=!0:n.lights&&r.lightsHash!==It.state.hash?n.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===lt.numPlanes&&r.numIntersection===lt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(v(n,e,i),n.needsUpdate=!1);var o=!1,a=!1,s=!1,l=r.program,u=l.getUniforms(),c=r.shader.uniforms;if(St.useProgram(l.program)&&(s=a=o=!0),n.id!==F&&(F=n.id,a=!0),(o||t!==G)&&(u.setValue(wt,"projectionMatrix",t.projectionMatrix),xt.logarithmicDepthBuffer&&u.setValue(wt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),G!==(Y||t)&&(G=Y||t,s=a=!0),(n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap)&&void 0!==(o=u.map.cameraPosition)&&o.setValue(wt,pt.setFromMatrixPosition(t.matrixWorld)),(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&u.setValue(wt,"viewMatrix",t.matrixWorldInverse)),n.skinning&&(u.setOptional(wt,i,"bindMatrix"),u.setOptional(wt,i,"bindMatrixInverse"),t=i.skeleton))if(o=t.bones,xt.floatVertexTextures){if(void 0===t.boneTexture){o=Math.sqrt(4*o.length),o=wr.ceilPowerOfTwo(o),o=Math.max(o,4);var d=new Float32Array(o*o*4);d.set(t.boneMatrices);var f=new h(d,o,o,1023,1015);t.boneMatrices=d,t.boneTexture=f,t.boneTextureSize=o}u.setValue(wt,"boneTexture",t.boneTexture),u.setValue(wt,"boneTextureSize",t.boneTextureSize)}else u.setOptional(wt,t,"boneMatrices");return a&&(u.setValue(wt,"toneMappingExposure",D.toneMappingExposure),u.setValue(wt,"toneMappingWhitePoint",D.toneMappingWhitePoint),n.lights&&(a=s,c.ambientLightColor.needsUpdate=a,c.directionalLights.needsUpdate=a,c.pointLights.needsUpdate=a,c.spotLights.needsUpdate=a,c.rectAreaLights.needsUpdate=a,c.hemisphereLights.needsUpdate=a),e&&n.fog&&(c.fogColor.value=e.color,e.isFog?(c.fogNear.value=e.near,c.fogFar.value=e.far):e.isFogExp2&&(c.fogDensity.value=e.density)),n.isMeshBasicMaterial?w(c,n):n.isMeshLambertMaterial?(w(c,n),n.emissiveMap&&(c.emissiveMap.value=n.emissiveMap)):n.isMeshPhongMaterial?(w(c,n),n.isMeshToonMaterial?(b(c,n),n.gradientMap&&(c.gradientMap.value=n.gradientMap)):b(c,n)):n.isMeshStandardMaterial?(w(c,n),n.isMeshPhysicalMaterial&&(c.clearCoat.value=n.clearCoat,c.clearCoatRoughness.value=n.clearCoatRoughness),c.roughness.value=n.roughness,c.metalness.value=n.metalness,n.roughnessMap&&(c.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(c.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(c.emissiveMap.value=n.emissiveMap),n.bumpMap&&(c.bumpMap.value=n.bumpMap,c.bumpScale.value=n.bumpScale),n.normalMap&&(c.normalMap.value=n.normalMap,c.normalScale.value.copy(n.normalScale)),n.displacementMap&&(c.displacementMap.value=n.displacementMap,c.displacementScale.value=n.displacementScale,c.displacementBias.value=n.displacementBias),n.envMap&&(c.envMapIntensity.value=n.envMapIntensity)):n.isMeshDepthMaterial?(w(c,n),n.displacementMap&&(c.displacementMap.value=n.displacementMap,c.displacementScale.value=n.displacementScale,c.displacementBias.value=n.displacementBias)):n.isMeshDistanceMaterial?(w(c,n),n.displacementMap&&(c.displacementMap.value=n.displacementMap,c.displacementScale.value=n.displacementScale,c.displacementBias.value=n.displacementBias),c.referencePosition.value.copy(n.referencePosition),c.nearDistance.value=n.nearDistance,c.farDistance.value=n.farDistance):n.isMeshNormalMaterial?(w(c,n),n.bumpMap&&(c.bumpMap.value=n.bumpMap,c.bumpScale.value=n.bumpScale),n.normalMap&&(c.normalMap.value=n.normalMap,c.normalScale.value.copy(n.normalScale)),n.displacementMap&&(c.displacementMap.value=n.displacementMap,c.displacementScale.value=n.displacementScale,c.displacementBias.value=n.displacementBias)):n.isLineBasicMaterial?(c.diffuse.value=n.color,c.opacity.value=n.opacity,n.isLineDashedMaterial&&(c.dashSize.value=n.dashSize,c.totalSize.value=n.dashSize+n.gapSize,c.scale.value=n.scale)):n.isPointsMaterial?(c.diffuse.value=n.color,c.opacity.value=n.opacity,c.size.value=n.size*nt,c.scale.value=.5*et,c.map.value=n.map,null!==n.map&&(!0===n.map.matrixAutoUpdate&&(e=n.map.offset,a=n.map.repeat,s=n.map.center,n.map.matrix.setUvTransform(e.x,e.y,a.x,a.y,n.map.rotation,s.x,s.y)),c.uvTransform.value.copy(n.map.matrix))):n.isShadowMaterial&&(c.color.value=n.color,c.opacity.value=n.opacity),void 0!==c.ltcMat&&(c.ltcMat.value=Rr.LTC_MAT_TEXTURE),void 0!==c.ltcMag&&(c.ltcMag.value=Rr.LTC_MAG_TEXTURE),j.upload(wt,r.uniformsList,c,D)),u.setValue(wt,"modelViewMatrix",i.modelViewMatrix),u.setValue(wt,"normalMatrix",i.normalMatrix),u.setValue(wt,"modelMatrix",i.matrixWorld),l}function w(t,e){if(t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map)var n=e.map;else e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap);if(void 0!==n){if(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate){e=n.offset;var i=n.repeat,r=n.center;n.matrix.setUvTransform(e.x,e.y,i.x,i.y,n.rotation,r.x,r.y)}t.uvTransform.value.copy(n.matrix)}}function b(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}console.log("THREE.WebGLRenderer","89");var _=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),E=void 0!==t.context?t.context:null,T=void 0!==t.alpha&&t.alpha,C=void 0===t.depth||t.depth,x=void 0===t.stencil||t.stencil,S=void 0!==t.antialias&&t.antialias,M=void 0===t.premultipliedAlpha||t.premultipliedAlpha,O=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,R=void 0!==t.powerPreference?t.powerPreference:"default",A=[],P=[],N=null,k=[],L=[];this.domElement=_,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var D=this,I=!1,H=null,U=null,F=-1,B="",G=null,Y=null,X=new l,q=new l,J=null,Q=0,tt=_.width,et=_.height,nt=1,rt=new l(0,0,tt,et),ot=new l(0,0,tt,et),at=!1,st=new Z,lt=new function(){function t(){c.value!==i&&(c.value=i,c.needsUpdate=0<r),n.numPlanes=r,n.numIntersection=0}function e(t,e,i,r){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=c.value,!0!==r||null===a)for(r=i+4*o,e=e.matrixWorldInverse,u.getNormalMatrix(e),(null===a||a.length<r)&&(a=new Float32Array(r)),r=0;r!==o;++r,i+=4)l.copy(t[r]).applyMatrix4(e,u),l.normal.toArray(a,i),a[i+3]=l.constant;c.value=a,c.needsUpdate=!0}return n.numPlanes=o,a}var n=this,i=null,r=0,o=!1,s=!1,l=new K,u=new a,c={value:null,needsUpdate:!1};this.uniform=c,this.numIntersection=this.numPlanes=0,this.init=function(t,n,a){var s=0!==t.length||n||0!==r||o;return o=n,i=e(t,a,0),r=t.length,s},this.beginShadows=function(){s=!0,e(null)},this.endShadows=function(){s=!1,t()},this.setState=function(n,a,l,u,h,d){if(!o||null===n||0===n.length||s&&!l)s?e(null):t();else{var f=4*(l=s?0:r),p=h.clippingState||null;for(c.value=p,p=e(n,u,f,d),n=0;n!==f;++n)p[n]=i[n];h.clippingState=p,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=l}}},ut=!1,ct=!1,dt=new i,pt=new o,mt={geometries:0,textures:0},gt={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:gt,memory:mt,programs:null};try{T={alpha:T,depth:C,stencil:x,antialias:S,premultipliedAlpha:M,preserveDrawingBuffer:O,powerPreference:R},_.addEventListener("webglcontextlost",s,!1),_.addEventListener("webglcontextrestored",u,!1);var wt=E||_.getContext("webgl",T)||_.getContext("experimental-webgl",T);if(null===wt){if(null!==_.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}void 0===wt.getShaderPrecisionFormat&&(wt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}var _t,xt,St,Mt,Rt,At,Lt,Dt,It,Ht,Ut,Ft,Bt,zt,Vt,Yt,Xt,qt;e();var Jt=new Wt(D);this.vr=Jt;var Kt=new $(D,Dt,xt.maxTextureSize);this.shadowMap=Kt,this.getContext=function(){return wt},this.getContextAttributes=function(){return wt.getContextAttributes()},this.forceContextLoss=function(){var t=_t.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=_t.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return nt},this.setPixelRatio=function(t){void 0!==t&&(nt=t,this.setSize(tt,et,!1))},this.getSize=function(){return{width:tt,height:et}},this.setSize=function(t,e,n){var i=Jt.getDevice();i&&i.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(tt=t,et=e,_.width=t*nt,_.height=e*nt,!1!==n&&(_.style.width=t+"px",_.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(){return{width:tt*nt,height:et*nt}},this.setDrawingBufferSize=function(t,e,n){tt=t,et=e,nt=n,_.width=t*n,_.height=e*n,this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,i){rt.set(t,et-e-i,n,i),St.viewport(X.copy(rt).multiplyScalar(nt))},this.setScissor=function(t,e,n,i){ot.set(t,et-e-i,n,i),St.scissor(q.copy(ot).multiplyScalar(nt))},this.setScissorTest=function(t){St.setScissorTest(at=t)},this.getClearColor=function(){return Ft.getClearColor()},this.setClearColor=function(){Ft.setClearColor.apply(Ft,arguments)},this.getClearAlpha=function(){return Ft.getClearAlpha()},this.setClearAlpha=function(){Ft.setClearAlpha.apply(Ft,arguments)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=wt.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=wt.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=wt.STENCIL_BUFFER_BIT),wt.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},this.dispose=function(){_.removeEventListener("webglcontextlost",s,!1),_.removeEventListener("webglcontextrestored",u,!1),Ut.dispose(),Jt.dispose()},this.renderBufferImmediate=function(t,e,n){St.initAttributes();var i=Mt.get(t);if(t.hasPositions&&!i.position&&(i.position=wt.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=wt.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=wt.createBuffer()),t.hasColors&&!i.color&&(i.color=wt.createBuffer()),e=e.getAttributes(),t.hasPositions&&(wt.bindBuffer(wt.ARRAY_BUFFER,i.position),wt.bufferData(wt.ARRAY_BUFFER,t.positionArray,wt.DYNAMIC_DRAW),St.enableAttribute(e.position),wt.vertexAttribPointer(e.position,3,wt.FLOAT,!1,0,0)),t.hasNormals){if(wt.bindBuffer(wt.ARRAY_BUFFER,i.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var r=0,o=3*t.count;r<o;r+=9){var a=t.normalArray,s=(a[r+0]+a[r+3]+a[r+6])/3,l=(a[r+1]+a[r+4]+a[r+7])/3,u=(a[r+2]+a[r+5]+a[r+8])/3;a[r+0]=s,a[r+1]=l,a[r+2]=u,a[r+3]=s,a[r+4]=l,a[r+5]=u,a[r+6]=s,a[r+7]=l,a[r+8]=u}wt.bufferData(wt.ARRAY_BUFFER,t.normalArray,wt.DYNAMIC_DRAW),St.enableAttribute(e.normal),wt.vertexAttribPointer(e.normal,3,wt.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(wt.bindBuffer(wt.ARRAY_BUFFER,i.uv),wt.bufferData(wt.ARRAY_BUFFER,t.uvArray,wt.DYNAMIC_DRAW),St.enableAttribute(e.uv),wt.vertexAttribPointer(e.uv,2,wt.FLOAT,!1,0,0)),t.hasColors&&0!==n.vertexColors&&(wt.bindBuffer(wt.ARRAY_BUFFER,i.color),wt.bufferData(wt.ARRAY_BUFFER,t.colorArray,wt.DYNAMIC_DRAW),St.enableAttribute(e.color),wt.vertexAttribPointer(e.color,3,wt.FLOAT,!1,0,0)),St.disableUnusedAttributes(),wt.drawArrays(wt.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,i,r,o){var a=r.isMesh&&0>r.matrixWorld.determinant();St.setMaterial(i,a);var s=y(t,e,i,r),l=!1;(t=n.id+"_"+s.id+"_"+(!0===i.wireframe))!==B&&(B=t,l=!0),r.morphTargetInfluences&&(Bt.update(r,n,i,s),l=!0);a=n.index;var u=n.attributes.position;if(e=1,!0===i.wireframe&&(a=Lt.getWireframeAttribute(n),e=2),t=zt,null!==a){var c=At.get(a);(t=Vt).setIndex(c)}if(l){if(l=void 0,n&&n.isInstancedBufferGeometry&&null===_t.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===l&&(l=0),St.initAttributes();var h=n.attributes,d=(s=s.getAttributes(),i.defaultAttributeValues);for(T in s){var f=s[T];if(0<=f){if(void 0!==(E=h[T])){var p=E.normalized,m=E.itemSize;if(void 0!==(w=At.get(E))){var g=w.buffer,v=w.type,w=w.bytesPerElement;if(E.isInterleavedBufferAttribute){var b=E.data,_=b.stride,E=E.offset;b&&b.isInstancedInterleavedBuffer?(St.enableAttributeAndDivisor(f,b.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=b.meshPerAttribute*b.count)):St.enableAttribute(f),wt.bindBuffer(wt.ARRAY_BUFFER,g),wt.vertexAttribPointer(f,m,v,p,_*w,(l*_+E)*w)}else E.isInstancedBufferAttribute?(St.enableAttributeAndDivisor(f,E.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=E.meshPerAttribute*E.count)):St.enableAttribute(f),wt.bindBuffer(wt.ARRAY_BUFFER,g),wt.vertexAttribPointer(f,m,v,p,0,l*m*w)}}else if(void 0!==d&&void 0!==(p=d[T]))switch(p.length){case 2:wt.vertexAttrib2fv(f,p);break;case 3:wt.vertexAttrib3fv(f,p);break;case 4:wt.vertexAttrib4fv(f,p);break;default:wt.vertexAttrib1fv(f,p)}}}St.disableUnusedAttributes()}null!==a&&wt.bindBuffer(wt.ELEMENT_ARRAY_BUFFER,c.buffer)}c=0,null!==a?c=a.count:void 0!==u&&(c=u.count),a=n.drawRange.start*e,u=null!==o?o.start*e:0;var T=Math.max(a,u);if(0!==(o=Math.max(0,Math.min(c,a+n.drawRange.count*e,u+(null!==o?o.count*e:1/0))-1-T+1))){if(r.isMesh)if(!0===i.wireframe)St.setLineWidth(i.wireframeLinewidth*(null===H?nt:1)),t.setMode(wt.LINES);else switch(r.drawMode){case 0:t.setMode(wt.TRIANGLES);break;case 1:t.setMode(wt.TRIANGLE_STRIP);break;case 2:t.setMode(wt.TRIANGLE_FAN)}else r.isLine?(void 0===(i=i.linewidth)&&(i=1),St.setLineWidth(i*(null===H?nt:1)),r.isLineSegments?t.setMode(wt.LINES):r.isLineLoop?t.setMode(wt.LINE_LOOP):t.setMode(wt.LINE_STRIP)):r.isPoints&&t.setMode(wt.POINTS);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&t.renderInstances(n,T,o):t.render(T,o)}},this.compile=function(t,e){A.length=0,P.length=0,t.traverse(function(t){t.isLight&&(A.push(t),t.castShadow&&P.push(t))}),It.setup(A,P,e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)v(e.material[n],t.fog,e);else v(e.material,t.fog,e)})};var Zt=!1,$t=null;this.animate=function(t){$t=t,Zt||((t=Jt.getDevice())&&t.isPresenting?t.requestAnimationFrame(f):window.requestAnimationFrame(f),Zt=!0)},this.render=function(t,e,n,i){if(e&&e.isCamera){if(!I){B="",F=-1,G=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),Jt.enabled&&(e=Jt.getCamera(e)),dt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),st.setFromMatrix(dt),A.length=0,P.length=0,k.length=0,L.length=0,ct=this.localClippingEnabled,ut=lt.init(this.clippingPlanes,ct,e),(N=Ut.get(t,e)).init(),p(t,e,D.sortObjects),!0===D.sortObjects&&N.sort(),Rt.updateVideoTextures(),ut&&lt.beginShadows(),Kt.render(P,t,e),It.setup(A,P,e),ut&&lt.endShadows(),gt.frame++,gt.calls=0,gt.vertices=0,gt.faces=0,gt.points=0,void 0===n&&(n=null),this.setRenderTarget(n),Ft.render(N,t,e,i),i=N.opaque;var r=N.transparent;if(t.overrideMaterial){var o=t.overrideMaterial;i.length&&m(i,t,e,o),r.length&&m(r,t,e,o)}else i.length&&m(i,t,e),r.length&&m(r,t,e);Xt.render(k,t,e),Yt.render(L,t,e,X),n&&Rt.updateRenderTargetMipmap(n),St.buffers.depth.setTest(!0),St.buffers.depth.setMask(!0),St.buffers.color.setMask(!0),St.setPolygonOffset(!1),Jt.enabled&&Jt.submitFrame()}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(t,e){St.setCullFace(t),St.setFlipSided(0===e)},this.allocTextureUnit=function(){var t=Q;return t>=xt.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+xt.maxTextures),Q+=1,t},this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),Rt.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),Rt.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?Rt.setTextureCube(e,n):Rt.setTextureCubeDynamic(e,n)}}(),this.getRenderTarget=function(){return H},this.setRenderTarget=function(t){(H=t)&&void 0===Mt.get(t).__webglFramebuffer&&Rt.setupRenderTarget(t);var e=null,n=!1;t?(e=Mt.get(t).__webglFramebuffer,t.isWebGLRenderTargetCube&&(e=e[t.activeCubeFace],n=!0),X.copy(t.viewport),q.copy(t.scissor),J=t.scissorTest):(X.copy(rt).multiplyScalar(nt),q.copy(ot).multiplyScalar(nt),J=at),U!==e&&(wt.bindFramebuffer(wt.FRAMEBUFFER,e),U=e),St.viewport(X),St.scissor(q),St.setScissorTest(J),n&&(n=Mt.get(t.texture),wt.framebufferTexture2D(wt.FRAMEBUFFER,wt.COLOR_ATTACHMENT0,wt.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,n.__webglTexture,t.activeMipMapLevel))},this.readRenderTargetPixels=function(t,e,n,i,r,o){if(t&&t.isWebGLRenderTarget){var a=Mt.get(t).__webglFramebuffer;if(a){var s=!1;a!==U&&(wt.bindFramebuffer(wt.FRAMEBUFFER,a),s=!0);try{var l=t.texture,u=l.format,c=l.type;1023!==u&&qt.convert(u)!==wt.getParameter(wt.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===c||qt.convert(c)===wt.getParameter(wt.IMPLEMENTATION_COLOR_READ_TYPE)||1015===c&&(_t.get("OES_texture_float")||_t.get("WEBGL_color_buffer_float"))||1016===c&&_t.get("EXT_color_buffer_half_float")?wt.checkFramebufferStatus(wt.FRAMEBUFFER)===wt.FRAMEBUFFER_COMPLETE?0<=e&&e<=t.width-i&&0<=n&&n<=t.height-r&&wt.readPixels(e,n,i,r,qt.convert(u),qt.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&wt.bindFramebuffer(wt.FRAMEBUFFER,U)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function Xt(t,e){this.name="",this.color=new z(t),this.density=void 0!==e?e:25e-5}function qt(t,e,n){this.name="",this.color=new z(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Jt(){et.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function Kt(t,e,n,i,r){et.call(this),this.lensFlares=[],this.positionScreen=new o,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,i,r)}function Zt(t){G.call(this),this.type="SpriteMaterial",this.color=new z(16777215),this.map=null,this.rotation=0,this.lights=this.fog=!1,this.setValues(t)}function $t(t){et.call(this),this.type="Sprite",this.material=void 0!==t?t:new Zt}function Qt(){et.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function te(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new i)}function ee(){et.call(this),this.type="Bone"}function ne(t,e){Ot.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new i,this.bindMatrixInverse=new i,t=new te(t=this.initBones()),this.bind(t,this.matrixWorld),this.normalizeSkinWeights()}function ie(t){G.call(this),this.type="LineBasicMaterial",this.color=new z(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(t)}function re(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new oe(t,e);et.call(this),this.type="Line",this.geometry=void 0!==t?t:new yt,this.material=void 0!==e?e:new ie({color:16777215*Math.random()})}function oe(t,e){re.call(this,t,e),this.type="LineSegments"}function ae(t,e){re.call(this,t,e),this.type="LineLoop"}function se(t){G.call(this),this.type="PointsMaterial",this.color=new z(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function le(t,e){et.call(this),this.type="Points",this.geometry=void 0!==t?t:new yt,this.material=void 0!==e?e:new se({color:16777215*Math.random()})}function ue(){et.call(this),this.type="Group"}function ce(t,e,n,i,r,o,a,l,u){function c(){t.removeEventListener("loadeddata",c,!1),h.needsUpdate=!0}s.call(this,t,e,n,i,r,o,a,l,u),this.generateMipmaps=!1;var h=this;t.addEventListener("loadeddata",c,!1)}function he(t,e,n,i,r,o,a,l,u,c,h,d){s.call(this,null,o,a,l,u,c,i,r,h,d),this.image={width:e,height:n},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function de(t,e,n,i,r,o,a,l,u,c){if(1026!==(c=void 0!==c?c:1026)&&1027!==c)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===c&&(n=1012),void 0===n&&1027===c&&(n=1020),s.call(this,null,i,r,o,a,l,c,n,u),this.image={width:t,height:e},this.magFilter=void 0!==a?a:1003,this.minFilter=void 0!==l?l:1003,this.generateMipmaps=this.flipY=!1}function fe(t){yt.call(this),this.type="WireframeGeometry";var e,n,i,r=[],a=[0,0],s={},l=["a","b","c"];if(t&&t.isGeometry){var u=t.faces,c=0;for(n=u.length;c<n;c++){var h=u[c];for(e=0;3>e;e++){var d=h[l[e]],f=h[l[(e+1)%3]];a[0]=Math.min(d,f),a[1]=Math.max(d,f),void 0===s[d=a[0]+","+a[1]]&&(s[d]={index1:a[0],index2:a[1]})}}for(d in s)c=s[d],l=t.vertices[c.index1],r.push(l.x,l.y,l.z),l=t.vertices[c.index2],r.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){l=new o;if(null!==t.index){u=t.attributes.position,h=t.index;var p=t.groups;for(0===p.length&&(p=[{start:0,count:h.count,materialIndex:0}]),t=0,i=p.length;t<i;++t)for(c=p[t],e=c.start,n=c.count,c=e,n=e+n;c<n;c+=3)for(e=0;3>e;e++)d=h.getX(c+e),f=h.getX(c+(e+1)%3),a[0]=Math.min(d,f),a[1]=Math.max(d,f),d=a[0]+","+a[1],void 0===s[d]&&(s[d]={index1:a[0],index2:a[1]});for(d in s)c=s[d],l.fromBufferAttribute(u,c.index1),r.push(l.x,l.y,l.z),l.fromBufferAttribute(u,c.index2),r.push(l.x,l.y,l.z)}else for(u=t.attributes.position,c=0,n=u.count/3;c<n;c++)for(e=0;3>e;e++)s=3*c+e,l.fromBufferAttribute(u,s),r.push(l.x,l.y,l.z),s=3*c+(e+1)%3,l.fromBufferAttribute(u,s),r.push(l.x,l.y,l.z)}this.addAttribute("position",new pt(r,3))}function pe(t,e,n){ot.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new me(t,e,n)),this.mergeVertices()}function me(t,e,n){yt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var i,r,a=[],s=[],l=[],u=[],c=new o,h=new o,d=new o,f=new o,p=new o,m=e+1;for(i=0;i<=n;i++){var g=i/n;for(r=0;r<=e;r++){var v=r/e;h=t(v,g,h);s.push(h.x,h.y,h.z),0<=v-1e-5?(d=t(v-1e-5,g,d),f.subVectors(h,d)):(d=t(v+1e-5,g,d),f.subVectors(d,h)),0<=g-1e-5?(d=t(v,g-1e-5,d),p.subVectors(h,d)):(d=t(v,g+1e-5,d),p.subVectors(d,h)),c.crossVectors(f,p).normalize(),l.push(c.x,c.y,c.z),u.push(v,g)}}for(i=0;i<n;i++)for(r=0;r<e;r++)t=i*m+r+1,c=(i+1)*m+r+1,h=(i+1)*m+r,a.push(i*m+r,t,h),a.push(t,c,h);this.setIndex(a),this.addAttribute("position",new pt(s,3)),this.addAttribute("normal",new pt(l,3)),this.addAttribute("uv",new pt(u,2))}function ge(t,e,n,i){ot.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i},this.fromBufferGeometry(new ve(t,e,n,i)),this.mergeVertices()}function ve(t,e,i,r){function a(t){u.push(t.x,t.y,t.z)}function s(e,n){e*=3,n.x=t[e+0],n.y=t[e+1],n.z=t[e+2]}function l(t,e,n,i){0>i&&1===t.x&&(c[e]=t.x-1),0===n.x&&0===n.z&&(c[e]=i/2/Math.PI+.5)}yt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:r},i=i||1;var u=[],c=[];!function(t){for(var n=new o,i=new o,r=new o,l=0;l<e.length;l+=3){s(e[l+0],n),s(e[l+1],i),s(e[l+2],r);var u,c,h=n,d=i,f=r,p=Math.pow(2,t),m=[];for(c=0;c<=p;c++){m[c]=[];var g=h.clone().lerp(f,c/p),v=d.clone().lerp(f,c/p),y=p-c;for(u=0;u<=y;u++)m[c][u]=0===u&&c===p?g:g.clone().lerp(v,u/y)}for(c=0;c<p;c++)for(u=0;u<2*(p-c)-1;u++)h=Math.floor(u/2),0==u%2?(a(m[c][h+1]),a(m[c+1][h]),a(m[c][h])):(a(m[c][h+1]),a(m[c+1][h+1]),a(m[c+1][h]))}}(r=r||0),function(t){for(var e=new o,n=0;n<u.length;n+=3)e.x=u[n+0],e.y=u[n+1],e.z=u[n+2],e.normalize().multiplyScalar(t),u[n+0]=e.x,u[n+1]=e.y,u[n+2]=e.z}(i),function(){for(var t=new o,e=0;e<u.length;e+=3)t.x=u[e+0],t.y=u[e+1],t.z=u[e+2],c.push(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5));t=new o,e=new o;for(var i=new o,r=new o,a=new n,s=new n,h=new n,d=0,f=0;d<u.length;d+=9,f+=6){t.set(u[d+0],u[d+1],u[d+2]),e.set(u[d+3],u[d+4],u[d+5]),i.set(u[d+6],u[d+7],u[d+8]),a.set(c[f+0],c[f+1]),s.set(c[f+2],c[f+3]),h.set(c[f+4],c[f+5]),r.copy(t).add(e).add(i).divideScalar(3);var p=Math.atan2(r.z,-r.x);l(a,f+0,t,p),l(s,f+2,e,p),l(h,f+4,i,p)}for(t=0;t<c.length;t+=6)e=c[t+0],i=c[t+2],r=c[t+4],a=Math.min(e,i,r),.9<Math.max(e,i,r)&&.1>a&&(.2>e&&(c[t+0]+=1),.2>i&&(c[t+2]+=1),.2>r&&(c[t+4]+=1))}(),this.addAttribute("position",new pt(u,3)),this.addAttribute("normal",new pt(u.slice(),3)),this.addAttribute("uv",new pt(c,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function ye(t,e){ot.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new we(t,e)),this.mergeVertices()}function we(t,e){ve.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function be(t,e){ot.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new _e(t,e)),this.mergeVertices()}function _e(t,e){ve.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ee(t,e){ot.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Te(t,e)),this.mergeVertices()}function Te(t,e){var n=(1+Math.sqrt(5))/2;ve.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ce(t,e){ot.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new xe(t,e)),this.mergeVertices()}function xe(t,e){var n=(1+Math.sqrt(5))/2,i=1/n;ve.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Se(t,e,n,i,r,o){ot.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new Me(t,e,n,i,r),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Me(t,e,i,r,a){function s(n){p=t.getPointAt(n/e,p);var o=l.normals[n];for(n=l.binormals[n],c=0;c<=r;c++){var a=c/r*Math.PI*2,s=Math.sin(a);a=-Math.cos(a);d.x=a*o.x+s*n.x,d.y=a*o.y+s*n.y,d.z=a*o.z+s*n.z,d.normalize(),g.push(d.x,d.y,d.z),h.x=p.x+i*d.x,h.y=p.y+i*d.y,h.z=p.z+i*d.z,m.push(h.x,h.y,h.z)}}yt.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:r,closed:a},e=e||64,i=i||1,r=r||8,a=a||!1;var l=t.computeFrenetFrames(e,a);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;var u,c,h=new o,d=new o,f=new n,p=new o,m=[],g=[],v=[],y=[];for(u=0;u<e;u++)s(u);for(s(!1===a?e:0),u=0;u<=e;u++)for(c=0;c<=r;c++)f.x=u/e,f.y=c/r,v.push(f.x,f.y);!function(){for(c=1;c<=e;c++)for(u=1;u<=r;u++){var t=(r+1)*c+(u-1),n=(r+1)*c+u,i=(r+1)*(c-1)+u;y.push((r+1)*(c-1)+(u-1),t,i),y.push(t,n,i)}}(),this.setIndex(y),this.addAttribute("position",new pt(m,3)),this.addAttribute("normal",new pt(g,3)),this.addAttribute("uv",new pt(v,2))}function Oe(t,e,n,i,r,o,a){ot.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Re(t,e,n,i,r,o)),this.mergeVertices()}function Re(t,e,n,i,r,a){function s(t,e,n,i,r){var o=Math.sin(t);e=n/e*t,n=Math.cos(e),r.x=i*(2+n)*.5*Math.cos(t),r.y=i*(2+n)*o*.5,r.z=i*Math.sin(e)*.5}yt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:a},t=t||1,e=e||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,a=a||3;var l,u=[],c=[],h=[],d=[],f=new o,p=new o,m=new o,g=new o,v=new o,y=new o,w=new o;for(l=0;l<=n;++l){var b=l/n*r*Math.PI*2;for(s(b,r,a,t,m),s(b+.01,r,a,t,g),y.subVectors(g,m),w.addVectors(g,m),v.crossVectors(y,w),w.crossVectors(v,y),v.normalize(),w.normalize(),b=0;b<=i;++b){var _=b/i*Math.PI*2,E=-e*Math.cos(_);_=e*Math.sin(_);f.x=m.x+(E*w.x+_*v.x),f.y=m.y+(E*w.y+_*v.y),f.z=m.z+(E*w.z+_*v.z),c.push(f.x,f.y,f.z),p.subVectors(f,m).normalize(),h.push(p.x,p.y,p.z),d.push(l/n),d.push(b/i)}}for(b=1;b<=n;b++)for(l=1;l<=i;l++)t=(i+1)*b+(l-1),e=(i+1)*b+l,r=(i+1)*(b-1)+l,u.push((i+1)*(b-1)+(l-1),t,r),u.push(t,e,r);this.setIndex(u),this.addAttribute("position",new pt(c,3)),this.addAttribute("normal",new pt(h,3)),this.addAttribute("uv",new pt(d,2))}function Ae(t,e,n,i,r){ot.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new Pe(t,e,n,i,r)),this.mergeVertices()}function Pe(t,e,n,i,r){yt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},t=t||1,e=e||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var a,s,l=[],u=[],c=[],h=[],d=new o,f=new o,p=new o;for(a=0;a<=n;a++)for(s=0;s<=i;s++){var m=s/i*r,g=a/n*Math.PI*2;f.x=(t+e*Math.cos(g))*Math.cos(m),f.y=(t+e*Math.cos(g))*Math.sin(m),f.z=e*Math.sin(g),u.push(f.x,f.y,f.z),d.x=t*Math.cos(m),d.y=t*Math.sin(m),p.subVectors(f,d).normalize(),c.push(p.x,p.y,p.z),h.push(s/i),h.push(a/n)}for(a=1;a<=n;a++)for(s=1;s<=i;s++)t=(i+1)*(a-1)+s-1,e=(i+1)*(a-1)+s,r=(i+1)*a+s,l.push((i+1)*a+s-1,t,r),l.push(t,e,r);this.setIndex(l),this.addAttribute("position",new pt(u,3)),this.addAttribute("normal",new pt(c,3)),this.addAttribute("uv",new pt(h,2))}function Ne(t,e,n,i,r){for(var o,a=0,s=e,l=n-i;s<n;s+=i)a+=(t[l]-t[s])*(t[s+1]+t[l+1]),l=s;if(r===0<a)for(r=e;r<n;r+=i)o=Ge(r,t[r],t[r+1],o);else for(r=n-i;r>=e;r-=i)o=Ge(r,t[r],t[r+1],o);return o&&je(o,o.next)&&(Ye(o),o=o.next),o}function ke(t,e){if(!t)return t;e||(e=t);do{var n=!1;if(t.steiner||!je(t,t.next)&&0!==Be(t.prev,t,t.next))t=t.next;else{if(Ye(t),(t=e=t.prev)===t.next)break;n=!0}}while(n||t!==e);return e}function Le(t,e,n,i,r,o,a){if(t){if(!a&&o){var s=d=t;do{null===s.z&&(s.z=He(s.x,s.y,i,r,o)),s.prevZ=s.prev,s=s.nextZ=s.next}while(s!==d);s.prevZ.nextZ=null,s.prevZ=null;var l,u,c,h,d=s,f=1;do{s=d;var p=d=null;for(u=0;s;){u++;var m=s;for(l=c=0;l<f&&(c++,m=m.nextZ);l++);for(h=f;0<c||0<h&&m;)0!==c&&(0===h||!m||s.z<=m.z)?(l=s,s=s.nextZ,c--):(l=m,m=m.nextZ,h--),p?p.nextZ=l:d=l,l.prevZ=p,p=l;s=m}p.nextZ=null,f*=2}while(1<u)}for(d=t;t.prev!==t.next;){if(s=t.prev,m=t.next,o)t:{h=i;var g=r,v=o;if(u=(p=t).prev,c=p,f=p.next,0<=Be(u,c,f))p=!1;else{var y=u.x>c.x?u.x>f.x?u.x:f.x:c.x>f.x?c.x:f.x,w=u.y>c.y?u.y>f.y?u.y:f.y:c.y>f.y?c.y:f.y;for(l=He(u.x<c.x?u.x<f.x?u.x:f.x:c.x<f.x?c.x:f.x,u.y<c.y?u.y<f.y?u.y:f.y:c.y<f.y?c.y:f.y,h,g,v),h=He(y,w,h,g,v),g=p.nextZ;g&&g.z<=h;){if(g!==p.prev&&g!==p.next&&Fe(u.x,u.y,c.x,c.y,f.x,f.y,g.x,g.y)&&0<=Be(g.prev,g,g.next)){p=!1;break t}g=g.nextZ}for(g=p.prevZ;g&&g.z>=l;){if(g!==p.prev&&g!==p.next&&Fe(u.x,u.y,c.x,c.y,f.x,f.y,g.x,g.y)&&0<=Be(g.prev,g,g.next)){p=!1;break t}g=g.prevZ}p=!0}}else t:if(p=t,u=p.prev,c=p,f=p.next,0<=Be(u,c,f))p=!1;else{for(l=p.next.next;l!==p.prev;){if(Fe(u.x,u.y,c.x,c.y,f.x,f.y,l.x,l.y)&&0<=Be(l.prev,l,l.next)){p=!1;break t}l=l.next}p=!0}if(p)e.push(s.i/n),e.push(t.i/n),e.push(m.i/n),Ye(t),d=t=m.next;else if((t=m)===d){if(a){if(1===a){a=e,d=n,s=t;do{m=s.prev,p=s.next.next,!je(m,p)&&ze(m,s,s.next,p)&&Ve(m,p)&&Ve(p,m)&&(a.push(m.i/d),a.push(s.i/d),a.push(p.i/d),Ye(s),Ye(s.next),s=t=p),s=s.next}while(s!==t);Le(t=s,e,n,i,r,o,2)}else if(2===a)t:{a=t;do{for(d=a.next.next;d!==a.prev;){if(s=a.i!==d.i){if(s=a,m=d,p=s.next.i!==m.i&&s.prev.i!==m.i){e:{p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==m.i&&p.next.i!==m.i&&ze(p,p.next,s,m)){p=!0;break e}p=p.next}while(p!==s);p=!1}p=!p}if(p=p&&Ve(s,m)&&Ve(m,s)){p=s,u=!1,c=(s.x+m.x)/2,m=(s.y+m.y)/2;do{p.y>m!=p.next.y>m&&p.next.y!==p.y&&c<(p.next.x-p.x)*(m-p.y)/(p.next.y-p.y)+p.x&&(u=!u),p=p.next}while(p!==s);p=u}s=p}if(s){t=We(a,d),a=ke(a,a.next),t=ke(t,t.next),Le(a,e,n,i,r,o),Le(t,e,n,i,r,o);break t}d=d.next}a=a.next}while(a!==t)}}else Le(ke(t),e,n,i,r,o,1);break}}}}function De(t,e){return t.x-e.x}function Ie(t,e){var n=e,i=t.x,r=t.y,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){if((l=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y))<=i&&l>o){if(o=l,l===i){if(r===n.y)return n;if(r===n.next.y)return n.next}var a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!a)return null;if(i===o)return a.prev;e=a;var s,l=a.x,u=a.y,c=1/0;for(n=a.next;n!==e;)i>=n.x&&n.x>=l&&i!==n.x&&Fe(r<u?i:o,r,l,u,r<u?o:i,r,n.x,n.y)&&((s=Math.abs(r-n.y)/(i-n.x))<c||s===c&&n.x>a.x)&&Ve(n,t)&&(a=n,c=s),n=n.next;return a}function He(t,e,n,i,r){return t=32767*(t-n)*r,e=32767*(e-i)*r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),1431655765&(t|t<<1)|(1431655765&(e|e<<1))<<1}function Ue(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function Fe(t,e,n,i,r,o,a,s){return 0<=(r-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(i-s)-(n-a)*(e-s)&&0<=(n-a)*(o-s)-(r-a)*(i-s)}function Be(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function je(t,e){return t.x===e.x&&t.y===e.y}function ze(t,e,n,i){return!!(je(t,e)&&je(n,i)||je(t,i)&&je(n,e))||0<Be(t,e,n)!=0<Be(t,e,i)&&0<Be(n,i,t)!=0<Be(n,i,e)}function Ve(t,e){return 0>Be(t.prev,t,t.next)?0<=Be(t,e,t.next)&&0<=Be(t,t.prev,e):0>Be(t,e,t.prev)||0>Be(t,t.next,e)}function We(t,e){var n=new Xe(t.i,t.x,t.y),i=new Xe(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Ge(t,e,n,i){return t=new Xe(t,e,n),i?(t.next=i.next,t.prev=i,i.next.prev=t,i.next=t):(t.prev=t,t.next=t),t}function Ye(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Xe(t,e,n){this.i=t,this.x=e,this.y=n,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function qe(t,e){ot.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Je(t,e)),this.mergeVertices()}function Je(t,e){void 0!==t&&(yt.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function Ke(t,e){ot.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Ze(t,e)),this.mergeVertices()}function Ze(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ot;t=n.generateShapes(t,e.size,e.curveSegments),e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Je.call(this,t,e),this.type="TextBufferGeometry"}function $e(t,e,n,i,r,o,a){ot.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Qe(t,e,n,i,r,o,a)),this.mergeVertices()}function Qe(t,e,n,i,r,a,s){yt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:s},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var l,u,c=(a=void 0!==a?a:0)+(s=void 0!==s?s:Math.PI),h=0,d=[],f=new o,p=new o,m=[],g=[],v=[],y=[];for(u=0;u<=n;u++){var w=[],b=u/n;for(l=0;l<=e;l++){var _=l/e;f.x=-t*Math.cos(i+_*r)*Math.sin(a+b*s),f.y=t*Math.cos(a+b*s),f.z=t*Math.sin(i+_*r)*Math.sin(a+b*s),g.push(f.x,f.y,f.z),p.set(f.x,f.y,f.z).normalize(),v.push(p.x,p.y,p.z),y.push(_,1-b),w.push(h++)}d.push(w)}for(u=0;u<n;u++)for(l=0;l<e;l++)t=d[u][l+1],i=d[u][l],r=d[u+1][l],s=d[u+1][l+1],(0!==u||0<a)&&m.push(t,i,s),(u!==n-1||c<Math.PI)&&m.push(i,r,s);this.setIndex(m),this.addAttribute("position",new pt(g,3)),this.addAttribute("normal",new pt(v,3)),this.addAttribute("uv",new pt(y,2))}function tn(t,e,n,i,r,o){ot.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new en(t,e,n,i,r,o)),this.mergeVertices()}function en(t,e,i,r,a,s){yt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:r,thetaStart:a,thetaLength:s},t=t||.5,e=e||1,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var l,u,c=[],h=[],d=[],f=[],p=t,m=(e-t)/(r=void 0!==r?Math.max(1,r):1),g=new o,v=new n;for(l=0;l<=r;l++){for(u=0;u<=i;u++)t=a+u/i*s,g.x=p*Math.cos(t),g.y=p*Math.sin(t),h.push(g.x,g.y,g.z),d.push(0,0,1),v.x=(g.x/e+1)/2,v.y=(g.y/e+1)/2,f.push(v.x,v.y);p+=m}for(l=0;l<r;l++)for(e=l*(i+1),u=0;u<i;u++)t=u+e,a=t+i+1,s=t+i+2,p=t+1,c.push(t,a,p),c.push(a,s,p);this.setIndex(c),this.addAttribute("position",new pt(h,3)),this.addAttribute("normal",new pt(d,3)),this.addAttribute("uv",new pt(f,2))}function nn(t,e,n,i){ot.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},this.fromBufferGeometry(new rn(t,e,n,i)),this.mergeVertices()}function rn(t,e,i,r){yt.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:r},e=Math.floor(e)||12,i=i||0,r=r||2*Math.PI,r=wr.clamp(r,0,2*Math.PI);var a,s=[],l=[],u=[],c=1/e,h=new o,d=new n;for(a=0;a<=e;a++){var f=i+a*c*r,p=Math.sin(f),m=Math.cos(f);for(f=0;f<=t.length-1;f++)h.x=t[f].x*p,h.y=t[f].y,h.z=t[f].x*m,l.push(h.x,h.y,h.z),d.x=a/e,d.y=f/(t.length-1),u.push(d.x,d.y)}for(a=0;a<e;a++)for(f=0;f<t.length-1;f++)i=f+a*t.length,c=i+t.length,h=i+t.length+1,d=i+1,s.push(i,c,d),s.push(c,h,d);if(this.setIndex(s),this.addAttribute("position",new pt(l,3)),this.addAttribute("uv",new pt(u,2)),this.computeVertexNormals(),r===2*Math.PI)for(r=this.attributes.normal.array,s=new o,l=new o,u=new o,i=e*t.length*3,f=a=0;a<t.length;a++,f+=3)s.x=r[f+0],s.y=r[f+1],s.z=r[f+2],l.x=r[i+f+0],l.y=r[i+f+1],l.z=r[i+f+2],u.addVectors(s,l).normalize(),r[f+0]=r[i+f+0]=u.x,r[f+1]=r[i+f+1]=u.y,r[f+2]=r[i+f+2]=u.z}function on(t,e){ot.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new an(t,e)),this.mergeVertices()}function an(t,e){function n(t){var n,s=r.length/3,u=(t=t.extractPoints(e)).shape,c=t.holes;if(!1===Fr.isClockWise(u))for(u=u.reverse(),t=0,n=c.length;t<n;t++){var h=c[t];!0===Fr.isClockWise(h)&&(c[t]=h.reverse())}var d=Fr.triangulateShape(u,c);for(t=0,n=c.length;t<n;t++)h=c[t],u=u.concat(h);for(t=0,n=u.length;t<n;t++)h=u[t],r.push(h.x,h.y,0),o.push(0,0,1),a.push(h.x,h.y);for(t=0,n=d.length;t<n;t++)u=d[t],i.push(u[0]+s,u[1]+s,u[2]+s),l+=3}yt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var i=[],r=[],o=[],a=[],s=0,l=0;if(!1===Array.isArray(t))n(t);else for(var u=0;u<t.length;u++)n(t[u]),this.addGroup(s,l,u),s+=l,l=0;this.setIndex(i),this.addAttribute("position",new pt(r,3)),this.addAttribute("normal",new pt(o,3)),this.addAttribute("uv",new pt(a,2))}function sn(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,i=t.length;n<i;n++)e.shapes.push(t[n].uuid);else e.shapes.push(t.uuid);return e}function ln(t,e){yt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e};var n=[];e=Math.cos(wr.DEG2RAD*(void 0!==e?e:1));var i=[0,0],r={},o=["a","b","c"];if(t.isBufferGeometry){var a=new ot;a.fromBufferGeometry(t)}else a=t.clone();a.mergeVertices(),a.computeFaceNormals(),t=a.vertices;for(var s=0,l=(a=a.faces).length;s<l;s++)for(var u=a[s],c=0;3>c;c++){var h=u[o[c]],d=u[o[(c+1)%3]];i[0]=Math.min(h,d),i[1]=Math.max(h,d),void 0===r[h=i[0]+","+i[1]]?r[h]={index1:i[0],index2:i[1],face1:s,face2:void 0}:r[h].face2=s}for(h in r)(void 0===(i=r[h]).face2||a[i.face1].normal.dot(a[i.face2].normal)<=e)&&(o=t[i.index1],n.push(o.x,o.y,o.z),o=t[i.index2],n.push(o.x,o.y,o.z));this.addAttribute("position",new pt(n,3))}function un(t,e,n,i,r,o,a,s){ot.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new cn(t,e,n,i,r,o,a,s)),this.mergeVertices()}function cn(t,e,i,r,a,s,l,u){function c(i){var a,s=new n,c=new o,v=0,b=!0===i?t:e,_=!0===i?1:-1,E=g;for(a=1;a<=r;a++)f.push(0,y*_,0),p.push(0,_,0),m.push(.5,.5),g++;var T=g;for(a=0;a<=r;a++){var C=a/r*u+l,x=Math.cos(C);C=Math.sin(C);c.x=b*C,c.y=y*_,c.z=b*x,f.push(c.x,c.y,c.z),p.push(0,_,0),s.x=.5*x+.5,s.y=.5*C*_+.5,m.push(s.x,s.y),g++}for(a=0;a<r;a++)s=E+a,c=T+a,!0===i?d.push(c,c+1,s):d.push(c+1,c,s),v+=3;h.addGroup(w,v,!0===i?1:2),w+=v}yt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:a,openEnded:s,thetaStart:l,thetaLength:u};var h=this;t=void 0!==t?t:1,e=void 0!==e?e:1,i=i||1,r=Math.floor(r)||8,a=Math.floor(a)||1,s=void 0!==s&&s,l=void 0!==l?l:0,u=void 0!==u?u:2*Math.PI;var d=[],f=[],p=[],m=[],g=0,v=[],y=i/2,w=0;!function(){var n,s,c=new o,b=new o,_=0,E=(e-t)/i;for(s=0;s<=a;s++){var T=[],C=s/a,x=C*(e-t)+t;for(n=0;n<=r;n++){var S=n/r,M=S*u+l,O=Math.sin(M);M=Math.cos(M);b.x=x*O,b.y=-C*i+y,b.z=x*M,f.push(b.x,b.y,b.z),c.set(O,E,M).normalize(),p.push(c.x,c.y,c.z),m.push(S,1-C),T.push(g++)}v.push(T)}for(n=0;n<r;n++)for(s=0;s<a;s++)c=v[s+1][n],b=v[s+1][n+1],E=v[s][n+1],d.push(v[s][n],c,E),d.push(c,b,E),_+=6;h.addGroup(w,_,0),w+=_}(),!1===s&&(0<t&&c(!0),0<e&&c(!1)),this.setIndex(d),this.addAttribute("position",new pt(f,3)),this.addAttribute("normal",new pt(p,3)),this.addAttribute("uv",new pt(m,2))}function hn(t,e,n,i,r,o,a){un.call(this,0,t,e,n,i,r,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function dn(t,e,n,i,r,o,a){cn.call(this,0,t,e,n,i,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function fn(t,e,n,i){ot.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new pn(t,e,n,i)),this.mergeVertices()}function pn(t,e,i,r){yt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var a,s=[],l=[],u=[],c=[],h=new o,d=new n;l.push(0,0,0),u.push(0,0,1),c.push(.5,.5);var f=0;for(a=3;f<=e;f++,a+=3){var p=i+f/e*r;h.x=t*Math.cos(p),h.y=t*Math.sin(p),l.push(h.x,h.y,h.z),u.push(0,0,1),d.x=(l[a]/t+1)/2,d.y=(l[a+1]/t+1)/2,c.push(d.x,d.y)}for(a=1;a<=e;a++)s.push(a,a+1,0);this.setIndex(s),this.addAttribute("position",new pt(l,3)),this.addAttribute("normal",new pt(u,3)),this.addAttribute("uv",new pt(c,2))}function mn(t){G.call(this),this.type="ShadowMaterial",this.color=new z(0),this.opacity=1,this.transparent=this.lights=!0,this.setValues(t)}function gn(t){Ct.call(this,t),this.type="RawShaderMaterial"}function vn(t){G.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new z(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new z(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function yn(t){vn.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(t)}function wn(t){G.call(this),this.type="MeshPhongMaterial",this.color=new z(16777215),this.specular=new z(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new z(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function bn(t){wn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function _n(t){G.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(t)}function En(t){G.call(this),this.type="MeshLambertMaterial",this.color=new z(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new z(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Tn(t){ie.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function Cn(t,e,n){var i=this,r=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===r&&void 0!==i.onStart&&i.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(r=!1,void 0!==i.onLoad)&&i.onLoad()},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}function xn(t){this.manager=void 0!==t?t:Vr}function Sn(t){this.manager=void 0!==t?t:Vr,this._parser=null}function Mn(t){this.manager=void 0!==t?t:Vr,this._parser=null}function On(t){this.manager=void 0!==t?t:Vr}function Rn(t){this.manager=void 0!==t?t:Vr}function An(t){this.manager=void 0!==t?t:Vr}function Pn(){this.type="Curve",this.arcLengthDivisions=200}function Nn(t,e,n,i,r,o,a,s){Pn.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function kn(t,e,n,i,r,o){Nn.call(this,t,e,n,n,i,r,o),this.type="ArcCurve"}function Ln(){var t=0,e=0,n=0,i=0;return{initCatmullRom:function(r,o,a,s,l){t=o,e=r=l*(a-r),n=-3*o+3*a-2*r-(s=l*(s-o)),i=2*o-2*a+r+s},initNonuniformCatmullRom:function(r,o,a,s,l,u,c){t=o,e=r=((o-r)/l-(a-r)/(l+u)+(a-o)/u)*u,n=-3*o+3*a-2*r-(s=((a-o)/u-(s-o)/(u+c)+(s-a)/c)*u),i=2*o-2*a+r+s},calc:function(r){var o=r*r;return t+e*r+n*o+i*o*r}}}function Dn(t,e,n,i){Pn.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=i||.5}function In(t,e,n,i,r){var o=t*t;return(2*n-2*i+(e=.5*(i-e))+(r=.5*(r-n)))*t*o+(-3*n+3*i-2*e-r)*o+e*t+n}function Hn(t,e,n,i){var r=1-t;return r*r*e+2*(1-t)*t*n+t*t*i}function Un(t,e,n,i,r){var o=1-t,a=1-t;return o*o*o*e+3*a*a*t*n+3*(1-t)*t*t*i+t*t*t*r}function Fn(t,e,i,r){Pn.call(this),this.type="CubicBezierCurve",this.v0=t||new n,this.v1=e||new n,this.v2=i||new n,this.v3=r||new n}function Bn(t,e,n,i){Pn.call(this),this.type="CubicBezierCurve3",this.v0=t||new o,this.v1=e||new o,this.v2=n||new o,this.v3=i||new o}function jn(t,e){Pn.call(this),this.type="LineCurve",this.v1=t||new n,this.v2=e||new n}function zn(t,e){Pn.call(this),this.type="LineCurve3",this.v1=t||new o,this.v2=e||new o}function Vn(t,e,i){Pn.call(this),this.type="QuadraticBezierCurve",this.v0=t||new n,this.v1=e||new n,this.v2=i||new n}function Wn(t,e,n){Pn.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new o,this.v1=e||new o,this.v2=n||new o}function Gn(t){Pn.call(this),this.type="SplineCurve",this.points=t||[]}function Yn(){Pn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Xn(t){Yn.call(this),this.type="Path",this.currentPoint=new n,t&&this.setFromPoints(t)}function qn(t){Xn.call(this,t),this.uuid=wr.generateUUID(),this.type="Shape",this.holes=[]}function Jn(t,e){et.call(this),this.type="Light",this.color=new z(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Kn(t,e,n){Jn.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(et.DefaultUp),this.updateMatrix(),this.groundColor=new z(e)}function Zn(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new n(512,512),this.map=null,this.matrix=new i}function $n(){Zn.call(this,new zt(50,1,.5,500))}function Qn(t,e,n,i,r,o){Jn.call(this,t,e),this.type="SpotLight",this.position.copy(et.DefaultUp),this.updateMatrix(),this.target=new et,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new $n}function ti(t,e,n,i){Jn.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new Zn(new zt(90,1,.5,500))}function ei(){Zn.call(this,new it(-5,5,5,-5,.5,500))}function ni(t,e){Jn.call(this,t,e),this.type="DirectionalLight",this.position.copy(et.DefaultUp),this.updateMatrix(),this.target=new et,this.shadow=new ei}function ii(t,e){Jn.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function ri(t,e,n,i){Jn.call(this,t,e),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}function oi(t,e,n,i){mi.call(this,t,e,n,i)}function ai(t,e,n){mi.call(this,t,e,n)}function si(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function li(t,e,n,i){si.call(this,t,e,n,i)}function ui(t,e,n,i){mi.call(this,t,e,n,i)}function ci(t,e,n,i){mi.call(this,t,e,n,i)}function hi(t,e,n,i){mi.call(this,t,e,n,i)}function di(t,e,n,i){si.call(this,t,e,n,i),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function fi(t,e,n,i){si.call(this,t,e,n,i)}function pi(t,e,n,i){si.call(this,t,e,n,i)}function mi(t,e,n,i){if(void 0===t)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Kr.convertArray(e,this.TimeBufferType),this.values=Kr.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation),this.validate(),this.optimize()}function gi(t,e,n,i){mi.call(this,t,e,n,i)}function vi(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=wr.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function yi(t){this.manager=void 0!==t?t:Vr,this.textures={}}function wi(t){this.manager=void 0!==t?t:Vr}function bi(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function _i(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Vr,this.withCredentials=!1}function Ei(t){this.manager=void 0!==t?t:Vr,this.texturePath=""}function Ti(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:Vr,this.options=void 0}function Ci(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function xi(t){this.type="Font",this.data=t}function Si(t){this.manager=void 0!==t?t:Vr}function Mi(t){this.manager=void 0!==t?t:Vr}function Oi(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new zt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new zt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Ri(t,e,n){et.call(this),this.type="CubeCamera";var i=new zt(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new o(1,0,0)),this.add(i);var r=new zt(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new o(-1,0,0)),this.add(r);var a=new zt(90,1,t,e);a.up.set(0,0,1),a.lookAt(new o(0,1,0)),this.add(a);var s=new zt(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new o(0,-1,0)),this.add(s);var l=new zt(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new o(0,0,1)),this.add(l);var u=new zt(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new o(0,0,-1)),this.add(u),this.renderTarget=new c(n,n,{format:1022,magFilter:1006,minFilter:1006}),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,o=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,i,n),n.activeCubeFace=1,t.render(e,r,n),n.activeCubeFace=2,t.render(e,a,n),n.activeCubeFace=3,t.render(e,s,n),n.activeCubeFace=4,t.render(e,l,n),n.texture.generateMipmaps=o,n.activeCubeFace=5,t.render(e,u,n),t.setRenderTarget(null)},this.clear=function(t,e,n,i){for(var r=this.renderTarget,o=0;6>o;o++)r.activeCubeFace=o,t.setRenderTarget(r),t.clear(e,n,i);t.setRenderTarget(null)}}function Ai(){et.call(this),this.type="AudioListener",this.context=io.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Pi(t){et.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.offset=this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ni(t){Pi.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function ki(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Li(t,e,n){switch(this.binding=t,this.valueSize=n,t=Float64Array,e){case"quaternion":e=this._slerp;break;case"string":case"bool":t=Array,e=this._select;break;default:e=this._lerp}this.buffer=new t(4*n),this._mixBufferRegion=e,this.referenceCount=this.useCount=this.cumulativeWeight=0}function Di(t,e,n){n=n||Ii.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function Ii(t,e,n){this.path=e,this.parsedPath=n||Ii.parseTrackName(e),this.node=Ii.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Hi(){this.uuid=wr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function Ui(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null,e=(t=e.tracks).length,n=Array(e);for(var i={endingStart:2400,endingEnd:2400},r=0;r!==e;++r){var o=t[r].createInterpolant(null);n[r]=o,o.settings=i}this._interpolantSettings=i,this._interpolants=n,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Fi(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Bi(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t}function ji(){yt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function zi(t,e,n,i){this.uuid=wr.generateUUID(),this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}function Vi(t,e){this.uuid=wr.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Wi(t,e,n){Vi.call(this,t,e),this.meshPerAttribute=n||1}function Gi(t,e,n){at.call(this,t,e),this.meshPerAttribute=n||1}function Yi(t,e,n,i){this.ray=new xt(t,e),this.near=n||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Xi(t,e){return t.distance-e.distance}function qi(t,e,n,i){if(!1!==t.visible&&(t.raycast(e,n),!0===i)){i=0;for(var r=(t=t.children).length;i<r;i++)qi(t[i],e,n,!0)}}function Ji(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Ki(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Zi(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function $i(t){et.call(this),this.material=t,this.render=function(){}}function Qi(t,e,n,i){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16711680,i=void 0!==i?i:1,e=0,(n=this.object.geometry)&&n.isGeometry?e=3*n.faces.length:n&&n.isBufferGeometry&&(e=n.attributes.normal.count),n=new yt,e=new pt(6*e,3),n.addAttribute("position",e),oe.call(this,n,new ie({color:t,linewidth:i})),this.matrixAutoUpdate=!1,this.update()}function tr(t,e){et.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,t=new yt,e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var n=0,i=1;32>n;n++,i++){var r=n/32*Math.PI*2,o=i/32*Math.PI*2;e.push(Math.cos(r),Math.sin(r),1,Math.cos(o),Math.sin(o),1)}t.addAttribute("position",new pt(e,3)),e=new ie({fog:!1}),this.cone=new oe(t,e),this.add(this.cone),this.update()}function er(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,er(t.children[n]));return e}function nr(t){for(var e=er(t),n=new yt,i=[],r=[],o=new z(0,0,1),a=new z(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}n.addAttribute("position",new pt(i,3)),n.addAttribute("color",new pt(r,3)),i=new ie({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),oe.call(this,n,i),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function ir(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n,t=new Qe(e,4,2),e=new Tt({wireframe:!0,fog:!1}),Ot.call(this,t,e),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function rr(t,e){et.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,t=new ie({fog:!1}),(e=new yt).addAttribute("position",new at(new Float32Array(15),3)),this.line=new re(e,t),this.add(this.line),this.update()}function or(t,e,n){et.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,(t=new _e(e)).rotateY(.5*Math.PI),this.material=new Tt({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2),e=t.getAttribute("position"),e=new Float32Array(3*e.count),t.addAttribute("color",new at(e,3)),this.add(new Ot(t,this.material)),this.update()}function ar(t,e,n,i){t=t||10,e=e||10,n=new z(void 0!==n?n:4473924),i=new z(void 0!==i?i:8947848);var r=e/2,o=t/e,a=t/2;t=[];for(var s=[],l=0,u=0,c=-a;l<=e;l++,c+=o){t.push(-a,0,c,a,0,c),t.push(c,0,-a,c,0,a);var h=l===r?n:i;h.toArray(s,u),u+=3,h.toArray(s,u),u+=3,h.toArray(s,u),u+=3,h.toArray(s,u),u+=3}(e=new yt).addAttribute("position",new pt(t,3)),e.addAttribute("color",new pt(s,3)),n=new ie({vertexColors:2}),oe.call(this,e,n)}function sr(t,e,n,i,r,o){t=t||10,e=e||16,n=n||8,i=i||64,r=new z(void 0!==r?r:4473924),o=new z(void 0!==o?o:8947848);var a,s=[],l=[];for(a=0;a<=e;a++){var u=a/e*2*Math.PI,c=Math.sin(u)*t;u=Math.cos(u)*t,s.push(0,0,0),s.push(c,0,u);var h=1&a?r:o;l.push(h.r,h.g,h.b),l.push(h.r,h.g,h.b)}for(a=0;a<=n;a++){h=1&a?r:o;var d=t-t/n*a;for(e=0;e<i;e++)u=e/i*2*Math.PI,c=Math.sin(u)*d,u=Math.cos(u)*d,s.push(c,0,u),l.push(h.r,h.g,h.b),u=(e+1)/i*2*Math.PI,c=Math.sin(u)*d,u=Math.cos(u)*d,s.push(c,0,u),l.push(h.r,h.g,h.b)}(t=new yt).addAttribute("position",new pt(s,3)),t.addAttribute("color",new pt(l,3)),s=new ie({vertexColors:2}),oe.call(this,t,s)}function lr(t,e,n,i){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16776960,i=void 0!==i?i:1,e=0,(n=this.object.geometry)&&n.isGeometry?e=n.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),n=new yt,e=new pt(6*e,3),n.addAttribute("position",e),oe.call(this,n,new ie({color:t,linewidth:i})),this.matrixAutoUpdate=!1,this.update()}function ur(t,e,n){et.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1),(t=new yt).addAttribute("position",new pt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3)),e=new ie({fog:!1}),this.lightPlane=new re(t,e),this.add(this.lightPlane),(t=new yt).addAttribute("position",new pt([0,0,0,0,0,1],3)),this.targetLine=new re(t,e),this.add(this.targetLine),this.update()}function cr(t){function e(t,e,i){n(t,i),n(e,i)}function n(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var i=new yt,r=new ie({color:16777215,vertexColors:1}),o=[],a=[],s={},l=new z(16755200),u=new z(16711680),c=new z(43775),h=new z(16777215),d=new z(3355443);e("n1","n2",l),e("n2","n4",l),e("n4","n3",l),e("n3","n1",l),e("f1","f2",l),e("f2","f4",l),e("f4","f3",l),e("f3","f1",l),e("n1","f1",l),e("n2","f2",l),e("n3","f3",l),e("n4","f4",l),e("p","n1",u),e("p","n2",u),e("p","n3",u),e("p","n4",u),e("u1","u2",c),e("u2","u3",c),e("u3","u1",c),e("c","t",h),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),i.addAttribute("position",new pt(o,3)),i.addAttribute("color",new pt(a,3)),oe.call(this,i,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function hr(t,e){this.object=t,void 0===e&&(e=16776960),t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var n=new Float32Array(24),i=new yt;i.setIndex(new at(t,1)),i.addAttribute("position",new at(n,3)),oe.call(this,i,new ie({color:e})),this.matrixAutoUpdate=!1,this.update()}function dr(t,e){this.type="Box3Helper",this.box=t,t=void 0!==e?e:16776960,e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var n=new yt;n.setIndex(new at(e,1)),n.addAttribute("position",new pt([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),oe.call(this,n,new ie({color:t})),this.geometry.computeBoundingSphere()}function fr(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e,t=void 0!==n?n:16776960,(e=new yt).addAttribute("position",new pt([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),e.computeBoundingSphere(),re.call(this,e,new ie({color:t})),(e=new yt).addAttribute("position",new pt([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),e.computeBoundingSphere(),this.add(new Ot(e,new Tt({color:t,opacity:.2,transparent:!0,depthWrite:!1})))}function pr(t,e,n,i,r,o){et.call(this),void 0===i&&(i=16776960),void 0===n&&(n=1),void 0===r&&(r=.2*n),void 0===o&&(o=.2*r),void 0===ro&&((ro=new yt).addAttribute("position",new pt([0,0,0,0,1,0],3)),(oo=new cn(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new re(ro,new ie({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ot(oo,new Tt({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,r,o)}function mr(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t];(t=new yt).addAttribute("position",new pt(e,3)),t.addAttribute("color",new pt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new ie({vertexColors:2}),oe.call(this,t,e)}function gr(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Dn.call(this,t),this.type="catmullrom",this.closed=!0}function vr(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Dn.call(this,t),this.type="catmullrom"}function yr(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Dn.call(this,t),this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){void 0!==this._listeners&&void 0!==(t=this._listeners[t])&&-1!==(e=t.indexOf(e))&&t.splice(e,1)},dispatchEvent:function(t){if(void 0!==this._listeners){if(void 0!==(e=this._listeners[t.type])){t.target=this;for(var e,n=0,i=(e=e.slice(0)).length;n<i;n++)e[n].call(this,t)}}}});var wr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;256>e;e++)t[e]=(16>e?"0":"")+e.toString(16).toUpperCase();return function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&i|128]+t[i>>8&255]+"-"+t[i>>16&255]+t[i>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*wr.DEG2RAD},radToDeg:function(t){return t*wr.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};Object.defineProperties(n.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(n.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y;return t=t.elements,this.x=t[0]*e+t[3]*n+t[6],this.y=t[1]*e+t[4]*n+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new n,e=new n;return function(n,i){return t.set(n,n),e.set(i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return t=this.y-t.y,e*e+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e);e=Math.sin(e);var i=this.x-t.x,r=this.y-t.y;return this.x=i*n-r*e+t.x,this.y=i*e+r*n+t.y,this}}),Object.assign(i.prototype,{isMatrix4:!0,set:function(t,e,n,i,r,o,a,s,l,u,c,h,d,f,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new i).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new o;return function(e){var n=this.elements,i=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length();return e=1/t.setFromMatrixColumn(e,2).length(),n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[8]=i[8]*e,n[9]=i[9]*e,n[10]=i[10]*e,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),a=(n=Math.sin(n),Math.cos(i)),s=(i=Math.sin(i),Math.cos(r));r=Math.sin(r);if("XYZ"===t.order){var l=o*s,u=o*r,c=n*s;t=n*r,e[0]=a*s,e[4]=-a*r,e[8]=i,e[1]=u+c*i,e[5]=l-t*i,e[9]=-n*a,e[2]=t-l*i,e[6]=c+u*i,e[10]=o*a}else"YXZ"===t.order?(l=a*s,u=a*r,c=i*s,t=i*r,e[0]=l+t*n,e[4]=c*n-u,e[8]=o*i,e[1]=o*r,e[5]=o*s,e[9]=-n,e[2]=u*n-c,e[6]=t+l*n,e[10]=o*a):"ZXY"===t.order?(l=a*s,u=a*r,c=i*s,t=i*r,e[0]=l-t*n,e[4]=-o*r,e[8]=c+u*n,e[1]=u+c*n,e[5]=o*s,e[9]=t-l*n,e[2]=-o*i,e[6]=n,e[10]=o*a):"ZYX"===t.order?(l=o*s,u=o*r,c=n*s,t=n*r,e[0]=a*s,e[4]=c*i-u,e[8]=l*i+t,e[1]=a*r,e[5]=t*i+l,e[9]=u*i-c,e[2]=-i,e[6]=n*a,e[10]=o*a):"YZX"===t.order?(l=o*a,u=o*i,c=n*a,t=n*i,e[0]=a*s,e[4]=t-l*r,e[8]=c*r+u,e[1]=r,e[5]=o*s,e[9]=-n*s,e[2]=-i*s,e[6]=u*r+c,e[10]=l-t*r):"XZY"===t.order&&(l=o*a,u=o*i,c=n*a,t=n*i,e[0]=a*s,e[4]=-r,e[8]=i*s,e[1]=l*r+t,e[5]=o*s,e[9]=u*r-c,e[2]=c*r-u,e[6]=n*s,e[10]=t*r+l);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t._x,i=t._y,r=t._z,o=t._w,a=r+r;t=n*(u=n+n);var s=n*(c=i+i),l=(n=n*a,i*c),u=(i=i*a,r=r*a,o*u),c=o*c;o*=a;return e[0]=1-(l+r),e[4]=s-o,e[8]=n+c,e[1]=s+o,e[5]=1-(t+r),e[9]=i-u,e[2]=n-c,e[6]=i+u,e[10]=1-(t+l),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new o,e=new o,n=new o;return function(i,r,o){var a=this.elements;return n.subVectors(i,r),0===n.lengthSq()&&(n.z=1),n.normalize(),t.crossVectors(o,n),0===t.lengthSq()&&(1===Math.abs(o.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),t.crossVectors(o,n)),t.normalize(),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements;e=this.elements,t=n[0];var r=n[4],o=n[8],a=n[12],s=n[1],l=n[5],u=n[9],c=n[13],h=n[2],d=n[6],f=n[10],p=n[14],m=n[3],g=n[7],v=n[11],y=(n=n[15],i[0]),w=i[4],b=i[8],_=i[12],E=i[1],T=i[5],C=i[9],x=i[13],S=i[2],M=i[6],O=i[10],R=i[14],A=i[3],P=i[7],N=i[11];i=i[15];return e[0]=t*y+r*E+o*S+a*A,e[4]=t*w+r*T+o*M+a*P,e[8]=t*b+r*C+o*O+a*N,e[12]=t*_+r*x+o*R+a*i,e[1]=s*y+l*E+u*S+c*A,e[5]=s*w+l*T+u*M+c*P,e[9]=s*b+l*C+u*O+c*N,e[13]=s*_+l*x+u*R+c*i,e[2]=h*y+d*E+f*S+p*A,e[6]=h*w+d*T+f*M+p*P,e[10]=h*b+d*C+f*O+p*N,e[14]=h*_+d*x+f*R+p*i,e[3]=m*y+g*E+v*S+n*A,e[7]=m*w+g*T+v*M+n*P,e[11]=m*b+g*C+v*O+n*N,e[15]=m*_+g*x+v*R+n*i,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new o;return function(e){for(var n=0,i=e.count;n<i;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+r*s*c-i*l*c-r*a*h+n*l*h+i*a*d-n*s*d)+t[7]*(+e*s*d-e*l*h+r*o*h-i*o*d+i*l*u-r*s*u)+t[11]*(+e*l*c-e*a*d-r*o*c+n*o*d+r*a*u-n*l*u)+t[15]*(-i*a*u-e*s*c+e*a*h+i*o*c-n*o*h+n*s*u)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements;t=(i=t.elements)[0];var i,r=i[1],o=i[2],a=i[3],s=i[4],l=i[5],u=i[6],c=i[7],h=i[8],d=i[9],f=i[10],p=i[11],m=i[12],g=i[13],v=i[14],y=d*v*c-g*f*c+g*u*p-l*v*p-d*u*(i=i[15])+l*f*i,w=m*f*c-h*v*c-m*u*p+s*v*p+h*u*i-s*f*i,b=h*g*c-m*d*c+m*l*p-s*g*p-h*l*i+s*d*i,_=m*d*u-h*g*u-m*l*f+s*g*f+h*l*v-s*d*v,E=t*y+r*w+o*b+a*_;if(0===E){if(!0===e)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return e=1/E,n[0]=y*e,n[1]=(g*f*a-d*v*a-g*o*p+r*v*p+d*o*i-r*f*i)*e,n[2]=(l*v*a-g*u*a+g*o*c-r*v*c-l*o*i+r*u*i)*e,n[3]=(d*u*a-l*f*a-d*o*c+r*f*c+l*o*p-r*u*p)*e,n[4]=w*e,n[5]=(h*v*a-m*f*a+m*o*p-t*v*p-h*o*i+t*f*i)*e,n[6]=(m*u*a-s*v*a-m*o*c+t*v*c+s*o*i-t*u*i)*e,n[7]=(s*f*a-h*u*a+h*o*c-t*f*c-s*o*p+t*u*p)*e,n[8]=b*e,n[9]=(m*d*a-h*g*a-m*r*p+t*g*p+h*r*i-t*d*i)*e,n[10]=(s*g*a-m*l*a+m*r*c-t*g*c-s*r*i+t*l*i)*e,n[11]=(h*l*a-s*d*a-h*r*c+t*d*c+s*r*p-t*l*p)*e,n[12]=_*e,n[13]=(h*g*o-m*d*o+m*r*f-t*g*f-h*r*v+t*d*v)*e,n[14]=(m*l*o-s*g*o-m*r*u+t*g*u+s*r*v-t*l*v)*e,n[15]=(s*d*o-h*l*o+h*r*u-t*d*u-s*r*f+t*l*f)*e,this},scale:function(t){var e=this.elements,n=t.x,i=t.y;return t=t.z,e[0]*=n,e[4]*=i,e[8]*=t,e[1]*=n,e[5]*=i,e[9]*=t,e[2]*=n,e[6]*=i,e[10]*=t,e[3]*=n,e[7]*=i,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e);e=Math.sin(e);var i=1-n,r=t.x,o=t.y;t=t.z;var a=i*r,s=i*o;return this.set(a*r+n,a*o-e*t,a*t+e*o,0,a*o+e*t,s*o+n,s*t-e*r,0,a*t-e*o,s*t+e*r,i*t*t+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t=new o,e=new i;return function(n,i,r){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length();0>this.determinant()&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.copy(this),n=1/a;o=1/s;var u=1/l;return e.elements[0]*=n,e.elements[1]*=n,e.elements[2]*=n,e.elements[4]*=o,e.elements[5]*=o,e.elements[6]*=o,e.elements[8]*=u,e.elements[9]*=u,e.elements[10]*=u,i.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=l,this}}(),makePerspective:function(t,e,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements;return a[0]=2*r/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*r/(n-i),a[9]=(n+i)/(n-i),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+r)/(o-r),a[14]=-2*o*r/(o-r),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,i,r,o){var a=this.elements,s=1/(e-t),l=1/(n-i),u=1/(o-r);return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-(e+t)*s,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-(n+i)*l,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-(o+r)*u,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var n=0;16>n;n++)if(e[n]!==t[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;16>n;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),Object.assign(r,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,a){var s=n[i+0],l=n[i+1],u=n[i+2];n=n[i+3],i=r[o+0];var c=r[o+1],h=r[o+2];if(r=r[o+3],n!==r||s!==i||l!==c||u!==h){o=1-a;var d=s*i+l*c+u*h+n*r,f=0<=d?1:-1,p=1-d*d;p>Number.EPSILON&&(p=Math.sqrt(p),d=Math.atan2(p,d*f),o=Math.sin(o*d)/p,a=Math.sin(a*d)/p),s=s*o+i*(f*=a),l=l*o+c*f,u=u*o+h*f,n=n*o+r*f,o===1-a&&(a=1/Math.sqrt(s*s+l*l+u*u+n*n),s*=a,l*=a,u*=a,n*=a)}t[e]=s,t[e+1]=l,t[e+2]=u,t[e+3]=n}}),Object.defineProperties(r.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(r.prototype,{set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,i=t._y,r=t._z;t=t.order;var o=Math.cos,a=Math.sin,s=o(n/2),l=o(i/2);o=o(r/2),n=a(n/2),i=a(i/2),r=a(r/2);return"XYZ"===t?(this._x=n*l*o+s*i*r,this._y=s*i*o-n*l*r,this._z=s*l*r+n*i*o,this._w=s*l*o-n*i*r):"YXZ"===t?(this._x=n*l*o+s*i*r,this._y=s*i*o-n*l*r,this._z=s*l*r-n*i*o,this._w=s*l*o+n*i*r):"ZXY"===t?(this._x=n*l*o-s*i*r,this._y=s*i*o+n*l*r,this._z=s*l*r+n*i*o,this._w=s*l*o-n*i*r):"ZYX"===t?(this._x=n*l*o-s*i*r,this._y=s*i*o+n*l*r,this._z=s*l*r-n*i*o,this._w=s*l*o+n*i*r):"YZX"===t?(this._x=n*l*o+s*i*r,this._y=s*i*o+n*l*r,this._z=s*l*r-n*i*o,this._w=s*l*o-n*i*r):"XZY"===t&&(this._x=n*l*o-s*i*r,this._y=s*i*o-n*l*r,this._z=s*l*r+n*i*o,this._w=s*l*o+n*i*r),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){e/=2;var n=Math.sin(e);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(e),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=(n=t.elements)[0];t=n[4];var n,i=n[8],r=n[1],o=n[5],a=n[9],s=n[2],l=n[6],u=e+o+(n=n[10]);return 0<u?(e=.5/Math.sqrt(u+1),this._w=.25/e,this._x=(l-a)*e,this._y=(i-s)*e,this._z=(r-t)*e):e>o&&e>n?(e=2*Math.sqrt(1+e-o-n),this._w=(l-a)/e,this._x=.25*e,this._y=(t+r)/e,this._z=(i+s)/e):o>n?(e=2*Math.sqrt(1+o-e-n),this._w=(i-s)/e,this._x=(t+r)/e,this._y=.25*e,this._z=(a+l)/e):(e=2*Math.sqrt(1+n-e-o),this._w=(r-t)/e,this._x=(i+s)/e,this._y=(a+l)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new o;return function(n,i){return void 0===e&&(e=new o),1e-6>(t=n.dot(i)+1)?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,i),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z;t=t._w;var o=e._x,a=e._y,s=e._z;return e=e._w,this._x=n*e+t*o+i*s-r*a,this._y=i*e+t*a+r*o-n*s,this._z=r*e+t*s+n*a-i*o,this._w=t*e-n*o-i*a-r*s,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w;if(0>(s=o*t._w+n*t._x+i*t._y+r*t._z)?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),1<=s)return this._w=o,this._x=n,this._y=i,this._z=r,this;if(t=Math.sqrt(1-s*s),.001>Math.abs(t))return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var a=Math.atan2(t,s),s=Math.sin((1-e)*a)/t;return e=Math.sin(e*a)/t,this._w=o*s+this._w*e,this._x=n*s+this._x*e,this._y=i*s+this._y*e,this._z=r*s+this._z*e,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(o.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new r;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new r;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=1/((t=t.elements)[3]*e+t[7]*n+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*i+t[12])*r,this.y=(t[1]*e+t[5]*n+t[9]*i+t[13])*r,this.z=(t[2]*e+t[6]*n+t[10]*i+t[14])*r,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=(t=t.w)*e+o*i-a*n,l=t*n+a*e-r*i,u=t*i+r*n-o*e;e=-r*e-o*n-a*i;return this.x=s*t+e*-r+l*-a-u*-o,this.y=l*t+e*-o+u*-r-s*-a,this.z=u*t+e*-a+s*-o-l*-r,this},project:function(){var t=new i;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new i;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new o,e=new o;return function(n,i){return t.set(n,n,n),e.set(i,i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,i=t.y;t=t.z;var r=e.x,o=e.y;return e=e.z,this.x=i*e-t*o,this.y=t*r-n*e,this.z=n*o-i*r,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new o;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new o;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){return t=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq()),Math.acos(wr.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return t=this.z-t.z,e*e+n*n+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(a.prototype,{isMatrix3:!0,set:function(t,e,n,i,r,o,a,s,l){var u=this.elements;return u[0]=t,u[1]=i,u[2]=a,u[3]=e,u[4]=r,u[5]=s,u[6]=n,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var t=new o;return function(e){for(var n=0,i=e.count;n<i;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements;e=this.elements,t=n[0];var r=n[3],o=n[6],a=n[1],s=n[4],l=n[7],u=n[2],c=n[5],h=(n=n[8],i[0]),d=i[3],f=i[6],p=i[1],m=i[4],g=i[7],v=i[2],y=i[5];i=i[8];return e[0]=t*h+r*p+o*v,e[3]=t*d+r*m+o*y,e[6]=t*f+r*g+o*i,e[1]=a*h+s*p+l*v,e[4]=a*d+s*m+l*y,e[7]=a*f+s*g+l*i,e[2]=u*h+c*p+n*v,e[5]=u*d+c*m+n*y,e[8]=u*f+c*g+n*i,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t,e=(t=this.elements)[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7];return e*o*(t=t[8])-e*a*l-n*r*t+n*a*s+i*r*l-i*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=t.elements;t=this.elements;var i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=(n=n[8])*s-l*c,d=l*u-n*a,f=c*a-s*u,p=i*h+r*d+o*f;if(0===p){if(!0===e)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return e=1/p,t[0]=h*e,t[1]=(o*c-n*r)*e,t[2]=(l*r-o*s)*e,t[3]=d*e,t[4]=(n*i-o*u)*e,t[5]=(o*a-l*i)*e,t[6]=f*e,t[7]=(r*u-c*i)*e,t[8]=(s*i-r*a)*e,this},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,i,r,o,a){var s=Math.cos(r);r=Math.sin(r),this.set(n*s,n*r,-n*(s*o+r*a)+o+t,-i*r,i*s,-i*(-r*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t);t=Math.sin(t);var n=this.elements,i=n[0],r=n[3],o=n[6],a=n[1],s=n[4],l=n[7];return n[0]=e*i+t*a,n[3]=e*r+t*s,n[6]=e*o+t*l,n[1]=-t*i+e*a,n[4]=-t*r+e*s,n[7]=-t*o+e*l,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){var e=this.elements;t=t.elements;for(var n=0;9>n;n++)if(e[n]!==t[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;9>n;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var br=0;s.DEFAULT_IMAGE=void 0,s.DEFAULT_MAPPING=300,s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var i=this.image;if(void 0===i.uuid&&(i.uuid=wr.generateUUID()),!e&&void 0===t.images[i.uuid]){var r=t.images,o=i.uuid,a=i.uuid;if(i instanceof HTMLCanvasElement)var s=i;else{(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=i.width,s.height=i.height;var l=s.getContext("2d");i instanceof ImageData?l.putImageData(i,0,0):l.drawImage(i,0,0,i.width,i.height)}s=2048<s.width||2048<s.height?s.toDataURL("image/jpeg",.6):s.toDataURL("image/png"),r[o]={uuid:a,url:s}}n.image=i.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.applyMatrix3(this.matrix),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(s.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(l.prototype,{isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*i+t[12]*r,this.y=t[1]*e+t[5]*n+t[9]*i+t[13]*r,this.z=t[2]*e+t[6]*n+t[10]*i+t[14]*r,this.w=t[3]*e+t[7]*n+t[11]*i+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e=(t=t.elements)[0],n=t[4],i=t[8],r=t[1],o=t[5],a=t[9],s=t[2],l=t[6],u=t[10];return.01>Math.abs(n-r)&&.01>Math.abs(i-s)&&.01>Math.abs(a-l)?.1>Math.abs(n+r)&&.1>Math.abs(i+s)&&.1>Math.abs(a+l)&&.1>Math.abs(e+o+u-3)?(this.set(1,0,0,0),this):(t=Math.PI,e=(e+1)/2,o=(o+1)/2,u=(u+1)/2,n=(n+r)/4,i=(i+s)/4,a=(a+l)/4,e>o&&e>u?.01>e?(l=0,n=s=.707106781):(l=Math.sqrt(e),s=n/l,n=i/l):o>u?.01>o?(l=.707106781,s=0,n=.707106781):(s=Math.sqrt(o),l=n/s,n=a/s):.01>u?(s=l=.707106781,n=0):(n=Math.sqrt(u),l=i/n,s=a/n),this.set(l,s,n,t),this):(t=Math.sqrt((l-a)*(l-a)+(i-s)*(i-s)+(r-n)*(r-n)),.001>Math.abs(t)&&(t=1),this.x=(l-a)/t,this.y=(i-s)/t,this.z=(r-n)/t,this.w=Math.acos((e+o+u-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new l,e=new l),t.set(n,n,n,n),e.set(i,i,i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),u.prototype=Object.assign(Object.create(e.prototype),{constructor:u,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(c.prototype=Object.create(u.prototype)).constructor=c,c.prototype.isWebGLRenderTargetCube=!0,(h.prototype=Object.create(s.prototype)).constructor=h,h.prototype.isDataTexture=!0,(d.prototype=Object.create(s.prototype)).constructor=d,d.prototype.isCubeTexture=!0,Object.defineProperty(d.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var _r=new s,Er=new d,Tr=[],Cr=[],xr=new Float32Array(16),Sr=new Float32Array(9);B.prototype.setValue=function(t,e){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var o=n[i];o.setValue(t,e[o.id])}};var Mr=/([\w\d_]+)(\])?(\[|\.)?/g;j.prototype.setValue=function(t,e,n){void 0!==(e=this.map[e])&&e.setValue(t,n,this.renderer)},j.prototype.setOptional=function(t,e,n){void 0!==(e=e[n])&&this.setValue(t,n,e)},j.upload=function(t,e,n,i){for(var r=0,o=e.length;r!==o;++r){var a=e[r],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,i)}},j.seqWithValue=function(t,e){for(var n=[],i=0,r=t.length;i!==r;++i){var o=t[i];o.id in e&&n.push(o)}return n};var Or={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(z.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:.5>n?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,i){return e=wr.euclideanModulo(e,1),n=wr.clamp(n,0,1),i=wr.clamp(i,0,1),0===n?this.r=this.g=this.b=i:(n=.5>=i?i*(1+n):i+n-i*n,i=2*i-n,this.r=t(i,n,e+1/3),this.g=t(i,n,e),this.b=t(i,n,e-1/3)),this}}(),setStyle:function(t){function e(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i=n[2];switch(n[1]){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){i=parseFloat(n[1])/360;var r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(i,r,o)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){if(n=n[1],3===(i=n.length))return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,this;if(6===i)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,this}return t&&0<t.length&&(void 0!==(n=Or[t])?this.setHex(n):console.warn("THREE.Color: Unknown color "+t)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return void 0===e&&(e=2),e=0<e?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var e,n=this.r,i=this.g,r=this.b,o=Math.max(n,i,r),a=((l=Math.min(n,i,r))+o)/2;if(l===o)l=e=0;else{var s=o-l,l=.5>=a?s/(o+l):s/(2-o-l);switch(o){case n:e=(i-r)/s+(i<r?6:0);break;case i:e=(r-n)/s+2;break;case r:e=(n-i)/s+4}e/=6}return t.h=e,t.s=l,t.l=a,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var Rr={common:{diffuse:{value:new z(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new a},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new n(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new z(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new z(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new a}}},Ar={merge:function(t){for(var e={},n=0;n<t.length;n++){var i,r=this.clone(t[n]);for(i in r)e[i]=r[i]}return e},clone:function(t){var e,n={};for(e in t){n[e]={};for(var i in t[e]){var r=t[e][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?n[e][i]=r.clone():Array.isArray(r)?n[e][i]=r.slice():n[e][i]=r}}return n}},Pr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Nr={basic:{uniforms:Ar.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.fog]),vertexShader:Pr.meshbasic_vert,fragmentShader:Pr.meshbasic_frag},lambert:{uniforms:Ar.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.fog,Rr.lights,{emissive:{value:new z(0)}}]),vertexShader:Pr.meshlambert_vert,fragmentShader:Pr.meshlambert_frag},phong:{uniforms:Ar.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,Rr.gradientmap,Rr.fog,Rr.lights,{emissive:{value:new z(0)},specular:{value:new z(1118481)},shininess:{value:30}}]),vertexShader:Pr.meshphong_vert,fragmentShader:Pr.meshphong_frag},standard:{uniforms:Ar.merge([Rr.common,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,Rr.roughnessmap,Rr.metalnessmap,Rr.fog,Rr.lights,{emissive:{value:new z(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Pr.meshphysical_vert,fragmentShader:Pr.meshphysical_frag},points:{uniforms:Ar.merge([Rr.points,Rr.fog]),vertexShader:Pr.points_vert,fragmentShader:Pr.points_frag},dashed:{uniforms:Ar.merge([Rr.common,Rr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pr.linedashed_vert,fragmentShader:Pr.linedashed_frag},depth:{uniforms:Ar.merge([Rr.common,Rr.displacementmap]),vertexShader:Pr.depth_vert,fragmentShader:Pr.depth_frag},normal:{uniforms:Ar.merge([Rr.common,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,{opacity:{value:1}}]),vertexShader:Pr.normal_vert,fragmentShader:Pr.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pr.cube_vert,fragmentShader:Pr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pr.equirect_vert,fragmentShader:Pr.equirect_frag},distanceRGBA:{uniforms:Ar.merge([Rr.common,Rr.displacementmap,{referencePosition:{value:new o},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pr.distanceRGBA_vert,fragmentShader:Pr.distanceRGBA_frag},shadow:{uniforms:Ar.merge([Rr.lights,Rr.fog,{color:{value:new z(0)},opacity:{value:1}}]),vertexShader:Pr.shadow_vert,fragmentShader:Pr.shadow_frag}};Nr.physical={uniforms:Ar.merge([Nr.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Pr.meshphysical_vert,fragmentShader:Pr.meshphysical_frag},Object.assign(V.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new n;return function(e,n){return n=t.copy(n).multiplyScalar(.5),this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t=t||new n,this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new n,this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new n).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new n).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new n;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),(W.prototype=Object.create(s.prototype)).constructor=W;var kr=0;G.prototype=Object.assign(Object.create(e.prototype),{constructor:G,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0===n)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else if("shading"===e)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else{var i=this[e];void 0===i?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]="overdraw"===e?Number(n):n}}},toJSON:function(t){function e(t){var e,n=[];for(e in t){var i=t[e];delete i.metadata,n.push(i)}return n}var n=void 0===t||"string"==typeof t;n&&(t={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),0!==this.side&&(i.side=this.side),0!==this.vertexColors&&(i.vertexColors=this.vertexColors),1>this.opacity&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,0!==this.rotation&&(i.rotation=this.rotation),1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),0<this.alphaTest&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),n&&(n=e(t.textures),t=e(t.images),0<n.length&&(i.textures=n),0<t.length&&(i.images=t)),i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=null;if(null!==(t=t.clippingPlanes))for(var n=t.length,i=(e=Array(n),0);i!==n;++i)e[i]=t[i].clone();return this.clippingPlanes=e,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(Y.prototype=Object.create(G.prototype)).constructor=Y,Y.prototype.isMeshDepthMaterial=!0,Y.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},(X.prototype=Object.create(G.prototype)).constructor=X,X.prototype.isMeshDistanceMaterial=!0,X.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Object.assign(q.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],c=t[s+1],h=t[s+2];u<e&&(e=u),c<n&&(n=c),h<i&&(i=h),u>r&&(r=u),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,n,i),this.max.set(r,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),c=t.getY(s),h=t.getZ(s);u<e&&(e=u),c<n&&(n=c),h<i&&(i=h),u>r&&(r=u),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,n,i),this.max.set(r,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new o;return function(e,n){return n=t.copy(n).multiplyScalar(.5),this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t=t||new o,this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new o,this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){function t(t){var o=t.geometry;if(void 0!==o)if(o.isGeometry)for(o=o.vertices,n=0,i=o.length;n<i;n++)r.copy(o[n]),r.applyMatrix4(t.matrixWorld),e.expandByPoint(r);else if(o.isBufferGeometry&&void 0!==(o=o.attributes.position))for(n=0,i=o.count;n<i;n++)r.fromBufferAttribute(o,n).applyMatrix4(t.matrixWorld),e.expandByPoint(r)}var e,n,i,r=new o;return function(n){return e=this,n.updateMatrixWorld(!0),n.traverse(t),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new o).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new o;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){if(0<t.normal.x)var e=t.normal.x*this.min.x,n=t.normal.x*this.max.x;else e=t.normal.x*this.max.x,n=t.normal.x*this.min.x;return 0<t.normal.y?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){return(e||new o).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new o;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new o;return function(e){return e=e||new J,this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new o,new o,new o,new o,new o,new o,new o,new o];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(J.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new q;return function(e,n){var i=this.center;void 0!==n?i.copy(n):t.setFromPoints(e).getCenter(i);for(var r=n=0,o=e.length;r<o;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return(e=e||new o).copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return(t=t||new q).set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(K.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new o,e=new o;return function(n,i,r){return i=t.subVectors(r,i).cross(e.subVectors(n,i)).normalize(),this.setFromNormalAndCoplanarPoint(i,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return(e||new o).copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new o;return function(e,n){n=n||new o;var i=e.delta(t),r=this.normal.dot(i);if(0===r){if(0===this.distanceToPoint(e.start))return n.copy(e.start)}else if(!(0>(r=-(e.start.dot(this.normal)+this.constant)/r)||1<r))return n.copy(i).multiplyScalar(r).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&0<t||0>t&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new o).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new o,e=new a;return function(n,i){return i=i||e.getNormalMatrix(n),n=this.coplanarPoint(t).applyMatrix4(n),i=this.normal.applyMatrix3(i).normalize(),this.constant=-n.dot(i),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(Z.prototype,{set:function(t,e,n,i,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;6>n;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes;t=(g=t.elements)[0];var n=g[1],i=g[2],r=g[3],o=g[4],a=g[5],s=g[6],l=g[7],u=g[8],c=g[9],h=g[10],d=g[11],f=g[12],p=g[13],m=g[14],g=g[15];return e[0].setComponents(r-t,l-o,d-u,g-f).normalize(),e[1].setComponents(r+t,l+o,d+u,g+f).normalize(),e[2].setComponents(r+n,l+a,d+c,g+p).normalize(),e[3].setComponents(r-n,l-a,d-c,g-p).normalize(),e[4].setComponents(r-i,l-s,d-h,g-m).normalize(),e[5].setComponents(r+i,l+s,d+h,g+m).normalize(),this},intersectsObject:function(){var t=new J;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new J;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){var e=this.planes,n=t.center;t=-t.radius;for(var i=0;6>i;i++)if(e[i].distanceToPoint(n)<t)return!1;return!0},intersectsBox:function(){var t=new o,e=new o;return function(n){for(var i=this.planes,r=0;6>r;r++){var o=i[r];t.x=0<o.normal.x?n.min.x:n.max.x,e.x=0<o.normal.x?n.max.x:n.min.x,t.y=0<o.normal.y?n.min.y:n.max.y,e.y=0<o.normal.y?n.max.y:n.min.y,t.z=0<o.normal.z?n.min.z:n.max.z,e.z=0<o.normal.z?n.max.z:n.min.z;var a=o.distanceToPoint(t);o=o.distanceToPoint(e);if(0>a&&0>o)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;6>n;n++)if(0>e[n].distanceToPoint(t))return!1;return!0}}),Q.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),Q.DefaultOrder="XYZ",Object.defineProperties(Q.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(Q.prototype,{isEuler:!0,set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var i=wr.clamp;t=(h=t.elements)[0];var r=h[4],o=h[8],a=h[1],s=h[5],l=h[9],u=h[2],c=h[6],h=h[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(i(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(-l,h),this._z=Math.atan2(-r,t)):(this._x=Math.atan2(c,s),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(o,h),this._z=Math.atan2(a,s)):(this._y=Math.atan2(-u,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(c,-1,1)),.99999>Math.abs(c)?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-r,s)):(this._y=0,this._z=Math.atan2(a,t))):"ZYX"===e?(this._y=Math.asin(-i(u,-1,1)),.99999>Math.abs(u)?(this._x=Math.atan2(c,h),this._z=Math.atan2(a,t)):(this._x=0,this._z=Math.atan2(-r,s))):"YZX"===e?(this._z=Math.asin(i(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(-l,s),this._y=Math.atan2(-u,t)):(this._x=0,this._y=Math.atan2(o,h))):"XZY"===e?(this._z=Math.asin(-i(r,-1,1)),.99999>Math.abs(r)?(this._x=Math.atan2(c,s),this._y=Math.atan2(o,t)):(this._x=Math.atan2(-l,h),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new i;return function(e,n,i){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,i)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new r;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new o(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(tt.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var Lr=0;et.DefaultUp=new o(0,1,0),et.DefaultMatrixAutoUpdate=!0,et.prototype=Object.assign(Object.create(e.prototype),{constructor:et,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new r;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new r;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new o(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new o(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new o(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new o;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new o(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new o(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new o(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new i;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new i,e=new o;return function(n,i,r){n.isVector3?e.copy(n):e.set(n,i,r),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}return-1!==(e=this.children.indexOf(t))&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return t=t||new o,this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new o,e=new o;return function(n){return n=n||new r,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new r;return function(e){return e=e||new Q,this.getWorldQuaternion(t),e.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new o,e=new r;return function(n){return n=n||new o,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new r;return function(e){return e=e||new o,this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){function e(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}function n(t){var e,n=[];for(e in t){var i=t[e];delete i.metadata,n.push(i)}return n}var i={};(l=void 0===t||"string"==typeof t)&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.matrix=this.matrix.toArray(),void 0!==this.geometry){r.geometry=e(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes)if(o=o.shapes,Array.isArray(o))for(var a=0,s=o.length;a<s;a++)e(t.shapes,o[a]);else e(t.shapes,o)}if(void 0!==this.material)if(Array.isArray(this.material)){for(o=[],a=0,s=this.material.length;a<s;a++)o.push(e(t.materials,this.material[a]));r.material=o}else r.material=e(t.materials,this.material);if(0<this.children.length)for(r.children=[],a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object);if(l){var l=n(t.geometries),u=(a=n(t.materials),s=n(t.textures),n(t.images));o=n(t.shapes),0<l.length&&(i.geometries=l),0<a.length&&(i.materials=a),0<s.length&&(i.textures=s),0<u.length&&(i.images=u),0<o.length&&(i.shapes=o)}return i.object=r,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(e=0;e<t.children.length;e++)this.add(t.children[e].clone());return this}}),nt.prototype=Object.assign(Object.create(et.prototype),{constructor:nt,isCamera:!0,copy:function(t,e){return et.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new r;return function(e){return e=e||new o,this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){et.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),it.prototype=Object.assign(Object.create(nt.prototype),{constructor:it,isOrthographicCamera:!0,copy:function(t,e){return nt.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(i=(this.right+this.left)/2)-t,i=i+t;t=(o=(this.top+this.bottom)/2)+e,e=o-e;if(null!==this.view&&this.view.enabled){i=this.zoom/(this.view.width/this.view.fullWidth),e=this.zoom/(this.view.height/this.view.fullHeight);var r=(this.right-this.left)/this.view.width,o=(this.top-this.bottom)/this.view.height;n=n+this.view.offsetX/i*r,i=n+this.view.width/i*r,t=t-this.view.offsetY/e*o,e=t-this.view.height/e*o}this.projectionMatrix.makeOrthographic(n,i,t,e,this.near,this.far)},toJSON:function(t){return t=et.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Object.assign(rt.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Dr=0;ot.prototype=Object.assign(Object.create(e.prototype),{constructor:ot,isGeometry:!0,applyMatrix:function(t){for(var e=(new a).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(n=0,i=this.faces.length;n<i;n++){(t=this.faces[n]).normal.applyMatrix3(e).normalize();for(var r=0,o=t.vertexNormals.length;r<o;r++)t.vertexNormals[r].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var t=new i;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new i;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new i;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new i;return function(e,n,i){return t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t=new i;return function(e,n,i){return t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t=new et;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,n,r){r=new rt(t,e,n,void 0!==l?[d[t].clone(),d[e].clone(),d[n].clone()]:[],void 0!==u?[i.colors[t].clone(),i.colors[e].clone(),i.colors[n].clone()]:[],r),i.faces.push(r),void 0!==c&&i.faceVertexUvs[0].push([f[t].clone(),f[e].clone(),f[n].clone()]),void 0!==h&&i.faceVertexUvs[1].push([p[t].clone(),p[e].clone(),p[n].clone()])}var i=this,r=null!==t.index?t.index.array:void 0,a=t.attributes,s=a.position.array,l=void 0!==a.normal?a.normal.array:void 0,u=void 0!==a.color?a.color.array:void 0,c=void 0!==a.uv?a.uv.array:void 0,h=void 0!==a.uv2?a.uv2.array:void 0;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var d=[],f=[],p=[],m=a=0;a<s.length;a+=3,m+=2)i.vertices.push(new o(s[a],s[a+1],s[a+2])),void 0!==l&&d.push(new o(l[a],l[a+1],l[a+2])),void 0!==u&&i.colors.push(new z(u[a],u[a+1],u[a+2])),void 0!==c&&f.push(new n(c[m],c[m+1])),void 0!==h&&p.push(new n(h[m],h[m+1]));var g=t.groups;if(0<g.length)for(a=0;a<g.length;a++){s=g[a];var v=s.start,y=s.count;for(m=v,v=v+y;m<v;m+=3)void 0!==r?e(r[m],r[m+1],r[m+2],s.materialIndex):e(m,m+1,m+2,s.materialIndex)}else if(void 0!==r)for(a=0;a<r.length;a+=3)e(r[a],r[a+1],r[a+2]);else for(a=0;a<s.length/3;a+=3)e(a,a+1,a+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,n=new i;return n.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new o,e=new o,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],a=this.vertices[r.a],s=this.vertices[r.b];t.subVectors(this.vertices[r.c],s),e.subVectors(a,s),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,n=Array(this.vertices.length),i=0;for(e=this.vertices.length;i<e;i++)n[i]=new o;if(t){var r=new o,a=new o;for(t=0,i=this.faces.length;t<i;t++){e=this.faces[t];var s=this.vertices[e.a],l=this.vertices[e.b],u=this.vertices[e.c];r.subVectors(u,l),a.subVectors(s,l),r.cross(a),n[e.a].add(r),n[e.b].add(r),n[e.c].add(r)}}else for(this.computeFaceNormals(),t=0,i=this.faces.length;t<i;t++)e=this.faces[t],n[e.a].add(e.normal),n[e.b].add(e.normal),n[e.c].add(e.normal);for(i=0,e=this.vertices.length;i<e;i++)n[i].normalize();for(t=0,i=this.faces.length;t<i;t++)e=this.faces[t],3===(s=e.vertexNormals).length?(s[0].copy(n[e.a]),s[1].copy(n[e.b]),s[2].copy(n[e.c])):(s[0]=n[e.a].clone(),s[1]=n[e.b].clone(),s[2]=n[e.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t;this.computeFaceNormals();var e=0;for(t=this.faces.length;e<t;e++){var n=this.faces[e],i=n.vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n=0;for(e=this.faces.length;n<e;n++){var i=this.faces[n];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);var r=0;for(t=i.vertexNormals.length;r<t;r++)i.__originalVertexNormals[r]?i.__originalVertexNormals[r].copy(i.vertexNormals[r]):i.__originalVertexNormals[r]=i.vertexNormals[r].clone()}var a=new ot;for(a.faces=this.faces,r=0,t=this.morphTargets.length;r<t;r++){if(!this.morphNormals[r]){this.morphNormals[r]={},this.morphNormals[r].faceNormals=[],this.morphNormals[r].vertexNormals=[],i=this.morphNormals[r].faceNormals;var s=this.morphNormals[r].vertexNormals;for(n=0,e=this.faces.length;n<e;n++){var l=new o,u={a:new o,b:new o,c:new o};i.push(l),s.push(u)}}for(s=this.morphNormals[r],a.vertices=this.morphTargets[r].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,e=this.faces.length;n<e;n++)i=this.faces[n],l=s.faceNormals[n],u=s.vertexNormals[n],l.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,e=this.faces.length;n<e;n++)i=this.faces[n],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,i=e.length;n<i;n++)0<n&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new q),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new J),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var i,r=this.vertices.length,o=this.vertices,s=t.vertices,l=this.faces,u=t.faces,c=this.faceVertexUvs[0],h=t.faceVertexUvs[0],d=this.colors,f=t.colors;void 0===n&&(n=0),void 0!==e&&(i=(new a).getNormalMatrix(e)),t=0;for(var p=s.length;t<p;t++){var m=s[t].clone();void 0!==e&&m.applyMatrix4(e),o.push(m)}for(t=0,p=f.length;t<p;t++)d.push(f[t].clone());for(t=0,p=u.length;t<p;t++){var g=(s=u[t]).vertexNormals;f=s.vertexColors;for((d=new rt(s.a+r,s.b+r,s.c+r)).normal.copy(s.normal),void 0!==i&&d.normal.applyMatrix3(i).normalize(),e=0,o=g.length;e<o;e++)m=g[e].clone(),void 0!==i&&m.applyMatrix3(i).normalize(),d.vertexNormals.push(m);for(d.color.copy(s.color),e=0,o=f.length;e<o;e++)m=f[e],d.vertexColors.push(m.clone());d.materialIndex=s.materialIndex+n,l.push(d)}for(t=0,p=h.length;t<p;t++)if(n=h[t],i=[],void 0!==n){for(e=0,o=n.length;e<o;e++)i.push(n[e].clone());c.push(i)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e={},n=[],i=[],r=Math.pow(10,4),o=0;for(t=this.vertices.length;o<t;o++){var a=this.vertices[o];void 0===e[a=Math.round(a.x*r)+"_"+Math.round(a.y*r)+"_"+Math.round(a.z*r)]?(e[a]=o,n.push(this.vertices[o]),i[o]=n.length-1):i[o]=i[e[a]]}for(e=[],o=0,t=this.faces.length;o<t;o++)for(r=this.faces[o],r.a=i[r.a],r.b=i[r.b],r.c=i[r.c],r=[r.a,r.b,r.c],a=0;3>a;a++)if(r[a]===r[(a+1)%3]){e.push(o);break}for(o=e.length-1;0<=o;o--)for(r=e[o],this.faces.splice(r,1),i=0,t=this.faceVertexUvs.length;i<t;i++)this.faceVertexUvs[i].splice(r,1);return o=this.vertices.length-n.length,this.vertices=n,o},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var i=t[e];this.vertices.push(new o(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var i,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===e&&(i=[]),a&&a.length===e&&(r=[]),n=0;n<e;n++){var s=t[n]._id;i&&i.push(o[s]),r&&r.push(a[s])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==u[e]?u[e]:(u[e]=l.length/3,l.push(t.x,t.y,t.z),u[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]?h[e]:(h[e]=c.length,c.push(t.getHex()),h[e])}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==f[e]?f[e]:(f[e]=d.length/2,d.push(t.x,t.y),f[e])}var r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o,a=this.parameters;for(o in a)void 0!==a[o]&&(r[o]=a[o]);return r}for(a=[],o=0;o<this.vertices.length;o++){var s=this.vertices[o];a.push(s.x,s.y,s.z)}s=[];var l=[],u={},c=[],h={},d=[],f={};for(o=0;o<this.faces.length;o++){var p=this.faces[o],m=void 0!==this.faceVertexUvs[0][o],g=0<p.normal.length(),v=0<p.vertexNormals.length,y=1!==p.color.r||1!==p.color.g||1!==p.color.b,w=0<p.vertexColors.length,b=t(b=t(b=t(b=t(b=t(b=t(b=t(b=t(b=0,0,0),1,!0),2,!1),3,m),4,g),5,v),6,y),7,w);s.push(b),s.push(p.a,p.b,p.c),s.push(p.materialIndex),m&&(m=this.faceVertexUvs[0][o],s.push(i(m[0]),i(m[1]),i(m[2]))),g&&s.push(e(p.normal)),v&&(g=p.vertexNormals,s.push(e(g[0]),e(g[1]),e(g[2]))),y&&s.push(n(p.color)),w&&(p=p.vertexColors,s.push(n(p[0]),n(p[1]),n(p[2])))}return r.data={},r.data.vertices=a,r.data.normals=l,0<c.length&&(r.data.colors=c),0<d.length&&(r.data.uvs=[d]),r.data.faces=s,r},clone:function(){return(new ot).copy(this)},copy:function(t){var e,n,i;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var r=t.vertices,o=0;for(e=r.length;o<e;o++)this.vertices.push(r[o].clone());for(o=0,e=(r=t.colors).length;o<e;o++)this.colors.push(r[o].clone());for(o=0,e=(r=t.faces).length;o<e;o++)this.faces.push(r[o].clone());for(o=0,e=t.faceVertexUvs.length;o<e;o++){var a=t.faceVertexUvs[o];for(void 0===this.faceVertexUvs[o]&&(this.faceVertexUvs[o]=[]),r=0,n=a.length;r<n;r++){var s=a[r],l=[],u=0;for(i=s.length;u<i;u++)l.push(s[u].clone());this.faceVertexUvs[o].push(l)}}for(o=0,e=(u=t.morphTargets).length;o<e;o++){if(i={},i.name=u[o].name,void 0!==u[o].vertices)for(i.vertices=[],r=0,n=u[o].vertices.length;r<n;r++)i.vertices.push(u[o].vertices[r].clone());if(void 0!==u[o].normals)for(i.normals=[],r=0,n=u[o].normals.length;r<n;r++)i.normals.push(u[o].normals[r].clone());this.morphTargets.push(i)}for(o=0,e=(u=t.morphNormals).length;o<e;o++){if(i={},void 0!==u[o].vertexNormals)for(i.vertexNormals=[],r=0,n=u[o].vertexNormals.length;r<n;r++)a=u[o].vertexNormals[r],s={},s.a=a.a.clone(),s.b=a.b.clone(),s.c=a.c.clone(),i.vertexNormals.push(s);if(void 0!==u[o].faceNormals)for(i.faceNormals=[],r=0,n=u[o].faceNormals.length;r<n;r++)i.faceNormals.push(u[o].faceNormals[r].clone());this.morphNormals.push(i)}for(o=0,e=(r=t.skinWeights).length;o<e;o++)this.skinWeights.push(r[o].clone());for(o=0,e=(r=t.skinIndices).length;o<e;o++)this.skinIndices.push(r[o].clone());for(o=0,e=(r=t.lineDistances).length;o<e;o++)this.lineDistances.push(r[o]);return null!==(o=t.boundingBox)&&(this.boundingBox=o.clone()),null!==(o=t.boundingSphere)&&(this.boundingSphere=o.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(at.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(at.prototype,{isBufferAttribute:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new z),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,r=0,o=t.length;r<o;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new n),e[i++]=a.x,e[i++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new o),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new l),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(st.prototype=Object.create(at.prototype)).constructor=st,(lt.prototype=Object.create(at.prototype)).constructor=lt,(ut.prototype=Object.create(at.prototype)).constructor=ut,(ct.prototype=Object.create(at.prototype)).constructor=ct,(ht.prototype=Object.create(at.prototype)).constructor=ht,(dt.prototype=Object.create(at.prototype)).constructor=dt,(ft.prototype=Object.create(at.prototype)).constructor=ft,(pt.prototype=Object.create(at.prototype)).constructor=pt,(mt.prototype=Object.create(at.prototype)).constructor=mt,Object.assign(gt.prototype,{computeGroups:function(t){var e=[],n=void 0;t=t.faces;for(var i=0;i<t.length;i++){var r=t[i];if(r.materialIndex!==n){n=r.materialIndex,void 0!==o&&(o.count=3*i-o.start,e.push(o));var o={start:3*i,materialIndex:n}}}void 0!==o&&(o.count=3*i-o.start,e.push(o)),this.groups=e},fromGeometry:function(t){var e=t.faces,i=t.vertices,r=t.faceVertexUvs,o=r[0]&&0<r[0].length,a=r[1]&&0<r[1].length,s=t.morphTargets,l=s.length;if(0<l){for(var u=[],c=0;c<l;c++)u[c]=[];this.morphTargets.position=u}var h=t.morphNormals,d=h.length;if(0<d){var f=[];for(c=0;c<d;c++)f[c]=[];this.morphTargets.normal=f}var p=t.skinIndices,m=t.skinWeights,g=p.length===i.length,v=m.length===i.length;for(c=0;c<e.length;c++){var y=e[c];this.vertices.push(i[y.a],i[y.b],i[y.c]);var w=y.vertexNormals;for(3===w.length?this.normals.push(w[0],w[1],w[2]):(w=y.normal,this.normals.push(w,w,w)),3===(w=y.vertexColors).length?this.colors.push(w[0],w[1],w[2]):(w=y.color,this.colors.push(w,w,w)),!0===o&&(void 0!==(w=r[0][c])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new n,new n,new n))),!0===a&&(void 0!==(w=r[1][c])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new n,new n,new n))),w=0;w<l;w++){var b=s[w].vertices;u[w].push(b[y.a],b[y.b],b[y.c])}for(w=0;w<d;w++)b=h[w].vertexNormals[c],f[w].push(b.a,b.b,b.c);g&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Ir=1;yt.prototype=Object.assign(Object.create(e.prototype),{constructor:yt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<vt(t)?ft:ht)(t,1):this.index=t},addAttribute:function(t,e,n){if(e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute){if("index"!==t)return this.attributes[t]=e,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)}else console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new at(e,n))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;return void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0),void 0!==(e=this.attributes.normal)&&((new a).getNormalMatrix(t).applyToBufferAttribute(e),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new i;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new i;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new i;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new i;return function(e,n,i){return t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t=new i;return function(e,n,i){return t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t=new et;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){t=new pt(3*e.vertices.length,3);var n=new pt(3*e.colors.length,3);this.addAttribute("position",t.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(t=new pt(e.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];e.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new pt(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var n=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(n=void 0,e.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}return!0===e.verticesNeedUpdate&&(void 0!==(n=this.attributes.position)&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(n=this.attributes.normal)&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(n=this.attributes.color)&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(n=this.attributes.uv)&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(n=this.attributes.lineDistance)&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new gt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);this.addAttribute("position",new at(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.addAttribute("normal",new at(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.addAttribute("color",new at(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new at(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new at(e,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(e=new(65535<vt(t.indices)?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new at(e,1).copyIndicesArray(t.indices))),this.groups=t.groups;for(var n in t.morphTargets){e=[];for(var i=t.morphTargets[n],r=0,o=i.length;r<o;r++){var a=i[r],s=new pt(3*a.length,3);e.push(s.copyVector3sArray(a))}this.morphAttributes[n]=e}return 0<t.skinIndices.length&&(n=new pt(4*t.skinIndices.length,4),this.addAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new pt(4*t.skinWeights.length,4),this.addAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new q);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new q,e=new o;return function(){null===this.boundingSphere&&(this.boundingSphere=new J);var n=this.attributes.position;if(n){var i=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(i);for(var r=0,o=0,a=n.count;o<a;o++)e.x=n.getX(o),e.y=n.getY(o),e.z=n.getZ(o),r=Math.max(r,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new at(new Float32Array(i.length),3));else for(var r=e.normal.array,a=0,s=r.length;a<s;a++)r[a]=0;r=e.normal.array;var l=new o,u=new o,c=new o,h=new o,d=new o;if(t){t=t.array,0===n.length&&this.addGroup(0,t.length);for(var f=0,p=n.length;f<p;++f){s=(a=n[f]).start;var m=a.count;for(a=s,s+=m;a<s;a+=3){m=3*t[a+0];var g=3*t[a+1],v=3*t[a+2];l.fromArray(i,m),u.fromArray(i,g),c.fromArray(i,v),h.subVectors(c,u),d.subVectors(l,u),h.cross(d),r[m]+=h.x,r[m+1]+=h.y,r[m+2]+=h.z,r[g]+=h.x,r[g+1]+=h.y,r[g+2]+=h.z,r[v]+=h.x,r[v+1]+=h.y,r[v+2]+=h.z}}}else for(a=0,s=i.length;a<s;a+=9)l.fromArray(i,a),u.fromArray(i,a+3),c.fromArray(i,a+6),h.subVectors(c,u),d.subVectors(l,u),h.cross(d),r[a]=h.x,r[a+1]=h.y,r[a+2]=h.z,r[a+3]=h.x,r[a+4]=h.y,r[a+5]=h.z,r[a+6]=h.x,r[a+7]=h.y,r[a+8]=h.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0);var n,i=this.attributes;for(n in i)if(void 0!==t.attributes[n]){var r=i[n].array,o=t.attributes[n],a=o.array,s=0;for(o=o.itemSize*e;s<a.length;s++,o++)r[o]=a[s]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var t=new o;return function(){for(var e=this.attributes.normal,n=0,i=e.count;n<i;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.normalize(),e.setXYZ(n,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t,e=new yt,n=this.index.array,i=this.attributes;for(t in i){for(var r,o=(a=i[t]).array,a=a.itemSize,s=new o.constructor(n.length*a),l=0,u=0,c=n.length;u<c;u++){r=n[u]*a;for(var h=0;h<a;h++)s[l++]=o[r++]}e.addAttribute(t,new at(s,a))}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var i=this.index;null!==i&&(e=Array.prototype.slice.call(i.array),t.data.index={type:i.array.constructor.name,array:e}),i=this.attributes;for(n in i){var r=i[n];e=Array.prototype.slice.call(r.array),t.data.attributes[n]={itemSize:r.itemSize,type:r.array.constructor.name,array:e,normalized:r.normalized}}return 0<(n=this.groups).length&&(t.data.groups=JSON.parse(JSON.stringify(n))),null!==(n=this.boundingSphere)&&(t.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),t},clone:function(){return(new yt).copy(this)},copy:function(t){var e;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var n=t.index;null!==n&&this.setIndex(n.clone()),n=t.attributes;for(a in n)this.addAttribute(a,n[a].clone());var i=t.morphAttributes;for(a in i){var r=[],o=i[a];for(n=0,e=o.length;n<e;n++)r.push(o[n].clone());this.morphAttributes[a]=r}var a=t.groups;for(n=0,e=a.length;n<e;n++)i=a[n],this.addGroup(i.start,i.count,i.materialIndex);return null!==(a=t.boundingBox)&&(this.boundingBox=a.clone()),null!==(a=t.boundingSphere)&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(wt.prototype=Object.create(ot.prototype)).constructor=wt,(bt.prototype=Object.create(yt.prototype)).constructor=bt,(_t.prototype=Object.create(ot.prototype)).constructor=_t,(Et.prototype=Object.create(yt.prototype)).constructor=Et,(Tt.prototype=Object.create(G.prototype)).constructor=Tt,Tt.prototype.isMeshBasicMaterial=!0,Tt.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},(Ct.prototype=Object.create(G.prototype)).constructor=Ct,Ct.prototype.isShaderMaterial=!0,Ct.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ar.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Ct.prototype.toJSON=function(t){return t=G.prototype.toJSON.call(this,t),t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(xt.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new o).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new o;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){return(e=e||new o).subVectors(t,this.origin),0>(t=e.dot(this.direction))?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new o;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return 0>n?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new o,e=new o,n=new o;return function(i,r,o,a){t.copy(i).add(r).multiplyScalar(.5),e.copy(r).sub(i).normalize(),n.copy(this.origin).sub(t);var s=.5*i.distanceTo(r),l=-this.direction.dot(e),u=n.dot(this.direction),c=-n.dot(e),h=n.lengthSq(),d=Math.abs(1-l*l);if(0<d){r=l*u-c;var f=s*d;0<=(i=l*c-u)?r>=-f?r<=f?(s=1/d,i*=s,r*=s,l=i*(i+l*r+2*u)+r*(l*i+r+2*c)+h):(r=s,i=Math.max(0,-(l*r+u)),l=-i*i+r*(r+2*c)+h):(r=-s,i=Math.max(0,-(l*r+u)),l=-i*i+r*(r+2*c)+h):r<=-f?(i=Math.max(0,-(-l*s+u)),r=0<i?-s:Math.min(Math.max(-s,-c),s),l=-i*i+r*(r+2*c)+h):r<=f?(i=0,r=Math.min(Math.max(-s,-c),s),l=r*(r+2*c)+h):(i=Math.max(0,-(l*s+u)),r=0<i?s:Math.min(Math.max(-s,-c),s),l=-i*i+r*(r+2*c)+h)}else r=0<l?-s:s,i=Math.max(0,-(l*r+u)),l=-i*i+r*(r+2*c)+h;return o&&o.copy(this.direction).multiplyScalar(i).add(this.origin),a&&a.copy(e).multiplyScalar(r).add(t),l}}(),intersectSphere:function(){var t=new o;return function(e,n){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),r=t.dot(t)-i*i;return e=e.radius*e.radius,r>e?null:(e=Math.sqrt(e-r),r=i-e,i+=e,0>r&&0>i?null:0>r?this.at(i,n):this.at(r,n))}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){return null===(t=this.distanceToPlane(t))?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e},intersectBox:function(t,e){var n=1/this.direction.x,i=1/this.direction.y,r=1/this.direction.z,o=this.origin;if(0<=n){var a=(t.min.x-o.x)*n;n*=t.max.x-o.x}else a=(t.max.x-o.x)*n,n*=t.min.x-o.x;if(0<=i){var s=(t.min.y-o.y)*i;i*=t.max.y-o.y}else s=(t.max.y-o.y)*i,i*=t.min.y-o.y;return a>i||s>n?null:((s>a||a!=a)&&(a=s),(i<n||n!=n)&&(n=i),0<=r?(s=(t.min.z-o.z)*r,t=(t.max.z-o.z)*r):(s=(t.max.z-o.z)*r,t=(t.min.z-o.z)*r),a>t||s>n?null:((s>a||a!=a)&&(a=s),(t<n||n!=n)&&(n=t),0>n?null:this.at(0<=a?a:n,e)))},intersectsBox:function(){var t=new o;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new o,e=new o,n=new o,i=new o;return function(r,o,a,s,l){if(e.subVectors(o,r),n.subVectors(a,r),i.crossVectors(e,n),0<(o=this.direction.dot(i))){if(s)return null;s=1}else{if(!(0>o))return null;s=-1,o=-o}return t.subVectors(this.origin,r),0>(r=s*this.direction.dot(n.crossVectors(t,n)))?null:0>(a=s*this.direction.dot(e.cross(t)))||r+a>o?null:0>(r=-s*t.dot(i))?null:this.at(r/o,l)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(St.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new o).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new o).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return e=e||new o,this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new o,e=new o;return function(n,i){return t.subVectors(n,this.start),e.subVectors(this.end,this.start),n=e.dot(e),n=e.dot(t)/n,i&&(n=wr.clamp(n,0,1)),n}}(),closestPointToPoint:function(t,e,n){return t=this.closestPointToPointParameter(t,e),n=n||new o,this.delta(n).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(Mt,{normal:function(){var t=new o;return function(e,n,i,r){return(r=r||new o).subVectors(i,n),t.subVectors(e,n),r.cross(t),0<(e=r.lengthSq())?r.multiplyScalar(1/Math.sqrt(e)):r.set(0,0,0)}}(),barycoordFromPoint:function(){var t=new o,e=new o,n=new o;return function(i,r,a,s,l){t.subVectors(s,r),e.subVectors(a,r),n.subVectors(i,r),i=t.dot(t),r=t.dot(e),a=t.dot(n);var u=e.dot(e);s=e.dot(n);var c=i*u-r*r;return l=l||new o,0===c?l.set(-2,-1,-1):(c=1/c,u=(u*a-r*s)*c,i=(i*s-r*a)*c,l.set(1-u-i,i,u))}}(),containsPoint:function(){var t=new o;return function(e,n,i,r){return 0<=(e=Mt.barycoordFromPoint(e,n,i,r,t)).x&&0<=e.y&&1>=e.x+e.y}}()}),Object.assign(Mt.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new o,e=new o;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new o).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return Mt.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new K).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return Mt.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return Mt.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t=new K,e=[new St,new St,new St],n=new o,i=new o;return function(r,a){a=a||new o;var s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,n),!0===this.containsPoint(n))a.copy(n);else for(e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a),r=0;r<e.length;r++){e[r].closestPointToPoint(n,!0,i);var l=n.distanceToSquared(i);l<s&&(s=l,a.copy(i))}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),Ot.prototype=Object.assign(Object.create(et.prototype),{constructor:Ot,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return et.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var e=Object.keys(t);if(0<e.length){var n=t[e[0]];if(void 0!==n)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=n.length;t<e;t++){var i=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}}else if(void 0!==(n=t.morphTargets)&&0<n.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=n.length;t<e;t++)i=n[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t},raycast:function(){function t(t,e,n,i,r,o,a){return Mt.barycoordFromPoint(t,e,n,i,y),r.multiplyScalar(y.x),o.multiplyScalar(y.y),a.multiplyScalar(y.z),r.add(o).add(a),r.clone()}function e(t,e,n,i,r,o,a,s){return null===(1===e.side?i.intersectTriangle(a,o,r,!0,s):i.intersectTriangle(r,o,a,2!==e.side,s))?null:(b.copy(s),b.applyMatrix4(t.matrixWorld),(e=n.ray.origin.distanceTo(b))<n.near||e>n.far?null:{distance:e,point:b.clone(),object:t})}function r(n,i,r,o,a,s,l,d){return u.fromBufferAttribute(o,s),c.fromBufferAttribute(o,l),h.fromBufferAttribute(o,d),(n=e(n,n.material,i,r,u,c,h,w))&&(a&&(m.fromBufferAttribute(a,s),g.fromBufferAttribute(a,l),v.fromBufferAttribute(a,d),n.uv=t(w,u,c,h,m,g,v)),n.face=new rt(s,l,d,Mt.normal(u,c,h)),n.faceIndex=s),n}var a=new i,s=new xt,l=new J,u=new o,c=new o,h=new o,d=new o,f=new o,p=new o,m=new n,g=new n,v=new n,y=new o,w=new o,b=new o;return function(n,i){var o=this.geometry,y=this.material,b=this.matrixWorld;if(void 0!==y&&(null===o.boundingSphere&&o.computeBoundingSphere(),l.copy(o.boundingSphere),l.applyMatrix4(b),!1!==n.ray.intersectsSphere(l)&&(a.getInverse(b),s.copy(n.ray).applyMatrix4(a),null===o.boundingBox||!1!==s.intersectsBox(o.boundingBox)))){var _;if(o.isBufferGeometry){y=o.index;var E,T=o.attributes.position;b=o.attributes.uv;if(null!==y){var C=0;for(E=y.count;C<E;C+=3){o=y.getX(C);var x=y.getX(C+1),S=y.getX(C+2);(_=r(this,n,s,T,b,o,x,S))&&(_.faceIndex=Math.floor(C/3),i.push(_))}}else if(void 0!==T)for(C=0,E=T.count;C<E;C+=3)o=C,x=C+1,S=C+2,(_=r(this,n,s,T,b,o,x,S))&&(_.index=o,i.push(_))}else if(o.isGeometry){b=Array.isArray(y);C=o.vertices,E=o.faces,0<(x=o.faceVertexUvs[0]).length&&(T=x);for(var M=0,O=E.length;M<O;M++){var R=E[M];if(void 0!==(_=b?y[R.materialIndex]:y)){x=C[R.a],S=C[R.b];var A=C[R.c];if(!0===_.morphTargets){var P=o.morphTargets,N=this.morphTargetInfluences;u.set(0,0,0),c.set(0,0,0),h.set(0,0,0);for(var k=0,L=P.length;k<L;k++){var D=N[k];if(0!==D){var I=P[k].vertices;u.addScaledVector(d.subVectors(I[R.a],x),D),c.addScaledVector(f.subVectors(I[R.b],S),D),h.addScaledVector(p.subVectors(I[R.c],A),D)}}u.add(x),c.add(S),h.add(A),x=u,S=c,A=h}(_=e(this,_,n,s,x,S,A,w))&&(T&&T[M]&&(P=T[M],m.copy(P[0]),g.copy(P[1]),v.copy(P[2]),_.uv=t(w,x,S,A,m,g,v)),_.face=R,_.faceIndex=M,i.push(_))}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Hr=0;zt.prototype=Object.assign(Object.create(nt.prototype),{constructor:zt,isPerspectiveCamera:!0,copy:function(t,e){return nt.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*wr.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*wr.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*wr.RAD2DEG*Math.atan(Math.tan(.5*wr.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=2*(a=t*Math.tan(.5*wr.DEG2RAD*this.fov)/this.zoom),n=-.5*(s=this.aspect*e),i=this.view;if(null!==this.view&&this.view.enabled){var r=i.fullWidth,o=i.fullHeight,a=(n=n+i.offsetX*s/r,a-i.offsetY*e/o),s=i.width/r*s;e=i.height/o*e}0!==(i=this.filmOffset)&&(n+=t*i/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+s,a,a-e,t,this.far)},toJSON:function(t){return t=et.prototype.toJSON.call(this,t),t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Vt.prototype=Object.assign(Object.create(zt.prototype),{constructor:Vt,isArrayCamera:!0}),Xt.prototype.isFogExp2=!0,Xt.prototype.clone=function(){return new Xt(this.color.getHex(),this.density)},Xt.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},qt.prototype.isFog=!0,qt.prototype.clone=function(){return new qt(this.color.getHex(),this.near,this.far)},qt.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Jt.prototype=Object.assign(Object.create(et.prototype),{constructor:Jt,copy:function(t,e){return et.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=et.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),Kt.prototype=Object.assign(Object.create(et.prototype),{constructor:Kt,isLensFlare:!0,copy:function(t){et.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,n,i,r,o){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=new z(16777215)),void 0===i&&(i=1),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:r,blending:i})},updateLensFlares:function(){var t,e=this.lensFlares.length,n=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(t=0;t<e;t++){var r=this.lensFlares[t];r.x=this.positionScreen.x+n*r.distance,r.y=this.positionScreen.y+i*r.distance,r.wantedRotation=r.x*Math.PI*.25,r.rotation+=.25*(r.wantedRotation-r.rotation)}}}),(Zt.prototype=Object.create(G.prototype)).constructor=Zt,Zt.prototype.isSpriteMaterial=!0,Zt.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},$t.prototype=Object.assign(Object.create(et.prototype),{constructor:$t,isSprite:!0,raycast:function(){var t=new o,e=new o,n=new o;return function(i,r){e.setFromMatrixPosition(this.matrixWorld),i.ray.closestPointToPoint(e,t),n.setFromMatrixScale(this.matrixWorld);var o=n.x*n.y/4;e.distanceToSquared(t)>o||(o=i.ray.origin.distanceTo(t))<i.near||o>i.far||r.push({distance:o,point:t.clone(),face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),Qt.prototype=Object.assign(Object.create(et.prototype),{constructor:Qt,copy:function(t){et.prototype.copy.call(this,t,!1);for(var e=0,n=(t=t.levels).length;e<n;e++){var i=t[e];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,i=0;i<n.length&&!(e<n[i].distance);i++);n.splice(i,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new o;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(e,n)}}(),update:function(){var t=new o,e=new o;return function(n){var i=this.levels;if(1<i.length){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),n=t.distanceTo(e),i[0].object.visible=!0;for(var r=1,o=i.length;r<o&&n>=i[r].distance;r++)i[r-1].object.visible=!1,i[r].object.visible=!0;for(;r<o;r++)i[r].object.visible=!1}}}(),toJSON:function(t){(t=et.prototype.toJSON.call(this,t)).object.levels=[];for(var e=this.levels,n=0,i=e.length;n<i;n++){var r=e[n];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}}),Object.assign(te.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new i;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n=0;for(e=this.bones.length;n<e;n++)(t=this.bones[n])&&t.matrixWorld.getInverse(this.boneInverses[n]);for(n=0,e=this.bones.length;n<e;n++)(t=this.bones[n])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new i,e=new i;return function(){for(var n=this.bones,i=this.boneInverses,r=this.boneMatrices,o=this.boneTexture,a=0,s=n.length;a<s;a++)t.multiplyMatrices(n[a]?n[a].matrixWorld:e,i[a]),t.toArray(r,16*a);void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new te(this.bones,this.boneInverses)}}),ee.prototype=Object.assign(Object.create(et.prototype),{constructor:ee,isBone:!0}),ne.prototype=Object.assign(Object.create(Ot.prototype),{constructor:ne,isSkinnedMesh:!0,initBones:function(){var t,e=[];if(this.geometry&&void 0!==this.geometry.bones){var n=0;for(t=this.geometry.bones.length;n<t;n++){var i=this.geometry.bones[n],r=new ee;e.push(r),r.name=i.name,r.position.fromArray(i.pos),r.quaternion.fromArray(i.rotq),void 0!==i.scl&&r.scale.fromArray(i.scl)}for(n=0,t=this.geometry.bones.length;n<t;n++)-1!==(i=this.geometry.bones[n]).parent&&null!==i.parent&&void 0!==e[i.parent]?e[i.parent].add(e[n]):this.add(e[n])}return this.updateMatrixWorld(!0),e},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var e=1/(n=this.geometry.skinWeights[t]).manhattanLength();1/0!==e?n.multiplyScalar(e):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new l,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++)n.x=i.getX(t),n.y=i.getY(t),n.z=i.getZ(t),n.w=i.getW(t),e=1/n.manhattanLength(),1/0!==e?n.multiplyScalar(e):n.set(1,0,0,0),i.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(t){Ot.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),(ie.prototype=Object.create(G.prototype)).constructor=ie,ie.prototype.isLineBasicMaterial=!0,ie.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},re.prototype=Object.assign(Object.create(et.prototype),{constructor:re,isLine:!0,raycast:function(){var t=new i,e=new xt,n=new J;return function(i,r){var a=(a=i.linePrecision)*a,s=this.geometry,l=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(l),!1!==i.ray.intersectsSphere(n)){t.getInverse(l),e.copy(i.ray).applyMatrix4(t);var u=new o,c=new o,h=(l=new o,new o),d=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var f=s.index,p=s.attributes.position.array;if(null!==f)for(var m=f.array,g=(s=0,m.length-1);s<g;s+=d)f=m[s+1],u.fromArray(p,3*m[s]),c.fromArray(p,3*f),(f=e.distanceSqToSegment(u,c,h,l))>a||(h.applyMatrix4(this.matrixWorld),(f=i.ray.origin.distanceTo(h))<i.near||f>i.far||r.push({distance:f,point:l.clone().applyMatrix4(this.matrixWorld),index:s,face:null,faceIndex:null,object:this}));else for(s=0,g=p.length/3-1;s<g;s+=d)u.fromArray(p,3*s),c.fromArray(p,3*s+3),(f=e.distanceSqToSegment(u,c,h,l))>a||(h.applyMatrix4(this.matrixWorld),(f=i.ray.origin.distanceTo(h))<i.near||f>i.far||r.push({distance:f,point:l.clone().applyMatrix4(this.matrixWorld),index:s,face:null,faceIndex:null,object:this}))}else if(s.isGeometry)for(u=s.vertices,c=u.length,s=0;s<c-1;s+=d)(f=e.distanceSqToSegment(u[s],u[s+1],h,l))>a||(h.applyMatrix4(this.matrixWorld),(f=i.ray.origin.distanceTo(h))<i.near||f>i.far||r.push({distance:f,point:l.clone().applyMatrix4(this.matrixWorld),index:s,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),oe.prototype=Object.assign(Object.create(re.prototype),{constructor:oe,isLineSegments:!0}),ae.prototype=Object.assign(Object.create(re.prototype),{constructor:ae,isLineLoop:!0}),(se.prototype=Object.create(G.prototype)).constructor=se,se.prototype.isPointsMaterial=!0,se.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},le.prototype=Object.assign(Object.create(et.prototype),{constructor:le,isPoints:!0,raycast:function(){var t=new i,e=new xt,n=new J;return function(i,r){function a(t,n){var o=e.distanceSqToPoint(t);if(o<h){(t=e.closestPointToPoint(t)).applyMatrix4(u);var a=i.ray.origin.distanceTo(t);a<i.near||a>i.far||r.push({distance:a,distanceToRay:Math.sqrt(o),point:t.clone(),index:n,face:null,object:s})}}var s=this,l=this.geometry,u=this.matrixWorld,c=i.params.Points.threshold;if(null===l.boundingSphere&&l.computeBoundingSphere(),n.copy(l.boundingSphere),n.applyMatrix4(u),n.radius+=c,!1!==i.ray.intersectsSphere(n)){t.getInverse(u),e.copy(i.ray).applyMatrix4(t);var h=(c=c/((this.scale.x+this.scale.y+this.scale.z)/3))*c;c=new o;if(l.isBufferGeometry){var d=l.index;l=l.attributes.position.array;if(null!==d)for(var f=d.array,p=(d=0,f.length);d<p;d++){var m=f[d];c.fromArray(l,3*m),a(c,m)}else for(d=0,f=l.length/3;d<f;d++)c.fromArray(l,3*d),a(c,d)}else for(c=l.vertices,d=0,f=c.length;d<f;d++)a(c[d],d)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ue.prototype=Object.assign(Object.create(et.prototype),{constructor:ue,isGroup:!0}),ce.prototype=Object.assign(Object.create(s.prototype),{constructor:ce,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(he.prototype=Object.create(s.prototype)).constructor=he,he.prototype.isCompressedTexture=!0,(de.prototype=Object.create(s.prototype)).constructor=de,de.prototype.isDepthTexture=!0,(fe.prototype=Object.create(yt.prototype)).constructor=fe,(pe.prototype=Object.create(ot.prototype)).constructor=pe,(me.prototype=Object.create(yt.prototype)).constructor=me,(ge.prototype=Object.create(ot.prototype)).constructor=ge,(ve.prototype=Object.create(yt.prototype)).constructor=ve,(ye.prototype=Object.create(ot.prototype)).constructor=ye,(we.prototype=Object.create(ve.prototype)).constructor=we,(be.prototype=Object.create(ot.prototype)).constructor=be,(_e.prototype=Object.create(ve.prototype)).constructor=_e,(Ee.prototype=Object.create(ot.prototype)).constructor=Ee,(Te.prototype=Object.create(ve.prototype)).constructor=Te,(Ce.prototype=Object.create(ot.prototype)).constructor=Ce,(xe.prototype=Object.create(ve.prototype)).constructor=xe,(Se.prototype=Object.create(ot.prototype)).constructor=Se,(Me.prototype=Object.create(yt.prototype)).constructor=Me,(Oe.prototype=Object.create(ot.prototype)).constructor=Oe,(Re.prototype=Object.create(yt.prototype)).constructor=Re,(Ae.prototype=Object.create(ot.prototype)).constructor=Ae,(Pe.prototype=Object.create(yt.prototype)).constructor=Pe;var Ur=function(t,e,n){n=n||2;var i=(u=e&&e.length)?e[0]*n:t.length,r=Ne(t,0,i,n,!0),o=[];if(!r)return o;var a;if(u){var s,l=n,u=[],c=0;for(s=e.length;c<s;c++){var h=e[c]*l;(h=Ne(t,h,c<s-1?e[c+1]*l:t.length,l,!1))===h.next&&(h.steiner=!0),u.push(Ue(h))}for(u.sort(De),c=0;c<u.length;c++)(l=Ie(e=u[c],l=r))&&(e=We(l,e),ke(e,e.next)),r=ke(r,r.next)}if(t.length>80*n){var d=a=t[0],f=u=t[1];for(l=n;l<i;l+=n)c=t[l],e=t[l+1],c<d&&(d=c),e<f&&(f=e),c>a&&(a=c),e>u&&(u=e);a=0!==(a=Math.max(a-d,u-f))?1/a:0}return Le(r,o,n,d,f,a),o},Fr={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},isClockWise:function(t){return 0>Fr.area(t)},triangulateShape:function(t,e){function n(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function i(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}var r=[],o=[],a=[];n(t),i(r,t);var s=t.length;for(e.forEach(n),t=0;t<e.length;t++)o.push(s),s+=e[t].length,i(r,e[t]);for(e=Ur(r,o),t=0;t<e.length;t+=3)a.push(e.slice(t,t+3));return a}};(qe.prototype=Object.create(ot.prototype)).constructor=qe,(Je.prototype=Object.create(yt.prototype)).constructor=Je,Je.prototype.getArrays=function(){var t,e,n;return{position:t=(t=this.getAttribute("position"))?Array.prototype.slice.call(t.array):[],uv:e=(e=this.getAttribute("uv"))?Array.prototype.slice.call(e.array):[],index:n=(n=this.index)?Array.prototype.slice.call(n.array):[]}},Je.prototype.addShapeList=function(t,e){var n=t.length;e.arrays=this.getArrays();for(var i=0;i<n;i++)this.addShape(t[i],e);this.setIndex(e.arrays.index),this.addAttribute("position",new pt(e.arrays.position,3)),this.addAttribute("uv",new pt(e.arrays.uv,2))},Je.prototype.addShape=function(t,e){function i(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function r(t,e,i){var r=t.x-e.x,o=t.y-e.y,a=i.x-t.x,s=i.y-t.y,l=r*r+o*o;if(Math.abs(r*s-o*a)>Number.EPSILON){var u=Math.sqrt(l),c=Math.sqrt(a*a+s*s);l=e.x-o/u;if(e=e.y+r/u,s=((i.x-s/c-l)*s-(i.y+a/c-e)*a)/(r*s-o*a),a=l+r*s-t.x,r=e+o*s-t.y,2>=(o=a*a+r*r))return new n(a,r);o=Math.sqrt(o/2)}else t=!1,r>Number.EPSILON?a>Number.EPSILON&&(t=!0):r<-Number.EPSILON?a<-Number.EPSILON&&(t=!0):Math.sign(o)===Math.sign(s)&&(t=!0),t?(a=-o,o=Math.sqrt(l)):(a=r,r=o,o=Math.sqrt(l/2));return new n(a/o,r/o)}function a(t,e){for(j=t.length;0<=--j;){var n=j,i=j-1;0>i&&(i=t.length-1);var r,o=_+2*y;for(r=0;r<o;r++){var a=F*r,s=e+i+a,l=e+i+(d=F*(r+1)),d=e+n+d;u(e+n+a),u(s),u(d),u(s),u(l),u(d),a=h.length/3,c((a=C.generateSideWallUV(P,h,a-6,a-3,a-2,a-1))[0]),c(a[1]),c(a[3]),c(a[1]),c(a[2]),c(a[3])}}}function s(t,e,n){p.push(t),p.push(e),p.push(n)}function l(t,e,n){u(t),u(e),u(n),t=h.length/3,c((t=C.generateTopUV(P,h,t-3,t-2,t-1))[0]),c(t[1]),c(t[2])}function u(t){d.push(h.length/3),h.push(p[3*t+0]),h.push(p[3*t+1]),h.push(p[3*t+2])}function c(t){f.push(t.x),f.push(t.y)}var h=(m=e.arrays?e.arrays:this.getArrays()).position,d=m.index,f=m.uv,p=[],m=void 0!==e.amount?e.amount:100,g=void 0!==e.bevelThickness?e.bevelThickness:6,v=void 0!==e.bevelSize?e.bevelSize:g-2,y=void 0!==e.bevelSegments?e.bevelSegments:3,w=void 0===e.bevelEnabled||e.bevelEnabled,b=void 0!==e.curveSegments?e.curveSegments:12,_=void 0!==e.steps?e.steps:1,E=e.extrudePath,T=!1,C=void 0!==e.UVGenerator?e.UVGenerator:qe.WorldUVGenerator;if(E){var x=E.getSpacedPoints(_);T=!0,w=!1;var S=void 0!==e.frames?e.frames:E.computeFrenetFrames(_,!1),M=new o,O=new o,R=new o}w||(v=g=y=0);var A,P=this;t=(b=t.extractPoints(b)).shape;var N=b.holes;if(!Fr.isClockWise(t)){t=t.reverse();var k=0;for(A=N.length;k<A;k++){var L=N[k];Fr.isClockWise(L)&&(N[k]=L.reverse())}}var D=Fr.triangulateShape(t,N),I=t;for(k=0,A=N.length;k<A;k++)L=N[k],t=t.concat(L);var H,U,F=t.length,B=D.length,j=(b=[],0),z=I.length,V=z-1;for(H=j+1;j<z;j++,V++,H++)V===z&&(V=0),H===z&&(H=0),b[j]=r(I[j],I[V],I[H]);E=[];var W=b.concat();for(k=0,A=N.length;k<A;k++){L=N[k];var G=[];for(j=0,V=(z=L.length)-1,H=j+1;j<z;j++,V++,H++)V===z&&(V=0),H===z&&(H=0),G[j]=r(L[j],L[V],L[H]);E.push(G),W=W.concat(G)}for(V=0;V<y;V++){z=V/y;var Y=g*Math.cos(z*Math.PI/2);for(H=v*Math.sin(z*Math.PI/2),j=0,z=I.length;j<z;j++){var X=i(I[j],b[j],H);s(X.x,X.y,-Y)}for(k=0,A=N.length;k<A;k++)for(L=N[k],G=E[k],j=0,z=L.length;j<z;j++)X=i(L[j],G[j],H),s(X.x,X.y,-Y)}for(H=v,j=0;j<F;j++)X=w?i(t[j],W[j],H):t[j],T?(O.copy(S.normals[0]).multiplyScalar(X.x),M.copy(S.binormals[0]).multiplyScalar(X.y),R.copy(x[0]).add(O).add(M),s(R.x,R.y,R.z)):s(X.x,X.y,0);for(z=1;z<=_;z++)for(j=0;j<F;j++)X=w?i(t[j],W[j],H):t[j],T?(O.copy(S.normals[z]).multiplyScalar(X.x),M.copy(S.binormals[z]).multiplyScalar(X.y),R.copy(x[z]).add(O).add(M),s(R.x,R.y,R.z)):s(X.x,X.y,m/_*z);for(V=y-1;0<=V;V--){for(z=V/y,Y=g*Math.cos(z*Math.PI/2),H=v*Math.sin(z*Math.PI/2),j=0,z=I.length;j<z;j++)X=i(I[j],b[j],H),s(X.x,X.y,m+Y);for(k=0,A=N.length;k<A;k++)for(L=N[k],G=E[k],j=0,z=L.length;j<z;j++)X=i(L[j],G[j],H),T?s(X.x,X.y+x[_-1].y,x[_-1].x+Y):s(X.x,X.y,m+Y)}!function(){var t=h.length/3;if(w){var n=0*F;for(j=0;j<B;j++)U=D[j],l(U[2]+n,U[1]+n,U[0]+n);for(n=F*(_+2*y),j=0;j<B;j++)U=D[j],l(U[0]+n,U[1]+n,U[2]+n)}else{for(j=0;j<B;j++)U=D[j],l(U[2],U[1],U[0]);for(j=0;j<B;j++)U=D[j],l(U[0]+F*_,U[1]+F*_,U[2]+F*_)}P.addGroup(t,h.length/3-t,void 0!==e.material?e.material:0)}(),function(){var t=h.length/3,n=0;for(a(I,n),n+=I.length,k=0,A=N.length;k<A;k++)L=N[k],a(L,n),n+=L.length;P.addGroup(t,h.length/3-t,void 0!==e.extrudeMaterial?e.extrudeMaterial:1)}(),e.arrays||(this.setIndex(d),this.addAttribute("position",new pt(h,3)),this.addAttribute("uv",new pt(f,2)))},qe.WorldUVGenerator={generateTopUV:function(t,e,i,r,o){t=e[3*r],r=e[3*r+1];var a=e[3*o];return o=e[3*o+1],[new n(e[3*i],e[3*i+1]),new n(t,r),new n(a,o)]},generateSideWallUV:function(t,e,i,r,o,a){t=e[3*i];var s=e[3*i+1];i=e[3*i+2];var l=e[3*r],u=e[3*r+1];r=e[3*r+2];var c=e[3*o],h=e[3*o+1];o=e[3*o+2];var d=e[3*a],f=e[3*a+1];return e=e[3*a+2],.01>Math.abs(s-u)?[new n(t,1-i),new n(l,1-r),new n(c,1-o),new n(d,1-e)]:[new n(s,1-i),new n(u,1-r),new n(h,1-o),new n(f,1-e)]}},(Ke.prototype=Object.create(ot.prototype)).constructor=Ke,(Ze.prototype=Object.create(Je.prototype)).constructor=Ze,($e.prototype=Object.create(ot.prototype)).constructor=$e,(Qe.prototype=Object.create(yt.prototype)).constructor=Qe,(tn.prototype=Object.create(ot.prototype)).constructor=tn,(en.prototype=Object.create(yt.prototype)).constructor=en,(nn.prototype=Object.create(ot.prototype)).constructor=nn,(rn.prototype=Object.create(yt.prototype)).constructor=rn,(on.prototype=Object.create(ot.prototype)).constructor=on,on.prototype.toJSON=function(){var t=ot.prototype.toJSON.call(this);return sn(this.parameters.shapes,t)},(an.prototype=Object.create(yt.prototype)).constructor=an,an.prototype.toJSON=function(){var t=yt.prototype.toJSON.call(this);return sn(this.parameters.shapes,t)},(ln.prototype=Object.create(yt.prototype)).constructor=ln,(un.prototype=Object.create(ot.prototype)).constructor=un,(cn.prototype=Object.create(yt.prototype)).constructor=cn,(hn.prototype=Object.create(un.prototype)).constructor=hn,(dn.prototype=Object.create(cn.prototype)).constructor=dn,(fn.prototype=Object.create(ot.prototype)).constructor=fn,(pn.prototype=Object.create(yt.prototype)).constructor=pn;var Br=Object.freeze({WireframeGeometry:fe,ParametricGeometry:pe,ParametricBufferGeometry:me,TetrahedronGeometry:ye,TetrahedronBufferGeometry:we,OctahedronGeometry:be,OctahedronBufferGeometry:_e,IcosahedronGeometry:Ee,IcosahedronBufferGeometry:Te,DodecahedronGeometry:Ce,DodecahedronBufferGeometry:xe,PolyhedronGeometry:ge,PolyhedronBufferGeometry:ve,TubeGeometry:Se,TubeBufferGeometry:Me,TorusKnotGeometry:Oe,TorusKnotBufferGeometry:Re,TorusGeometry:Ae,TorusBufferGeometry:Pe,TextGeometry:Ke,TextBufferGeometry:Ze,SphereGeometry:$e,SphereBufferGeometry:Qe,RingGeometry:tn,RingBufferGeometry:en,PlaneGeometry:_t,PlaneBufferGeometry:Et,LatheGeometry:nn,LatheBufferGeometry:rn,ShapeGeometry:on,ShapeBufferGeometry:an,ExtrudeGeometry:qe,ExtrudeBufferGeometry:Je,EdgesGeometry:ln,ConeGeometry:hn,ConeBufferGeometry:dn,CylinderGeometry:un,CylinderBufferGeometry:cn,CircleGeometry:fn,CircleBufferGeometry:pn,BoxGeometry:wt,BoxBufferGeometry:bt});(mn.prototype=Object.create(G.prototype)).constructor=mn,mn.prototype.isShadowMaterial=!0,(gn.prototype=Object.create(Ct.prototype)).constructor=gn,gn.prototype.isRawShaderMaterial=!0,(vn.prototype=Object.create(G.prototype)).constructor=vn,vn.prototype.isMeshStandardMaterial=!0,vn.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(yn.prototype=Object.create(vn.prototype)).constructor=yn,yn.prototype.isMeshPhysicalMaterial=!0,yn.prototype.copy=function(t){return vn.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},(wn.prototype=Object.create(G.prototype)).constructor=wn,wn.prototype.isMeshPhongMaterial=!0,wn.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(bn.prototype=Object.create(wn.prototype)).constructor=bn,bn.prototype.isMeshToonMaterial=!0,bn.prototype.copy=function(t){return wn.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},(_n.prototype=Object.create(G.prototype)).constructor=_n,_n.prototype.isMeshNormalMaterial=!0,_n.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(En.prototype=Object.create(G.prototype)).constructor=En,En.prototype.isMeshLambertMaterial=!0,En.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Tn.prototype=Object.create(ie.prototype)).constructor=Tn,Tn.prototype.isLineDashedMaterial=!0,Tn.prototype.copy=function(t){return ie.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var jr=Object.freeze({ShadowMaterial:mn,SpriteMaterial:Zt,RawShaderMaterial:gn,ShaderMaterial:Ct,PointsMaterial:se,MeshPhysicalMaterial:yn,MeshStandardMaterial:vn,MeshPhongMaterial:wn,MeshToonMaterial:bn,MeshNormalMaterial:_n,MeshLambertMaterial:En,MeshDepthMaterial:Y,MeshDistanceMaterial:X,MeshBasicMaterial:Tt,LineDashedMaterial:Tn,LineBasicMaterial:ie,Material:G}),zr={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Vr=new Cn,Wr={};Object.assign(xn.prototype,{load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,o=zr.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;if(void 0===Wr[t]){if(s=t.match(/^data:(.*?)(;base64)?,(.*)$/)){n=s[1];var a=!!s[2],s=s[3];s=window.decodeURIComponent(s);a&&(s=window.atob(s));try{var l=(this.responseType||"").toLowerCase();switch(l){case"arraybuffer":case"blob":var u=new Uint8Array(s.length);for(a=0;a<s.length;a++)u[a]=s.charCodeAt(a);var c="blob"===l?new Blob([u.buffer],{type:n}):u.buffer;break;case"document":c=(new DOMParser).parseFromString(s,n);break;case"json":c=JSON.parse(s);break;default:c=s}window.setTimeout(function(){e&&e(c),r.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){i&&i(e),r.manager.itemEnd(t),r.manager.itemError(t)},0)}}else{Wr[t]=[],Wr[t].push({onLoad:e,onProgress:n,onError:i});var h=new XMLHttpRequest;h.open("GET",t,!0),h.addEventListener("load",function(e){var n=this.response;zr.add(t,n);var i=Wr[t];if(delete Wr[t],200===this.status){for(var o=0,a=i.length;o<a;o++){var s=i[o];s.onLoad&&s.onLoad(n)}r.manager.itemEnd(t)}else if(0===this.status){for(console.warn("THREE.FileLoader: HTTP Status 0 received."),o=0,a=i.length;o<a;o++)(s=i[o]).onLoad&&s.onLoad(n);r.manager.itemEnd(t)}else{for(o=0,a=i.length;o<a;o++)(s=i[o]).onError&&s.onError(e);r.manager.itemEnd(t),r.manager.itemError(t)}},!1),h.addEventListener("progress",function(e){for(var n=Wr[t],i=0,r=n.length;i<r;i++){var o=n[i];o.onProgress&&o.onProgress(e)}},!1),h.addEventListener("error",function(e){var n=Wr[t];delete Wr[t];for(var i=0,o=n.length;i<o;i++){var a=n[i];a.onError&&a.onError(e)}r.manager.itemEnd(t),r.manager.itemError(t)},!1),void 0!==this.responseType&&(h.responseType=this.responseType),void 0!==this.withCredentials&&(h.withCredentials=this.withCredentials),h.overrideMimeType&&h.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(a in this.requestHeader)h.setRequestHeader(a,this.requestHeader[a]);h.send(null)}return r.manager.itemStart(t),h}Wr[t].push({onLoad:e,onProgress:n,onError:i})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(Sn.prototype,{load:function(t,e,n,i){function r(r){u.load(t[r],function(t){t=a._parser(t,!0),s[r]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(o+=1)&&(1===t.mipmapCount&&(l.minFilter=1006),l.format=t.format,l.needsUpdate=!0,e&&e(l))},n,i)}var o,a=this,s=[],l=new he;l.image=s;var u=new xn(this.manager);if(u.setPath(this.path),u.setResponseType("arraybuffer"),Array.isArray(t))for(var c=o=0,h=t.length;c<h;++c)r(c);else u.load(t,function(t){if((t=a._parser(t,!0)).isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,i=0;i<n;i++){s[i]={mipmaps:[]};for(var r=0;r<t.mipmapCount;r++)s[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+r]),s[i].format=t.format,s[i].width=t.width,s[i].height=t.height}else l.image.width=t.width,l.image.height=t.height,l.mipmaps=t.mipmaps;1===t.mipmapCount&&(l.minFilter=1006),l.format=t.format,l.needsUpdate=!0,e&&e(l)},n,i);return l},setPath:function(t){return this.path=t,this}}),Object.assign(Mn.prototype,{load:function(t,e,n,i){var r=this,o=new h,a=new xn(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){(t=r._parser(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:1001,o.wrapT=void 0!==t.wrapT?t.wrapT:1001,o.magFilter=void 0!==t.magFilter?t.magFilter:1006,o.minFilter=void 0!==t.minFilter?t.minFilter:1008,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,e&&e(o,t))},n,i),o}}),Object.assign(On.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,o=zr.get(t);return void 0!==o?(r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o):((n=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",function(){zr.add(t,this),e&&e(this),r.manager.itemEnd(t)},!1),n.addEventListener("error",function(e){i&&i(e),r.manager.itemEnd(t),r.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(n.crossOrigin=this.crossOrigin),r.manager.itemStart(t),n.src=t,n)},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Rn.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,i){function r(n){a.load(t[n],function(t){o.images[n]=t,6===++s&&(o.needsUpdate=!0,e&&e(o))},void 0,i)}var o=new d,a=new On(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var s=0;for(n=0;n<t.length;++n)r(n);return o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(An.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,i){var r=new s,o=new On(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(n){r.image=n,n=0<t.search(/\.(jpg|jpeg)$/)||0===t.search(/^data\:image\/jpeg/),r.format=n?1022:1023,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Pn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){return t=this.getUtoTmapping(t),this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n=[],i=this.getPoint(0),r=0;for(n.push(0),e=1;e<=t;e++){var o=this.getPoint(e/t);r+=o.distanceTo(i),n.push(r),i=o}return this.cacheArcLengths=n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n=this.getLengths(),i=n.length;e=e||t*n[i-1];for(var r,o=0,a=i-1;o<=a;)if(t=Math.floor(o+(a-o)/2),0>(r=n[t]-e))o=t+1;else{if(!(0<r)){a=t;break}a=t-1}return t=a,n[t]===e?t/(i-1):(o=n[t],(t+(e-o)/(n[t+1]-o))/(i-1))},getTangent:function(t){var e=t-1e-4;return t+=1e-4,0>e&&(e=0),1<t&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},computeFrenetFrames:function(t,e){var n,r=new o,a=[],s=[],l=[],u=new o,c=new i;for(n=0;n<=t;n++){var h=n/t;a[n]=this.getTangentAt(h),a[n].normalize()}s[0]=new o,l[0]=new o,n=Number.MAX_VALUE,h=Math.abs(a[0].x);var d=Math.abs(a[0].y),f=Math.abs(a[0].z);for(h<=n&&(n=h,r.set(1,0,0)),d<=n&&(n=d,r.set(0,1,0)),f<=n&&r.set(0,0,1),u.crossVectors(a[0],r).normalize(),s[0].crossVectors(a[0],u),l[0].crossVectors(a[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),l[n]=l[n-1].clone(),u.crossVectors(a[n-1],a[n]),u.length()>Number.EPSILON&&(u.normalize(),r=Math.acos(wr.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(u,r))),l[n].crossVectors(a[n],s[n]);if(!0===e)for(r=Math.acos(wr.clamp(s[0].dot(s[t]),-1,1)),r/=t,0<a[0].dot(u.crossVectors(s[0],s[t]))&&(r=-r),n=1;n<=t;n++)s[n].applyMatrix4(c.makeRotationAxis(a[n],r*n)),l[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(Nn.prototype=Object.create(Pn.prototype)).constructor=Nn,Nn.prototype.isEllipseCurve=!0,Nn.prototype.getPoint=function(t,e){e=e||new n;for(var i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,o=Math.abs(r)<Number.EPSILON;0>r;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=o?0:i),!0!==this.aClockwise||o||(r=r===i?-i:r-i),i=this.aStartAngle+t*r,t=this.aX+this.xRadius*Math.cos(i);var a=this.aY+this.yRadius*Math.sin(i);return 0!==this.aRotation&&(i=Math.cos(this.aRotation),r=Math.sin(this.aRotation),o=t-this.aX,a-=this.aY,t=o*i-a*r+this.aX,a=o*r+a*i+this.aY),e.set(t,a)},Nn.prototype.copy=function(t){return Pn.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Nn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Nn.prototype.fromJSON=function(t){return Pn.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(kn.prototype=Object.create(Nn.prototype)).constructor=kn,kn.prototype.isArcCurve=!0;var Gr=new o,Yr=new Ln,Xr=new Ln,qr=new Ln;(Dn.prototype=Object.create(Pn.prototype)).constructor=Dn,Dn.prototype.isCatmullRomCurve3=!0,Dn.prototype.getPoint=function(t,e){e=e||new o;var n=this.points;t*=(l=n.length)-(this.closed?0:1);if(t-=u=Math.floor(t),this.closed?u+=0<u?0:(Math.floor(Math.abs(u)/n.length)+1)*n.length:0===t&&u===l-1&&(u=l-2,t=1),this.closed||0<u)var i=n[(u-1)%l];else Gr.subVectors(n[0],n[1]).add(n[0]),i=Gr;var r=n[u%l],a=n[(u+1)%l];if(this.closed||u+2<l?n=n[(u+2)%l]:(Gr.subVectors(n[l-1],n[l-2]).add(n[l-1]),n=Gr),"centripetal"===this.curveType||"chordal"===this.curveType){var s="chordal"===this.curveType?.5:.25,l=Math.pow(i.distanceToSquared(r),s),u=Math.pow(r.distanceToSquared(a),s);s=Math.pow(a.distanceToSquared(n),s);1e-4>u&&(u=1),1e-4>l&&(l=u),1e-4>s&&(s=u),Yr.initNonuniformCatmullRom(i.x,r.x,a.x,n.x,l,u,s),Xr.initNonuniformCatmullRom(i.y,r.y,a.y,n.y,l,u,s),qr.initNonuniformCatmullRom(i.z,r.z,a.z,n.z,l,u,s)}else"catmullrom"===this.curveType&&(Yr.initCatmullRom(i.x,r.x,a.x,n.x,this.tension),Xr.initCatmullRom(i.y,r.y,a.y,n.y,this.tension),qr.initCatmullRom(i.z,r.z,a.z,n.z,this.tension));return e.set(Yr.calc(t),Xr.calc(t),qr.calc(t)),e},Dn.prototype.copy=function(t){Pn.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Dn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Dn.prototype.fromJSON=function(t){Pn.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var i=t.points[e];this.points.push((new o).fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(Fn.prototype=Object.create(Pn.prototype)).constructor=Fn,Fn.prototype.isCubicBezierCurve=!0,Fn.prototype.getPoint=function(t,e){e=e||new n;var i=this.v0,r=this.v1,o=this.v2,a=this.v3;return e.set(Un(t,i.x,r.x,o.x,a.x),Un(t,i.y,r.y,o.y,a.y)),e},Fn.prototype.copy=function(t){return Pn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Fn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Fn.prototype.fromJSON=function(t){return Pn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(Bn.prototype=Object.create(Pn.prototype)).constructor=Bn,Bn.prototype.isCubicBezierCurve3=!0,Bn.prototype.getPoint=function(t,e){e=e||new o;var n=this.v0,i=this.v1,r=this.v2,a=this.v3;return e.set(Un(t,n.x,i.x,r.x,a.x),Un(t,n.y,i.y,r.y,a.y),Un(t,n.z,i.z,r.z,a.z)),e},Bn.prototype.copy=function(t){return Pn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Bn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Bn.prototype.fromJSON=function(t){return Pn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(jn.prototype=Object.create(Pn.prototype)).constructor=jn,jn.prototype.isLineCurve=!0,jn.prototype.getPoint=function(t,e){return e=e||new n,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},jn.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},jn.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},jn.prototype.copy=function(t){return Pn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},jn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},jn.prototype.fromJSON=function(t){return Pn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(zn.prototype=Object.create(Pn.prototype)).constructor=zn,zn.prototype.isLineCurve3=!0,zn.prototype.getPoint=function(t,e){return e=e||new o,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},zn.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},zn.prototype.copy=function(t){return Pn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},zn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},zn.prototype.fromJSON=function(t){return Pn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Vn.prototype=Object.create(Pn.prototype)).constructor=Vn,Vn.prototype.isQuadraticBezierCurve=!0,Vn.prototype.getPoint=function(t,e){e=e||new n;var i=this.v0,r=this.v1,o=this.v2;return e.set(Hn(t,i.x,r.x,o.x),Hn(t,i.y,r.y,o.y)),e},Vn.prototype.copy=function(t){return Pn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Vn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Vn.prototype.fromJSON=function(t){return Pn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Wn.prototype=Object.create(Pn.prototype)).constructor=Wn,Wn.prototype.isQuadraticBezierCurve3=!0,Wn.prototype.getPoint=function(t,e){e=e||new o;var n=this.v0,i=this.v1,r=this.v2;return e.set(Hn(t,n.x,i.x,r.x),Hn(t,n.y,i.y,r.y),Hn(t,n.z,i.z,r.z)),e},Wn.prototype.copy=function(t){return Pn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Wn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Wn.prototype.fromJSON=function(t){return Pn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Gn.prototype=Object.create(Pn.prototype)).constructor=Gn,Gn.prototype.isSplineCurve=!0,Gn.prototype.getPoint=function(t,e){e=e||new n;var i=(i=((s=this.points).length-1)*t)-(t=Math.floor(i)),r=s[0===t?t:t-1],o=s[t],a=s[t>s.length-2?s.length-1:t+1],s=s[t>s.length-3?s.length-1:t+2];return e.set(In(i,r.x,o.x,a.x,s.x),In(i,r.y,o.y,a.y,s.y)),e},Gn.prototype.copy=function(t){Pn.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this},Gn.prototype.toJSON=function(){var t=Pn.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t},Gn.prototype.fromJSON=function(t){Pn.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var r=t.points[e];this.points.push((new n).fromArray(r))}return this};var Jr=Object.freeze({ArcCurve:kn,CatmullRomCurve3:Dn,CubicBezierCurve:Fn,CubicBezierCurve3:Bn,EllipseCurve:Nn,LineCurve:jn,LineCurve3:zn,QuadraticBezierCurve:Vn,QuadraticBezierCurve3:Wn,SplineCurve:Gn});Yn.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Yn,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new jn(e,t))},getPoint:function(t){var e=t*this.getLength(),n=this.getCurveLengths();for(t=0;t<n.length;){if(n[t]>=e)return e=n[t]-e,t=this.curves[t],n=t.getLength(),t.getPointAt(0===n?0:1-e/n);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],i=0,r=this.curves;i<r.length;i++)for(var o=r[i],a=(o=o.getPoints(o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t),0);a<o.length;a++){var s=o[a];e&&e.equals(s)||(n.push(s),e=s)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){Pn.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=Pn.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){Pn.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var i=t.curves[e];this.curves.push((new Jr[i.type]).fromJSON(i))}return this}}),Xn.prototype=Object.assign(Object.create(Yn.prototype),{constructor:Xn,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var i=new jn(this.currentPoint.clone(),new n(t,e));this.curves.push(i),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,i,r){t=new Vn(this.currentPoint.clone(),new n(t,e),new n(i,r)),this.curves.push(t),this.currentPoint.set(i,r)},bezierCurveTo:function(t,e,i,r,o,a){t=new Fn(this.currentPoint.clone(),new n(t,e),new n(i,r),new n(o,a)),this.curves.push(t),this.currentPoint.set(o,a)},splineThru:function(t){var e=new Gn(e=[this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,i,r,o){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,i,r,o)},absarc:function(t,e,n,i,r,o){this.absellipse(t,e,n,n,i,r,o)},ellipse:function(t,e,n,i,r,o,a,s){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,i,r,o,a,s)},absellipse:function(t,e,n,i,r,o,a,s){t=new Nn(t,e,n,i,r,o,a,s),0<this.curves.length&&((e=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)},copy:function(t){return Yn.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Yn.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Yn.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),qn.prototype=Object.assign(Object.create(Xn.prototype),{constructor:qn,getPointsHoles:function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Xn.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){var t=Xn.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){Xn.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var i=t.holes[e];this.holes.push((new Xn).fromJSON(i))}return this}}),Jn.prototype=Object.assign(Object.create(et.prototype),{constructor:Jn,isLight:!0,copy:function(t){return et.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return t=et.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Kn.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Kn,isHemisphereLight:!0,copy:function(t){return Jn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Zn.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),$n.prototype=Object.assign(Object.create(Zn.prototype),{constructor:$n,isSpotLightShadow:!0,update:function(t){var e=this.camera,n=2*wr.RAD2DEG*t.angle,i=this.mapSize.width/this.mapSize.height;t=t.distance||e.far,n===e.fov&&i===e.aspect&&t===e.far||(e.fov=n,e.aspect=i,e.far=t,e.updateProjectionMatrix())}}),Qn.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Qn,isSpotLight:!0,copy:function(t){return Jn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),ti.prototype=Object.assign(Object.create(Jn.prototype),{constructor:ti,isPointLight:!0,copy:function(t){return Jn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),ei.prototype=Object.assign(Object.create(Zn.prototype),{constructor:ei}),ni.prototype=Object.assign(Object.create(Jn.prototype),{constructor:ni,isDirectionalLight:!0,copy:function(t){return Jn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),ii.prototype=Object.assign(Object.create(Jn.prototype),{constructor:ii,isAmbientLight:!0}),ri.prototype=Object.assign(Object.create(Jn.prototype),{constructor:ri,isRectAreaLight:!0,copy:function(t){return Jn.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return t=Jn.prototype.toJSON.call(this,t),t.object.width=this.width,t.object.height=this.height,t}}),oi.prototype=Object.assign(Object.create(mi.prototype),{constructor:oi,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ai.prototype=Object.assign(Object.create(mi.prototype),{constructor:ai,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(si.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{n:{i:if(!(t<i)){for(var o=n+2;;){if(void 0===i){if(t<r)break i;return this._cachedIndex=n=e.length,this.afterEnd_(n-1,t,r)}if(n===o)break;if(r=i,i=e[++n],t<i)break e}i=e.length;break n}if(t>=r)break t;for(t<(o=e[1])&&(n=2,r=o),o=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===o)break;if(i=r,r=e[--n-1],t>=r)break e}i=n,n=0}for(;n<i;)r=n+i>>>1,t<e[r]?i=r:n=r+1;if(i=e[n],void 0===(r=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return this._cachedIndex=n=e.length,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize;t*=i;for(var r=0;r!==i;++r)e[r]=n[t+r];return e},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(si.prototype,{beforeStart_:si.prototype.copySampleValue_,afterEnd_:si.prototype.copySampleValue_}),li.prototype=Object.assign(Object.create(si.prototype),{constructor:li,interpolate_:function(t,e,n,i){var o=this.resultBuffer,a=this.sampleValues,s=this.valueSize;for(e=(n-e)/(i-e),n=(t*=s)+s;t!==n;t+=4)r.slerpFlat(o,0,a,t-s,a,t,e);return o}}),ui.prototype=Object.assign(Object.create(mi.prototype),{constructor:ui,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new li(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),ci.prototype=Object.assign(Object.create(mi.prototype),{constructor:ci,ValueTypeName:"color"}),hi.prototype=Object.assign(Object.create(mi.prototype),{constructor:hi,ValueTypeName:"number"}),di.prototype=Object.assign(Object.create(si.prototype),{constructor:di,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var i=this.parameterPositions,r=t-2,o=t+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:r=t,a=2*e-n;break;case 2402:a=e+i[r=i.length-2]-i[r+1];break;default:r=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*n-e;break;case 2402:o=1,s=n+i[1]-i[0];break;default:o=t-1,s=e}t=.5*(n-e),i=this.valueSize,this._weightPrev=t/(e-a),this._weightNext=t/(s-n),this._offsetPrev=r*i,this._offsetNext=o*i},interpolate_:function(t,e,n,i){var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a,l=this._offsetPrev,u=this._offsetNext,c=this._weightPrev,h=this._weightNext,d=(n-e)/(i-e);for(e=-c*(i=(n=d*d)*d)+2*c*n-c*d,c=(1+c)*i+(-1.5-2*c)*n+(-.5+c)*d+1,d=(-1-h)*i+(1.5+h)*n+.5*d,h=h*i-h*n,n=0;n!==a;++n)r[n]=e*o[l+n]+c*o[s+n]+d*o[t+n]+h*o[u+n];return r}}),fi.prototype=Object.assign(Object.create(si.prototype),{constructor:fi,interpolate_:function(t,e,n,i){var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a;for(n=1-(e=(n-e)/(i-e)),i=0;i!==a;++i)r[i]=o[s+i]*n+o[t+i]*e;return r}}),pi.prototype=Object.assign(Object.create(si.prototype),{constructor:pi,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Kr={arraySlice:function(t,e,n){return Kr.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=Array(e),i=0;i!==e;++i)n[i]=i;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var i=t.length,r=new t.constructor(i),o=0,a=0;a!==i;++o)for(var s=n[o]*e,l=0;l!==e;++l)r[a++]=t[s+l];return r},flattenJSON:function(t,e,n,i){for(var r=1,o=t[0];void 0!==o&&void 0===o[i];)o=t[r++];if(void 0!==o){var a=o[i];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[i])&&(e.push(o.time),n.push.apply(n,a)),o=t[r++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[i])&&(e.push(o.time),a.toArray(n,n.length)),o=t[r++]}while(void 0!==o);else do{void 0!==(a=o[i])&&(e.push(o.time),n.push(a)),o=t[r++]}while(void 0!==o)}}};Object.assign(mi,{parse:function(t){if(void 0===t.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=mi._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],i=[];Kr.flattenJSON(t.keys,n,i,"value"),t.times=n,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){if(void 0!==(e=t.constructor).toJSON)e=e.toJSON(t);else{var e={name:t.name,times:Kr.convertArray(t.times,Array),values:Kr.convertArray(t.values,Array)},n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return hi;case"vector":case"vector2":case"vector3":case"vector4":return gi;case"color":return ci;case"quaternion":return ui;case"bool":case"boolean":return ai;case"string":return oi}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(mi.prototype,{constructor:mi,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new pi(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new fi(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new di(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",e)}else this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,i=n.length,r=0,o=i-1;r!==i&&n[r]<t;)++r;for(;-1!==o&&n[o]>e;)--o;return++o,0===r&&o===i||(r>=o&&(o=Math.max(o,1),r=o-1),t=this.getValueSize(),this.times=Kr.arraySlice(n,r,o),this.values=Kr.arraySlice(this.values,r*t,o*t)),this},validate:function(){var t=!0;0!=(n=this.getValueSize())-Math.floor(n)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var e=this.times,n=this.values,i=e.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var r=null,o=0;o!==i;o++){var a=e[o];if("number"==typeof a&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(null!==r&&r>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,r),t=!1;break}r=a}if(void 0!==n&&Kr.isTypedArray(n))for(o=0,e=n.length;o!==e;++o)if(i=n[o],isNaN(i)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,i),t=!1;break}return t},optimize:function(){for(var t,e,n=this.times,i=this.values,r=this.getValueSize(),o=2302===this.getInterpolation(),a=1,s=n.length-1,l=1;l<s;++l){t=!1;if((h=n[l])!==n[l+1]&&(1!==l||h!==h[0]))if(o)t=!0;else for(var u=(e=l*r)-r,c=e+r,h=0;h!==r;++h){var d=i[e+h];if(d!==i[u+h]||d!==i[c+h]){t=!0;break}}if(t){if(l!==a)for(n[a]=n[l],e=l*r,t=a*r,h=0;h!==r;++h)i[t+h]=i[e+h];++a}}if(0<s){for(n[a]=n[s],e=s*r,t=a*r,h=0;h!==r;++h)i[t+h]=i[e+h];++a}return a!==n.length&&(this.times=Kr.arraySlice(n,0,a),this.values=Kr.arraySlice(i,0,a*r)),this}}),gi.prototype=Object.assign(Object.create(mi.prototype),{constructor:gi,ValueTypeName:"vector"}),Object.assign(vi,{parse:function(t){for(var e=[],n=t.tracks,i=1/(t.fps||1),r=0,o=n.length;r!==o;++r)e.push(mi.parse(n[r]).scale(i));return new vi(t.name,t.duration,e)},toJSON:function(t){var e=[],n=t.tracks;t={name:t.name,duration:t.duration,tracks:e};for(var i=0,r=n.length;i!==r;++i)e.push(mi.toJSON(n[i]));return t},CreateFromMorphTargetSequence:function(t,e,n,i){for(var r=e.length,o=[],a=0;a<r;a++){var s=[];(u=[]).push((a+r-1)%r,a,(a+1)%r),s.push(0,1,0);var l=Kr.getKeyframeOrder(u),u=Kr.sortedArray(u,1,l);s=Kr.sortedArray(s,1,l);i||0!==u[0]||(u.push(r),s.push(s[0])),o.push(new hi(".morphTargetInfluences["+e[a].name+"]",u,s).scale(1/n))}return new vi(t,-1,o)},findByName:function(t,e){var n=t;for(Array.isArray(t)||(n=t.geometry&&t.geometry.animations||t.animations),t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var i,r={},o=/^([\w-]*?)([\d]+)$/,a=0,s=t.length;a<s;a++){var l=t[a],u=l.name.match(o);u&&1<u.length&&(i=u[1],(u=r[i])||(r[i]=u=[]),u.push(l))}t=[];for(i in r)t.push(vi.CreateFromMorphTargetSequence(i,r[i],e,n));return t},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var n=function(t,e,n,i,r){if(0!==n.length){var o=[],a=[];Kr.flattenJSON(n,o,a,i),0!==o.length&&r.push(new t(e,o,a))}},i=[],r=t.name||"default",o=t.length||-1,a=t.fps||30;t=t.hierarchy||[];for(var s=0;s<t.length;s++){var l=t[s].keys;if(l&&0!==l.length)if(l[0].morphTargets){o={};for(var u=0;u<l.length;u++)if(l[u].morphTargets)for(var c=0;c<l[u].morphTargets.length;c++)o[l[u].morphTargets[c]]=-1;for(var h in o){var d=[],f=[];for(c=0;c!==l[u].morphTargets.length;++c){var p=l[u];d.push(p.time),f.push(p.morphTarget===h?1:0)}i.push(new hi(".morphTargetInfluence["+h+"]",d,f))}o=o.length*(a||1)}else u=".bones["+e[s].name+"]",n(gi,u+".position",l,"pos",i),n(ui,u+".quaternion",l,"rot",i),n(gi,u+".scale",l,"scl",i)}return 0===i.length?null:new vi(r,o,i)}}),Object.assign(vi.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(yi.prototype,{load:function(t,e,n,i){var r=this;new xn(r.manager).load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===i[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),i[t]}var i=this.textures,r=new jr[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=e(t.map)),void 0!==t.alphaMap&&(r.alphaMap=e(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=e(t.normalMap)),void 0!==t.normalScale){var o=t.normalScale;!1===Array.isArray(o)&&(o=[o,o]),r.normalScale=(new n).fromArray(o)}return void 0!==t.displacementMap&&(r.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=e(t.specularMap)),void 0!==t.envMap&&(r.envMap=e(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=e(t.gradientMap)),r}}),Object.assign(wi.prototype,{load:function(t,e,n,i){var r=this;new xn(r.manager).load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},parse:function(t){var e=new yt,n=t.data.index;void 0!==n&&(n=new Zr[n.type](n.array),e.setIndex(new at(n,1)));var i=t.data.attributes;for(a in i){var r=i[a];n=new Zr[r.type](r.array),e.addAttribute(a,new at(n,r.itemSize,r.normalized))}var a=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==a)for(n=0,i=a.length;n!==i;++n)r=a[n],e.addGroup(r.start,r.count,r.materialIndex);return void 0!==(t=t.data.boundingSphere)&&(a=new o,void 0!==t.center&&a.fromArray(t.center),e.boundingSphere=new J(a,t.radius)),e}});var Zr={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};bi.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,i=e.length;n<i;n+=2){var r=e[n+1];if(e[n].test(t))return r}return null}},Object.assign(bi.prototype,{crossOrigin:void 0,initMaterials:function(t,e,n){for(var i=[],r=0;r<t.length;++r)i[r]=this.createMaterial(t[r],e,n);return i},createMaterial:function(){var t={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},e=new z,n=new An,i=new yi;return function(r,o,a){function s(t,e,i,r,s){t=o+t;var l=bi.Handlers.get(t);return null!==l?t=l.load(t):(n.setCrossOrigin(a),t=n.load(t)),void 0!==e&&(t.repeat.fromArray(e),1!==e[0]&&(t.wrapS=1e3),1!==e[1]&&(t.wrapT=1e3)),void 0!==i&&t.offset.fromArray(i),void 0!==r&&("repeat"===r[0]&&(t.wrapS=1e3),"mirror"===r[0]&&(t.wrapS=1002),"repeat"===r[1]&&(t.wrapT=1e3),"mirror"===r[1]&&(t.wrapT=1002)),void 0!==s&&(t.anisotropy=s),e=wr.generateUUID(),u[e]=t,e}var l,u={},c={uuid:wr.generateUUID(),type:"MeshLambertMaterial"};for(l in r){var h=r[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=h;break;case"blending":c.blending=t[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":c.color=e.fromArray(h).getHex();break;case"colorSpecular":c.specular=e.fromArray(h).getHex();break;case"colorEmissive":c.emissive=e.fromArray(h).getHex();break;case"specularCoef":c.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(c.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(c.type="MeshStandardMaterial");break;case"mapDiffuse":c.map=s(h,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":c.emissiveMap=s(h,r.mapEmissiveRepeat,r.mapEmissiveOffset,r.mapEmissiveWrap,r.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":c.lightMap=s(h,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=s(h,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=s(h,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=s(h,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=[h,h];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=s(h,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":c.metalnessMap=s(h,r.mapMetalnessRepeat,r.mapMetalnessOffset,r.mapMetalnessWrap,r.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":c.roughnessMap=s(h,r.mapRoughnessRepeat,r.mapRoughnessOffset,r.mapRoughnessWrap,r.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":c.alphaMap=s(h,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=1;break;case"doubleSided":c.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[l]=h;break;case"vertexColors":!0===h&&(c.vertexColors=2),"face"===h&&(c.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,h)}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,1>c.opacity&&(c.transparent=!0),i.setTextures(u),i.parse(c)}}()});var $r={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);return e},extractUrlBase:function(t){return 1===(t=t.split("/")).length?"./":(t.pop(),t.join("/")+"/")}};Object.assign(_i.prototype,{load:function(t,e,n,i){var r=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:$r.extractUrlBase(t),a=new xn(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(n){var i=(n=JSON.parse(n)).metadata;if(void 0!==i&&void 0!==(i=i.type)){if("object"===i.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===i.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}n=r.parse(n,o),e(n.geometry,n.materials)},n,i)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){void 0!==t.data&&(t=t.data),t.scale=void 0!==t.scale?1/t.scale:1;var i,r,a,s=new ot,u=t,c=u.faces,h=u.vertices,d=u.normals,f=u.colors,p=u.scale,m=0;if(void 0!==u.uvs){for(i=0;i<u.uvs.length;i++)u.uvs[i].length&&m++;for(i=0;i<m;i++)s.faceVertexUvs[i]=[]}var g=0;for(a=h.length;g<a;)i=new o,i.x=h[g++]*p,i.y=h[g++]*p,i.z=h[g++]*p,s.vertices.push(i);for(g=0,a=c.length;g<a;){var v=1&(h=c[g++]),y=2&h;i=8&h;var w=16&h,b=32&h;if(p=64&h,h&=128,v){(v=new rt).a=c[g],v.b=c[g+1],v.c=c[g+3];var _=new rt;if(_.a=c[g+1],_.b=c[g+2],_.c=c[g+3],g+=4,y&&(y=c[g++],v.materialIndex=y,_.materialIndex=y),y=s.faces.length,i)for(i=0;i<m;i++){var E=u.uvs[i];for(s.faceVertexUvs[i][y]=[],s.faceVertexUvs[i][y+1]=[],r=0;4>r;r++){var T=c[g++],C=E[2*T];C=new n(C,T=E[2*T+1]),2!==r&&s.faceVertexUvs[i][y].push(C),0!==r&&s.faceVertexUvs[i][y+1].push(C)}}if(w&&(w=3*c[g++],v.normal.set(d[w++],d[w++],d[w]),_.normal.copy(v.normal)),b)for(i=0;4>i;i++)w=3*c[g++],b=new o(d[w++],d[w++],d[w]),2!==i&&v.vertexNormals.push(b),0!==i&&_.vertexNormals.push(b);if(p&&(p=c[g++],p=f[p],v.color.setHex(p),_.color.setHex(p)),h)for(i=0;4>i;i++)p=c[g++],p=f[p],2!==i&&v.vertexColors.push(new z(p)),0!==i&&_.vertexColors.push(new z(p));s.faces.push(v),s.faces.push(_)}else{if(v=new rt,v.a=c[g++],v.b=c[g++],v.c=c[g++],y&&(y=c[g++],v.materialIndex=y),y=s.faces.length,i)for(i=0;i<m;i++)for(E=u.uvs[i],s.faceVertexUvs[i][y]=[],r=0;3>r;r++)T=c[g++],C=E[2*T],T=E[2*T+1],C=new n(C,T),s.faceVertexUvs[i][y].push(C);if(w&&(w=3*c[g++],v.normal.set(d[w++],d[w++],d[w])),b)for(i=0;3>i;i++)w=3*c[g++],b=new o(d[w++],d[w++],d[w]),v.vertexNormals.push(b);if(p&&(p=c[g++],v.color.setHex(f[p])),h)for(i=0;3>i;i++)p=c[g++],v.vertexColors.push(new z(f[p]));s.faces.push(v)}}if(u=t,g=void 0!==u.influencesPerVertex?u.influencesPerVertex:2,u.skinWeights)for(a=0,c=u.skinWeights.length;a<c;a+=g)s.skinWeights.push(new l(u.skinWeights[a],1<g?u.skinWeights[a+1]:0,2<g?u.skinWeights[a+2]:0,3<g?u.skinWeights[a+3]:0));if(u.skinIndices)for(a=0,c=u.skinIndices.length;a<c;a+=g)s.skinIndices.push(new l(u.skinIndices[a],1<g?u.skinIndices[a+1]:0,2<g?u.skinIndices[a+2]:0,3<g?u.skinIndices[a+3]:0));if(s.bones=u.bones,s.bones&&0<s.bones.length&&(s.skinWeights.length!==s.skinIndices.length||s.skinIndices.length!==s.vertices.length)&&console.warn("When skinning, number of vertices ("+s.vertices.length+"), skinIndices ("+s.skinIndices.length+"), and skinWeights ("+s.skinWeights.length+") should match."),a=t,c=a.scale,void 0!==a.morphTargets)for(u=0,g=a.morphTargets.length;u<g;u++)for(s.morphTargets[u]={},s.morphTargets[u].name=a.morphTargets[u].name,s.morphTargets[u].vertices=[],d=s.morphTargets[u].vertices,f=a.morphTargets[u].vertices,m=0,h=f.length;m<h;m+=3)p=new o,p.x=f[m]*c,p.y=f[m+1]*c,p.z=f[m+2]*c,d.push(p);if(void 0!==a.morphColors&&0<a.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),c=s.faces,a=a.morphColors[0].colors,u=0,g=c.length;u<g;u++)c[u].color.fromArray(a,3*u);for(u=[],g=[],void 0!==(a=t).animation&&g.push(a.animation),void 0!==a.animations&&(a.animations.length?g=g.concat(a.animations):g.push(a.animations)),a=0;a<g.length;a++)(c=vi.parseAnimation(g[a],s.bones))&&u.push(c);return s.morphTargets&&(g=vi.CreateClipsFromMorphTargetSequences(s.morphTargets,10),u=u.concat(g)),0<u.length&&(s.animations=u),s.computeFaceNormals(),s.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:s}:(t=bi.prototype.initMaterials(t.materials,e,this.crossOrigin),{geometry:s,materials:t})}}),Object.assign(Ei.prototype,{load:function(t,e,n,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this;new xn(r.manager).load(t,function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==i&&i(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}void 0===(n=o.metadata)||void 0===n.type||"geometry"===n.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead."):r.parse(o,e)},n,i)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseShape(t.shapes),i=(n=this.parseGeometries(t.geometries,n),this.parseImages(t.images,function(){void 0!==e&&e(r)})),r=(i=this.parseTextures(t.textures,i),i=this.parseMaterials(t.materials,i),this.parseObject(t.object,n,i));return t.animations&&(r.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(r),r},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,i=t.length;n<i;n++){var r=(new qn).fromJSON(t[n]);e[r.uuid]=r}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var i=new _i,r=new wi,o=0,a=t.length;o<a;o++){var s=t[o];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":var l=new Br[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":l=new Br[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":l=new Br[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":l=new Br[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":l=new Br[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":l=new Br[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":l=new Br[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":l=new Br[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":l=new Br[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":l=new Br[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":l=new Br[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":l=new Br[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(l=[],o=0,a=s.shapes.length;o<a;o++)l.push(e[s.shapes[o]]);l=new Br[s.type](l,s.curveSegments);break;case"BufferGeometry":l=r.parse(s);break;case"Geometry":l=i.parse(s,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),n[s.uuid]=l}return n},parseMaterials:function(t,e){var n={};if(void 0!==t){var i=new yi;i.setTextures(e),e=0;for(var r=t.length;e<r;e++){var o=t[e];if("MultiMaterial"===o.type){for(var a=[],s=0;s<o.materials.length;s++)a.push(i.parse(o.materials[s]));n[o.uuid]=a}else n[o.uuid]=i.parse(o)}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var i=vi.parse(t[n]);e.push(i)}return e},parseImages:function(t,e){function n(t){return i.manager.itemStart(t),o.load(t,function(){i.manager.itemEnd(t)},void 0,function(){i.manager.itemEnd(t),i.manager.itemError(t)})}var i=this,r={};if(void 0!==t&&0<t.length){var o=new On(e=new Cn(e));o.setCrossOrigin(this.crossOrigin),e=0;for(var a=t.length;e<a;e++){var s=t[e],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:i.texturePath+s.url;r[s.uuid]=n(l)}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var i={};if(void 0!==t)for(var r=0,o=t.length;r<o;r++){var a=t[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var l=new s(e[a.image]);l.needsUpdate=!0,l.uuid=a.uuid,void 0!==a.name&&(l.name=a.name),void 0!==a.mapping&&(l.mapping=n(a.mapping,Qr)),void 0!==a.offset&&l.offset.fromArray(a.offset),void 0!==a.repeat&&l.repeat.fromArray(a.repeat),void 0!==a.center&&l.center.fromArray(a.center),void 0!==a.rotation&&(l.rotation=a.rotation),void 0!==a.wrap&&(l.wrapS=n(a.wrap[0],to),l.wrapT=n(a.wrap[1],to)),void 0!==a.minFilter&&(l.minFilter=n(a.minFilter,eo)),void 0!==a.magFilter&&(l.magFilter=n(a.magFilter,eo)),void 0!==a.anisotropy&&(l.anisotropy=a.anisotropy),void 0!==a.flipY&&(l.flipY=a.flipY),i[a.uuid]=l}return i},parseObject:function(){var t=new i;return function(e,n,i){function r(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];void 0===i[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(i[o])}return e}return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}}switch(e.type){case"Scene":var a=new Jt;void 0!==e.background&&Number.isInteger(e.background)&&(a.background=new z(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new qt(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new Xt(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new zt(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new it(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new ii(e.color,e.intensity);break;case"DirectionalLight":a=new ni(e.color,e.intensity);break;case"PointLight":a=new ti(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new ri(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Qn(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Kn(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":a=r(e.geometry);var s=o(e.material);a=a.bones&&0<a.bones.length?new ne(a,s):new Ot(a,s);break;case"LOD":a=new Qt;break;case"Line":a=new re(r(e.geometry),o(e.material),e.mode);break;case"LineLoop":a=new ae(r(e.geometry),o(e.material));break;case"LineSegments":a=new oe(r(e.geometry),o(e.material));break;case"PointCloud":case"Points":a=new le(r(e.geometry),o(e.material));break;case"Sprite":a=new $t(o(e.material));break;case"Group":a=new ue;break;default:a=new et}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children){s=e.children;for(var l=0;l<s.length;l++)a.add(this.parseObject(s[l],n,i))}if("LOD"===e.type)for(e=e.levels,s=0;s<e.length;s++){l=e[s];var u=a.getObjectByProperty("uuid",l.object);void 0!==u&&a.addLevel(u,l.distance)}return a}}()});var Qr={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},to={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},eo={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};Ti.prototype={constructor:Ti,setOptions:function(t){return this.options=t,this},load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,o=zr.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,r.options)}).then(function(n){zr.add(t,n),e&&e(n),r.manager.itemEnd(t)}).catch(function(e){i&&i(e),r.manager.itemEnd(t),r.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Ci.prototype,{moveTo:function(t,e){this.currentPath=new Xn,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,i){this.currentPath.quadraticCurveTo(t,e,n,i)},bezierCurveTo:function(t,e,n,i,r,o){this.currentPath.bezierCurveTo(t,e,n,i,r,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n],o=new qn;o.curves=r.curves,e.push(o)}return e}function i(t,e){for(var n=e.length,i=!1,r=n-1,o=0;o<n;r=o++){var a=e[r],s=e[o],l=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(0>u&&(a=e[o],l=-l,s=e[r],u=-u),!(t.y<a.y||t.y>s.y))if(t.y===a.y){if(t.x===a.x)return!0}else{if(0==(r=u*(t.x-a.x)-l*(t.y-a.y)))return!0;0>r||(i=!i)}}else if(t.y===a.y&&(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x))return!0}return i}var r=Fr.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);if(e=[],1===o.length){var a=o[0],s=new qn;return s.curves=a.curves,e.push(s),e}var l=!r(o[0].getPoints());l=t?!l:l;s=[];var u=[],c=[],h=0;u[h]=void 0,c[h]=[];for(var d=0,f=o.length;d<f;d++){var p=(a=o[d]).getPoints(),m=r(p);(m=t?!m:m)?(!l&&u[h]&&h++,u[h]={s:new qn,p:p},u[h].s.curves=a.curves,l&&h++,c[h]=[]):c[h].push({h:a,p:p[0]})}if(!u[0])return n(o);if(1<u.length){for(d=!1,t=[],r=0,o=u.length;r<o;r++)s[r]=[];for(r=0,o=u.length;r<o;r++)for(a=c[r],m=0;m<a.length;m++){for(l=a[m],h=!0,p=0;p<u.length;p++)i(l.p,u[p].p)&&(r!==p&&t.push({froms:r,tos:p,hole:m}),h?(h=!1,s[p].push(l)):d=!0);h&&s[r].push(l)}0<t.length&&(d||(c=s))}for(d=0,r=u.length;d<r;d++)for(s=u[d].s,e.push(s),t=c[d],o=0,a=t.length;o<a;o++)s.holes.push(t[o].h);return e}}),Object.assign(xi.prototype,{isFont:!0,generateShapes:function(t,e,n){void 0===e&&(e=100),n=this.data,t=String(t).split("");var i=e/n.resolution,r=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=0,a=0;e=[];for(var s=0;s<t.length;s++){var l=t[s];if("\n"===l)o=0,a-=r;else{var u=i,c=o,h=a;if(l=n.glyphs[l]||n.glyphs["?"]){var d=new Ci;if(l.o)for(var f=l._cachedOutline||(l._cachedOutline=l.o.split(" ")),p=0,m=f.length;p<m;)switch(f[p++]){case"m":var g=f[p++]*u+c,v=f[p++]*u+h;d.moveTo(g,v);break;case"l":g=f[p++]*u+c,v=f[p++]*u+h,d.lineTo(g,v);break;case"q":var y=f[p++]*u+c,w=f[p++]*u+h,b=f[p++]*u+c,_=f[p++]*u+h;d.quadraticCurveTo(b,_,y,w);break;case"b":y=f[p++]*u+c,w=f[p++]*u+h,b=f[p++]*u+c,_=f[p++]*u+h,g=f[p++]*u+c,v=f[p++]*u+h,d.bezierCurveTo(b,_,g,v,y,w)}u={offsetX:l.ha*u,path:d}}else u=void 0;o+=u.offsetX,e.push(u.path)}}for(n=[],t=0,i=e.length;t<i;t++)Array.prototype.push.apply(n,e[t].toShapes());return n}}),Object.assign(Si.prototype,{load:function(t,e,n,i){var r=this,o=new xn(this.manager);o.setPath(this.path),o.load(t,function(t){try{var n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}t=r.parse(n),e&&e(t)},n,i)},parse:function(t){return new xi(t)},setPath:function(t){return this.path=t,this}});var no,io={getContext:function(){return void 0===no&&(no=new(window.AudioContext||window.webkitAudioContext)),no},setContext:function(t){no=t}};Object.assign(Mi.prototype,{load:function(t,e,n,i){var r=new xn(this.manager);r.setResponseType("arraybuffer"),r.load(t,function(t){io.getContext().decodeAudioData(t,function(t){e(t)})},n,i)}}),Object.assign(Oi.prototype,{update:function(){var t,e,n,r,o,a,s,l,u=new i,c=new i;return function(i){if(t!==this||e!==i.focus||n!==i.fov||r!==i.aspect*this.aspect||o!==i.near||a!==i.far||s!==i.zoom||l!==this.eyeSep){t=this,e=i.focus,n=i.fov,r=i.aspect*this.aspect,o=i.near,a=i.far,s=i.zoom;var h=i.projectionMatrix.clone(),d=(l=this.eyeSep/2)*o/e,f=o*Math.tan(wr.DEG2RAD*n*.5)/s;c.elements[12]=-l,u.elements[12]=l;var p=-f*r+d,m=f*r+d;h.elements[0]=2*o/(m-p),h.elements[8]=(m+p)/(m-p),this.cameraL.projectionMatrix.copy(h),p=-f*r-d,m=f*r-d,h.elements[0]=2*o/(m-p),h.elements[8]=(m+p)/(m-p),this.cameraR.projectionMatrix.copy(h)}this.cameraL.matrixWorld.copy(i.matrixWorld).multiply(c),this.cameraR.matrixWorld.copy(i.matrixWorld).multiply(u)}}()}),(Ri.prototype=Object.create(et.prototype)).constructor=Ri,Ai.prototype=Object.assign(Object.create(et.prototype),{constructor:Ai,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new o,e=new r,n=new o,i=new o;return function(r){et.prototype.updateMatrixWorld.call(this,r),r=this.context.listener;var o=this.up;this.matrixWorld.decompose(t,e,n),i.set(0,0,-1).applyQuaternion(e),r.positionX?(r.positionX.setValueAtTime(t.x,this.context.currentTime),r.positionY.setValueAtTime(t.y,this.context.currentTime),r.positionZ.setValueAtTime(t.z,this.context.currentTime),r.forwardX.setValueAtTime(i.x,this.context.currentTime),r.forwardY.setValueAtTime(i.y,this.context.currentTime),r.forwardZ.setValueAtTime(i.z,this.context.currentTime),r.upX.setValueAtTime(o.x,this.context.currentTime),r.upY.setValueAtTime(o.y,this.context.currentTime),r.upZ.setValueAtTime(o.z,this.context.currentTime)):(r.setPosition(t.x,t.y,t.z),r.setOrientation(i.x,i.y,i.z,o.x,o.y,o.z))}}()}),Pi.prototype=Object.assign(Object.create(et.prototype),{constructor:Pi,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),Ni.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Ni,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new o;return function(e){et.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(ki.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(Li.prototype,{accumulate:function(t,e){var n=this.buffer,i=this.valueSize;t=t*i+i;var r=this.cumulativeWeight;if(0===r){for(r=0;r!==i;++r)n[t+r]=n[r];r=e}else r+=e,this._mixBufferRegion(n,t,0,e/r,i);this.cumulativeWeight=r},apply:function(t){var e=this.valueSize,n=this.buffer;t=t*e+e;var i=this.cumulativeWeight,r=this.binding;this.cumulativeWeight=0,1>i&&this._mixBufferRegion(n,t,3*e,1-i,e);i=e;for(var o=e+e;i!==o;++i)if(n[i]!==n[i+e]){r.setValue(n,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,n=3*e;this.binding.getValue(t,n);for(var i=e;i!==n;++i)t[i]=t[n+i%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,n,i,r){if(.5<=i)for(i=0;i!==r;++i)t[e+i]=t[n+i]},_slerp:function(t,e,n,i){r.slerpFlat(t,e,t,e,t,n,i)},_lerp:function(t,e,n,i,r){for(var o=1-i,a=0;a!==r;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*i}}}),Object.assign(Di.prototype,{getValue:function(t,e){this.bind();var n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(Ii,{Composite:Di,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new Ii.Composite(t,e,n):new Ii(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:function(){var t=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),e=["material","materials","bones"];return function(n){if(!(i=t.exec(n)))throw Error("PropertyBinding: Cannot parse trackName: "+n);var i,r=(i={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]}).nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var o=i.nodeName.substring(r+1);-1!==e.indexOf(o)&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=o)}if(null===i.propertyName||0===i.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+n);return i}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=function(t){for(var n=0;n<t.bones.length;n++){var i=t.bones[n];if(i.name===e)return i}return null}(t.skeleton);if(n)return n}if(t.children){var i=function(t){for(var n=0;n<t.length;n++){var r=t[n];if(r.name===e||r.uuid===e||(r=i(r.children)))return r}return null};if(t=i(t.children))return t}return null}}),Object.assign(Ii.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)t[e++]=n[i]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,i=e.propertyName,r=e.propertyIndex;if(t||(this.node=t=Ii.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,n=0;n<t.length;n++)if(t[n].name===o){o=n;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}if(void 0===(o=t[i]))console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+i+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==t.needsUpdate?(e=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t),n=this.BindingType.Direct,void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(n=0;n<this.node.geometry.morphAttributes.position.length;n++)if(t.geometry.morphAttributes.position[n].name===r){r=n;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(n=0;n<this.node.geometry.morphTargets.length;n++)if(t.geometry.morphTargets[n].name===r){r=n;break}}}n=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(n=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(n=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[n],this.setValue=this.SetterByBindingTypeAndVersioning[n][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Ii.prototype,{_getValue_unbound:Ii.prototype.getValue,_setValue_unbound:Ii.prototype.setValue}),Object.assign(Hi.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,l=0,u=arguments.length;l!==u;++l){var c=arguments[l],h=i[d=c.uuid];if(void 0===h){h=e++,i[d]=h,t.push(c);for(var d=0,f=s;d!==f;++d)a[d].push(new Ii(c,r[d],o[d]))}else if(h<n){var p=--n;for(i[(f=t[p]).uuid]=h,t[h]=f,i[d]=p,t[p]=c,d=0,f=s;d!==f;++d){var m=a[d],g=m[h];m[h]=m[p],void 0===g&&(g=new Ii(c,r[d],o[d])),m[p]=g}}else void 0!==t[h]&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,r=i.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],l=s.uuid,u=n[l];if(void 0!==u&&u>=e){var c=e++;for(n[(h=t[c]).uuid]=u,t[u]=h,n[l]=c,t[c]=s,s=0,l=r;s!==l;++s){var h,d=(h=i[s])[u];h[u]=h[c],h[c]=d}}}this.nCachedObjects_=e},uncache:function(){for(var t,e,n=this._objects,i=n.length,r=this.nCachedObjects_,o=this._indicesByUUID,a=this._bindings,s=a.length,l=0,u=arguments.length;l!==u;++l){var c=o[e=arguments[l].uuid];if(void 0!==c)if(delete o[e],c<r){var h=--r,d=n[h];t=n[e=--i],o[d.uuid]=c,n[c]=d,o[t.uuid]=h,n[h]=t,n.pop();d=0;for(var f=s;d!==f;++d){var p=(t=a[d])[e];t[c]=t[h],t[h]=p,t.pop()}}else for(e=--i,t=n[e],o[t.uuid]=c,n[c]=t,n.pop(),d=0,f=s;d!==f;++d)t=a[d],t[c]=t[e],t.pop()}this.nCachedObjects_=r},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,i=n[t],r=this._bindings;if(void 0!==i)return r[i];var o=this._paths,a=this._parsedPaths,s=this._objects,l=this.nCachedObjects_,u=Array(s.length);i=r.length;for(n[t]=i,o.push(t),a.push(e),r.push(u),n=l,i=s.length;n!==i;++n)u[n]=new Ii(s[n],t,e);return u},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}}),Object.assign(Ui.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){n=this._clip.duration;var i=t._clip.duration,r=n/i;t.warp(1,i/n,e),this.warp(r,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var i=this._mixer,r=i.time,o=this._timeScaleInterpolant,a=this.timeScale;return null===o&&(this._timeScaleInterpolant=o=i._lendControlInterpolant()),i=o.parameterPositions,o=o.sampleValues,i[0]=r,i[1]=r+n,o[0]=t/a,o[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,i){if(this.enabled){if(null!==(r=this._startTime)){if(0>(e=(t-r)*n)||0===n)return;this._startTime=null,e*=n}if(e*=this._updateTimeScale(t),n=this._updateTime(e),0<(t=this._updateWeight(t))){e=this._interpolants;for(var r=this._propertyBindings,o=0,a=e.length;o!==a;++o)e[o].evaluate(n),r[o].accumulate(i,t)}}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(t)[0];e=e*i;t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n){e=e*n.evaluate(t)[0];t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,i=this.loop,r=this._loopCount;if(2200===i)t:{if(-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1)),e>=n)e=n;else{if(!(0>e))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(i=2202===i,-1===r&&(0<=t?(r=0,this._setEndings(!0,0===this.repetitions,i)):this._setEndings(0===this.repetitions,!0,i)),e>=n||0>e){var o=Math.floor(e/n),a=(e=e-n*o,r=r+Math.abs(o),this.repetitions-r);0>a?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(0===a?(t=0>t,this._setEndings(t,!t,i)):this._setEndings(!1,!1,i),this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o}))}if(i&&1==(1&r))return this.time=e,n-e}return this.time=e},_setEndings:function(t,e,n){var i=this._interpolantSettings;n?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,i.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var i=this._mixer,r=i.time,o=this._weightInterpolant;return null===o&&(this._weightInterpolant=o=i._lendControlInterpolant()),i=o.parameterPositions,o=o.sampleValues,i[0]=r,o[0]=e,i[1]=r+t,o[1]=n,this}}),Fi.prototype=Object.assign(Object.create(e.prototype),{constructor:Fi,_bindAction:function(t,e){var n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,o=t._propertyBindings;t=t._interpolants;var a=n.uuid,s=this._bindingsByRootAndName,l=s[a];for(void 0===l&&(l={},s[a]=l),s=0;s!==r;++s){var u=i[s],c=u.name,h=l[c];if(void 0===h){if(void 0!==(h=o[s])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,a,c));continue}++(h=new Li(Ii.create(n,c,e&&e._propertyBindings[s].binding.parsedPath),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(h,a,c)}o[s]=h,t[s].resultBuffer=h.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}for(n=0,i=(e=t._propertyBindings).length;n!==i;++n){var r=e[n];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions},_addInactiveAction:function(t,e,n){var i=this._actions,r=this._actionsByClip,o=r[e];void 0===o?(o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o):(e=o.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=i.length,i.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=(i=this._actions)[i.length-1],n=t._cacheIndex;e._cacheIndex=n,i[n]=e,i.pop(),t._cacheIndex=null;var i=t._clip.uuid,r=(n=(e=this._actionsByClip)[i]).knownActions,o=r[r.length-1],a=t._byClipCacheIndex;o._byClipCacheIndex=a,r[a]=o,r.pop(),t._byClipCacheIndex=null,delete n.actionByRoot[(t._localRoot||this._root).uuid],0===r.length&&delete e[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=0,n=(t=t._propertyBindings).length;e!==n;++e){var i=t[e];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_addInactiveBinding:function(t,e,n){var i=this._bindingsByRootAndName,r=i[e],o=this._bindings;void 0===r&&(r={},i[e]=r),r[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=(i=t.binding).rootNode.uuid,i=i.path,r=this._bindingsByRootAndName,o=r[n],a=e[e.length-1];t=t._cacheIndex,a._cacheIndex=t,e[t]=a,e.pop(),delete o[i];t:{for(var s in o)break t;delete r[n]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&(n=new fi(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n,i=(n=e||this._root).uuid;t=null!==(n="string"==typeof t?vi.findByName(n,t):t)?n.uuid:t;var r=this._actionsByClip[t],o=null;if(void 0!==r){if(void 0!==(o=r.actionByRoot[i]))return o;o=r.knownActions[0],null===n&&(n=o._clip)}return null===n?null:(e=new Ui(this,n,e),this._bindAction(e,o),this._addInactiveAction(e,t,i),e)},existingAction:function(t,e){var n=e||this._root;return e=n.uuid,n="string"==typeof t?vi.findByName(n,t):t,void 0!==(t=this._actionsByClip[n?n.uuid:t])?t.actionByRoot[e]||null:null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions,n=this._bindings,i=this._nActiveBindings,r=this._nActiveBindings=this._nActiveActions=0;r!==e;++r)t[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a)e[a]._update(i,t,r,o);for(t=this._bindings,e=this._nActiveBindings,a=0;a!==e;++a)t[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var n=this._actionsByClip;if(void 0!==(i=n[t])){for(var i,r=0,o=(i=i.knownActions).length;r!==o;++r){var a=i[r];this._deactivateAction(a);var s=a._cacheIndex,l=e[e.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,l._cacheIndex=s,e[s]=l,e.pop(),this._removeInactiveBindingsForAction(a)}delete n[t]}},uncacheRoot:function(t){t=t.uuid;var e=this._actionsByClip;for(i in e){var n=e[i].actionByRoot[t];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}var i=this._bindingsByRootAndName[t];if(void 0!==i)for(var r in i)(t=i[r]).restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){null!==(t=this.existingAction(t,e))&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),Bi.prototype.clone=function(){return new Bi(void 0===this.value.clone?this.value:this.value.clone())},ji.prototype=Object.assign(Object.create(yt.prototype),{constructor:ji,isInstancedBufferGeometry:!0,copy:function(t){return yt.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(zi.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(zi.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}}),Object.defineProperty(Vi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Vi.prototype,{isInterleavedBuffer:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),Wi.prototype=Object.assign(Object.create(Vi.prototype),{constructor:Wi,isInstancedInterleavedBuffer:!0,copy:function(t){return Vi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Gi.prototype=Object.assign(Object.create(at.prototype),{constructor:Gi,isInstancedBufferAttribute:!0,copy:function(t){return at.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Yi.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var n=[];return qi(t,this,n,e),n.sort(Xi),n},intersectObjects:function(t,e){var n=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,r=t.length;i<r;i++)qi(t[i],this,n,e);return n.sort(Xi),n}}),Object.assign(Ji.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3;this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(Ki.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(wr.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(Zi.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),($i.prototype=Object.create(et.prototype)).constructor=$i,$i.prototype.isImmediateRenderObject=!0,(Qi.prototype=Object.create(oe.prototype)).constructor=Qi,Qi.prototype.update=function(){var t=new o,e=new o,n=new a;return function(){var i,r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var o=this.object.matrixWorld,a=this.geometry.attributes.position;if((i=this.object.geometry)&&i.isGeometry)for(var s=i.vertices,l=i.faces,u=i=0,c=l.length;u<c;u++)for(var h=l[u],d=0,f=h.vertexNormals.length;d<f;d++){var p=h.vertexNormals[d];t.copy(s[h[r[d]]]).applyMatrix4(o),e.copy(p).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(i,t.x,t.y,t.z),i+=1,a.setXYZ(i,e.x,e.y,e.z),i+=1}else if(i&&i.isBufferGeometry)for(r=i.attributes.position,s=i.attributes.normal,d=i=0,f=r.count;d<f;d++)t.set(r.getX(d),r.getY(d),r.getZ(d)).applyMatrix4(o),e.set(s.getX(d),s.getY(d),s.getZ(d)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(i,t.x,t.y,t.z),i+=1,a.setXYZ(i,e.x,e.y,e.z),i+=1;a.needsUpdate=!0}}(),(tr.prototype=Object.create(et.prototype)).constructor=tr,tr.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},tr.prototype.update=function(){var t=new o,e=new o;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,i=n*Math.tan(this.light.angle);this.cone.scale.set(i,i,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),(nr.prototype=Object.create(oe.prototype)).constructor=nr,nr.prototype.updateMatrixWorld=function(){var t=new o,e=new i,n=new i;return function(i){var r=this.bones,o=this.geometry,a=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,l=0;s<r.length;s++){var u=r[s];u.parent&&u.parent.isBone&&(e.multiplyMatrices(n,u.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(l,t.x,t.y,t.z),e.multiplyMatrices(n,u.parent.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(l+1,t.x,t.y,t.z),l+=2)}o.getAttribute("position").needsUpdate=!0,et.prototype.updateMatrixWorld.call(this,i)}}(),(ir.prototype=Object.create(Ot.prototype)).constructor=ir,ir.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ir.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},(rr.prototype=Object.create(et.prototype)).constructor=rr,rr.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},rr.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,n=this.line.geometry.attributes.position,i=n.array;i[0]=t,i[1]=-e,i[2]=0,i[3]=t,i[4]=e,i[5]=0,i[6]=-t,i[7]=e,i[8]=0,i[9]=-t,i[10]=-e,i[11]=0,i[12]=t,i[13]=-e,i[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},(or.prototype=Object.create(et.prototype)).constructor=or,or.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},or.prototype.update=function(){var t=new o,e=new z,n=new z;return function(){var i=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var r=i.geometry.getAttribute("color");e.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,a=r.count;o<a;o++){var s=o<a/2?e:n;r.setXYZ(o,s.r,s.g,s.b)}r.needsUpdate=!0}i.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),(ar.prototype=Object.create(oe.prototype)).constructor=ar,(sr.prototype=Object.create(oe.prototype)).constructor=sr,(lr.prototype=Object.create(oe.prototype)).constructor=lr,lr.prototype.update=function(){var t=new o,e=new o,n=new a;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var i,r=this.object.matrixWorld,o=this.geometry.attributes.position,a=(i=this.object.geometry).vertices,s=0,l=0,u=(i=i.faces).length;l<u;l++){var c=i[l],h=c.normal;t.copy(a[c.a]).add(a[c.b]).add(a[c.c]).divideScalar(3).applyMatrix4(r),e.copy(h).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(s,t.x,t.y,t.z),s+=1,o.setXYZ(s,e.x,e.y,e.z),s+=1}o.needsUpdate=!0}}(),(ur.prototype=Object.create(et.prototype)).constructor=ur,ur.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},ur.prototype.update=function(){var t=new o,e=new o,n=new o;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),(cr.prototype=Object.create(oe.prototype)).constructor=cr,cr.prototype.update=function(){function t(t,o,a,s){if(i.set(o,a,s).unproject(r),void 0!==(t=n[t]))for(o=e.getAttribute("position"),a=0,s=t.length;a<s;a++)o.setXYZ(t[a],i.x,i.y,i.z)}var e,n,i=new o,r=new nt;return function(){e=this.geometry,n=this.pointMap,r.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),(hr.prototype=Object.create(oe.prototype)).constructor=hr,hr.prototype.update=function(){var t=new q;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){e=t.min;var n=t.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),hr.prototype.setFromObject=function(t){return this.object=t,this.update(),this},(dr.prototype=Object.create(oe.prototype)).constructor=dr,dr.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),et.prototype.updateMatrixWorld.call(this,t))},(fr.prototype=Object.create(re.prototype)).constructor=fr,fr.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;1e-8>Math.abs(e)&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),et.prototype.updateMatrixWorld.call(this,t)};var ro,oo;(pr.prototype=Object.create(et.prototype)).constructor=pr,pr.prototype.setDirection=function(){var t,e=new o;return function(n){.99999<n.y?this.quaternion.set(0,0,0,1):-.99999>n.y?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),pr.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},pr.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},(mr.prototype=Object.create(oe.prototype)).constructor=mr,Pn.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Pn.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Yn.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new ot,n=0,i=t.length;n<i;n++){var r=t[n];e.vertices.push(new o(r.x,r.y,r.z||0))}return e}}),Object.assign(Xn.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),gr.prototype=Object.create(Dn.prototype),vr.prototype=Object.create(Dn.prototype),yr.prototype=Object.create(Dn.prototype),Object.assign(yr.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),ar.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},nr.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(bi.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),$r.extractUrlBase(t)}}),Object.assign(V.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(q.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),St.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(wr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),wr.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),wr.ceilPowerOfTwo(t)}}),Object.assign(a.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(i.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new o),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,o)}}),K.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},r.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(xt.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(qn.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new qe(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new on(this,t)}}),Object.assign(n.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(o.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(l.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ot.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(et.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(et.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Qt.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(te.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Pn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),zt.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Jn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(at.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(yt.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(yt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Bi.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(G.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new z}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}}}),Object.defineProperties(wn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Ct.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Yt.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(Yt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties($.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(t){t=1!==t,console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(u.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.assign(Wt.prototype,{getStandingMatrix:function(){console.warn("THREE.WebVRManager: .getStandingMatrix() has been removed.")}}),Object.defineProperties(Wt.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Pi.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Mi).load(t,function(t){e.setBuffer(t)}),this},ki.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ri.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},t.WebGLRenderTargetCube=c,t.WebGLRenderTarget=u,t.WebGLRenderer=Yt,t.ShaderLib=Nr,t.UniformsLib=Rr,t.UniformsUtils=Ar,t.ShaderChunk=Pr,t.FogExp2=Xt,t.Fog=qt,t.Scene=Jt,t.LensFlare=Kt,t.Sprite=$t,t.LOD=Qt,t.SkinnedMesh=ne,t.Skeleton=te,t.Bone=ee,t.Mesh=Ot,t.LineSegments=oe,t.LineLoop=ae,t.Line=re,t.Points=le,t.Group=ue,t.VideoTexture=ce,t.DataTexture=h,t.CompressedTexture=he,t.CubeTexture=d,t.CanvasTexture=W,t.DepthTexture=de,t.Texture=s,t.CompressedTextureLoader=Sn,t.DataTextureLoader=Mn,t.CubeTextureLoader=Rn,t.TextureLoader=An,t.ObjectLoader=Ei,t.MaterialLoader=yi,t.BufferGeometryLoader=wi,t.DefaultLoadingManager=Vr,t.LoadingManager=Cn,t.JSONLoader=_i,t.ImageLoader=On,t.ImageBitmapLoader=Ti,t.FontLoader=Si,t.FileLoader=xn,t.Loader=bi,t.LoaderUtils=$r,t.Cache=zr,t.AudioLoader=Mi,t.SpotLightShadow=$n,t.SpotLight=Qn,t.PointLight=ti,t.RectAreaLight=ri,t.HemisphereLight=Kn,t.DirectionalLightShadow=ei,t.DirectionalLight=ni,t.AmbientLight=ii,t.LightShadow=Zn,t.Light=Jn,t.StereoCamera=Oi,t.PerspectiveCamera=zt,t.OrthographicCamera=it,t.CubeCamera=Ri,t.ArrayCamera=Vt,t.Camera=nt,t.AudioListener=Ai,t.PositionalAudio=Ni,t.AudioContext=io,t.AudioAnalyser=ki,t.Audio=Pi,t.VectorKeyframeTrack=gi,t.StringKeyframeTrack=oi,t.QuaternionKeyframeTrack=ui,t.NumberKeyframeTrack=hi,t.ColorKeyframeTrack=ci,t.BooleanKeyframeTrack=ai,t.PropertyMixer=Li,t.PropertyBinding=Ii,t.KeyframeTrack=mi,t.AnimationUtils=Kr,t.AnimationObjectGroup=Hi,t.AnimationMixer=Fi,t.AnimationClip=vi,t.Uniform=Bi,t.InstancedBufferGeometry=ji,t.BufferGeometry=yt,t.Geometry=ot,t.InterleavedBufferAttribute=zi,t.InstancedInterleavedBuffer=Wi,t.InterleavedBuffer=Vi,t.InstancedBufferAttribute=Gi,t.Face3=rt,t.Object3D=et,t.Raycaster=Yi,t.Layers=tt,t.EventDispatcher=e,t.Clock=Ji,t.QuaternionLinearInterpolant=li,t.LinearInterpolant=fi,t.DiscreteInterpolant=pi,t.CubicInterpolant=di,t.Interpolant=si,t.Triangle=Mt,t.Math=wr,t.Spherical=Ki,t.Cylindrical=Zi,t.Plane=K,t.Frustum=Z,t.Sphere=J,t.Ray=xt,t.Matrix4=i,t.Matrix3=a,t.Box3=q,t.Box2=V,t.Line3=St,t.Euler=Q,t.Vector4=l,t.Vector3=o,t.Vector2=n,t.Quaternion=r,t.Color=z,t.ImmediateRenderObject=$i,t.VertexNormalsHelper=Qi,t.SpotLightHelper=tr,t.SkeletonHelper=nr,t.PointLightHelper=ir,t.RectAreaLightHelper=rr,t.HemisphereLightHelper=or,t.GridHelper=ar,t.PolarGridHelper=sr,t.FaceNormalsHelper=lr,t.DirectionalLightHelper=ur,t.CameraHelper=cr,t.BoxHelper=hr,t.Box3Helper=dr,t.PlaneHelper=fr,t.ArrowHelper=pr,t.AxesHelper=mr,t.Shape=qn,t.Path=Xn,t.ShapePath=Ci,t.Font=xi,t.CurvePath=Yn,t.Curve=Pn,t.ShapeUtils=Fr,t.SceneUtils={createMultiMaterialObject:function(t,e){for(var n=new ue,i=0,r=e.length;i<r;i++)n.add(new Ot(t,e[i]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){t.applyMatrix((new i).getInverse(n.matrixWorld)),e.remove(t),n.add(t)}},t.WebGLUtils=Gt,t.WireframeGeometry=fe,t.ParametricGeometry=pe,t.ParametricBufferGeometry=me,t.TetrahedronGeometry=ye,t.TetrahedronBufferGeometry=we,t.OctahedronGeometry=be,t.OctahedronBufferGeometry=_e,t.IcosahedronGeometry=Ee,t.IcosahedronBufferGeometry=Te,t.DodecahedronGeometry=Ce,t.DodecahedronBufferGeometry=xe,t.PolyhedronGeometry=ge,t.PolyhedronBufferGeometry=ve,t.TubeGeometry=Se,t.TubeBufferGeometry=Me,t.TorusKnotGeometry=Oe,t.TorusKnotBufferGeometry=Re,t.TorusGeometry=Ae,t.TorusBufferGeometry=Pe,t.TextGeometry=Ke,t.TextBufferGeometry=Ze,t.SphereGeometry=$e,t.SphereBufferGeometry=Qe,t.RingGeometry=tn,t.RingBufferGeometry=en,t.PlaneGeometry=_t,t.PlaneBufferGeometry=Et,t.LatheGeometry=nn,t.LatheBufferGeometry=rn,t.ShapeGeometry=on,t.ShapeBufferGeometry=an,t.ExtrudeGeometry=qe,t.ExtrudeBufferGeometry=Je,t.EdgesGeometry=ln,t.ConeGeometry=hn,t.ConeBufferGeometry=dn,t.CylinderGeometry=un,t.CylinderBufferGeometry=cn,t.CircleGeometry=fn,t.CircleBufferGeometry=pn,t.BoxGeometry=wt,t.BoxBufferGeometry=bt,t.ShadowMaterial=mn,t.SpriteMaterial=Zt,t.RawShaderMaterial=gn,t.ShaderMaterial=Ct,t.PointsMaterial=se,t.MeshPhysicalMaterial=yn,t.MeshStandardMaterial=vn,t.MeshPhongMaterial=wn,t.MeshToonMaterial=bn,t.MeshNormalMaterial=_n,t.MeshLambertMaterial=En,t.MeshDepthMaterial=Y,t.MeshDistanceMaterial=X,t.MeshBasicMaterial=Tt,t.LineDashedMaterial=Tn,t.LineBasicMaterial=ie,t.Material=G,t.Float64BufferAttribute=mt,t.Float32BufferAttribute=pt,t.Uint32BufferAttribute=ft,t.Int32BufferAttribute=dt,t.Uint16BufferAttribute=ht,t.Int16BufferAttribute=ct,t.Uint8ClampedBufferAttribute=ut,t.Uint8BufferAttribute=lt,t.Int8BufferAttribute=st,t.BufferAttribute=at,t.ArcCurve=kn,t.CatmullRomCurve3=Dn,t.CubicBezierCurve=Fn,t.CubicBezierCurve3=Bn,t.EllipseCurve=Nn,t.LineCurve=jn,t.LineCurve3=zn,t.QuadraticBezierCurve=Vn,t.QuadraticBezierCurve3=Wn,t.SplineCurve=Gn,t.REVISION="89",t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.FlatShading=1,t.SmoothShading=2,t.NoColors=0,t.FaceColors=1,t.VertexColors=2,t.NoBlending=0,t.NormalBlending=1,t.AdditiveBlending=2,t.SubtractiveBlending=3,t.MultiplyBlending=4,t.CustomBlending=5,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.NeverDepth=0,t.AlwaysDepth=1,t.LessDepth=2,t.LessEqualDepth=3,t.EqualDepth=4,t.GreaterEqualDepth=5,t.GreaterDepth=6,t.NotEqualDepth=7,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.NoToneMapping=0,t.LinearToneMapping=1,t.ReinhardToneMapping=2,t.Uncharted2ToneMapping=3,t.CineonToneMapping=4,t.UVMapping=300,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.SphericalReflectionMapping=305,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.NearestFilter=1003,t.NearestMipMapNearestFilter=1004,t.NearestMipMapLinearFilter=1005,t.LinearFilter=1006,t.LinearMipMapNearestFilter=1007,t.LinearMipMapLinearFilter=1008,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.HalfFloatType=1016,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedInt248Type=1020,t.AlphaFormat=1021,t.RGBFormat=1022,t.RGBAFormat=1023,t.LuminanceFormat=1024,t.LuminanceAlphaFormat=1025,t.RGBEFormat=1023,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.RGB_S3TC_DXT1_Format=2001,t.RGBA_S3TC_DXT1_Format=2002,t.RGBA_S3TC_DXT3_Format=2003,t.RGBA_S3TC_DXT5_Format=2004,t.RGB_PVRTC_4BPPV1_Format=2100,t.RGB_PVRTC_2BPPV1_Format=2101,t.RGBA_PVRTC_4BPPV1_Format=2102,t.RGBA_PVRTC_2BPPV1_Format=2103,t.RGB_ETC1_Format=2151,t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.ZeroCurvatureEnding=2400,t.ZeroSlopeEnding=2401,t.WrapAroundEnding=2402,t.TrianglesDrawMode=0,t.TriangleStripDrawMode=1,t.TriangleFanDrawMode=2,t.LinearEncoding=3e3,t.sRGBEncoding=3001,t.GammaEncoding=3007,t.RGBEEncoding=3002,t.LogLuvEncoding=3003,t.RGBM7Encoding=3004,t.RGBM16Encoding=3005,t.RGBDEncoding=3006,t.BasicDepthPacking=3200,t.RGBADepthPacking=3201,t.CubeGeometry=wt,t.Face4=function(t,e,n,i,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new rt(t,e,n,r,o,a)},t.LineStrip=0,t.LinePieces=1,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t},t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new le(t,e)},t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new $t(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new le(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new se(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new se(t)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new se(t)},t.Vertex=function(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new o(t,e,n)},t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new at(t,e).setDynamic(!0)},t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new st(t,e)},t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new lt(t,e)},t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ut(t,e)},t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ct(t,e)},t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ht(t,e)},t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new dt(t,e)},t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new ft(t,e)},t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new pt(t,e)},t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new mt(t,e)},t.ClosedSplineCurve3=gr,t.SplineCurve3=vr,t.Spline=yr,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new mr(t)},t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new hr(t,e)},t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new oe(new ln(t.geometry),new ie({color:void 0!==e?e:16777215}))},t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new oe(new fe(t.geometry),new ie({color:void 0!==e?e:16777215}))},t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new xn(t)},t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Mn(t)},t.GeometryUtils={merge:function(t,e,n){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh){e.matrixAutoUpdate&&e.updateMatrix();var i=e.matrix;e=e.geometry}t.merge(e,i,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new An;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,n,void 0,i),e&&(t.mapping=e),t},loadTextureCube:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Rn;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,n,void 0,i),e&&(t.mapping=e),t},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},t.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(t,"__esModule",{value:!0})}),define("threejs",["threemin"],function(t){return window.THREE=t,t}),THREE.CSS3DObject=function(t){THREE.Object3D.call(this),this.element=t,this.element.style.position="absolute",this.addEventListener("removed",function(t){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},THREE.CSS3DObject.prototype=Object.create(THREE.Object3D.prototype),THREE.CSS3DObject.prototype.constructor=THREE.CSS3DObject,THREE.CSS3DSprite=function(t){THREE.CSS3DObject.call(this,t)},THREE.CSS3DSprite.prototype=Object.create(THREE.CSS3DObject.prototype),THREE.CSS3DSprite.prototype.constructor=THREE.CSS3DSprite,THREE.CSS3DRenderer=function(){console.log("THREE.CSS3DRenderer",THREE.REVISION);var t,e,n,i,r=new THREE.Matrix4,o={camera:{fov:0,style:""},objects:{}},a=document.createElement("div");a.style.overflow="hidden",a.style.WebkitTransformStyle="preserve-3d",a.style.MozTransformStyle="preserve-3d",a.style.oTransformStyle="preserve-3d",a.style.transformStyle="preserve-3d",this.domElement=a;var s=document.createElement("div");s.style.WebkitTransformStyle="preserve-3d",s.style.MozTransformStyle="preserve-3d",s.style.oTransformStyle="preserve-3d",s.style.transformStyle="preserve-3d",a.appendChild(s),this.setClearColor=function(){},this.getSize=function(){return{width:t,height:e}},this.setSize=function(r,o){n=(t=r)/2,i=(e=o)/2,a.style.width=r+"px",a.style.height=o+"px",s.style.width=r+"px",s.style.height=o+"px"};var l=function(t){return Math.abs(t)<Number.EPSILON?0:t},u=function(t){var e=t.elements;return"translate3d(-50%,-50%,0) matrix3d("+l(e[0])+","+l(e[1])+","+l(e[2])+","+l(e[3])+","+l(-e[4])+","+l(-e[5])+","+l(-e[6])+","+l(-e[7])+","+l(e[8])+","+l(e[9])+","+l(e[10])+","+l(e[11])+","+l(e[12])+","+l(e[13])+","+l(e[14])+","+l(e[15])+")"},c=function(t,e){if(t instanceof THREE.CSS3DObject){var n;t instanceof THREE.CSS3DSprite?(r.copy(e.matrixWorldInverse),r.transpose(),r.copyPosition(t.matrixWorld),r.scale(t.scale),r.elements[3]=0,r.elements[7]=0,r.elements[11]=0,r.elements[15]=1,n=u(r)):n=u(t.matrixWorld);var i=t.element,a=o.objects[t.id];void 0!==a&&a===n||(i.style.WebkitTransform=n,i.style.MozTransform=n,i.style.oTransform=n,i.style.transform=n,o.objects[t.id]=n),i.parentNode!==s&&s.appendChild(i)}for(var l=0,h=t.children.length;l<h;l++)c(t.children[l],e)};this.render=function(t,r){var u=.5/Math.tan(THREE.Math.degToRad(.5*r.getEffectiveFOV()))*e;o.camera.fov!==u&&(a.style.WebkitPerspective=u+"px",a.style.MozPerspective=u+"px",a.style.oPerspective=u+"px",a.style.perspective=u+"px",o.camera.fov=u),t.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),r.matrixWorldInverse.getInverse(r.matrixWorld);var h="translate3d(0,0,"+u+"px)"+function(t){var e=t.elements;return"matrix3d("+l(e[0])+","+l(-e[1])+","+l(e[2])+","+l(e[3])+","+l(e[4])+","+l(-e[5])+","+l(e[6])+","+l(e[7])+","+l(e[8])+","+l(-e[9])+","+l(e[10])+","+l(e[11])+","+l(e[12])+","+l(-e[13])+","+l(e[14])+","+l(e[15])+")"}(r.matrixWorldInverse)+" translate3d("+n+"px,"+i+"px, 0)";o.camera.style!==h&&(s.style.WebkitTransform=h,s.style.MozTransform=h,s.style.oTransform=h,s.style.transform=h,o.camera.style=h),c(t,r)}},define("CSS3DRenderer",function(){}),THREE.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*l.autoRotateSpeed}function i(){return Math.pow(.95,l.zoomSpeed)}function r(t){if(!1!==l.enabled){if(0===t.button){if(!0===l.noRotate)return;M=S.ROTATE,u.set(t.clientX,t.clientY)}else if(1===t.button){if(!0===l.noZoom)return;t.preventDefault(),M=S.DOLLY,v.set(t.clientX,t.clientY)}else if(2===t.button){if(!0===l.noPan)return;t.preventDefault(),M=S.PAN,d.set(t.clientX,t.clientY)}document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",a,!1),l.dispatchEvent(P)}}function o(t){if(!1!==l.enabled){t.preventDefault();var e=l.domElement===document?l.domElement.body:l.domElement;if(M===S.ROTATE){if(!0===l.noRotate)return;c.set(t.clientX,t.clientY),h.subVectors(c,u),l.rotateLeft(2*Math.PI*h.x/e.clientWidth*l.rotateSpeed),l.rotateUp(2*Math.PI*h.y/e.clientHeight*l.rotateSpeed),u.copy(c)}else if(M===S.DOLLY){if(!0===l.noZoom)return;y.set(t.clientX,t.clientY),w.subVectors(y,v),w.y>0?l.dollyIn():l.dollyOut(),v.copy(y)}else if(M===S.PAN){if(!0===l.noPan)return;f.set(t.clientX,t.clientY),p.subVectors(f,d),l.pan(p.x,p.y),d.copy(f)}l.update()}}function a(){!1!==l.enabled&&(document.removeEventListener("mousemove",o,!1),document.removeEventListener("mouseup",a,!1),l.dispatchEvent(N),M=S.NONE)}function s(t){if(!(l.domElement.className.indexOf("freezeZooming")>-1)&&!1!==l.enabled&&!0!==l.noZoom){var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?l.dollyOut():l.dollyIn(),l.update(),l.dispatchEvent(P),l.dispatchEvent(N)}}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=400,this.maxDistance=3e4,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var l=this,u=new THREE.Vector2,c=new THREE.Vector2,h=new THREE.Vector2,d=new THREE.Vector2,f=new THREE.Vector2,p=new THREE.Vector2,m=new THREE.Vector3,g=new THREE.Vector3,v=new THREE.Vector2,y=new THREE.Vector2,w=new THREE.Vector2,b=0,_=0,E=1,T=new THREE.Vector3,C=new THREE.Vector3,x=new THREE.Quaternion,S={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},M=S.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var O=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),R=O.clone().inverse(),A={type:"change"},P={type:"start"},N={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=n()),_-=t},this.rotateUp=function(t){void 0===t&&(t=n()),b-=t},this.panLeft=function(t){var e=this.object.matrix.elements;m.set(e[0],e[1],e[2]),m.multiplyScalar(-t),T.add(m)},this.panUp=function(t){var e=this.object.matrix.elements;m.set(e[4],e[5],e[6]),m.multiplyScalar(t),T.add(m)},this.pan=function(t,e){var n=l.domElement===document?l.domElement.body:l.domElement;if(void 0!==l.object.fov){var i=l.object.position.clone().sub(l.target).length();i*=Math.tan(l.object.fov/2*Math.PI/180),l.panLeft(2*t*i/n.clientHeight),l.panUp(2*e*i/n.clientHeight)}else void 0!==l.object.top?(l.panLeft(t*(l.object.right-l.object.left)/n.clientWidth),l.panUp(e*(l.object.top-l.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=i()),E/=t},this.dollyOut=function(t){void 0===t&&(t=i()),E*=t},this.update=function(){var t=this.object.position;g.copy(t).sub(this.target),g.applyQuaternion(O);var e=Math.atan2(g.x,g.z),i=Math.atan2(Math.sqrt(g.x*g.x+g.z*g.z),g.y);this.autoRotate&&this.rotateLeft(n()),e+=_,i+=b,i=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,i)),i=Math.max(1e-6,Math.min(Math.PI-1e-6,i));var r=g.length()*E;r=Math.max(this.minDistance,Math.min(this.maxDistance,r)),this.target.add(T),g.x=r*Math.sin(i)*Math.sin(e),g.y=r*Math.cos(i),g.z=r*Math.sin(i)*Math.cos(e),g.applyQuaternion(R),t.copy(this.target).add(g),this.object.lookAt(this.target),_=0,b=0,E=1,T.set(0,0,0),(C.distanceToSquared(this.object.position)>1e-6||8*(1-x.dot(this.object.quaternion))>1e-6)&&(this.dispatchEvent(A),C.copy(this.object.position),x.copy(this.object.quaternion))},this.reset=function(){M=S.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault(),r(t)},!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",function(t){if(!1!==l.enabled){switch(t.touches.length){case 1:if(!0===l.noRotate)return;M=S.TOUCH_ROTATE,u.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===l.noZoom)return;M=S.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);v.set(0,i);break;case 3:if(!0===l.noPan)return;M=S.TOUCH_PAN,d.set(t.touches[0].pageX,t.touches[0].pageY);break;default:M=S.NONE}l.dispatchEvent(P)}},!1),this.domElement.addEventListener("touchend",function(){!1!==l.enabled&&(l.dispatchEvent(N),M=S.NONE)},!1),this.domElement.addEventListener("touchmove",function(t){if(!1!==l.enabled){t.preventDefault(),t.stopPropagation();var e=l.domElement===document?l.domElement.body:l.domElement;switch(t.touches.length){case 1:if(!0===l.noRotate)return;if(M!==S.TOUCH_ROTATE)return;c.set(t.touches[0].pageX,t.touches[0].pageY),h.subVectors(c,u),l.rotateLeft(2*Math.PI*h.x/e.clientWidth*l.rotateSpeed),l.rotateUp(2*Math.PI*h.y/e.clientHeight*l.rotateSpeed),u.copy(c),l.update();break;case 2:if(!0===l.noZoom)return;if(M!==S.TOUCH_DOLLY)return;var n=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(n*n+i*i);y.set(0,r),w.subVectors(y,v),w.y>0?l.dollyOut():l.dollyIn(),v.copy(y),l.update();break;case 3:if(!0===l.noPan)return;if(M!==S.TOUCH_PAN)return;f.set(t.touches[0].pageX,t.touches[0].pageY),p.subVectors(f,d),l.pan(p.x,p.y),d.copy(f),l.update();break;default:M=S.NONE}}},!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),define("OrbitControls",function(){}),function(t,e){"use strict";"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define("bootstrap3-typeahead",["jquery"],function(t){return e(t)}):e(t.jQuery)}(this,function(t){"use strict";var e=function(e,n){this.$element=t(e),this.options=t.extend({},t.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"!=typeof this.options.autoSelect||this.options.autoSelect,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.source=this.options.source,this.delay=this.options.delay,this.$menu=t(this.options.menu),this.$appendTo=this.options.appendTo?t(this.options.appendTo):null,this.shown=!1,this.listen(),this.showHintOnFocus="boolean"==typeof this.options.showHintOnFocus&&this.options.showHintOnFocus,this.afterSelect=this.options.afterSelect,this.addItem=!1};e.prototype={constructor:e,select:function(){var t=this.$menu.find(".active").data("value");if(this.$element.data("active",t),this.autoSelect||t){var e=this.updater(t);this.$element.val(this.displayText(e)||e).change(),this.afterSelect(e)}return this.hide()},updater:function(t){return t},setSource:function(t){this.source=t},show:function(){var e,n=t.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return e="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight,(this.$appendTo?this.$menu.appendTo(this.$appendTo):this.$menu.insertAfter(this.$element)).css({top:n.top+n.height+e,left:n.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(e){if(this.query=void 0!==e&&null!==e?e:this.$element.val()||"",this.query.length<this.options.minLength)return this.shown?this.hide():this;var n=t.proxy(function(){t.isFunction(this.source)?this.source(this.query,t.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(n,this.delay)},process:function(e){var n=this;return e=t.grep(e,function(t){return n.matcher(t)}),(e=this.sorter(e)).length||this.options.addItem?(e.length>0?this.$element.data("active",e[0]):this.$element.data("active",null),this.options.addItem&&e.push(this.options.addItem),"all"==this.options.items?this.render(e).show():this.render(e.slice(0,this.options.items)).show()):this.shown?this.hide():this},matcher:function(t){return~this.displayText(t).toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var e,n=[],i=[],r=[];e=t.shift();){var o=this.displayText(e);o.toLowerCase().indexOf(this.query.toLowerCase())?~o.indexOf(this.query)?i.push(e):r.push(e):n.push(e)}return n.concat(i,r)},highlighter:function(e){var n,i,r,o,a,s=t("<div></div>"),l=this.query,u=e.toLowerCase().indexOf(l.toLowerCase());if(0===(n=l.length))return s.text(e).html();for(;u>-1;)i=e.substr(0,u),r=e.substr(u,n),o=e.substr(u+n),a=t("<strong></strong>").text(r),s.append(document.createTextNode(i)).append(a),e=o,u=e.toLowerCase().indexOf(l.toLowerCase());return s.append(document.createTextNode(e)).html()},render:function(e){var n=this,i=this,r=!1;return e=t(e).map(function(e,o){var a=i.displayText(o);return(e=t(n.options.item).data("value",o)).find("a").html(n.highlighter(a)),a==i.$element.val()&&(e.addClass("active"),i.$element.data("active",o),r=!0),e[0]}),this.autoSelect&&!r&&(e.first().addClass("active"),this.$element.data("active",e.first().data("value"))),this.$menu.html(e),this},displayText:function(t){return t.name||t},next:function(){var e=this.$menu.find(".active").removeClass("active").next();e.length||(e=t(this.$menu.find("li")[0])),e.addClass("active")},prev:function(){var t=this.$menu.find(".active").removeClass("active").prev();t.length||(t=this.$menu.find("li").last()),t.addClass("active")},listen:function(){this.$element.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("keypress",t.proxy(this.keypress,this)).on("keyup",t.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",t.proxy(this.keydown,this)),this.$menu.on("click",t.proxy(this.click,this)).on("mouseenter","li",t.proxy(this.mouseenter,this)).on("mouseleave","li",t.proxy(this.mouseleave,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.off("focus").off("blur").off("keypress").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove()},eventSupported:function(t){var e=t in this.$element;return e||(this.$element.setAttribute(t,"return;"),e="function"==typeof this.$element[t]),e},move:function(t){if(this.shown){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:if(t.shiftKey)return;t.preventDefault(),this.prev();break;case 40:if(t.shiftKey)return;t.preventDefault(),this.next()}t.stopPropagation()}},keydown:function(e){this.suppressKeyPressRepeat=~t.inArray(e.keyCode,[40,38,9,13,27]),this.shown||40!=e.keyCode?this.move(e):this.lookup()},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.stopPropagation(),t.preventDefault()},focus:function(){this.focused||(this.focused=!0,this.options.showHintOnFocus&&this.lookup(""))},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(e){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),t(e.currentTarget).addClass("active")},mouseleave:function(){}};var n=t.fn.typeahead;t.fn.typeahead=function(n){var i=arguments;return"string"==typeof n&&"getActive"==n?this.data("active"):this.each(function(){var r=t(this),o=r.data("typeahead"),a="object"==typeof n&&n;o||r.data("typeahead",o=new e(this,a)),"string"==typeof n&&(i.length>1?o[n].apply(o,Array.prototype.slice.call(i,1)):o[n]())})},t.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a href="#" role="option"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:t.noop,delay:0,addItem:!1},t.fn.typeahead.Constructor=e,t.fn.typeahead.noConflict=function(){return t.fn.typeahead=n,this},t(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(){var e=t(this);e.data("typeahead")||e.typeahead(e.data())})}),define("componentSearcher",["dataFlow/dataFlow_loader","underscore","jquery","bootstrap","bootstrap3-typeahead"],function(t,e,n){function i(t){this.$input=t,this.init()}var r=[];return t.iterateComponents(function(t,e){r.push({functionName:t,name:e.label,shortDescription:e.desc}),e.label&&e.desc||console&&console.warn(t+" lacks a name or description field. It will not be searchable.")}),i.prototype.init=function(){var t=this.$input,e=this,i=function(t,e){var n=new RegExp(this.query||e,"i");return(t.name+" "+t.shortDescription).search(n)>-1};t.on("submit",function(t){t.preventDefault()}),t.keyup(function(e){27===e.keyCode&&(t.val(""),t.data("active",null))}),t.typeahead({source:r,highlighter:function(t){var e=t.name+" / "+t.shortDescription,n=new RegExp(this.query,"gi");return e.replace(n,function(t){return"<strong>"+t+"</strong>"})},displayText:function(t){return t},matcher:i,sorter:function(t){for(var e,n=[],i=[],r=[],o=new RegExp(this.query,"i");e=t.pop();)0===e.name.search(o)?n.splice(0,0,e):e.name.search(o)>-1?n.push(e):e.shortDescription.search(o)>-1?i.push(e):r.push(e);return n.concat(i,r)},afterSelect:function(){var r=t.typeahead("getActive");r&&!0===i(r,t.val())&&n(e).trigger("selectedComponent",[r]),t.val("")}})},i.prototype.destroy=function(){this.$input.typeahead("destroy"),this.$input.remove()},i}),define("dataFlow/UI/workspaceView",["jquery","dataFlow/UI/contextMenuJupyter","dataFlow/enums","dataFlow/UI/helpTooltips","threejs","CSS3DRenderer","OrbitControls","underscore","backbone"],function(t,e,n,i){function r(){o=this,this.init()}_.extend(THREE.CSS3DObject.prototype,Backbone.Events,{addDraggableScopes:function(t){this.draggableScopes=_.union(this.draggableScopes||[],t)},addDroppableScopes:function(t){this.dropableScopes=_.union(this.dropableScopes||[],t)},getDroppableScopes:function(){return this.dropableScopes||[]},getDraggableScopes:function(){return this.draggableScopes||[]},isDroppableForScopes:function(t){return(-1===this.getDroppableScopes().indexOf("input")||-1!==t.indexOf("input"))&&((-1===this.getDroppableScopes().indexOf("output")||-1!==t.indexOf("output"))&&(t.indexOf(n.OUTPUT_TYPES.WILD)>-1||this.getDraggableScopes().indexOf(n.OUTPUT_TYPES.WILD)>-1||_.without(_.intersection(this.getDroppableScopes(),t),"input","output").length>0))},dropObject:function(t,e){this.trigger("drop",t,e)}}),_.extend(THREE.Mesh.prototype,Backbone.Events,{setHomePosition:function(){this.homePosition=this.position.clone()},getHomePosition:function(){return this.homePosition}});var o=null;r.prototype.init=function(){_.extend(this,Backbone.Events),_.bindAll(this,"destroy","drag","render","mouseUp","clearHover","setupDraggableView","startDraggingObject","getCurrentVisibleCenterPoint","hideChooser"),this.dragObject=null,this.dragOffset=[0,0],this.width=window.innerWidth,this.height=window.innerHeight,this.camera=new THREE.PerspectiveCamera(70,this.width/this.height,1,1e6),this.camera.position.z=1200},r.prototype.createWorkspace=function(){this.glscene=new THREE.Scene,this.glrenderer=new THREE.WebGLRenderer,this.glrenderer.setSize(this.width,this.height),document.body.appendChild(this.glrenderer.domElement),this.glrenderer.domElement.className="TOP",this.scene=new THREE.Scene,this.renderer=new THREE.CSS3DRenderer({alpha:!0}),this.renderer.setSize(this.width,this.height),document.body.appendChild(this.renderer.domElement),this.renderer.domElement.className="TOP",this.attachControls(),this.setupContextMenu(),this.helpTooltips=new i,this.setupDraggableEventHandlers(),s()},r.prototype.destroy=function(){this.helpTooltips.destroy(),delete this.helpTooltips,t(this.renderer.domElement).off().remove(),t(this.glrenderer.domElement).off().remove(),delete this.controls,delete this.scene,delete this.camera};var a={},s=_.once(function(){a[n.KEYS.SHIFT]=!1;window.onkeydown=function(t){t||(t=window.event),t.keyCode===n.KEYS.SHIFT&&(a[n.KEYS.SHIFT]=!0)},window.onkeyup=function(t){t||(t=window.event),t.keyCode===n.KEYS.SHIFT&&(a[n.KEYS.SHIFT]=!1)}});return r.prototype.toJSON=function(){var t=this.camera;return window.camera=this.camera,{camera:{position:t.position.toArray(),rotation:t.rotation.toArray()},controls:{target:this.controls.target.toArray()}}},r.prototype.fromJSON=function(t){if(t){if(t.camera){var e=["position","rotation","scale"],n=this.camera;_.each(e,function(e){t.camera[e]&&n[e].fromArray(t.camera[e])}),n.updateMatrixWorld(!0)}t.controls&&t.controls.target&&(this.controls.target.fromArray(t.controls.target),this.controls.target0.fromArray(t.controls.target),this.controls.update()),this.render()}},r.prototype.render=function(){this.renderer.render(this.scene,this.camera),this.glrenderer.render(this.glscene,this.camera)},r.prototype.attachControls=function(){this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement);var e=t(this.renderer.domElement);e.on("mouseleave",".freezeZooming",function(){e.removeClass("freezeZooming")}),e.on("mouseenter",".freezeZooming",function(){e.addClass("freezeZooming")}),this.controls.noRotate=!0,this.controls.zoomSpeed=.8,this.controls.addEventListener("change",this.render),t(this.controls.domElement).on("dblclick",{workspace:this},this.showChooser),t(this.controls.domElement).on("click",{workspace:this},this.hideChooser),this.render()},r.prototype.showChooser=function(e){var n=e.data.workspace,i={x:e.clientX,y:e.clientY},r=n.unprojectMouse(e.clientX,e.clientY),o=n.mouseWorldXYPosition(r),a=t('<input id="mobileSearcher" class="mobileComponentSearchInput"/>');t("body").append(a),a.css({top:i.y,left:i.x}).focus(),require(["componentSearcher"],function(e){n.searcher=new e(a),t(n.searcher).on("selectedComponent",function(t,e){e.position=o,n.trigger("createNewComponent",e),n.hideChooser()})})},r.prototype.hideChooser=function(){this.searcher&&this.searcher.destroy()},r.prototype.enableControls=function(t){this.controls.enabled=t},r.prototype.getCurrentVisibleCenterPoint=function(){return{x:this.camera.position.x,y:this.camera.position.y}},r.prototype.mouseUp=function(t){if(!_.isNull(this.dragObject)){var e=this.glDragObject.getHomePosition();if(_.isUndefined(e)||(this.dragObject.position.set(e.x,e.y,0),this.glDragObject.position.set(e.x,e.y,0),this.glDragObject.updateMatrixWorld(),this.glDragObject.trigger("changePosition"),this.render()),!_.isNull(this.hoverObject)){var n=a;-1!==this.hoverObject.getDroppableScopes().indexOf("output")?this.hoverObject.dropObject(this.dragObject,n):this.dragObject.dropObject(this.hoverObject,n)}this.dragObject=null,this.glDragObject=null,this.dragOffset={},this.renderer.domElement.removeEventListener("mousemove",this.drag),this.renderer.domElement.removeEventListener("mouseup",this.mouseUp)}_.isNull(this.hoverObject)||this.clearHover()},r.prototype.startDraggingObject=function(t){this.renderer.domElement.addEventListener("mousemove",this.drag),this.renderer.domElement.addEventListener("mouseup",this.mouseUp);var e=this.unprojectMouse(t.clientX,t.clientY),n=this.mouseWorldXYPosition(e);this.dragObject=t.object.cssObject,this.glDragObject=t.object.glObject,this.hoverObject=null,this.glHoverObject=null,this.dragOffset={x:n.x-this.dragObject.position.x,y:n.y-this.dragObject.position.y},this.intersectionObjects=this.computeDroppableObjects()},r.prototype.setupContextMenu=function(){t("div.TOP").on("contextmenu","div.draggable",function(n){n.stopPropagation(),n.preventDefault();var i=t(n.currentTarget).data("viewObject"),r=n.clientX,o=n.clientY;_.isUndefined(i.component)||new e({x:r,y:o,model:i.component})})},r.prototype.setupDraggableEventHandlers=function(){var e,n=this;t("div.TOP").on("mousedown","div.draggable",function(l){0===l.button&&!1!==n.controls.enabled&&(e=t(l.currentTarget).data("viewObject"),l.object=e,n.startDraggingObject(l),s++,_.isNull(i)&&(i=setTimeout(function(){clearTimeout(i),i=null,o=!0},r)),a||(a=setTimeout(function(){clearTimeout(a),a=null,!0===o?console.log("drag"):1===s&&function(t){"function"!=typeof e.click||_.isUndefined(t)||e.click(t.clientX,t.clientY)}(l),s=0},r)))}).on("mouseup","div.draggable",function(t){_.isNull(i)||(clearTimeout(i),i=null,o=!1)}).on("mouseout","div.draggable",function(){}).on("dblclick","div.draggable",function(t){t.stopPropagation(),"function"==typeof e.doubleclick?e.doubleclick():console.log("No doubleclick handler for view: ",e)});var i=null,r=200,o=!1,a=null,s=0},r.prototype.setupDraggableView=function(e){if(_.isUndefined(e.cssObject)||_.isUndefined(e.glObject))throw new Error("Draggable views must have both cssObject and glObject properties");t(e.cssObject.element).data("viewObject",e)},r.prototype.computeDroppableObjects=function(){function t(r){r===i.glDragObject||r===i.glscene||_.isUndefined(r.IOView)||r.IOView.cssObject.isDroppableForScopes(n)&&e.push(r),_.each(r.children,t)}var e=[],n=this.dragObject.getDraggableScopes(),i=this;return t(i.glscene),e},r.prototype.drag=function(t){event.preventDefault();var e=this.unprojectMouse(t.clientX,t.clientY),n=this.mouseWorldXYPosition(e);this.dragObject.position.set(n.x-this.dragOffset.x,n.y-this.dragOffset.y,0),this.glDragObject.position.set(n.x-this.dragOffset.x,n.y-this.dragOffset.y,0),this.glDragObject.trigger("changePosition"),this.findIntersections(e),this.render()},r.prototype.unprojectMouse=function(t,e){var n=new THREE.Vector3(t/this.glrenderer.domElement.clientWidth*2-1,-e/this.glrenderer.domElement.clientHeight*2+1,.5);return n.unproject(this.camera),n},r.prototype.mouseWorldXYPosition=function(t){if(void 0!==this.camera.fov){var e=t.clone().sub(this.camera.position).normalize(),n=-this.camera.position.z/e.z;return this.camera.position.clone().add(e.multiplyScalar(n))}},r.prototype.findIntersections=function(t){var e=new THREE.Raycaster(this.camera.position,t.clone().sub(this.camera.position).normalize()).intersectObjects(this.intersectionObjects,!0);if(e.length>0&&_.isNull(this.hoverObject)){var n=e[0];this.glHoverObject=n.object,this.hoverObject=n.object.IOView.cssObject,this.hoverObject.element.className+=" glHover"}_.isNull(this.hoverObject)||0!==e.length&&e[0].object===this.glHoverObject||this.clearHover()},r.prototype.clearHover=function(){this.hoverObject.element.className=this.hoverObject.element.className.replace(" glHover",""),this.glHoverObject=null,this.hoverObject=null},r.prototype.drawCurveFromPointToPoint=function(t,e,n){for(var i=Math.min(200,Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),r=new THREE.Vector3(Math.max(t.x+i,t.x+2*(e.x-t.x)/3),t.y,0),o=new THREE.Vector3(Math.min(e.x-i,e.x-2*(e.x-t.x)/3),e.y,0),a=new THREE.CubicBezierCurve3(t,r,o,e),s=_.isUndefined(n),l=s?new THREE.Geometry:n.geometry,u=a.getPoints(30),c=0;c<u.length;c++)l.vertices[c]=u[c];if(l.verticesNeedUpdate=!0,s){var h=new THREE.LineBasicMaterial({color:16777215});(n=new THREE.Line(l,h)).frustumCulled=!1}return n},{getWorkspaceSingleton:function(){return o},Workspace:r}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("moment",e):t.moment=e()}(this,function(){"use strict";function t(){return qt.apply(null,arguments)}function e(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function n(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function i(t){return void 0===t}function r(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function o(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function a(t,e){var n,i=[];for(n=0;n<t.length;++n)i.push(e(t[n],n));return i}function s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function l(t,e){for(var n in e)s(e,n)&&(t[n]=e[n]);return s(e,"toString")&&(t.toString=e.toString),s(e,"valueOf")&&(t.valueOf=e.valueOf),t}function u(t,e,n,i){return gt(t,e,n,i,!0).utc()}function c(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function h(t){if(null==t._isValid){var e=c(t),n=Jt.call(e.parsedDateParts,function(t){return null!=t}),i=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(i=i&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return i;t._isValid=i}return t._isValid}function d(t){var e=u(NaN);return null!=t?l(c(e),t):c(e).userInvalidated=!0,e}function f(t,e){var n,r,o;if(i(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),i(e._i)||(t._i=e._i),i(e._f)||(t._f=e._f),i(e._l)||(t._l=e._l),i(e._strict)||(t._strict=e._strict),i(e._tzm)||(t._tzm=e._tzm),i(e._isUTC)||(t._isUTC=e._isUTC),i(e._offset)||(t._offset=e._offset),i(e._pf)||(t._pf=c(e)),i(e._locale)||(t._locale=e._locale),Kt.length>0)for(n=0;n<Kt.length;n++)i(o=e[r=Kt[n]])||(t[r]=o);return t}function p(e){f(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Zt&&(Zt=!0,t.updateOffset(this),Zt=!1)}function m(t){return t instanceof p||null!=t&&null!=t._isAMomentObject}function g(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function v(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=g(e)),n}function y(t,e,n){var i,r=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),a=0;for(i=0;i<r;i++)(n&&t[i]!==e[i]||!n&&v(t[i])!==v(e[i]))&&a++;return a+o}function w(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function b(e,n){var i=!0;return l(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),i){for(var r,o=[],a=0;a<arguments.length;a++){if(r="","object"==typeof arguments[a]){r+="\n["+a+"] ";for(var s in arguments[0])r+=s+": "+arguments[0][s]+", ";r=r.slice(0,-2)}else r=arguments[a];o.push(r)}w(e+"\nArguments: "+Array.prototype.slice.call(o).join("")+"\n"+(new Error).stack),i=!1}return n.apply(this,arguments)},n)}function _(e,n){null!=t.deprecationHandler&&t.deprecationHandler(e,n),$t[e]||(w(n),$t[e]=!0)}function E(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function T(t,e){var i,r=l({},t);for(i in e)s(e,i)&&(n(t[i])&&n(e[i])?(r[i]={},l(r[i],t[i]),l(r[i],e[i])):null!=e[i]?r[i]=e[i]:delete r[i]);for(i in t)s(t,i)&&!s(e,i)&&n(t[i])&&(r[i]=l({},r[i]));return r}function C(t){null!=t&&this.set(t)}function x(t,e){var n=t.toLowerCase();te[n]=te[n+"s"]=te[e]=t}function S(t){return"string"==typeof t?te[t]||te[t.toLowerCase()]:void 0}function M(t){var e,n,i={};for(n in t)s(t,n)&&(e=S(n))&&(i[e]=t[n]);return i}function O(t,e){ee[t]=e}function R(e,n){return function(i){return null!=i?(P(this,e,i),t.updateOffset(this,n),this):A(this,e)}}function A(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function P(t,e,n){t.isValid()&&t._d["set"+(t._isUTC?"UTC":"")+e](n)}function N(t,e,n){var i=""+Math.abs(t),r=e-i.length;return(t>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}function k(t,e,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),t&&(oe[t]=r),e&&(oe[e[0]]=function(){return N(r.apply(this,arguments),e[1],e[2])}),n&&(oe[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function L(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function D(t,e){return t.isValid()?(e=I(e,t.localeData()),re[e]=re[e]||function(t){var e,n,i=t.match(ne);for(e=0,n=i.length;e<n;e++)oe[i[e]]?i[e]=oe[i[e]]:i[e]=L(i[e]);return function(e){var r,o="";for(r=0;r<n;r++)o+=E(i[r])?i[r].call(e,t):i[r];return o}}(e),re[e](t)):t.localeData().invalidDate()}function I(t,e){function n(t){return e.longDateFormat(t)||t}var i=5;for(ie.lastIndex=0;i>=0&&ie.test(t);)t=t.replace(ie,n),ie.lastIndex=0,i-=1;return t}function H(t,e,n){Ee[t]=E(e)?e:function(t,i){return t&&n?n:e}}function U(t,e){return s(Ee,t)?Ee[t](e._strict,e._locale):new RegExp(function(t){return F(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,i,r){return e||n||i||r}))}(t))}function F(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function B(t,e){var n,i=e;for("string"==typeof t&&(t=[t]),r(e)&&(i=function(t,n){n[e]=v(t)}),n=0;n<t.length;n++)Te[t[n]]=i}function j(t,e){B(t,function(t,n,i,r){i._w=i._w||{},e(t,i._w,i,r)})}function z(t,e,n){null!=e&&s(Te,t)&&Te[t](e,n._a,n,t)}function V(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function W(t,e){var n;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=v(e);else if(e=t.localeData().monthsParse(e),!r(e))return t;return n=Math.min(t.date(),V(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function G(e){return null!=e?(W(this,e),t.updateOffset(this,!0),this):A(this,"Month")}function Y(){function t(t,e){return e.length-t.length}var e,n,i=[],r=[],o=[];for(e=0;e<12;e++)n=u([2e3,e]),i.push(this.monthsShort(n,"")),r.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(i.sort(t),r.sort(t),o.sort(t),e=0;e<12;e++)i[e]=F(i[e]),r[e]=F(r[e]);for(e=0;e<24;e++)o[e]=F(o[e]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function X(t){return q(t)?366:365}function q(t){return t%4==0&&t%100!=0||t%400==0}function J(t){var e=new Date(Date.UTC.apply(null,arguments));return t<100&&t>=0&&isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t),e}function K(t,e,n){var i=7+e-n;return-((7+J(t,0,i).getUTCDay()-e)%7)+i-1}function Z(t,e,n,i,r){var o,a,s=1+7*(e-1)+(7+n-i)%7+K(t,i,r);return s<=0?a=X(o=t-1)+s:s>X(t)?(o=t+1,a=s-X(t)):(o=t,a=s),{year:o,dayOfYear:a}}function $(t,e,n){var i,r,o=K(t.year(),e,n),a=Math.floor((t.dayOfYear()-o-1)/7)+1;return a<1?i=a+Q(r=t.year()-1,e,n):a>Q(t.year(),e,n)?(i=a-Q(t.year(),e,n),r=t.year()+1):(r=t.year(),i=a),{week:i,year:r}}function Q(t,e,n){var i=K(t,e,n),r=K(t+1,e,n);return(X(t)-i+r)/7}function tt(){function t(t,e){return e.length-t.length}var e,n,i,r,o,a=[],s=[],l=[],c=[];for(e=0;e<7;e++)n=u([2e3,1]).day(e),i=this.weekdaysMin(n,""),r=this.weekdaysShort(n,""),o=this.weekdays(n,""),a.push(i),s.push(r),l.push(o),c.push(i),c.push(r),c.push(o);for(a.sort(t),s.sort(t),l.sort(t),c.sort(t),e=0;e<7;e++)s[e]=F(s[e]),l[e]=F(l[e]),c[e]=F(c[e]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function et(){return this.hours()%12||12}function nt(t,e){k(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function it(t,e){return e._meridiemParse}function rt(t){return t?t.toLowerCase().replace("_","-"):t}function ot(t){var e=null;if(!Je[t]&&"undefined"!=typeof module&&module&&module.exports)try{e=Ye._abbr,require("./locale/"+t),at(e)}catch(t){}return Je[t]}function at(t,e){var n;return t&&(n=i(e)?lt(t):st(t,e))&&(Ye=n),Ye._abbr}function st(t,e){if(null!==e){var n=qe;if(e.abbr=t,null!=Je[t])_("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Je[t]._config;else if(null!=e.parentLocale){if(null==Je[e.parentLocale])return Ke[e.parentLocale]||(Ke[e.parentLocale]=[]),Ke[e.parentLocale].push({name:t,config:e}),null;n=Je[e.parentLocale]._config}return Je[t]=new C(T(n,e)),Ke[t]&&Ke[t].forEach(function(t){st(t.name,t.config)}),at(t),Je[t]}return delete Je[t],null}function lt(t){var n;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ye;if(!e(t)){if(n=ot(t))return n;t=[t]}return function(t){for(var e,n,i,r,o=0;o<t.length;){for(e=(r=rt(t[o]).split("-")).length,n=(n=rt(t[o+1]))?n.split("-"):null;e>0;){if(i=ot(r.slice(0,e).join("-")))return i;if(n&&n.length>=e&&y(r,n,!0)>=e-1)break;e--}o++}return null}(t)}function ut(t){var e,n=t._a;return n&&-2===c(t).overflow&&(e=n[xe]<0||n[xe]>11?xe:n[Se]<1||n[Se]>V(n[Ce],n[xe])?Se:n[Me]<0||n[Me]>24||24===n[Me]&&(0!==n[Oe]||0!==n[Re]||0!==n[Ae])?Me:n[Oe]<0||n[Oe]>59?Oe:n[Re]<0||n[Re]>59?Re:n[Ae]<0||n[Ae]>999?Ae:-1,c(t)._overflowDayOfYear&&(e<Ce||e>Se)&&(e=Se),c(t)._overflowWeeks&&-1===e&&(e=Pe),c(t)._overflowWeekday&&-1===e&&(e=Ne),c(t).overflow=e),t}function ct(t){var e,n,i,r,o,a,s=t._i,l=Ze.exec(s)||$e.exec(s);if(l){for(c(t).iso=!0,e=0,n=tn.length;e<n;e++)if(tn[e][1].exec(l[1])){r=tn[e][0],i=!1!==tn[e][2];break}if(null==r)return void(t._isValid=!1);if(l[3]){for(e=0,n=en.length;e<n;e++)if(en[e][1].exec(l[3])){o=(l[2]||" ")+en[e][0];break}if(null==o)return void(t._isValid=!1)}if(!i&&null!=o)return void(t._isValid=!1);if(l[4]){if(!Qe.exec(l[4]))return void(t._isValid=!1);a="Z"}t._f=r+(o||"")+(a||""),pt(t)}else t._isValid=!1}function ht(t){var e,n,i,r,o,a,s,l,u={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"};if(e=t._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),n=rn.exec(e)){if(i=n[1]?"ddd"+(5===n[1].length?", ":" "):"",r="D MMM "+(n[2].length>10?"YYYY ":"YY "),o="HH:mm"+(n[4]?":ss":""),n[1]){var h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date(n[2]).getDay()];if(n[1].substr(0,3)!==h)return c(t).weekdayMismatch=!0,void(t._isValid=!1)}switch(n[5].length){case 2:s=0===l?" +0000":((l="YXWVUTSRQPONZABCDEFGHIKLM".indexOf(n[5][1].toUpperCase())-12)<0?" -":" +")+(""+l).replace(/^-?/,"0").match(/..$/)[0]+"00";break;case 4:s=u[n[5]];break;default:s=u[" GMT"]}n[5]=s,t._i=n.splice(1).join(""),a=" ZZ",t._f=i+r+o+a,pt(t),c(t).rfc2822=!0}else t._isValid=!1}function dt(t,e,n){return null!=t?t:null!=e?e:n}function ft(e){var n,i,r,o,a=[];if(!e._d){for(r=function(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}(e),e._w&&null==e._a[Se]&&null==e._a[xe]&&function(t){var e,n,i,r,o,a,s,l;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)o=1,a=4,n=dt(e.GG,t._a[Ce],$(vt(),1,4).year),i=dt(e.W,1),((r=dt(e.E,1))<1||r>7)&&(l=!0);else{o=t._locale._week.dow,a=t._locale._week.doy;var u=$(vt(),o,a);n=dt(e.gg,t._a[Ce],u.year),i=dt(e.w,u.week),null!=e.d?((r=e.d)<0||r>6)&&(l=!0):null!=e.e?(r=e.e+o,(e.e<0||e.e>6)&&(l=!0)):r=o}i<1||i>Q(n,o,a)?c(t)._overflowWeeks=!0:null!=l?c(t)._overflowWeekday=!0:(s=Z(n,i,r,o,a),t._a[Ce]=s.year,t._dayOfYear=s.dayOfYear)}(e),null!=e._dayOfYear&&(o=dt(e._a[Ce],r[Ce]),(e._dayOfYear>X(o)||0===e._dayOfYear)&&(c(e)._overflowDayOfYear=!0),i=J(o,0,e._dayOfYear),e._a[xe]=i.getUTCMonth(),e._a[Se]=i.getUTCDate()),n=0;n<3&&null==e._a[n];++n)e._a[n]=a[n]=r[n];for(;n<7;n++)e._a[n]=a[n]=null==e._a[n]?2===n?1:0:e._a[n];24===e._a[Me]&&0===e._a[Oe]&&0===e._a[Re]&&0===e._a[Ae]&&(e._nextDay=!0,e._a[Me]=0),e._d=(e._useUTC?J:function(t,e,n,i,r,o,a){var s=new Date(t,e,n,i,r,o,a);return t<100&&t>=0&&isFinite(s.getFullYear())&&s.setFullYear(t),s}).apply(null,a),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Me]=24)}}function pt(e){if(e._f!==t.ISO_8601)if(e._f!==t.RFC_2822){e._a=[],c(e).empty=!0;var n,i,r,o,a,s=""+e._i,l=s.length,u=0;for(r=I(e._f,e._locale).match(ne)||[],n=0;n<r.length;n++)o=r[n],(i=(s.match(U(o,e))||[])[0])&&((a=s.substr(0,s.indexOf(i))).length>0&&c(e).unusedInput.push(a),s=s.slice(s.indexOf(i)+i.length),u+=i.length),oe[o]?(i?c(e).empty=!1:c(e).unusedTokens.push(o),z(o,i,e)):e._strict&&!i&&c(e).unusedTokens.push(o);c(e).charsLeftOver=l-u,s.length>0&&c(e).unusedInput.push(s),e._a[Me]<=12&&!0===c(e).bigHour&&e._a[Me]>0&&(c(e).bigHour=void 0),c(e).parsedDateParts=e._a.slice(0),c(e).meridiem=e._meridiem,e._a[Me]=function(t,e,n){var i;if(null==n)return e;return null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?((i=t.isPM(n))&&e<12&&(e+=12),i||12!==e||(e=0),e):e}(e._locale,e._a[Me],e._meridiem),ft(e),ut(e)}else ht(e);else ct(e)}function mt(s){var u=s._i,g=s._f;return s._locale=s._locale||lt(s._l),null===u||void 0===g&&""===u?d({nullInput:!0}):("string"==typeof u&&(s._i=u=s._locale.preparse(u)),m(u)?new p(ut(u)):(o(u)?s._d=u:e(g)?function(t){var e,n,i,r,o;if(0===t._f.length)return c(t).invalidFormat=!0,void(t._d=new Date(NaN));for(r=0;r<t._f.length;r++)o=0,e=f({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[r],pt(e),h(e)&&(o+=c(e).charsLeftOver,o+=10*c(e).unusedTokens.length,c(e).score=o,(null==i||o<i)&&(i=o,n=e));l(t,n||e)}(s):g?pt(s):function(s){var l=s._i;i(l)?s._d=new Date(t.now()):o(l)?s._d=new Date(l.valueOf()):"string"==typeof l?function(e){var n=nn.exec(e._i);null===n?(ct(e),!1===e._isValid&&(delete e._isValid,ht(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e)))):e._d=new Date(+n[1])}(s):e(l)?(s._a=a(l.slice(0),function(t){return parseInt(t,10)}),ft(s)):n(l)?function(t){if(!t._d){var e=M(t._i);t._a=a([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),ft(t)}}(s):r(l)?s._d=new Date(l):t.createFromInputFallback(s)}(s),h(s)||(s._d=null),s))}function gt(t,i,r,o,a){var s={};return!0!==r&&!1!==r||(o=r,r=void 0),(n(t)&&function(t){var e;for(e in t)return!1;return!0}(t)||e(t)&&0===t.length)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=a,s._l=r,s._i=t,s._f=i,s._strict=o,function(t){var e=new p(ut(mt(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}(s)}function vt(t,e,n,i){return gt(t,e,n,i,!1)}function yt(t,n){var i,r;if(1===n.length&&e(n[0])&&(n=n[0]),!n.length)return vt();for(i=n[0],r=1;r<n.length;++r)n[r].isValid()&&!n[r][t](i)||(i=n[r]);return i}function wt(t){var e=M(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||0,a=e.day||0,s=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=function(t){for(var e in t)if(-1===sn.indexOf(e)||null!=t[e]&&isNaN(t[e]))return!1;for(var n=!1,i=0;i<sn.length;++i)if(t[sn[i]]){if(n)return!1;parseFloat(t[sn[i]])!==v(t[sn[i]])&&(n=!0)}return!0}(e),this._milliseconds=+c+1e3*u+6e4*l+1e3*s*60*60,this._days=+a+7*o,this._months=+r+3*i+12*n,this._data={},this._locale=lt(),this._bubble()}function bt(t){return t instanceof wt}function _t(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function Et(t,e){k(t,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+N(~~(t/60),2)+e+N(~~t%60,2)})}function Tt(t,e){var n=(e||"").match(t);if(null===n)return null;var i=((n[n.length-1]||[])+"").match(ln)||["-",0,0],r=60*i[1]+v(i[2]);return 0===r?0:"+"===i[0]?r:-r}function Ct(e,n){var i,r;return n._isUTC?(i=n.clone(),r=(m(e)||o(e)?e.valueOf():vt(e).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+r),t.updateOffset(i,!1),i):vt(e).local()}function xt(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function St(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Mt(t,e){var n,i,o,a=t,l=null;return bt(t)?a={ms:t._milliseconds,d:t._days,M:t._months}:r(t)?(a={},e?a[e]=t:a.milliseconds=t):(l=un.exec(t))?(n="-"===l[1]?-1:1,a={y:0,d:v(l[Se])*n,h:v(l[Me])*n,m:v(l[Oe])*n,s:v(l[Re])*n,ms:v(_t(1e3*l[Ae]))*n}):(l=cn.exec(t))?(n="-"===l[1]?-1:1,a={y:Ot(l[2],n),M:Ot(l[3],n),w:Ot(l[4],n),d:Ot(l[5],n),h:Ot(l[6],n),m:Ot(l[7],n),s:Ot(l[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(o=function(t,e){var n;if(!t.isValid()||!e.isValid())return{milliseconds:0,months:0};e=Ct(e,t),t.isBefore(e)?n=Rt(t,e):((n=Rt(e,t)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(vt(a.from),vt(a.to)),(a={}).ms=o.milliseconds,a.M=o.months),i=new wt(a),bt(t)&&s(t,"_locale")&&(i._locale=t._locale),i}function Ot(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Rt(t,e){var n={milliseconds:0,months:0};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function At(t,e){return function(n,i){var r,o;return null===i||isNaN(+i)||(_(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),n="string"==typeof n?+n:n,r=Mt(n,i),Pt(this,r,t),this}}function Pt(e,n,i,r){var o=n._milliseconds,a=_t(n._days),s=_t(n._months);e.isValid()&&(r=null==r||r,o&&e._d.setTime(e._d.valueOf()+o*i),a&&P(e,"Date",A(e,"Date")+a*i),s&&W(e,A(e,"Month")+s*i),r&&t.updateOffset(e,a||s))}function Nt(t){var e;return void 0===t?this._locale._abbr:(null!=(e=lt(t))&&(this._locale=e),this)}function kt(){return this._locale}function Lt(t,e){k(0,[t,t.length],0,e)}function Dt(t,e,n,i,r){var o;return null==t?$(this,i,r).year:(o=Q(t,i,r),e>o&&(e=o),function(t,e,n,i,r){var o=Z(t,e,n,i,r),a=J(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,t,e,n,i,r))}function It(t,e){e[Ae]=v(1e3*("0."+t))}function Ht(t){return t}function Ut(t,e,n,i){var r=lt(),o=u().set(i,e);return r[n](o,t)}function Ft(t,e,n){if(r(t)&&(e=t,t=void 0),t=t||"",null!=e)return Ut(t,e,n,"month");var i,o=[];for(i=0;i<12;i++)o[i]=Ut(t,i,n,"month");return o}function Bt(t,e,n,i){"boolean"==typeof t?(r(e)&&(n=e,e=void 0),e=e||""):(n=e=t,t=!1,r(e)&&(n=e,e=void 0),e=e||"");var o=lt(),a=t?o._week.dow:0;if(null!=n)return Ut(e,(n+a)%7,i,"day");var s,l=[];for(s=0;s<7;s++)l[s]=Ut(e,(s+a)%7,i,"day");return l}function jt(t,e,n,i){var r=Mt(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function zt(t){return t<0?Math.floor(t):Math.ceil(t)}function Vt(t){return 4800*t/146097}function Wt(t){return 146097*t/4800}function Gt(t){return function(){return this.as(t)}}function Yt(t){return function(){return this.isValid()?this._data[t]:NaN}}function Xt(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n=Fn(this._milliseconds)/1e3,i=Fn(this._days),r=Fn(this._months);e=g((t=g(n/60))/60),n%=60,t%=60;var o=g(r/12),a=r%=12,s=i,l=e,u=t,c=n,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(o?o+"Y":"")+(a?a+"M":"")+(s?s+"D":"")+(l||u||c?"T":"")+(l?l+"H":"")+(u?u+"M":"")+(c?c+"S":""):"P0D"}var qt,Jt=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),n=e.length>>>0,i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1},Kt=t.momentProperties=[],Zt=!1,$t={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var Qt=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)s(t,e)&&n.push(e);return n},te={},ee={},ne=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ie=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,re={},oe={},ae=/\d/,se=/\d\d/,le=/\d{3}/,ue=/\d{4}/,ce=/[+-]?\d{6}/,he=/\d\d?/,de=/\d\d\d\d?/,fe=/\d\d\d\d\d\d?/,pe=/\d{1,3}/,me=/\d{1,4}/,ge=/[+-]?\d{1,6}/,ve=/\d+/,ye=/[+-]?\d+/,we=/Z|[+-]\d\d:?\d\d/gi,be=/Z|[+-]\d\d(?::?\d\d)?/gi,_e=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ee={},Te={},Ce=0,xe=1,Se=2,Me=3,Oe=4,Re=5,Ae=6,Pe=7,Ne=8,ke=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};k("M",["MM",2],"Mo",function(){return this.month()+1}),k("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),k("MMMM",0,0,function(t){return this.localeData().months(this,t)}),x("month","M"),O("month",8),H("M",he),H("MM",he,se),H("MMM",function(t,e){return e.monthsShortRegex(t)}),H("MMMM",function(t,e){return e.monthsRegex(t)}),B(["M","MM"],function(t,e){e[xe]=v(t)-1}),B(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);null!=r?e[xe]=r:c(n).invalidMonth=t});var Le=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,De="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ie="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),He=_e,Ue=_e;k("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),k(0,["YY",2],0,function(){return this.year()%100}),k(0,["YYYY",4],0,"year"),k(0,["YYYYY",5],0,"year"),k(0,["YYYYYY",6,!0],0,"year"),x("year","y"),O("year",1),H("Y",ye),H("YY",he,se),H("YYYY",me,ue),H("YYYYY",ge,ce),H("YYYYYY",ge,ce),B(["YYYYY","YYYYYY"],Ce),B("YYYY",function(e,n){n[Ce]=2===e.length?t.parseTwoDigitYear(e):v(e)}),B("YY",function(e,n){n[Ce]=t.parseTwoDigitYear(e)}),B("Y",function(t,e){e[Ce]=parseInt(t,10)}),t.parseTwoDigitYear=function(t){return v(t)+(v(t)>68?1900:2e3)};var Fe=R("FullYear",!0);k("w",["ww",2],"wo","week"),k("W",["WW",2],"Wo","isoWeek"),x("week","w"),x("isoWeek","W"),O("week",5),O("isoWeek",5),H("w",he),H("ww",he,se),H("W",he),H("WW",he,se),j(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=v(t)});k("d",0,"do","day"),k("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),k("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),k("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),k("e",0,0,"weekday"),k("E",0,0,"isoWeekday"),x("day","d"),x("weekday","e"),x("isoWeekday","E"),O("day",11),O("weekday",11),O("isoWeekday",11),H("d",he),H("e",he),H("E",he),H("dd",function(t,e){return e.weekdaysMinRegex(t)}),H("ddd",function(t,e){return e.weekdaysShortRegex(t)}),H("dddd",function(t,e){return e.weekdaysRegex(t)}),j(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);null!=r?e.d=r:c(n).invalidWeekday=t}),j(["d","e","E"],function(t,e,n,i){e[i]=v(t)});var Be="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),je="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),ze="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ve=_e,We=_e,Ge=_e;k("H",["HH",2],0,"hour"),k("h",["hh",2],0,et),k("k",["kk",2],0,function(){return this.hours()||24}),k("hmm",0,0,function(){return""+et.apply(this)+N(this.minutes(),2)}),k("hmmss",0,0,function(){return""+et.apply(this)+N(this.minutes(),2)+N(this.seconds(),2)}),k("Hmm",0,0,function(){return""+this.hours()+N(this.minutes(),2)}),k("Hmmss",0,0,function(){return""+this.hours()+N(this.minutes(),2)+N(this.seconds(),2)}),nt("a",!0),nt("A",!1),x("hour","h"),O("hour",13),H("a",it),H("A",it),H("H",he),H("h",he),H("k",he),H("HH",he,se),H("hh",he,se),H("kk",he,se),H("hmm",de),H("hmmss",fe),H("Hmm",de),H("Hmmss",fe),B(["H","HH"],Me),B(["k","kk"],function(t,e,n){var i=v(t);e[Me]=24===i?0:i}),B(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),B(["h","hh"],function(t,e,n){e[Me]=v(t),c(n).bigHour=!0}),B("hmm",function(t,e,n){var i=t.length-2;e[Me]=v(t.substr(0,i)),e[Oe]=v(t.substr(i)),c(n).bigHour=!0}),B("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Me]=v(t.substr(0,i)),e[Oe]=v(t.substr(i,2)),e[Re]=v(t.substr(r)),c(n).bigHour=!0}),B("Hmm",function(t,e,n){var i=t.length-2;e[Me]=v(t.substr(0,i)),e[Oe]=v(t.substr(i))}),B("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Me]=v(t.substr(0,i)),e[Oe]=v(t.substr(i,2)),e[Re]=v(t.substr(r))});var Ye,Xe=R("Hours",!0),qe={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:De,monthsShort:Ie,week:{dow:0,doy:6},weekdays:Be,weekdaysMin:ze,weekdaysShort:je,meridiemParse:/[ap]\.?m?\.?/i},Je={},Ke={},Ze=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,$e=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Qe=/Z|[+-]\d\d(?::?\d\d)?/,tn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],en=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],nn=/^\/?Date\((\-?\d+)/i,rn=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;t.createFromInputFallback=b("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var on=b("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=vt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:d()}),an=b("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=vt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:d()}),sn=["year","quarter","month","week","day","hour","minute","second","millisecond"];Et("Z",":"),Et("ZZ",""),H("Z",be),H("ZZ",be),B(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Tt(be,t)});var ln=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var un=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,cn=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Mt.fn=wt.prototype,Mt.invalid=function(){return Mt(NaN)};var hn=At(1,"add"),dn=At(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var fn=b("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});k(0,["gg",2],0,function(){return this.weekYear()%100}),k(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Lt("gggg","weekYear"),Lt("ggggg","weekYear"),Lt("GGGG","isoWeekYear"),Lt("GGGGG","isoWeekYear"),x("weekYear","gg"),x("isoWeekYear","GG"),O("weekYear",1),O("isoWeekYear",1),H("G",ye),H("g",ye),H("GG",he,se),H("gg",he,se),H("GGGG",me,ue),H("gggg",me,ue),H("GGGGG",ge,ce),H("ggggg",ge,ce),j(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=v(t)}),j(["gg","GG"],function(e,n,i,r){n[r]=t.parseTwoDigitYear(e)}),k("Q",0,"Qo","quarter"),x("quarter","Q"),O("quarter",7),H("Q",ae),B("Q",function(t,e){e[xe]=3*(v(t)-1)}),k("D",["DD",2],"Do","date"),x("date","D"),O("date",9),H("D",he),H("DD",he,se),H("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),B(["D","DD"],Se),B("Do",function(t,e){e[Se]=v(t.match(he)[0])});var pn=R("Date",!0);k("DDD",["DDDD",3],"DDDo","dayOfYear"),x("dayOfYear","DDD"),O("dayOfYear",4),H("DDD",pe),H("DDDD",le),B(["DDD","DDDD"],function(t,e,n){n._dayOfYear=v(t)}),k("m",["mm",2],0,"minute"),x("minute","m"),O("minute",14),H("m",he),H("mm",he,se),B(["m","mm"],Oe);var mn=R("Minutes",!1);k("s",["ss",2],0,"second"),x("second","s"),O("second",15),H("s",he),H("ss",he,se),B(["s","ss"],Re);var gn=R("Seconds",!1);k("S",0,0,function(){return~~(this.millisecond()/100)}),k(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),k(0,["SSS",3],0,"millisecond"),k(0,["SSSS",4],0,function(){return 10*this.millisecond()}),k(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),k(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),k(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),k(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),k(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),x("millisecond","ms"),O("millisecond",16),H("S",pe,ae),H("SS",pe,se),H("SSS",pe,le);var vn;for(vn="SSSS";vn.length<=9;vn+="S")H(vn,ve);for(vn="S";vn.length<=9;vn+="S")B(vn,It);var yn=R("Milliseconds",!1);k("z",0,0,"zoneAbbr"),k("zz",0,0,"zoneName");var wn=p.prototype;wn.add=hn,wn.calendar=function(e,n){var i=e||vt(),r=Ct(i,this).startOf("day"),o=t.calendarFormat(this,r)||"sameElse",a=n&&(E(n[o])?n[o].call(this,i):n[o]);return this.format(a||this.localeData().calendar(o,this,vt(i)))},wn.clone=function(){return new p(this)},wn.diff=function(t,e,n){var i,r,o,a;return this.isValid()&&(i=Ct(t,this)).isValid()?(r=6e4*(i.utcOffset()-this.utcOffset()),"year"===(e=S(e))||"month"===e||"quarter"===e?(a=function(t,e){var n,i,r=12*(e.year()-t.year())+(e.month()-t.month()),o=t.clone().add(r,"months");return e-o<0?(n=t.clone().add(r-1,"months"),i=(e-o)/(o-n)):(n=t.clone().add(r+1,"months"),i=(e-o)/(n-o)),-(r+i)||0}(this,i),"quarter"===e?a/=3:"year"===e&&(a/=12)):(o=this-i,a="second"===e?o/1e3:"minute"===e?o/6e4:"hour"===e?o/36e5:"day"===e?(o-r)/864e5:"week"===e?(o-r)/6048e5:o),n?a:g(a)):NaN},wn.endOf=function(t){return void 0===(t=S(t))||"millisecond"===t?this:("date"===t&&(t="day"),this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms"))},wn.format=function(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=D(this,e);return this.localeData().postformat(n)},wn.from=function(t,e){return this.isValid()&&(m(t)&&t.isValid()||vt(t).isValid())?Mt({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},wn.fromNow=function(t){return this.from(vt(),t)},wn.to=function(t,e){return this.isValid()&&(m(t)&&t.isValid()||vt(t).isValid())?Mt({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},wn.toNow=function(t){return this.to(vt(),t)},wn.get=function(t){return t=S(t),E(this[t])?this[t]():this},wn.invalidAt=function(){return c(this).overflow},wn.isAfter=function(t,e){var n=m(t)?t:vt(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=S(i(e)?"millisecond":e))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())},wn.isBefore=function(t,e){var n=m(t)?t:vt(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=S(i(e)?"millisecond":e))?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())},wn.isBetween=function(t,e,n,i){return("("===(i=i||"()")[0]?this.isAfter(t,n):!this.isBefore(t,n))&&(")"===i[1]?this.isBefore(e,n):!this.isAfter(e,n))},wn.isSame=function(t,e){var n,i=m(t)?t:vt(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=S(e||"millisecond"))?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))},wn.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},wn.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},wn.isValid=function(){return h(this)},wn.lang=fn,wn.locale=Nt,wn.localeData=kt,wn.max=an,wn.min=on,wn.parsingFlags=function(){return l({},c(this))},wn.set=function(t,e){if("object"==typeof t)for(var n=function(t){var e=[];for(var n in t)e.push({unit:n,priority:ee[n]});return e.sort(function(t,e){return t.priority-e.priority}),e}(t=M(t)),i=0;i<n.length;i++)this[n[i].unit](t[n[i].unit]);else if(t=S(t),E(this[t]))return this[t](e);return this},wn.startOf=function(t){switch(t=S(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},wn.subtract=dn,wn.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},wn.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},wn.toDate=function(){return new Date(this.valueOf())},wn.toISOString=function(){if(!this.isValid())return null;var t=this.clone().utc();return t.year()<0||t.year()>9999?D(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):E(Date.prototype.toISOString)?this.toDate().toISOString():D(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},wn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r=e+'[")]';return this.format(n+i+"-MM-DD[T]HH:mm:ss.SSS"+r)},wn.toJSON=function(){return this.isValid()?this.toISOString():null},wn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},wn.unix=function(){return Math.floor(this.valueOf()/1e3)},wn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},wn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},wn.year=Fe,wn.isLeapYear=function(){return q(this.year())},wn.weekYear=function(t){return Dt.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},wn.isoWeekYear=function(t){return Dt.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},wn.quarter=wn.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},wn.month=G,wn.daysInMonth=function(){return V(this.year(),this.month())},wn.week=wn.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},wn.isoWeek=wn.isoWeeks=function(t){var e=$(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},wn.weeksInYear=function(){var t=this.localeData()._week;return Q(this.year(),t.dow,t.doy)},wn.isoWeeksInYear=function(){return Q(this.year(),1,4)},wn.date=pn,wn.day=wn.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},wn.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},wn.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},wn.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},wn.hour=wn.hours=Xe,wn.minute=wn.minutes=mn,wn.second=wn.seconds=gn,wn.millisecond=wn.milliseconds=yn,wn.utcOffset=function(e,n,i){var r,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Tt(be,e)))return this}else Math.abs(e)<16&&!i&&(e*=60);return!this._isUTC&&n&&(r=xt(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),o!==e&&(!n||this._changeInProgress?Pt(this,Mt(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:xt(this)},wn.utc=function(t){return this.utcOffset(0,t)},wn.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(xt(this),"m")),this},wn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=Tt(we,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},wn.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?vt(t).utcOffset():0,(this.utcOffset()-t)%60==0)},wn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},wn.isLocal=function(){return!!this.isValid()&&!this._isUTC},wn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},wn.isUtc=St,wn.isUTC=St,wn.zoneAbbr=function(){return this._isUTC?"UTC":""},wn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},wn.dates=b("dates accessor is deprecated. Use date instead.",pn),wn.months=b("months accessor is deprecated. Use month instead",G),wn.years=b("years accessor is deprecated. Use year instead",Fe),wn.zone=b("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),wn.isDSTShifted=b("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!i(this._isDSTShifted))return this._isDSTShifted;var t={};if(f(t,this),(t=mt(t))._a){var e=t._isUTC?u(t._a):vt(t._a);this._isDSTShifted=this.isValid()&&y(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var bn=C.prototype;bn.calendar=function(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return E(i)?i.call(e,n):i},bn.longDateFormat=function(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])},bn.invalidDate=function(){return this._invalidDate},bn.ordinal=function(t){return this._ordinal.replace("%d",t)},bn.preparse=Ht,bn.postformat=Ht,bn.relativeTime=function(t,e,n,i){var r=this._relativeTime[n];return E(r)?r(t,e,n,i):r.replace(/%d/i,t)},bn.pastFuture=function(t,e){var n=this._relativeTime[t>0?"future":"past"];return E(n)?n(e):n.replace(/%s/i,e)},bn.set=function(t){var e,n;for(n in t)E(e=t[n])?this[n]=e:this["_"+n]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},bn.months=function(t,n){return t?e(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Le).test(n)?"format":"standalone"][t.month()]:e(this._months)?this._months:this._months.standalone},bn.monthsShort=function(t,n){return t?e(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Le.test(n)?"format":"standalone"][t.month()]:e(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},bn.monthsParse=function(t,e,n){var i,r,o;if(this._monthsParseExact)return function(t,e,n){var i,r,o,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=u([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===e?-1!==(r=ke.call(this._shortMonthsParse,a))?r:null:-1!==(r=ke.call(this._longMonthsParse,a))?r:null:"MMM"===e?-1!==(r=ke.call(this._shortMonthsParse,a))?r:-1!==(r=ke.call(this._longMonthsParse,a))?r:null:-1!==(r=ke.call(this._longMonthsParse,a))?r:-1!==(r=ke.call(this._shortMonthsParse,a))?r:null}.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=u([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[i].test(t))return i;if(n&&"MMM"===e&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}},bn.monthsRegex=function(t){return this._monthsParseExact?(s(this,"_monthsRegex")||Y.call(this),t?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=Ue),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},bn.monthsShortRegex=function(t){return this._monthsParseExact?(s(this,"_monthsRegex")||Y.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=He),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},bn.week=function(t){return $(t,this._week.dow,this._week.doy).week},bn.firstDayOfYear=function(){return this._week.doy},bn.firstDayOfWeek=function(){return this._week.dow},bn.weekdays=function(t,n){return t?e(this._weekdays)?this._weekdays[t.day()]:this._weekdays[this._weekdays.isFormat.test(n)?"format":"standalone"][t.day()]:e(this._weekdays)?this._weekdays:this._weekdays.standalone},bn.weekdaysMin=function(t){return t?this._weekdaysMin[t.day()]:this._weekdaysMin},bn.weekdaysShort=function(t){return t?this._weekdaysShort[t.day()]:this._weekdaysShort},bn.weekdaysParse=function(t,e,n){var i,r,o;if(this._weekdaysParseExact)return function(t,e,n){var i,r,o,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=u([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===e?-1!==(r=ke.call(this._weekdaysParse,a))?r:null:"ddd"===e?-1!==(r=ke.call(this._shortWeekdaysParse,a))?r:null:-1!==(r=ke.call(this._minWeekdaysParse,a))?r:null:"dddd"===e?-1!==(r=ke.call(this._weekdaysParse,a))?r:-1!==(r=ke.call(this._shortWeekdaysParse,a))?r:-1!==(r=ke.call(this._minWeekdaysParse,a))?r:null:"ddd"===e?-1!==(r=ke.call(this._shortWeekdaysParse,a))?r:-1!==(r=ke.call(this._weekdaysParse,a))?r:-1!==(r=ke.call(this._minWeekdaysParse,a))?r:null:-1!==(r=ke.call(this._minWeekdaysParse,a))?r:-1!==(r=ke.call(this._weekdaysParse,a))?r:-1!==(r=ke.call(this._shortWeekdaysParse,a))?r:null}.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=u([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".",".?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[i].test(t))return i;if(n&&"ddd"===e&&this._shortWeekdaysParse[i].test(t))return i;if(n&&"dd"===e&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}},bn.weekdaysRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||tt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=Ve),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},bn.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||tt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=We),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},bn.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||tt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ge),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},bn.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},bn.meridiem=function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},at("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===v(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),t.lang=b("moment.lang is deprecated. Use moment.locale instead.",at),t.langData=b("moment.langData is deprecated. Use moment.localeData instead.",lt);var _n=Math.abs,En=Gt("ms"),Tn=Gt("s"),Cn=Gt("m"),xn=Gt("h"),Sn=Gt("d"),Mn=Gt("w"),On=Gt("M"),Rn=Gt("y"),An=Yt("milliseconds"),Pn=Yt("seconds"),Nn=Yt("minutes"),kn=Yt("hours"),Ln=Yt("days"),Dn=Yt("months"),In=Yt("years"),Hn=Math.round,Un={ss:44,s:45,m:45,h:22,d:26,M:11},Fn=Math.abs,Bn=wt.prototype;return Bn.isValid=function(){return this._isValid},Bn.abs=function(){var t=this._data;return this._milliseconds=_n(this._milliseconds),this._days=_n(this._days),this._months=_n(this._months),t.milliseconds=_n(t.milliseconds),t.seconds=_n(t.seconds),t.minutes=_n(t.minutes),t.hours=_n(t.hours),t.months=_n(t.months),t.years=_n(t.years),this},Bn.add=function(t,e){return jt(this,t,e,1)},Bn.subtract=function(t,e){return jt(this,t,e,-1)},Bn.as=function(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if("month"===(t=S(t))||"year"===t)return e=this._days+i/864e5,n=this._months+Vt(e),"month"===t?n:n/12;switch(e=this._days+Math.round(Wt(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return 24*e+i/36e5;case"minute":return 1440*e+i/6e4;case"second":return 86400*e+i/1e3;case"millisecond":return Math.floor(864e5*e)+i;default:throw new Error("Unknown unit "+t)}},Bn.asMilliseconds=En,Bn.asSeconds=Tn,Bn.asMinutes=Cn,Bn.asHours=xn,Bn.asDays=Sn,Bn.asWeeks=Mn,Bn.asMonths=On,Bn.asYears=Rn,Bn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12):NaN},Bn._bubble=function(){var t,e,n,i,r,o=this._milliseconds,a=this._days,s=this._months,l=this._data;return o>=0&&a>=0&&s>=0||o<=0&&a<=0&&s<=0||(o+=864e5*zt(Wt(s)+a),a=0,s=0),l.milliseconds=o%1e3,t=g(o/1e3),l.seconds=t%60,e=g(t/60),l.minutes=e%60,n=g(e/60),l.hours=n%24,a+=g(n/24),r=g(Vt(a)),s+=r,a-=zt(Wt(r)),i=g(s/12),s%=12,l.days=a,l.months=s,l.years=i,this},Bn.get=function(t){return t=S(t),this.isValid()?this[t+"s"]():NaN},Bn.milliseconds=An,Bn.seconds=Pn,Bn.minutes=Nn,Bn.hours=kn,Bn.days=Ln,Bn.weeks=function(){return g(this.days()/7)},Bn.months=Dn,Bn.years=In,Bn.humanize=function(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),n=function(t,e,n){var i=Mt(t).abs(),r=Hn(i.as("s")),o=Hn(i.as("m")),a=Hn(i.as("h")),s=Hn(i.as("d")),l=Hn(i.as("M")),u=Hn(i.as("y")),c=r<=Un.ss&&["s",r]||r<Un.s&&["ss",r]||o<=1&&["m"]||o<Un.m&&["mm",o]||a<=1&&["h"]||a<Un.h&&["hh",a]||s<=1&&["d"]||s<Un.d&&["dd",s]||l<=1&&["M"]||l<Un.M&&["MM",l]||u<=1&&["y"]||["yy",u];return c[2]=e,c[3]=+t>0,c[4]=n,function(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}.apply(null,c)}(this,!t,e);return t&&(n=e.pastFuture(+this,n)),e.postformat(n)},Bn.toISOString=Xt,Bn.toString=Xt,Bn.toJSON=Xt,Bn.locale=Nt,Bn.localeData=kt,Bn.toIsoString=b("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Xt),Bn.lang=fn,k("X",0,0,"unix"),k("x",0,0,"valueOf"),H("x",ye),H("X",/[+-]?\d+(\.\d{1,3})?/),B("X",function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))}),B("x",function(t,e,n){n._d=new Date(v(t))}),t.version="2.18.1",function(t){qt=t}(vt),t.fn=wn,t.min=function(){return yt("isBefore",[].slice.call(arguments,0))},t.max=function(){return yt("isAfter",[].slice.call(arguments,0))},t.now=function(){return Date.now?Date.now():+new Date},t.utc=u,t.unix=function(t){return vt(1e3*t)},t.months=function(t,e){return Ft(t,e,"months")},t.isDate=o,t.locale=at,t.invalid=d,t.duration=Mt,t.isMoment=m,t.weekdays=function(t,e,n){return Bt(t,e,n,"weekdays")},t.parseZone=function(){return vt.apply(null,arguments).parseZone()},t.localeData=lt,t.isDuration=bt,t.monthsShort=function(t,e){return Ft(t,e,"monthsShort")},t.weekdaysMin=function(t,e,n){return Bt(t,e,n,"weekdaysMin")},t.defineLocale=st,t.updateLocale=function(t,e){if(null!=e){var n,i=qe;null!=Je[t]&&(i=Je[t]._config),(n=new C(e=T(i,e))).parentLocale=Je[t],Je[t]=n,at(t)}else null!=Je[t]&&(null!=Je[t].parentLocale?Je[t]=Je[t].parentLocale:null!=Je[t]&&delete Je[t]);return Je[t]},t.locales=function(){return Qt(Je)},t.weekdaysShort=function(t,e,n){return Bt(t,e,n,"weekdaysShort")},t.normalizeUnits=S,t.relativeTimeRounding=function(t){return void 0===t?Hn:"function"==typeof t&&(Hn=t,!0)},t.relativeTimeThreshold=function(t,e){return void 0!==Un[t]&&(void 0===e?Un[t]:(Un[t]=e,"s"===t&&(Un.ss=e-1),!0))},t.calendarFormat=function(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},t.prototype=wn,t}),function(){"use strict";function t(t){this._value=t}function e(t){return 0===t?1:Math.floor(Math.log(Math.abs(t))/Math.LN10)+1}function n(t){var e,n="";for(e=0;e<t;e++)n+="0";return n}function i(t,e,i,r){var o,a,s=Math.pow(10,e);return t.toString().indexOf("e")>-1?"-"===(a=function(t,e){var i,r,o,a,s,l;return l=t.toString(),i=l.split("e")[0],a=l.split("e")[1],r=i.split(".")[0],o=i.split(".")[1]||"",+a>0?l=r+o+n(a-o.length):(s=+r<0?"-0":"0",e>0&&(s+="."),l=s+(n(-1*a-1)+Math.abs(r)+o).substr(0,e)),+a>0&&e>0&&(l+="."+n(e)),l}(t,e)).charAt(0)&&+a>=0&&(a=a.substr(1)):a=(i(t+"e+"+e)/s).toFixed(e),r&&(o=new RegExp("0{1,"+r+"}$"),a=a.replace(o,"")),a}function r(t,e,n){var i=e.replace(/\{[^\{\}]*\}/g,"");return i.indexOf("$")>-1?a(t,y[b].currency.symbol,e,n):i.indexOf("%")>-1?function(t,e,n){var i,r="",o=100*t._value;e.indexOf(" %")>-1?(r=" ",e=e.replace(" %","")):e=e.replace("%","");(i=l(o,e,n)).indexOf(")")>-1?((i=i.split("")).splice(-1,0,r+"%"),i=i.join("")):i=i+r+"%";return i}(t,e,n):i.indexOf(":")>-1?function(t){var e=Math.floor(t._value/60/60),n=Math.floor((t._value-60*e*60)/60),i=Math.round(t._value-60*e*60-60*n);return e+":"+(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)}(t):l(t._value,e,n)}function o(t,e){var n,i,r,o,a,s=e,l=!1;if(e.indexOf(":")>-1)t._value=function(t){var e=t.split(":"),n=0;3===e.length?(n+=60*Number(e[0])*60,n+=60*Number(e[1]),n+=Number(e[2])):2===e.length&&(n+=60*Number(e[0]),n+=Number(e[1]));return Number(n)}(e);else if(e===_)t._value=0;else{for("."!==y[b].delimiters.decimal&&(e=e.replace(/\./g,"").replace(y[b].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+y[b].abbreviations.thousand+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+y[b].abbreviations.million+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+y[b].abbreviations.billion+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+y[b].abbreviations.trillion+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),a=1;a<p.length&&!l;++a)e.indexOf(p[a])>-1?l=Math.pow(1024,a):e.indexOf(m[a])>-1&&(l=Math.pow(1e3,a));var u=e.replace(/[^0-9\.]+/g,"");""===u?t._value=NaN:(t._value=(l||1)*(s.match(n)?Math.pow(10,3):1)*(s.match(i)?Math.pow(10,6):1)*(s.match(r)?Math.pow(10,9):1)*(s.match(o)?Math.pow(10,12):1)*(e.indexOf("%")>-1?.01:1)*((e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1)*Number(u),t._value=l?Math.ceil(t._value):t._value)}return t._value}function a(t,e,n,i){var r,o,a=n,s=a.indexOf("$"),u=a.indexOf("("),c=a.indexOf("+"),h=a.indexOf("-"),d="",f="";if(-1===a.indexOf("$")?"infix"===y[b].currency.position?(f=e,y[b].currency.spaceSeparated&&(f=" "+f+" ")):y[b].currency.spaceSeparated&&(d=" "):a.indexOf(" $")>-1?(d=" ",a=a.replace(" $","")):a.indexOf("$ ")>-1?(d=" ",a=a.replace("$ ","")):a=a.replace("$",""),o=l(t._value,a,i,f),-1===n.indexOf("$"))switch(y[b].currency.position){case"postfix":o.indexOf(")")>-1?((o=o.split("")).splice(-1,0,d+e),o=o.join("")):o=o+d+e;break;case"infix":break;case"prefix":o.indexOf("(")>-1||o.indexOf("-")>-1?(o=o.split(""),r=Math.max(u,h)+1,o.splice(r,0,e+d),o=o.join("")):o=e+d+o;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else s<=1?o.indexOf("(")>-1||o.indexOf("+")>-1||o.indexOf("-")>-1?(o=o.split(""),r=1,(s<u||s<c||s<h)&&(r=0),o.splice(r,0,e+d),o=o.join("")):o=e+d+o:o.indexOf(")")>-1?((o=o.split("")).splice(-1,0,d+e),o=o.join("")):o=o+d+e;return o}function s(t,e,n){var i,r,o,a=e[0],s=Math.abs(t);if(s>=n){for(i=1;i<e.length;++i)if(r=Math.pow(n,i),o=Math.pow(n,i+1),s>=r&&s<o){a=e[i],t/=r;break}a===e[0]&&(t/=Math.pow(n,e.length-1),a=e[e.length-1])}return{value:t,suffix:a}}function l(t,r,o,a){var l,u,c,h,d,f,p,m,g,w,E,T,C,x,S,M,O=!1,R=!1,A=!1,P="",N=!1,k=!1,L=!1,D=!1,I=!1,H="",U="",F=Math.abs(t),B="",j=!1,z=!1,V="";if(0===t&&null!==_)return _;if(!isFinite(t))return""+t;if(0===r.indexOf("{")){var W=r.indexOf("}");if(-1===W)throw Error('Format should also contain a "}"');w=r.slice(1,W),r=r.slice(W+1)}else w="";if(r.indexOf("}")===r.length-1&&r.length){var G=r.indexOf("{");if(-1===G)throw Error('Format should also contain a "{"');E=r.slice(G+1,-1),r=r.slice(0,G+1)}else E="";var Y;for(S=null===(Y=-1===r.indexOf(".")?r.match(/([0-9]+).*/):r.match(/([0-9]+)\..*/))?-1:Y[1].length,-1!==r.indexOf("-")&&(j=!0),r.indexOf("(")>-1?(O=!0,r=r.slice(1,-1)):r.indexOf("+")>-1&&(R=!0,r=r.replace(/\+/g,"")),r.indexOf("a")>-1&&(m=r.split(".")[0].match(/[0-9]+/g)||["0"],m=parseInt(m[0],10),N=r.indexOf("aK")>=0,k=r.indexOf("aM")>=0,L=r.indexOf("aB")>=0,D=r.indexOf("aT")>=0,I=N||k||L||D,r.indexOf(" a")>-1?(P=" ",r=r.replace(" a","")):r=r.replace("a",""),d=0===(d=(c=e(t))%3)?3:d,m&&0!==F&&(f=3*~~((Math.min(m,c)-d)/3),F/=Math.pow(10,f)),c!==m&&(F>=Math.pow(10,12)&&!I||D?(P+=y[b].abbreviations.trillion,t/=Math.pow(10,12)):F<Math.pow(10,12)&&F>=Math.pow(10,9)&&!I||L?(P+=y[b].abbreviations.billion,t/=Math.pow(10,9)):F<Math.pow(10,9)&&F>=Math.pow(10,6)&&!I||k?(P+=y[b].abbreviations.million,t/=Math.pow(10,6)):(F<Math.pow(10,6)&&F>=Math.pow(10,3)&&!I||N)&&(P+=y[b].abbreviations.thousand,t/=Math.pow(10,3))),h=e(t),m&&h<m&&-1===r.indexOf(".")&&(r+="[.]",r+=n(m-h))),M=0;M<v.length;++M)if(l=v[M],r.indexOf(l.marker)>-1){r.indexOf(" "+l.marker)>-1&&(H=" "),r=r.replace(H+l.marker,""),t=(u=s(t,l.suffixes,l.scale)).value,H+=u.suffix;break}if(r.indexOf("o")>-1&&(r.indexOf(" o")>-1?(U=" ",r=r.replace(" o","")):r=r.replace("o",""),y[b].ordinal&&(U+=y[b].ordinal(t))),r.indexOf("[.]")>-1&&(A=!0,r=r.replace("[.]",".")),g=r.split(".")[1],T=r.indexOf(","),g){var X=[];if(-1!==g.indexOf("*")?(X=(B=t.toString()).split(".")).length>1&&(B=i(t,X[1].length,o)):B=g.indexOf("[")>-1?i(t,(g=(g=g.replace("]","")).split("["))[0].length+g[1].length,o,g[1].length):i(t,g.length,o),X=B.split("."),p=X[0],X.length>1&&X[1].length){B=(a?P+a:y[b].delimiters.decimal)+X[1]}else B="";A&&0===Number(B.slice(1))&&(B="")}else p=i(t,0,o);return p.indexOf("-")>-1&&(p=p.slice(1),z=!0),p.length<S&&(p=n(S-p.length)+p),T>-1&&(p=p.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+y[b].delimiters.thousands)),0===r.indexOf(".")&&(p=""),C=r.indexOf("("),x=r.indexOf("-"),V=C<x?(O&&z?"(":"")+(j&&z||!O&&z?"-":""):(j&&z||!O&&z?"-":"")+(O&&z?"(":""),w+V+(!z&&R&&0!==t?"+":"")+p+B+(U||"")+(P&&!a?P:"")+(H||"")+(O&&z?")":"")+E}function u(t,e){y[t]=e}function c(t){b=t;var e=y[t].defaults;e&&e.format&&f.defaultFormat(e.format),e&&e.currencyFormat&&f.defaultCurrencyFormat(e.currencyFormat)}function h(t){var e=t.toString().split(".");return e.length<2?1:Math.pow(10,e[1].length)}function d(){return Array.prototype.slice.call(arguments).reduce(function(t,e){var n=h(t),i=h(e);return n>i?n:i},-1/0)}var f,p=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],m=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],g={general:{scale:1024,suffixes:m,marker:"bd"},binary:{scale:1024,suffixes:p,marker:"b"},decimal:{scale:1e3,suffixes:m,marker:"d"}},v=[g.general,g.binary,g.decimal],y={},w=y,b="en-US",_=null,E="0,0",T="0$",C="undefined"!=typeof module&&module.exports;(f=function(e){return e=f.isNumbro(e)?e.value():"string"==typeof e||"number"==typeof e?f.fn.unformat(e):NaN,new t(Number(e))}).version="1.11.0",f.isNumbro=function(e){return e instanceof t},f.setLanguage=function(t,e){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var n=t,i=t.split("-")[0],r=null;w[n]||(Object.keys(w).forEach(function(t){r||t.split("-")[0]!==i||(r=t)}),n=r||e||"en-US"),c(n)},f.setCulture=function(t,e){var n=t,i=t.split("-")[1],r=null;y[n]||(i&&Object.keys(y).forEach(function(t){r||t.split("-")[1]!==i||(r=t)}),n=r||e||"en-US"),c(n)},f.language=function(t,e){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!t)return b;if(t&&!e){if(!w[t])throw new Error("Unknown language : "+t);c(t)}return!e&&w[t]||u(t,e),f},f.culture=function(t,e){if(!t)return b;if(t&&!e){if(!y[t])throw new Error("Unknown culture : "+t);c(t)}return!e&&y[t]||u(t,e),f},f.languageData=function(t){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!t)return w[b];if(!w[t])throw new Error("Unknown language : "+t);return w[t]},f.cultureData=function(t){if(!t)return y[b];if(!y[t])throw new Error("Unknown culture : "+t);return y[t]},f.culture("en-US",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}}),f.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),w},f.cultures=function(){return y},f.zeroFormat=function(t){_="string"==typeof t?t:null},f.defaultFormat=function(t){E="string"==typeof t?t:"0.0"},f.defaultCurrencyFormat=function(t){T="string"==typeof t?t:"0$"},f.validate=function(t,e){var n,i,r,o,a,s,l,u;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",t)),t=t.trim(),(t=t.replace(/^[+-]?/,"")).match(/^\d+$/))return!0;if(""===t)return!1;try{l=f.cultureData(e)}catch(t){l=f.cultureData(f.culture())}return r=l.currency.symbol,a=l.abbreviations,n=l.delimiters.decimal,i="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,(null===(u=t.match(/^[^\d\.\,]+/))||(t=t.substr(1),u[0]===r))&&((null===(u=t.match(/[^\d]+$/))||(t=t.slice(0,-1),u[0]===a.thousand||u[0]===a.million||u[0]===a.billion||u[0]===a.trillion))&&(s=new RegExp(i+"{2}"),!t.match(/[^\d.,]/g)&&!((o=t.split(n)).length>2||(o.length<2?!o[0].match(/^\d+.*\d$/)||o[0].match(s):""===o[0]?o[0].match(s)||!o[1].match(/^\d+$/):1===o[0].length?!o[0].match(/^\d+$/)||o[0].match(s)||!o[1].match(/^\d+$/):!o[0].match(/^\d+.*\d$/)||o[0].match(s)||!o[1].match(/^\d+$/)))))},f.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),f.loadCulturesInNode()},f.loadCulturesInNode=function(){var t=require("./languages");for(var e in t)e&&f.culture(e,t[e])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var n,i,r=this.length>>>0,o=!1;for(1<arguments.length&&(i=e,o=!0),n=0;r>n;++n)this.hasOwnProperty(n)&&(o?i=t(i,this[n],n,this):(i=this[n],o=!0));if(!o)throw new TypeError("Reduce of empty array with no initial value");return i}),f.fn=t.prototype={clone:function(){return f(this)},format:function(t,e){return r(this,t||E,void 0!==e?e:Math.round)},formatCurrency:function(t,e){return a(this,y[b].currency.symbol,t||T,void 0!==e?e:Math.round)},formatForeignCurrency:function(t,e,n){return function(t,e,n,i){return a(t,e,n,i)}(this,t,e||T,void 0!==n?n:Math.round)},unformat:function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=o(this,t);return isNaN(e)?void 0:e}},binaryByteUnits:function(){return s(this._value,g.binary.suffixes,g.binary.scale).suffix},byteUnits:function(){return s(this._value,g.general.suffixes,g.general.scale).suffix},decimalByteUnits:function(){return s(this._value,g.decimal.suffixes,g.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(t){return this._value=Number(t),this},add:function(t){var e=d.call(null,this._value,t);return this._value=[this._value,t].reduce(function(t,n){return t+e*n},0)/e,this},subtract:function(t){var e=d.call(null,this._value,t);return this._value=[t].reduce(function(t,n){return t-e*n},this._value*e)/e,this},multiply:function(t){return this._value=[this._value,t].reduce(function(t,e){var n=d(t,e),i=t*n;return i*=e*n,i/=n*n},1),this},divide:function(t){return this._value=[this._value,t].reduce(function(t,e){var n=d(t,e);return t*n/(e*n)}),this},difference:function(t){return Math.abs(f(this._value).subtract(t).value())}},"undefined"!=typeof process&&void 0===process.browser&&process.title&&(-1!==process.title.indexOf("node")||process.title.indexOf("meteor-tool")>0||"grunt"===process.title||"gulp"===process.title)&&"undefined"!=typeof require&&f.loadCulturesInNode(),C?module.exports=f:("undefined"==typeof ender&&(this.numbro=f),"function"==typeof define&&define.amd&&define("numbro",[],function(){return f}))}.call("undefined"==typeof window?this:window),function(t,e){"use strict";var n;if("object"==typeof exports){try{n=require("moment")}catch(t){}module.exports=e(n)}else"function"==typeof define&&define.amd?define("pikaday",["require"],function(t){try{n=t("moment")}catch(t){}return e(n)}):t.Pikaday=e(t.moment)}(this,function(t){"use strict";var e="function"==typeof t,n=!!window.addEventListener,i=window.document,r=window.setTimeout,o=function(t,e,i,r){n?t.addEventListener(e,i,!!r):t.attachEvent("on"+e,i)},a=function(t,e,i,r){n?t.removeEventListener(e,i,!!r):t.detachEvent("on"+e,i)},s=function(t,e,n){var r;i.createEvent?((r=i.createEvent("HTMLEvents")).initEvent(e,!0,!1),r=m(r,n),t.dispatchEvent(r)):i.createEventObject&&(r=i.createEventObject(),r=m(r,n),t.fireEvent("on"+e,r))},l=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},u=function(t){return/Array/.test(Object.prototype.toString.call(t))},c=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},h=function(t){var e=t.getDay();return 0===e||6===e},d=function(t,e){return[31,function(t){return t%4==0&&t%100!=0||t%400==0}(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},f=function(t){c(t)&&t.setHours(0,0,0,0)},p=function(t,e){return t.getTime()===e.getTime()},m=function(t,e,n){var i,r;for(i in e)(r=void 0!==t[i])&&"object"==typeof e[i]&&null!==e[i]&&void 0===e[i].nodeName?c(e[i])?n&&(t[i]=new Date(e[i].getTime())):u(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=m({},e[i],n):!n&&r||(t[i]=e[i]);return t},g=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},v={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},y=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},w=function(t){var e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},b=function(t,e,n){var i=new Date(n,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(n,e,t)-i)/864e5+i.getDay()+1)/7)+"</td>"},_=function(t,e){return"<tr>"+(e?t.reverse():t).join("")+"</tr>"},E=function(t,e,n,i,r,o){var a,s,l,c,h,d=t._o,f=n===d.minYear,p=n===d.maxYear,m='<div id="'+o+'" class="pika-title" role="heading" aria-live="assertive">',g=!0,v=!0;for(l=[],a=0;a<12;a++)l.push('<option value="'+(n===r?a-e:12+a-e)+'"'+(a===i?' selected="selected"':"")+(f&&a<d.minMonth||p&&a>d.maxMonth?'disabled="disabled"':"")+">"+d.i18n.months[a]+"</option>");for(c='<div class="pika-label">'+d.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",u(d.yearRange)?(a=d.yearRange[0],s=d.yearRange[1]+1):(a=n-d.yearRange,s=1+n+d.yearRange),l=[];a<s&&a<=d.maxYear;a++)a>=d.minYear&&l.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return h='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",d.showMonthAfterYear?m+=h+c:m+=c+h,f&&(0===i||d.minMonth>=i)&&(g=!1),p&&(11===i||d.maxMonth<=i)&&(v=!1),0===e&&(m+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(m+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),m+="</div>"},T=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(t){var e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+y(t,e)+'">'+y(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"}(t)+function(t){return"<tbody>"+t.join("")+"</tbody>"}(e)+"</table>"},C=function(a){var s=this,u=s.config(a);s._onMouseDown=function(t){if(s._v){var e=(t=t||window.event).target||t.srcElement;if(e)if(l(e,"is-disabled")||(!l(e,"pika-button")||l(e,"is-empty")||l(e.parentNode,"is-disabled")?l(e,"pika-prev")?s.prevMonth():l(e,"pika-next")&&s.nextMonth():(s.setDate(new Date(e.getAttribute("data-pika-year"),e.getAttribute("data-pika-month"),e.getAttribute("data-pika-day"))),u.bound&&r(function(){s.hide(),u.field&&u.field.blur()},100))),l(e,"pika-select"))s._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}},s._onChange=function(t){var e=(t=t||window.event).target||t.srcElement;e&&(l(e,"pika-select-month")?s.gotoMonth(e.value):l(e,"pika-select-year")&&s.gotoYear(e.value))},s._onKeyChange=function(t){if(t=t||window.event,s.isVisible())switch(t.keyCode){case 13:case 27:u.field.blur();break;case 37:t.preventDefault(),s.adjustDate("subtract",1);break;case 38:s.adjustDate("subtract",7);break;case 39:s.adjustDate("add",1);break;case 40:s.adjustDate("add",7)}},s._onInputChange=function(n){var i;n.firedBy!==s&&(i=e?(i=t(u.field.value,u.format,u.formatStrict))&&i.isValid()?i.toDate():null:new Date(Date.parse(u.field.value)),c(i)&&s.setDate(i),s._v||s.show())},s._onInputFocus=function(){s.show()},s._onInputClick=function(){s.show()},s._onInputBlur=function(){var t=i.activeElement;do{if(l(t,"pika-single"))return}while(t=t.parentNode);s._c||(s._b=r(function(){s.hide()},50)),s._c=!1},s._onClick=function(t){var e=(t=t||window.event).target||t.srcElement,i=e;if(e){!n&&l(e,"pika-select")&&(e.onchange||(e.setAttribute("onchange","return;"),o(e,"change",s._onChange)));do{if(l(i,"pika-single")||i===u.trigger)return}while(i=i.parentNode);s._v&&e!==u.trigger&&i!==u.trigger&&s.hide()}},s.el=i.createElement("div"),s.el.className="pika-single"+(u.isRTL?" is-rtl":"")+(u.theme?" "+u.theme:""),o(s.el,"mousedown",s._onMouseDown,!0),o(s.el,"touchend",s._onMouseDown,!0),o(s.el,"change",s._onChange),o(i,"keydown",s._onKeyChange),u.field&&(u.container?u.container.appendChild(s.el):u.bound?i.body.appendChild(s.el):u.field.parentNode.insertBefore(s.el,u.field.nextSibling),o(u.field,"change",s._onInputChange),u.defaultDate||(e&&u.field.value?u.defaultDate=t(u.field.value,u.format).toDate():u.defaultDate=new Date(Date.parse(u.field.value)),u.setDefaultDate=!0));var h=u.defaultDate;c(h)?u.setDefaultDate?s.setDate(h,!0):s.gotoDate(h):s.gotoDate(new Date),u.bound?(this.hide(),s.el.className+=" is-bound",o(u.trigger,"click",s._onInputClick),o(u.trigger,"focus",s._onInputFocus),o(u.trigger,"blur",s._onInputBlur)):this.show()};return C.prototype={config:function(t){this._o||(this._o=m({},v,!0));var e=m(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;var n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,c(e.minDate)||(e.minDate=!1),c(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),u(e.yearRange)){var i=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||v.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return c(this._d)?e?t(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return e?t(this._d):null},setMoment:function(n,i){e&&t.isMoment(n)&&this.setDate(n.toDate(),i)},getDate:function(){return c(this._d)?new Date(this._d.getTime()):new Date},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",s(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),c(t)){var n=this._o.minDate,i=this._o.maxDate;c(n)&&t<n?t=n:c(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),f(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),s(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(t){var e=!0;if(c(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,i){var r,o=this.getDate(),a=24*parseInt(i)*60*60*1e3;"add"===n?r=new Date(o.valueOf()+a):"subtract"===n&&(r=new Date(o.valueOf()-a)),e&&("add"===n?r=t(o).add(i,"days").toDate():"subtract"===n&&(r=t(o).subtract(i,"days").toDate())),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=g(this.calendars[0]);for(var t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=g({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(f(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=v.minDate,this._o.minYear=v.minYear,this._o.minMonth=v.minMonth,this._o.startRange=v.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(f(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=v.maxDate,this._o.maxYear=v.maxYear,this._o.maxMonth=v.maxMonth,this._o.endRange=v.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(this._v||t){var e,n=this._o,i=n.minYear,o=n.maxYear,a=n.minMonth,s=n.maxMonth,l="";this._y<=i&&(this._y=i,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=o&&(this._y=o,!isNaN(s)&&this._m>s&&(this._m=s)),e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<n.numberOfMonths;u++)l+='<div class="pika-lendar">'+E(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,e)+this.render(this.calendars[u].year,this.calendars[u].month,e)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&r(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var t,e,n,r,o,a,s,l,u,c;if(!this._o.container){if(this.el.style.position="absolute",t=this._o.trigger,e=t,n=this.el.offsetWidth,r=this.el.offsetHeight,o=window.innerWidth||i.documentElement.clientWidth,a=window.innerHeight||i.documentElement.clientHeight,s=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,"function"==typeof t.getBoundingClientRect)l=(c=t.getBoundingClientRect()).left+window.pageXOffset,u=c.bottom+window.pageYOffset;else for(l=e.offsetLeft,u=e.offsetTop+e.offsetHeight;e=e.offsetParent;)l+=e.offsetLeft,u+=e.offsetTop;(this._o.reposition&&l+n>o||this._o.position.indexOf("right")>-1&&l-n+t.offsetWidth>0)&&(l=l-n+t.offsetWidth),(this._o.reposition&&u+r>a+s||this._o.position.indexOf("top")>-1&&u-r-t.offsetHeight>0)&&(u=u-r-t.offsetHeight),this.el.style.left=l+"px",this.el.style.top=u+"px"}},render:function(t,e,n){var i=this._o,r=new Date,o=d(t,e),a=new Date(t,e,1).getDay(),s=[],l=[];f(r),i.firstDay>0&&(a-=i.firstDay)<0&&(a+=7);for(var u=0===e?11:e-1,m=11===e?0:e+1,g=0===e?t-1:t,v=11===e?t+1:t,y=d(g,u),E=o+a,C=E;C>7;)C-=7;E+=7-C;for(var x=0,S=0;x<E;x++){var M=new Date(t,e,x-a+1),O=!!c(this._d)&&p(M,this._d),R=p(M,r),A=x<a||x>=o+a,P=x-a+1,N=e,k=t,L=i.startRange&&p(i.startRange,M),D=i.endRange&&p(i.endRange,M),I=i.startRange&&i.endRange&&i.startRange<M&&M<i.endRange,H=i.minDate&&M<i.minDate||i.maxDate&&M>i.maxDate||i.disableWeekends&&h(M)||i.disableDayFn&&i.disableDayFn(M);A&&(x<a?(P=y+P,N=u,k=g):(P-=o,N=m,k=v));var U={day:P,month:N,year:k,isSelected:O,isToday:R,isDisabled:H,isEmpty:A,isStartRange:L,isEndRange:D,isInRange:I,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths};l.push(w(U)),7==++S&&(i.showWeekNumber&&l.unshift(b(x-a,e,t)),s.push(_(l,i.isRTL)),l=[],S=0)}return T(i,s,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(!function(t,e){t.className=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}((" "+t.className+" ").replace(" "+e+" "," "))}(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(o(i,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var t=this._v;!1!==t&&(this._o.bound&&a(i,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",function(t,e){l(t,e)||(t.className=""===t.className?e:t.className+" "+e)}(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),this._o.field&&(a(this._o.field,"change",this._onInputChange),this._o.bound&&(a(this._o.trigger,"click",this._onInputClick),a(this._o.trigger,"focus",this._onInputFocus),a(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},C}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("moment"),require("numbro"),require("pikaday")):"function"==typeof define&&define.amd?define("Handsontable",["moment","numbro","pikaday"],e):"object"==typeof exports?exports.Handsontable=e(require("moment"),require("numbro"),require("pikaday")):t.Handsontable=e(t.moment,t.numbro,t.Pikaday)}(this,function(t,e,n){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=185)}([function(t,e,n){"use strict";function i(t,e,n){for(;null!=t&&t!==n;){if(t.nodeType===Node.ELEMENT_NODE&&(e.indexOf(t.nodeName)>-1||e.indexOf(t)>-1))return t;t=t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.host:t.parentNode}return null}function r(t){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(t):t}function o(t){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(t):t}function a(t){var e=0,n=[];if(!t||!t.length)return n;for(;t[e];)n.push(t[e]),e++;return n}function s(t,e){if(3===t.nodeType)e.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var n=t.childNodes,i=n.length-1;i>=0;i--)s(n[i],t)}function l(t){for(var e;e=t.lastChild;)t.removeChild(e)}function u(t,e){var n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?C?n.textContent=e:n.data=e:(l(t),t.appendChild(document.createTextNode(e)))}function c(t){for(var e=t;o(e)!==document.documentElement;){if(null===e)return!1;if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(e.host){if(e.host.impl)return c(e.host.impl);if(e.host)return c(e.host);throw Error("Lost in Web Components world")}return!1}if("none"===e.style.display)return!1;e=e.parentNode}return!0}function h(){var t=window.scrollY;return void 0===t&&(t=document.documentElement.scrollTop),t}function d(){var t=window.scrollX;return void 0===t&&(t=document.documentElement.scrollLeft),t}function f(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}function p(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}e.__esModule=!0,e.HTML_CHARACTERS=void 0,e.getParent=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,i=null;null!=t;){if(n===e){i=t;break}t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t=t.host:(n++,t=t.parentNode)}return i},e.closest=i,e.closestDown=function(t,e,n){for(var r=[];t&&(t=i(t,e,n))&&(!n||n.contains(t));)r.push(t),t=t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.host:t.parentNode;var o=r.length;return o?r[o-1]:null},e.isChildOf=function(t,e){var n=t.parentNode,i=[];for("string"==typeof e?i=Array.prototype.slice.call(document.querySelectorAll(e),0):i.push(e);null!=n;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1},e.isChildOfWebComponentTable=function(t){function e(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName===i.toUpperCase()}var n,i="hot-table",o=!1;for(n=r(t);null!=n;){if(e(n)){o=!0;break}if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o=e(n.host))break;n=n.host}n=n.parentNode}return o},e.polymerWrap=r,e.polymerUnwrap=o,e.index=function(t){var e=0;if(t.previousSibling)for(;t=t.previousSibling;)++e;return e},e.overlayContainsElement=function(t,e){var n=document.querySelector(".ht_clone_"+t);return n?n.contains(e):null},e.hasClass=function(t,e){return m(t,e)},e.addClass=function(t,e){return g(t,e)},e.removeClass=function(t,e){return v(t,e)},e.removeTextNodes=s,e.empty=l,e.fastInnerHTML=function(t,e){T.test(e)?t.innerHTML=e:u(t,e)},e.fastInnerText=u,e.isVisible=c,e.offset=function(t){var e,n,i,r,o;if(r=document.documentElement,(0,w.hasCaptionProblem)()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName)return o=t.getBoundingClientRect(),{top:o.top+(window.pageYOffset||r.scrollTop)-(r.clientTop||0),left:o.left+(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0)};for(e=t.offsetLeft,n=t.offsetTop,i=t;(t=t.offsetParent)&&t!==document.body;)e+=t.offsetLeft,n+=t.offsetTop,i=t;return i&&"fixed"===i.style.position&&(e+=window.pageXOffset||r.scrollLeft,n+=window.pageYOffset||r.scrollTop),{left:e,top:n}},e.getWindowScrollTop=h,e.getWindowScrollLeft=d,e.getScrollTop=function(t){return t===window?h():t.scrollTop},e.getScrollLeft=function(t){return t===window?d():t.scrollLeft},e.getScrollableElement=function(t){for(var e,n,i,r=t.parentNode,o=["auto","scroll"],a="",s="",l="",u="";r&&r.style&&document.body!==r;){if(e=r.style.overflow,n=r.style.overflowX,i=r.style.overflowY,"scroll"==e||"scroll"==n||"scroll"==i)return r;if(window.getComputedStyle&&(a=window.getComputedStyle(r),s=a.getPropertyValue("overflow"),l=a.getPropertyValue("overflow-y"),u=a.getPropertyValue("overflow-x"),"scroll"===s||"scroll"===u||"scroll"===l))return r;if(r.scrollHeight+1>=r.clientHeight&&(-1!==o.indexOf(i)||-1!==o.indexOf(e)||-1!==o.indexOf(s)||-1!==o.indexOf(l)))return r;if(r.scrollWidth+1>=r.clientWidth&&(-1!==o.indexOf(n)||-1!==o.indexOf(e)||-1!==o.indexOf(s)||-1!==o.indexOf(u)))return r;r=r.parentNode}return window},e.getTrimmingContainer=function(t){for(var e=t.parentNode;e&&e.style&&document.body!==e;){if("visible"!==e.style.overflow&&""!==e.style.overflow)return e;if(window.getComputedStyle){var n=window.getComputedStyle(e);if("visible"!==n.getPropertyValue("overflow")&&""!==n.getPropertyValue("overflow"))return e}e=e.parentNode}return window},e.getStyle=function(t,e){if(t){if(t!==window){var n,i=t.style[e];return""!==i&&void 0!==i?i:""!==(n=f(t))[e]&&void 0!==n[e]?n[e]:void 0}if("width"===e)return window.innerWidth+"px";if("height"===e)return window.innerHeight+"px"}},e.getComputedStyle=f,e.outerWidth=function(t){return t.offsetWidth},e.outerHeight=function(t){return(0,w.hasCaptionProblem)()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight},e.innerHeight=function(t){return t.clientHeight||t.innerHeight},e.innerWidth=function(t){return t.clientWidth||t.innerWidth},e.addEvent=function(t,e,n){window.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},e.removeEvent=function(t,e,n){window.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)},e.getCaretPosition=function(t){if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null==e)return 0;var n=t.createTextRange(),i=n.duplicate();return n.moveToBookmark(e.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0},e.getSelectionEndPosition=function(t){if(t.selectionEnd)return t.selectionEnd;if(document.selection){var e=document.selection.createRange();return null==e?0:t.createTextRange().text.indexOf(e.text)+e.text.length}return 0},e.getSelectionText=function(){var t="";return window.getSelection?t=""+window.getSelection():document.selection&&"Control"!==document.selection.type&&(t=document.selection.createRange().text),t},e.setCaretPosition=function(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(o){var i=t.parentNode,r=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=r}}else if(t.createTextRange){var o=t.createTextRange();o.collapse(!0),o.moveEnd("character",n),o.moveStart("character",e),o.select()}},e.getScrollbarWidth=function(){return void 0===E&&(E=function(){var t=document.createElement("div");t.style.height="200px",t.style.width="100%";var e=document.createElement("div");e.style.boxSizing="content-box",e.style.height="150px",e.style.left="0px",e.style.overflow="hidden",e.style.position="absolute",e.style.top="0px",e.style.width="200px",e.style.visibility="hidden",e.appendChild(t),(document.body||document.documentElement).appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;return n==i&&(i=e.clientWidth),(document.body||document.documentElement).removeChild(e),n-i}()),E},e.hasVerticalScrollbar=function(t){return t.offsetWidth!==t.clientWidth},e.hasHorizontalScrollbar=function(t){return t.offsetHeight!==t.clientHeight},e.setOverlayPosition=function(t,e,n){(0,y.isIE8)()||(0,y.isIE9)()?(t.style.top=n,t.style.left=e):(0,y.isSafari)()?t.style["-webkit-transform"]="translate3d("+e+","+n+",0)":t.style.transform="translate3d("+e+","+n+",0)"},e.getCssTransform=function(t){var e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:t.style["-webkit-transform"]&&""!==(e=t.style["-webkit-transform"])?["-webkit-transform",e]:-1},e.resetCssTransform=function(t){t.style.transform&&""!==t.style.transform?t.style.transform="":t.style["-webkit-transform"]&&""!==t.style["-webkit-transform"]&&(t.style["-webkit-transform"]="")},e.isInput=p,e.isOutsideInput=function(t){return p(t)&&-1==t.className.indexOf("handsontableInput")&&-1==t.className.indexOf("copyPaste")};var m,g,v,y=n(27),w=n(35);if(!!document.documentElement.classList){var b=function(){var t=document.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")}();m=function(t,e){return void 0!==t.classList&&""!==e&&t.classList.contains(e)},g=function(t,e){var n=0;if("string"==typeof e&&(e=e.split(" ")),e=a(e),b)t.classList.add.apply(t.classList,e);else for(;e&&e[n];)t.classList.add(e[n]),n++},v=function(t,e){var n=0;if("string"==typeof e&&(e=e.split(" ")),e=a(e),b)t.classList.remove.apply(t.classList,e);else for(;e&&e[n];)t.classList.remove(e[n]),n++}}else{var _=function(t){return RegExp("(\\s|^)"+t+"(\\s|$)")};m=function(t,e){return void 0!==t.className&&_(e).test(t.className)},g=function(t,e){var n=0,i=t.className;if("string"==typeof e&&(e=e.split(" ")),""===i)i=e.join(" ");else for(;e&&e[n];)_(e[n]).test(i)||(i+=" "+e[n]),n++;t.className=i},v=function(t,e){var n=0,i=t.className;for("string"==typeof e&&(e=e.split(" "));e&&e[n];)i=i.replace(_(e[n])," ").trim(),n++;t.className!==i&&(t.className=i)}}var E,T=e.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,C=!!document.createTextNode("test").textContent},function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){var e;return Array.isArray(t)?e=[]:(e={},l(t,function(t,n){"__children"!==n&&(e[n]=t&&"object"===(void 0===t?"undefined":u(t))&&!Array.isArray(t)?r(t):Array.isArray(t)?t.length&&"object"===u(t[0])&&!Array.isArray(t[0])?[r(t[0])]:[]:null)})),e}function o(t,e){l(e,function(n,i){e[i]&&"object"===u(e[i])?(t[i]||(t[i]=Array.isArray(e[i])?[]:"[object Date]"===Object.prototype.toString.call(e[i])?e[i]:{}),o(t[i],e[i])):t[i]=e[i]})}function a(t){return"object"===(void 0===t?"undefined":u(t))?JSON.parse(JSON.stringify(t)):t}function s(t){return"[object Object]"==Object.prototype.toString.call(t)}function l(t,e){for(var n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}e.__esModule=!0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.duckSchema=r,e.inherit=function(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t},e.extend=function(t,e){return l(e,function(e,n){t[n]=e}),t},e.deepExtend=o,e.deepClone=a,e.clone=function(t){var e={};return l(t,function(t,n){e[n]=t}),e},e.mixin=function(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return(0,c.arrayEach)(n,function(e){t.MIXINS.push(e.MIXIN_NAME),l(e,function(e,n){if(void 0!==t.prototype[n])throw Error("Mixin conflict. Property '"+n+"' already exist and cannot be overwritten.");"function"==typeof e?t.prototype[n]=e:Object.defineProperty(t.prototype,n,{get:function(t,e){return t="_"+t,function(){return void 0===this[t]&&(this[t]=function(t){return(Array.isArray(t)||s(t))&&(t=a(t)),t}(e)),this[t]}}(n,e),set:function(t){return t="_"+t,function(e){this[t]=e}}(n),configurable:!0})})}),t},e.isObjectEquals=function(t,e){return JSON.stringify(t)===JSON.stringify(e)},e.isObject=s,e.defineGetter=function(t,e,n,i){i.value=n,i.writable=!1!==i.writable,i.enumerable=!1!==i.enumerable,i.configurable=!1!==i.configurable,Object.defineProperty(t,e,i)},e.objectEach=l,e.getProperty=function(t,e){var n=t;return l(e.split("."),function(t){if(void 0===(n=n[t]))return n=void 0,!1}),n},e.deepObjectSize=function(t){return s(t)?function t(e){var n=0;return s(e)?l(e,function(e){n+=t(e)}):n++,n}(t):0},e.createObjectPropListener=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_"+n,o=(e={_touched:!1},i(e,r,t),i(e,"isTouched",function(){return this._touched}),e);return Object.defineProperty(o,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),o},e.hasOwnProperty=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var c=n(2)},function(t,e,n){"use strict";function i(t,e,n,i){var r=-1,o=t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function r(t,e){for(var n=-1,i=t.length;++n<i&&!1!==e(t[n],n,t););return t}function o(t){return i(t,function(t,e){return t+e},0)}function a(t){return i(t,function(t,e){return t.concat(Array.isArray(e)?a(e):e)},[])}e.__esModule=!0,e.to2dArray=function(t){for(var e=0,n=t.length;n>e;)t[e]=[t[e]],e++},e.extendArray=function(t,e){for(var n=0,i=e.length;i>n;)t.push(e[n]),n++},e.pivot=function(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,i=t[0].length,r=0;n>r;r++)for(var o=0;i>o;o++)e[o]||(e[o]=[]),e[o][r]=t[r][o];return e},e.arrayReduce=i,e.arrayFilter=function(t,e){for(var n=-1,i=t.length,r=-1,o=[];++n<i;){var a=t[n];e(a,n,t)&&(o[++r]=a)}return o},e.arrayMap=function(t,e){for(var n=-1,i=t.length,r=-1,o=[];++n<i;){var a=t[n];o[++r]=e(a,n,t)}return o},e.arrayEach=r,e.arraySum=o,e.arrayMax=function(t){return i(t,function(t,e){return t>e?t:e},Array.isArray(t)?t[0]:void 0)},e.arrayMin=function(t){return i(t,function(t,e){return e>t?t:e},Array.isArray(t)?t[0]:void 0)},e.arrayAvg=function(t){return t.length?o(t)/t.length:0},e.arrayFlatten=a,e.arrayUnique=function(t){var e=[];return r(t,function(t){-1===e.indexOf(t)&&e.push(t)}),e}},function(t,e,n){var i=n(12),r=n(46),o=n(30),a=n(29),s=n(31),l=function(t,e,n){var u,c,h,d,f=t&l.F,p=t&l.G,m=t&l.S,g=t&l.P,v=t&l.B,y=p?i:m?i[e]||(i[e]={}):(i[e]||{}).prototype,w=p?r:r[e]||(r[e]={}),b=w.prototype||(w.prototype={});p&&(n=e);for(u in n)c=!f&&y&&void 0!==y[u],h=(c?y:n)[u],d=v&&c?s(h,i):g&&"function"==typeof h?s(Function.call,h):h,y&&a(y,u,h,t&l.U),w[u]!=h&&o(w,u,d),g&&b[u]!=h&&(b[u]=h)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.getListenersCounter=function(){return l};var r=n(0),o=n(1),a=n(35),s=n(11),l=0,u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return i(t,[{key:"addEventListener",value:function(t,e,n){function i(t){t=function(t,e){var n=void 0,i=void 0,l=void 0,c=void 0,h=void 0,d=void 0;if(e.isTargetWebComponent=!1,e.realTarget=e.target,d=e.stopImmediatePropagation,e.stopImmediatePropagation=function(){d.apply(this),(0,s.stopImmediatePropagation)(this)},!u.isHotTableEnv)return e;for(h=(e=(0,r.polymerWrap)(e)).path?e.path.length:0;h--;){if("HOT-TABLE"===e.path[h].nodeName)n=!0;else if(n&&e.path[h].shadowRoot){c=e.path[h];break}0!==h||c||(c=e.path[h])}return c||(c=e.target),e.isTargetWebComponent=!0,(0,a.isWebComponentSupportedNatively)()?e.realTarget=e.srcElement||e.toElement:((0,o.hasOwnProperty)(t,"hot")||t.isHotTableEnv||t.wtTable)&&((0,o.hasOwnProperty)(t,"hot")?i=t.hot?t.hot.view.wt.wtTable.TABLE:null:t.isHotTableEnv?i=t.view.activeWt.wtTable.TABLE.parentNode.parentNode:t.wtTable&&(i=t.wtTable.TABLE.parentNode.parentNode),l=(0,r.closest)(e.target,["HOT-TABLE"],i),e.realTarget=l?i.querySelector("HOT-TABLE")||e.target:e.target),Object.defineProperty(e,"target",{get:function(){return(0,r.polymerWrap)(c)},enumerable:!0,configurable:!0}),e}(h,t),n.call(this,t)}var c=this,h=this.context;return this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:i}),window.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i),l++,function(){c.removeEventListener(t,e,n)}}},{key:"removeEventListener",value:function(t,e,n){for(var i=this.context.eventListeners.length,r=void 0;i--;)if((r=this.context.eventListeners[i]).event==e&&r.element==t){if(n&&n!=r.callback)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener?r.element.removeEventListener(r.event,r.callbackProxy,!1):r.element.detachEvent("on"+r.event,r.callbackProxy),l--}}},{key:"clearEvents",value:function(){if(this.context)for(var t=this.context.eventListeners.length;t--;){var e=this.context.eventListeners[t];e&&this.removeEventListener(e.element,e.event,e.callback)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"fireEvent",value:function(t,e){var n,i={bubbles:!0,cancelable:"mousemove"!==e,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(n=document.createEvent("MouseEvents")).initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||document.body.parentNode):n=document.createEventObject(),t.dispatchEvent?t.dispatchEvent(n):t.fireEvent("on"+e,n)}}]),t}();e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.isNumeric=function(t){var e=void 0===t?"undefined":i(t);return"number"==e?!isNaN(t)&&isFinite(t):"string"==e?!!t.length&&(1==t.length?/\d/.test(t):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(t)):"object"==e&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)},e.rangeEach=function(t,e,n){var i=-1;for("function"==typeof e?(n=e,e=t):i=t-1;++i<=e&&!1!==n(i););},e.rangeEachReverse=function(t,e,n){var i=t+1;for("function"==typeof e&&(n=e,e=0);--i>=e&&!1!==n(i););},e.valueAccordingPercent=function(t,e){return e=parseInt((""+e).replace("%",""),10),e=parseInt(t*e/100,10)}},function(t,e,n){"use strict";e.__esModule=!0,e.getPluginName=e.getRegistredPluginNames=e.getPlugin=e.registerPlugin=void 0;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(8)),r=n(1),o=n(33),a=new WeakMap;e.registerPlugin=function(t,e){t=(0,o.toUpperCaseFirst)(t),i.default.getSingleton().add("construct",function(){var n=void 0;a.has(this)||a.set(this,{}),(n=a.get(this))[t]||(n[t]=new e(this))}),i.default.getSingleton().add("afterDestroy",function(){if(a.has(this)){var t=a.get(this);(0,r.objectEach)(t,function(t){return t.destroy()}),a.delete(this)}})},e.getPlugin=function(t,e){if("string"!=typeof e)throw Error('Only strings can be passed as "plugin" parameter');var n=(0,o.toUpperCaseFirst)(e);if(a.has(t)&&a.get(t)[n])return a.get(t)[n]},e.getRegistredPluginNames=function(t){return a.has(t)?Object.keys(a.get(t)):[]},e.getPluginName=function(t,e){var n=null;return a.has(t)&&(0,r.objectEach)(a.get(t),function(t,i){t===e&&(n=i)}),n}},function(t,e,n){"use strict";e.__esModule=!0;var i=e.CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",r=(e.CONTEXTMENU_ITEMS_ROW_ABOVE=i+".insertRowAbove",e.CONTEXTMENU_ITEMS_ROW_BELOW=i+".insertRowBelow",e.CONTEXTMENU_ITEMS_INSERT_LEFT=i+".insertColumnOnTheLeft",e.CONTEXTMENU_ITEMS_INSERT_RIGHT=i+".insertColumnOnTheRight",e.CONTEXTMENU_ITEMS_REMOVE_ROW=i+".removeRow",e.CONTEXTMENU_ITEMS_REMOVE_COLUMN=i+".removeColumn",e.CONTEXTMENU_ITEMS_UNDO=i+".undo",e.CONTEXTMENU_ITEMS_REDO=i+".redo",e.CONTEXTMENU_ITEMS_READ_ONLY=i+".readOnly",e.CONTEXTMENU_ITEMS_CLEAR_COLUMN=i+".clearColumn",e.CONTEXTMENU_ITEMS_COPY=i+".copy",e.CONTEXTMENU_ITEMS_CUT=i+".cut",e.CONTEXTMENU_ITEMS_FREEZE_COLUMN=i+".freezeColumn",e.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=i+".unfreezeColumn",e.CONTEXTMENU_ITEMS_MERGE_CELLS=i+".mergeCells",e.CONTEXTMENU_ITEMS_UNMERGE_CELLS=i+".unmergeCells",e.CONTEXTMENU_ITEMS_ADD_COMMENT=i+".addComment",e.CONTEXTMENU_ITEMS_EDIT_COMMENT=i+".editComment",e.CONTEXTMENU_ITEMS_REMOVE_COMMENT=i+".removeComment",e.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=i+".readOnlyComment",e.CONTEXTMENU_ITEMS_ALIGNMENT=i+".align",e.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=i+".align.left",e.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=i+".align.center",e.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=i+".align.right",e.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=i+".align.justify",e.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=i+".align.top",e.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=i+".align.middle",e.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=i+".align.bottom",e.CONTEXTMENU_ITEMS_BORDERS=i+".borders",e.CONTEXTMENU_ITEMS_BORDERS_TOP=i+".borders.top",e.CONTEXTMENU_ITEMS_BORDERS_RIGHT=i+".borders.right",e.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=i+".borders.bottom",e.CONTEXTMENU_ITEMS_BORDERS_LEFT=i+".borders.left",e.CONTEXTMENU_ITEMS_REMOVE_BORDERS=i+".borders.remove",e.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=i+".nestedHeaders.insertChildRow",e.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=i+".nestedHeaders.detachFromParent",e.CONTEXTMENU_ITEMS_HIDE_COLUMN=i+".hideColumn",e.CONTEXTMENU_ITEMS_SHOW_COLUMN=i+".showColumn",e.CONTEXTMENU_ITEMS_HIDE_ROW=i+".hideRow",e.CONTEXTMENU_ITEMS_SHOW_ROW=i+".showRow",e.FILTERS_NAMESPACE="Filters:"),o=e.FILTERS_CONDITIONS_NAMESPACE=r+"conditions";e.FILTERS_CONDITIONS_NONE=o+".none",e.FILTERS_CONDITIONS_EMPTY=o+".isEmpty",e.FILTERS_CONDITIONS_NOT_EMPTY=o+".isNotEmpty",e.FILTERS_CONDITIONS_EQUAL=o+".isEqualTo",e.FILTERS_CONDITIONS_NOT_EQUAL=o+".isNotEqualTo",e.FILTERS_CONDITIONS_BEGINS_WITH=o+".beginsWith",e.FILTERS_CONDITIONS_ENDS_WITH=o+".endsWith",e.FILTERS_CONDITIONS_CONTAINS=o+".contains",e.FILTERS_CONDITIONS_NOT_CONTAIN=o+".doesNotContain",e.FILTERS_CONDITIONS_BY_VALUE=o+".byValue",e.FILTERS_CONDITIONS_GREATER_THAN=o+".greaterThan",e.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=o+".greaterThanOrEqualTo",e.FILTERS_CONDITIONS_LESS_THAN=o+".lessThan",e.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=o+".lessThanOrEqualTo",e.FILTERS_CONDITIONS_BETWEEN=o+".isBetween",e.FILTERS_CONDITIONS_NOT_BETWEEN=o+".isNotBetween",e.FILTERS_CONDITIONS_AFTER=o+".after",e.FILTERS_CONDITIONS_BEFORE=o+".before",e.FILTERS_CONDITIONS_TODAY=o+".today",e.FILTERS_CONDITIONS_TOMORROW=o+".tomorrow",e.FILTERS_CONDITIONS_YESTERDAY=o+".yesterday",e.FILTERS_DIVS_FILTER_BY_CONDITION=r+"labels.filterByCondition",e.FILTERS_DIVS_FILTER_BY_VALUE=r+"labels.filterByValue",e.FILTERS_LABELS_CONJUNCTION=r+"labels.conjunction",e.FILTERS_LABELS_DISJUNCTION=r+"labels.disjunction",e.FILTERS_VALUES_BLANK_CELLS=r+"values.blankCells",e.FILTERS_BUTTONS_SELECT_ALL=r+"buttons.selectAll",e.FILTERS_BUTTONS_CLEAR=r+"buttons.clear",e.FILTERS_BUTTONS_OK=r+"buttons.ok",e.FILTERS_BUTTONS_CANCEL=r+"buttons.cancel",e.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=r+"buttons.placeholder.search",e.FILTERS_BUTTONS_PLACEHOLDER_VALUE=r+"buttons.placeholder.value",e.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=r+"buttons.placeholder.secondValue"},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(2),o=n(1),a=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","afterListen","afterUnlisten"],s=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.globalBucket=this.createEmptyBucket()}return i(t,null,[{key:"getSingleton",value:function(){return l}}]),i(t,[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return(0,r.arrayEach)(a,function(e){return t[e]=[]}),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))(0,r.arrayEach)(e,function(e){return n.add(t,e,i)});else{var o=this.getBucket(i);if(void 0===o[t]&&(this.register(t),o[t]=[]),e.skip=!1,-1===o[t].indexOf(e)){var a=!1;e.initialHook&&(0,r.arrayEach)(o[t],function(n,i){if(n.initialHook)return o[t][i]=e,a=!0,!1}),a||o[t].push(e)}}return this}},{key:"once",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?(0,r.arrayEach)(e,function(e){return n.once(t,e,i)}):(e.runOnce=!0,this.add(t,e,i))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.getBucket(n);return void 0!==i[t]&&i[t].indexOf(e)>=0&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}},{key:"run",value:function(t,e,n,i,r,o,a,s){var l=this.globalBucket[e],u=-1,c=l?l.length:0;if(c)for(;++u<c;)if(l[u]&&!l[u].skip){var h=l[u].call(t,n,i,r,o,a,s);void 0!==h&&(n=h),l[u]&&l[u].runOnce&&this.remove(e,l[u])}var d=this.getBucket(t)[e],f=-1,p=d?d.length:0;if(p)for(;++f<p;)if(d[f]&&!d[f].skip){var m=d[f].call(t,n,i,r,o,a,s);void 0!==m&&(n=m),d[f]&&d[f].runOnce&&this.remove(e,d[f],t)}return n}},{key:"destroy",value:function(){(0,o.objectEach)(this.getBucket(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),function(t,e,n){return n[e].length=0})}},{key:"register",value:function(t){this.isRegistered(t)||a.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&a.splice(a.indexOf(t),1)}},{key:"isRegistered",value:function(t){return a.indexOf(t)>=0}},{key:"getRegistered",value:function(){return a}}]),t}(),l=new s;e.default=s},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.getRegisteredRenderers=e.getRegisteredRendererNames=e.hasRenderer=e.getRenderer=e.registerRenderer=void 0;var r=i(n(42)),o=i(n(224)),a=i(n(225)),s=i(n(226)),l=i(n(227)),u=i(n(228)),c=i(n(229)),h=i(n(230)),d=(0,r.default)("renderers"),f=d.register,p=d.getItem,m=d.hasItem,g=d.getNames,v=d.getValues;f("base",o.default),f("autocomplete",a.default),f("checkbox",s.default),f("html",l.default),f("numeric",u.default),f("password",c.default),f("text",h.default),e.registerRenderer=f,e.getRenderer=function(t){if("function"==typeof t)return t;if(!m(t))throw Error('No registered renderer found under "'+t+'" name');return p(t)},e.hasRenderer=m,e.getRegisteredRendererNames=g,e.getRegisteredRenderers=v},function(t,e,n){var i=n(71)("wks"),r=n(44),o=n(12).Symbol,a="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))}).store=i},function(t,e,n){"use strict";e.__esModule=!0,e.stopImmediatePropagation=function(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0},e.isImmediatePropagationStopped=function(t){return!1===t.isImmediatePropagationEnabled},e.stopPropagation=function(t){"function"==typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},e.pageX=function(t){return t.pageX?t.pageX:t.clientX+(0,i.getWindowScrollLeft)()},e.pageY=function(t){return t.pageY?t.pageY:t.clientY+(0,i.getWindowScrollTop)()},e.isRightClick=function(t){return 2===t.button},e.isLeftClick=function(t){return 0===t.button};var i=n(0)},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.Viewport=e.TableRenderer=e.Table=e.Settings=e.Selection=e.Scroll=e.Overlays=e.Event=e.Core=e.default=e.Border=e.TopLeftCornerOverlay=e.TopOverlay=e.LeftOverlay=e.DebugOverlay=e.RowFilter=e.ColumnFilter=e.CellRange=e.CellCoords=e.ViewportRowsCalculator=e.ViewportColumnsCalculator=void 0,n(91),n(105),n(106),n(110),n(111),n(113),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(124),n(126),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(135),n(136),n(137),n(138),n(80),n(139),n(140),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(150),n(151),n(152),n(154),n(155),n(156);var r=i(n(157)),o=i(n(158)),a=i(n(51)),s=i(n(81)),l=i(n(159)),u=i(n(160)),c=i(n(209)),h=i(n(210)),d=i(n(211)),f=i(n(212)),p=i(n(170)),m=i(n(161)),g=i(n(163)),v=i(n(164)),y=i(n(165)),w=i(n(213)),b=i(n(166)),_=i(n(167)),E=i(n(168)),T=i(n(169));e.ViewportColumnsCalculator=r.default,e.ViewportRowsCalculator=o.default,e.CellCoords=a.default,e.CellRange=s.default,e.ColumnFilter=l.default,e.RowFilter=u.default,e.DebugOverlay=c.default,e.LeftOverlay=h.default,e.TopOverlay=d.default,e.TopLeftCornerOverlay=f.default,e.Border=p.default,e.default=m.default,e.Core=m.default,e.Event=g.default,e.Overlays=v.default,e.Scroll=y.default,e.Selection=w.default,e.Settings=b.default,e.Table=_.default,e.TableRenderer=E.default,e.Viewport=T.default},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(1),o=n(2),a=n(175),s=n(6),l=new WeakMap,u=null;e.default=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),(0,r.defineGetter)(this,"hot",e,{writable:!1}),(0,r.defineGetter)(this,"t",(0,a.getTranslator)(e),{writable:!1}),l.set(this,{hooks:{}}),u=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return n.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(){return n.onUpdateSettings()}),this.hot.addHook("beforeInit",function(){return n.init()})}return i(t,[{key:"init",value:function(){this.pluginName=(0,s.getPluginName)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),u||(u=(0,s.getRegistredPluginNames)(this.hot)),0>u.indexOf(this.pluginName)||u.splice(u.indexOf(this.pluginName),1),u.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,e){l.get(this).hooks[t]=l.get(this).hooks[t]||[];var n=l.get(this).hooks[t];this.hot.addHook(t,e),n.push(e),l.get(this).hooks[t]=n}},{key:"removeHooks",value:function(t){var e=this;(0,o.arrayEach)(l.get(this).hooks[t]||[],function(n){e.hot.removeHook(t,n)})}},{key:"clearHooks",value:function(){var t=this,e=l.get(this).hooks;(0,r.objectEach)(e,function(e,n){return t.removeHooks(n)}),e.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){(0,o.arrayEach)(this.pluginsInitializedCallbacks,function(t){return t()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),(0,r.objectEach)(this,function(e,n){"hot"!==n&&"t"!==n&&(t[n]=null)}),delete this.t,delete this.hot}}]),t}()},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},l.default.getSingleton().add("afterDestroy",function(){e={}})}function o(t,e){var n=void 0;if("function"==typeof t)b.get(t)||a(null,t),n=b.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=T(t)}if(!n)throw Error('No editor registered under name "'+t+'"');return n.getInstance(e)}function a(t,e){var n=new r(e);"string"==typeof t&&E(t,n),b.set(e,n)}e.__esModule=!0,e.getRegisteredEditors=e.getRegisteredEditorNames=e.hasEditor=e.getEditorInstance=e.getEditor=e.registerEditor=void 0,e.RegisteredEditor=r,e._getEditorInstance=o;var s=i(n(42)),l=i(n(8)),u=i(n(43)),c=i(n(171)),h=i(n(215)),d=i(n(216)),f=i(n(219)),p=i(n(172)),m=i(n(220)),g=i(n(221)),v=i(n(222)),y=i(n(223)),w=i(n(53)),b=new WeakMap,_=(0,s.default)("editors"),E=_.register,T=_.getItem,C=_.hasItem,x=_.getNames,S=_.getValues;a("base",u.default),a("autocomplete",c.default),a("checkbox",h.default),a("date",d.default),a("dropdown",f.default),a("handsontable",p.default),a("mobile",m.default),a("numeric",g.default),a("password",v.default),a("select",y.default),a("text",w.default),e.registerEditor=a,e.getEditor=function(t){if(!C(t))throw Error('No registered editor found under "'+t+'" name');return T(t).getConstructor()},e.getEditorInstance=o,e.hasEditor=C,e.getRegisteredEditorNames=x,e.getRegisteredEditors=S},function(t,e,n){"use strict";function i(t){return void 0===t}function r(t){return null===t||""===t||i(t)}e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=Object.freeze(Object.defineProperties(["\n          Your license key of Handsontable Pro has expired. \n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "],{raw:{value:Object.freeze(["\n          Your license key of Handsontable Pro has expired.\\x20\n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "])}}));e.stringify=function(t){var e=void 0;switch(void 0===t?"undefined":o(t)){case"string":case"number":e=""+t;break;case"object":e=null===t?"":""+t;break;case"undefined":e="";break;default:e=""+t}return e},e.isDefined=function(t){return void 0!==t},e.isUndefined=i,e.isEmpty=r,e.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},e._injectProductInfo=function(t,e){var n="",i=!0,o=function(t){var e=[][u],n=e;if(t[u]!==f("Z"))return!1;for(var i="",r="B<H4P+".split(""),o=f(r.shift());o;o=f(r.shift()||"A"))--o<""[u]?n|=(h(""+h(c(i)+(c(d(t,Math.abs(o),2))+[]).padStart(2,"0")))%97||2)>>1:i=d(t,o,o?1===r[u]?9:8:6);return n===e}(t=p(t||"")),y=g(),w=r(t)||"trial"===t;if(w||o)if(o){var b=Math.floor((0,s.default)("06/12/2017","DD/MM/YYYY").toDate().getTime()/864e5),_=m(t);(_>45e3||_!==parseInt(_,10))&&(n="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly."),n||(b>_+1&&(n=(0,l.toSingleLine)(a)),i=b>_+15)}else n="Evaluation version of Handsontable Pro. Not licensed for use in a production environment.";else n="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly.";if(y&&(n=!1,i=!1),n&&!v&&(console[w?"info":"warn"](n),v=!0),i&&e.parentNode){var E=document.createElement("div");E.id="hot-display-license-info",E.appendChild(document.createTextNode("Evaluation version of Handsontable Pro.")),E.appendChild(document.createElement("br")),E.appendChild(document.createTextNode("Not licensed for production use.")),e.parentNode.insertBefore(E,e.nextSibling)}};var s=function(t){return t&&t.__esModule?t:{default:t}}(n(52)),l=n(162),u="length",c=function(t){return parseInt(t,16)},h=function(t){return parseInt(t,10)},d=function(t,e,n){return t.substr(e,n)},f=function(t){return t.codePointAt(0)-65},p=function(t){return(""+t).replace(/\-/g,"")},m=function(t){return c(d(p(t),c("12"),f("F")))/(c(d(p(t),f("B"),~~![][u]))||9)},g=function(){return"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},v=!1},function(t,e,n){var i=n(15);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var i=n(18),r=n(93),o=n(67),a=Object.defineProperty;e.f=n(22)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";e.__esModule=!0,e.KEY_CODES=void 0,e.isPrintableChar=function(t){return 32==t||t>=48&&57>=t||t>=96&&111>=t||t>=186&&192>=t||t>=219&&222>=t||t>=226||t>=65&&90>=t},e.isMetaKey=function(t){return-1!==[r.ARROW_DOWN,r.ARROW_UP,r.ARROW_LEFT,r.ARROW_RIGHT,r.HOME,r.END,r.DELETE,r.BACKSPACE,r.F1,r.F2,r.F3,r.F4,r.F5,r.F6,r.F7,r.F8,r.F9,r.F10,r.F11,r.F12,r.TAB,r.PAGE_DOWN,r.PAGE_UP,r.ENTER,r.ESCAPE,r.SHIFT,r.CAPS_LOCK,r.ALT].indexOf(t)},e.isCtrlKey=function(t){return-1!==[r.CONTROL_LEFT,224,r.COMMAND_LEFT,r.COMMAND_RIGHT].indexOf(t)},e.isKey=function(t,e){var n=e.split("|"),o=!1;return(0,i.arrayEach)(n,function(e){if(t===r[e])return o=!0,!1}),o};var i=n(2),r=e.KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},function(t,e,n){"use strict";function i(t,e){return-1!=t.indexOf(e)?t:(t=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),t+=" "+e)}function r(t,e){return-1!=t.indexOf(e)?t:(t=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),t+=" "+e)}function o(t,e,n,o,a,s){var l=a(t,e),u=o;l.className&&(u="vertical"===n?i(l.className,o):r(l.className,o)),s(t,e,"className",u)}function a(t,e){for(var n=t.slice(0);n.length>0&&n[0].name===e;)n.shift();return n}e.__esModule=!0,e.normalizeSelection=function(t){return{start:t.getTopLeftCorner(),end:t.getBottomRightCorner()}},e.isSeparator=function(t){return(0,l.hasClass)(t,"htSeparator")},e.hasSubMenu=function(t){return(0,l.hasClass)(t,"htSubmenu")},e.isDisabled=function(t){return(0,l.hasClass)(t,"htDisabled")},e.isSelectionDisabled=function(t){return(0,l.hasClass)(t,"htSelectionDisabled")},e.getValidSelection=function(t){var e=t.getSelected();return e?0>e[0]?null:e:null},e.prepareVerticalAlignClass=i,e.prepareHorizontalAlignClass=r,e.getAlignmentClasses=function(t,e){for(var n={},i=t.from.row;t.to.row>=i;i++)for(var r=t.from.col;t.to.col>=r;r++)n[i]||(n[i]=[]),n[i][r]=e(i,r);return n},e.align=function(t,e,n,i,r){if(t.from.row==t.to.row&&t.from.col==t.to.col)o(t.from.row,t.from.col,e,n,i,r);else for(var a=t.from.row;t.to.row>=a;a++)for(var s=t.from.col;t.to.col>=s;s++)o(a,s,e,n,i,r)},e.checkSelectionConsistency=function(t,e){var n=!1;return t&&t.forAll(function(t,i){if(e(t,i))return n=!0,!1}),n},e.markLabelAsSelected=function(t){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+t},e.isItemHidden=function(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))},e.filterSeparators=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.KEY,n=t.slice(0);return n=a(n,e),n=function(t,e){var n=t.slice(0);return n.reverse(),(n=a(n,e)).reverse(),n}(n,e),n=function(t){var e=[];return(0,s.arrayEach)(t,function(t,n){n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}(n)};var s=n(2),l=n(0),u=n(88)},function(t,e,n){t.exports=!n(24)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(54),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(69),r=n(34);t.exports=function(t){return i(r(t))}},function(t,e,n){"use strict";e.__esModule=!0,e.isIE8=function(){return i},e.isIE9=function(){return r},e.isSafari=function(){return o},e.isChrome=function(){return a},e.isMobileBrowser=function(t){return t||(t=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)};var i=!document.createTextNode("test").textContent,r=!!document.documentMode,o=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),a=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.getRegisteredValidators=e.getRegisteredValidatorNames=e.hasValidator=e.getValidator=e.registerValidator=void 0;var r=i(n(42)),o=i(n(231)),a=i(n(232)),s=i(n(233)),l=i(n(234)),u=(0,r.default)("validators"),c=u.register,h=u.getItem,d=u.hasItem,f=u.getNames,p=u.getValues;c("autocomplete",o.default),c("date",a.default),c("numeric",s.default),c("time",l.default),e.registerValidator=c,e.getValidator=function(t){if("function"==typeof t)return t;if(!d(t))throw Error('No registered validator found under "'+t+'" name');return h(t)},e.hasValidator=d,e.getRegisteredValidatorNames=f,e.getRegisteredValidators=p},function(t,e,n){var i=n(12),r=n(30),o=n(25),a=n(44)("src"),s=Function.toString,l=(""+s).split("toString");n(46).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var u="function"==typeof n;u&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||r(n,a,t[e]?""+t[e]:l.join(e+""))),t===i?t[e]=n:s?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e,n){var i=n(19),r=n(45);t.exports=n(22)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(57);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),a=n(1),s=n(2),l=i(n(4)),u=i(n(161)),c={};e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),(0,a.defineGetter)(this,"wot",e,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=(0,o.getTrimmingContainer)(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}return r(t,null,[{key:"registerOverlay",value:function(e,n){if(-1===t.CLONE_TYPES.indexOf(e))throw Error("Unsupported overlay ("+e+").");c[e]=n}},{key:"createOverlay",value:function(t,e){return new c[t](e)}},{key:"hasOverlay",value:function(t){return void 0!==c[t]}},{key:"isOverlayTypeOf",value:function(t,e){return!(!t||!c[e])&&t instanceof c[e]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[t.CLONE_TOP,t.CLONE_BOTTOM,t.CLONE_LEFT,t.CLONE_TOP_LEFT_CORNER,t.CLONE_BOTTOM_LEFT_CORNER,t.CLONE_DEBUG]}}]),r(t,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=(0,o.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){this.mainTableScrollableElement=(0,o.getScrollableElement)(this.wot.wtTable.TABLE)}},{key:"makeClone",value:function(e){if(-1===t.CLONE_TYPES.indexOf(e))throw Error('Clone type "'+e+'" is not supported.');var n=document.createElement("DIV"),i=document.createElement("TABLE");n.className="ht_clone_"+e+" handsontable",n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.overflow="hidden",i.className=this.wot.wtTable.TABLE.className,n.appendChild(i),this.type=e,this.wot.wtTable.wtRootElement.parentNode.appendChild(n);var r=this.wot.getSetting("preventOverflow");return this.mainTableScrollableElement=!0===r||"horizontal"===r&&this.type===t.CLONE_TOP||"vertical"===r&&this.type===t.CLONE_LEFT?window:(0,o.getScrollableElement)(this.wot.wtTable.TABLE),new u.default({cloneSource:this.wot,cloneOverlay:this,table:i})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder;(0,s.arrayEach)([t.style,this.clone.wtTable.hider.style,t.parentNode.style],function(t){t.width="",t.height=""})}}},{key:"destroy",value:function(){new l.default(this.clone).destroy()}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0,e.toUpperCaseFirst=function(t){return t[0].toUpperCase()+t.substr(1)},e.equalsIgnoreCase=function(){for(var t=[],e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];for(var o=n.length;o--;){var a=(0,i.stringify)(n[o]).toLowerCase();-1===t.indexOf(a)&&t.push(a)}return 1===t.length},e.randomString=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()},e.isPercentValue=function(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)},e.substitute=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(""+t).replace(/(?:\\)?\[([^[\]]+)]/g,function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]})},e.stripTags=function(t){return(t+="").replace(r,"")};var i=n(17),r=(n(5),/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi)},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){"use strict";e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.requestAnimationFrame=function(t){return a.call(window,t)},e.cancelAnimationFrame=function(t){s.call(window,t)},e.isTouchSupported=function(){return"ontouchstart"in window},e.isWebComponentSupportedNatively=function(){var t=document.createElement("div");return!(!t.createShadowRoot||!(""+t.createShadowRoot).match(/\[native code\]/))},e.hasCaptionProblem=function(){return void 0===u&&function(){var t=document.createElement("TABLE");t.style.borderSpacing=0,t.style.borderWidth=0,t.style.padding=0;var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,t.insertBefore(n,e),document.body.appendChild(t),u=2*t.lastChild.offsetHeight>t.offsetHeight,document.body.removeChild(t)}(),u},e.getComparisonFunction=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c||(c="object"===("undefined"==typeof Intl?"undefined":i(Intl))?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?function(t,e){return(""+t).localeCompare(e)}:function(t,e){return t===e?0:t>e?-1:1})};for(var r=0,o=["ms","moz","webkit","o"],a=window.requestAnimationFrame,s=window.cancelAnimationFrame,l=0;4>l&&!a;++l)a=window[o[l]+"RequestAnimationFrame"],s=window[o[l]+"CancelAnimationFrame"]||window[o[l]+"CancelRequestAnimationFrame"];a||(a=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-r)),i=window.setTimeout(function(){t(e+n)},n);return r=e+n,i}),s||(s=function(t){clearTimeout(t)});var u,c=void 0},function(t,e,n){"use strict";function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,i={lastCallThrottled:!0},r=null;return function(){var o=this,a=arguments,s=Date.now(),l=!1;i.lastCallThrottled=!0,n||(n=s,l=!0);var u=e-(s-n);return l?(i.lastCallThrottled=!1,t.apply(this,a)):(r&&clearTimeout(r),r=setTimeout(function(){i.lastCallThrottled=!1,t.apply(o,a),n=0,r=void 0},u)),i}}e.__esModule=!0,e.isFunction=function(t){return"function"==typeof t},e.throttle=i,e.throttleAfterHits=function(t){function e(){return a?(a--,t.apply(this,arguments)):o.apply(this,arguments)}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=i(t,n),a=r;return e.clearHits=function(){a=r},e},e.debounce=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null,i=void 0;return function(){var r=this,o=arguments;return n&&clearTimeout(n),n=setTimeout(function(){i=t.apply(r,o)},e),i}},e.pipe=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];var i=e[0],o=e.slice(1);return function(){return(0,r.arrayReduce)(o,function(t,e){return e(t)},i.apply(this,arguments))}},e.partial=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return function(){for(var e=arguments.length,i=Array(e),r=0;e>r;r++)i[r]=arguments[r];return t.apply(this,n.concat(i))}},e.curry=function(t){function e(i){return function(){for(var r=arguments.length,o=Array(r),a=0;r>a;a++)o[a]=arguments[a];var s=i.concat(o);return n>s.length?e(s):t.apply(this,s)}}var n=t.length;return e([])},e.curryRight=function(t){function e(i){return function(){for(var r=arguments.length,o=Array(r),a=0;r>a;a++)o[a]=arguments[a];var s=i.concat(o.reverse());return n>s.length?e(s):t.apply(this,s)}}var n=t.length;return e([])};var r=n(2)},function(t,e,n){var i=n(94),r=n(72);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(34);t.exports=function(t){return Object(i(t))}},function(t,e,n){var i=n(15);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){var i=n(10)("unscopables"),r=Array.prototype;void 0==r[i]&&n(30)(r,i,{}),t.exports=function(t){r[i][t]=!0}},function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);t.length>e;e++)n[e]=t[e];return n}return Array.from(t)}e.__esModule=!0,e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";r.has(t)||r.set(t,new Map);var e=r.get(t);return{register:function(t,n){e.set(t,n)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[].concat(i(e.keys()))},getValues:function(){return[].concat(i(e.values()))}}};var r=e.collection=new Map},function(t,e,n){"use strict";function i(t){this.instance=t,this.state=a.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}e.__esModule=!0,e.EditorState=void 0;var r=n(13),o=n(17),a=e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};i.prototype._fireCallbacks=function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)},i.prototype.init=function(){},i.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},i.prototype.setValue=function(t){throw Error("Editor setValue() method unimplemented")},i.prototype.open=function(){throw Error("Editor open() method unimplemented")},i.prototype.close=function(){throw Error("Editor close() method unimplemented")},i.prototype.prepare=function(t,e,n,i,r,o){this.TD=i,this.row=t,this.col=e,this.prop=n,this.originalValue=r,this.cellProperties=o,this.state=a.VIRGIN},i.prototype.extend=function(){var t=this.constructor;return function(e,n){function i(){}return i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e,e}(function(){t.apply(this,arguments)})},i.prototype.saveValue=function(t,e){var n=void 0,i=void 0;e?((n=this.instance.getSelected())[0]>n[2]&&(i=n[0],n[0]=n[2],n[2]=i),n[1]>n[3]&&(i=n[1],n[1]=n[3],n[3]=i)):n=[this.row,this.col,null,null],this.instance.populateFromArray(n[0],n[1],t,n[2],n[3],"edit")},i.prototype.beginEditing=function(t,e){this.state==a.VIRGIN&&(this.instance.view.scrollViewport(new r.CellCoords(this.row,this.col)),this.instance.view.render(),this.state=a.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue((0,o.stringify)(t)),this.open(e),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))},i.prototype.finishEditing=function(t,e,n){var i,r=this;if(n){var o=this._closeCallback;this._closeCallback=function(t){o&&o(t),n(t),r.instance.view.render()}}if(!this.isWaiting()){if(this.state==a.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0));if(this.state==a.EDITING){if(t)return this.cancelChanges(),void this.instance.view.render();var s=this.getValue();i=this.instance.getSettings().trimWhitespace?[["string"==typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=a.WAITING,this.saveValue(i,e),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(t){r.state=a.FINISHED,r.discardEditor(t)}):(this.state=a.FINISHED,this.discardEditor(!0))}}},i.prototype.cancelChanges=function(){this.state=a.FINISHED,this.discardEditor()},i.prototype.discardEditor=function(t){this.state===a.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=a.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=a.VIRGIN,this._fireCallbacks(!0)))},i.prototype.enableFullEditMode=function(){this._fullEditMode=!0},i.prototype.isInFullEditMode=function(){return this._fullEditMode},i.prototype.isOpened=function(){return this._opened},i.prototype.isWaiting=function(){return this.state===a.WAITING},i.prototype.checkEditorSection=function(){var t=this.instance.countRows(),e="";return this.row<this.instance.getSettings().fixedRowsTop?e=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=t-this.instance.getSettings().fixedRowsBottom?e=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(e="left"),e},e.default=i},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)},function(t,e){t.exports={}},function(t,e,n){var i=n(19).f,r=n(25),o=n(10)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){var i=n(44)("meta"),r=n(15),o=n(25),a=n(19).f,s=0,l=Object.isExtensible||function(){return!0},u=!n(24)(function(){return l(Object.preventExtensions({}))}),c=function(t){a(t,i,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[i].i},getWeak:function(t,e){if(!o(t,i)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[i].w},onFreeze:function(t){return u&&h.NEED&&l(t)&&!o(t,i)&&c(t),t}}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.default=function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),void 0!==e&&void 0!==n?(this.row=e,this.col=n):(this.row=null,this.col=null)}return i(t,[{key:"isValid",value:function(t){return this.row>=0&&this.col>=0&&this.row<t.getSetting("totalRows")&&this.col<t.getSetting("totalColumns")}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&this.col>=t.col}},{key:"isNorthWestOf",value:function(t){return t.row>=this.row&&t.col>=this.col}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&t.col>=this.col}},{key:"isNorthEastOf",value:function(t){return t.row>=this.row&&this.col>=t.col}}]),t}()},function(e,n){e.exports=t},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(0),o=i(n(214)),a=n(43),s=i(a),l=i(n(4)),u=n(20),c=n(11),h=s.default.prototype.extend();h.prototype.init=function(){var t=this;this.createElements(),this.eventManager=new l.default(this),this.bindEvents(),this.autoResize=(0,o.default)(),this.instance.addHook("afterDestroy",function(){t.destroy()})},h.prototype.getValue=function(){return this.TEXTAREA.value},h.prototype.setValue=function(t){this.TEXTAREA.value=t};var d=function(t){var e,n=this.getActiveEditor();if(e=(t.ctrlKey||t.metaKey)&&!t.altKey,t.target===n.TEXTAREA&&!(0,c.isImmediatePropagationStopped)(t)){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void(0,c.stopImmediatePropagation)(t);switch(t.keyCode){case u.KEY_CODES.ARROW_RIGHT:case u.KEY_CODES.ARROW_LEFT:n.isInFullEditMode()&&(!n.isWaiting()&&!n.allowKeyEventPropagation||!n.isWaiting()&&n.allowKeyEventPropagation&&!n.allowKeyEventPropagation(t.keyCode))&&(0,c.stopImmediatePropagation)(t);break;case u.KEY_CODES.ARROW_UP:case u.KEY_CODES.ARROW_DOWN:n.isInFullEditMode()&&(!n.isWaiting()&&!n.allowKeyEventPropagation||!n.isWaiting()&&n.allowKeyEventPropagation&&!n.allowKeyEventPropagation(t.keyCode))&&(0,c.stopImmediatePropagation)(t);break;case u.KEY_CODES.ENTER:var i=n.instance.getSelected(),o=!(i[0]===i[2]&&i[1]===i[3]);if(e&&!o||t.altKey){if(n.isOpened()){var a=(0,r.getCaretPosition)(n.TEXTAREA),s=n.getValue();n.setValue(s.slice(0,a)+"\n"+s.slice(a)),(0,r.setCaretPosition)(n.TEXTAREA,a+1)}else n.beginEditing(n.originalValue+"\n");(0,c.stopImmediatePropagation)(t)}t.preventDefault();break;case u.KEY_CODES.A:case u.KEY_CODES.X:case u.KEY_CODES.C:case u.KEY_CODES.V:e&&(0,c.stopImmediatePropagation)(t);break;case u.KEY_CODES.BACKSPACE:case u.KEY_CODES.DELETE:case u.KEY_CODES.HOME:case u.KEY_CODES.END:(0,c.stopImmediatePropagation)(t)}-1===[u.KEY_CODES.ARROW_UP,u.KEY_CODES.ARROW_RIGHT,u.KEY_CODES.ARROW_DOWN,u.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)&&n.autoResize.resize(String.fromCharCode(t.keyCode))}};h.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",d)},h.prototype.close=function(t){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",d)},h.prototype.focus=function(){this.TEXTAREA.focus(),(0,r.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},h.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),(0,r.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),(0,r.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var t=this;this.instance._registerTimeout(setTimeout(function(){t.refreshDimensions()},0))},h.prototype.getEditedCell=function(){var t;switch(this.checkEditorSection()){case"top":t=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"top-left-corner":t=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":t=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":t=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;case"bottom":t=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:t=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=t&&-2!=t?t:void 0},h.prototype.refreshValue=function(){var t=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()},h.prototype.refreshDimensions=function(){if(this.state===a.EditorState.EDITING){if(!(this.TD=this.getEditedCell()))return void this.close(!0);var t,e=(0,r.offset)(this.TD),n=(0,r.offset)(this.instance.rootElement),i=(0,r.getScrollableElement)(this.TD),o=this.instance.countRows(),s=e.top===n.top?0:1,l=e.top-n.top-s-(i.scrollTop||0),u=e.left-n.left-1-(i.scrollLeft||0),c=this.instance.getSettings(),h=(this.instance.hasRowHeaders(),this.instance.hasColHeaders()),d=this.checkEditorSection(),f=this.TD.style.backgroundColor;switch(d){case"top":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(h&&0===this.instance.getSelected()[0]||c.fixedRowsBottom&&this.instance.getSelected()[0]===o-c.fixedRowsBottom)&&(l+=1),0===this.instance.getSelected()[1]&&(u+=1),t&&-1!=t?this.textareaParentStyle[t[0]]=t[1]:(0,r.resetCssTransform)(this.TEXTAREA_PARENT),this.textareaParentStyle.top=l+"px",this.textareaParentStyle.left=u+"px";var p=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,m=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,g=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),v=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),y=(0,r.getScrollbarWidth)(),w=this.TD.offsetTop+p-v,b=this.TD.offsetLeft+m-g,_=(0,r.innerWidth)(this.TD)-8,E=(0,r.hasVerticalScrollbar)(i)?y:0,T=(0,r.hasHorizontalScrollbar)(i)?y:0,C=this.instance.view.maximumVisibleElementWidth(b)-9-E,x=this.TD.scrollHeight+1,S=Math.max(this.instance.view.maximumVisibleElementHeight(w)-T,23),M=(0,r.getComputedStyle)(this.TD);this.TEXTAREA.style.fontSize=M.fontSize,this.TEXTAREA.style.fontFamily=M.fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=f||(0,r.getComputedStyle)(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(x,S),maxHeight:S,minWidth:Math.min(_,C),maxWidth:C},!0),this.textareaParentStyle.display="block"}},h.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){(0,c.stopPropagation)(t)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){(0,c.stopPropagation)(t)}),this.instance.addHook("afterScrollHorizontally",function(){t.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterRowResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterDestroy",function(){t.eventManager.destroy()})},h.prototype.destroy=function(){this.eventManager.destroy()},e.default=h},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(54),r=Math.max,o=Math.min;t.exports=function(t,e){return 0>(t=i(t))?r(t+e,0):o(t,e)}},function(t,e,n){var i=n(29);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(31),r=n(97),o=n(98),a=n(18),s=n(23),l=n(99),u={},c={};(e=t.exports=function(t,e,n,h,d){var f,p,m,g,v=d?function(){return t}:l(t),y=i(n,h,e?2:1),w=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(o(v)){for(f=s(t.length);f>w;w++)if((g=e?y(a(p=t[w])[0],p[1]):y(t[w]))===u||g===c)return g}else for(m=v.call(t);!(p=m.next()).done;)if((g=r(m,y,p.value,e))===u||g===c)return g}).BREAK=u,e.RETURN=c},function(t,e){t.exports=!1},function(t,e,n){"use strict";var i=n(12),r=n(3),o=n(29),a=n(56),s=n(49),l=n(59),u=n(58),c=n(15),h=n(24),d=n(73),f=n(48),p=n(189);t.exports=function(t,e,n,m,g,v){var y=i[t],w=y,b=g?"set":"add",_=w&&w.prototype,E={},T=function(t){var e=_[t];o(_,t,"delete"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof w&&(v||_.forEach&&!h(function(){(new w).entries().next()}))){var C=new w,x=C[b](v?{}:-0,1)!=C,S=h(function(){C.has(1)}),M=d(function(t){new w(t)}),O=!v&&h(function(){for(var t=new w,e=5;e--;)t[b](e,e);return!t.has(-0)});M||(w=e(function(e,n){u(e,w,t);var i=p(new y,e,w);return void 0!=n&&l(n,g,i[b],i),i}),w.prototype=_,_.constructor=w),(S||O)&&(T("delete"),T("has"),g&&T("get")),(O||x)&&T(b),v&&_.clear&&delete _.clear}else w=m.getConstructor(e,t,g,b),a(w.prototype,n),s.NEED=!0;return f(w,t),E[t]=w,r(r.G+r.W+r.F*(w!=y),E),v||m.setStrong(w,t,g),w}},function(t,e,n){var i=n(31),r=n(69),o=n(39),a=n(23),s=n(190);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,h=6==t,d=5==t||h,f=e||s;return function(e,s,p){for(var m,g,v=o(e),y=r(v),w=i(s,p,3),b=a(y.length),_=0,E=n?f(e,b):l?f(e,0):void 0;b>_;_++)if((d||_ in y)&&(m=y[_],g=w(m,_,v),t))if(n)E[_]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return _;case 2:E.push(m)}else if(c)return!1;return h?-1:u||c?c:E}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";var i=n(30),r=n(29),o=n(24),a=n(34),s=n(10);t.exports=function(t,e,n){var l=s(t),u=n(a,l,""[t]),c=u[0],h=u[1];o(function(){var e={};return e[l]=function(){return 7},7!=""[t](e)})&&(r(String.prototype,t,c),i(RegExp.prototype,l,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n=t;return(0,a.isObject)(t)&&(e=t,n=e.languageCode),function(t,e){t!==c&&(0,s.extendNotExistingKeys)(e,f(c))}(n,e),d(n,(0,a.deepClone)(e)),(0,a.deepClone)(e)}function o(t){return p(t)}e.__esModule=!0,e.DEFAULT_LANGUAGE_CODE=e.getLanguagesDictionaries=e.getDefaultLanguageDictionary=e.hasLanguageDictionary=e.getLanguageDictionary=e.registerLanguageDictionary=void 0;var a=n(1),s=n(179),l=i(n(42)),u=i(n(250)),c=u.default.languageCode,h=(0,l.default)("languagesDictionaries"),d=h.register,f=h.getItem,p=h.hasItem,m=h.getValues;e.registerLanguageDictionary=r,e.getLanguageDictionary=function(t){return o(t)?(0,a.deepClone)(f(t)):null},e.hasLanguageDictionary=o,e.getDefaultLanguageDictionary=function(){return u.default},e.getLanguagesDictionaries=function(){return m()},e.DEFAULT_LANGUAGE_CODE=c,r(u.default)},function(t,e,n){var i=n(15),r=n(12).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){var i=n(15);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(18),r=n(186),o=n(72),a=n(70)("IE_PROTO"),s=function(){},l=function(){var t,e=n(66)("iframe"),i=o.length;for(e.style.display="none",n(96).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[o[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=i(t),n=new s,s.prototype=null,n[a]=t):n=l(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(38);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var i=n(71)("keys"),r=n(44);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(12),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});t.exports=function(t){return r[t]||(r[t]={})}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(10)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:n=!0}},o[i]=function(){return a},t(o)}catch(t){}return n}},function(t,e,n){var i=n(50),r=n(45),o=n(26),a=n(67),s=n(25),l=n(93),u=Object.getOwnPropertyDescriptor;e.f=n(22)?u:function(t,e){if(t=o(t),e=a(e,!0),l)try{return u(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){var i,r,o,a=n(31),s=n(193),l=n(96),u=n(66),c=n(12),h=c.process,d=c.setImmediate,f=c.clearImmediate,p=c.MessageChannel,m=c.Dispatch,g=0,v={},y=function(){var t=+this;if(v.hasOwnProperty(t)){var e=v[t];delete v[t],e()}},w=function(t){y.call(t.data)};d&&f||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return v[++g]=function(){s("function"==typeof t?t:Function(t),e)},i(g),g},f=function(t){delete v[t]},"process"==n(38)(h)?i=function(t){h.nextTick(a(y,t,1))}:m&&m.now?i=function(t){m.now(a(y,t,1))}:p?(r=new p,o=r.port2,r.port1.onmessage=w,i=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(t){c.postMessage(t+"","*")},c.addEventListener("message",w,!1)):i="onreadystatechange"in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),t.exports={set:d,clear:f}},function(t,e,n){var i=n(94),r=n(72).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(125),r=n(34);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return r(t)+""}},function(t,e,n){var i=n(10)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){"use strict";var i=n(19),r=n(45);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){"use strict";var i=n(41),r=n(102),o=n(47),a=n(26);t.exports=n(101)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return t&&t.length>n?r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]]):(this._t=void 0,r(1))},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(n(51));e.default=function(){function t(e,n,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.highlight=e,this.from=n,this.to=i}return i(t,[{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(t){var e=t.row,n=t.col,i=this.getTopLeftCorner(),r=this.getBottomRightCorner();return!(i.row>e||e>r.row||i.col>n||n>r.col)}},{key:"includesRange",value:function(t){return this.includes(t.getTopLeftCorner())&&this.includes(t.getBottomRightCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)==Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getTopLeftCorner())&&t.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getTopLeftCorner().isSouthEastOf(t)||this.getBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getTopLeftCorner().isNorthWestOf(t)||this.getBottomRightCorner().isNorthWestOf(t)}},{key:"expand",value:function(t){var e=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(e.row>t.row||e.col>t.col||t.row>n.row||t.col>n.col)&&(this.from=new r.default(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=new r.default(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var n=this.getTopLeftCorner(),i=this.getBottomRightCorner(),o=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),a=e.getBottomRightCorner(),s=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(i.row,a.row),c=Math.max(i.col,a.col),h=new r.default(s,l),d=new r.default(u,c),f=new t(h,h,d).isCorner(this.from,e),p=e.isEqual(new t(h,h,d));return f&&!p&&(this.from.col>h.col&&(h.col=c,d.col=l),this.from.row>h.row&&(h.row=u,d.row=s)),this.from=h,this.to=d,!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var i=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var r=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=r[0],this.to=r[1]}}},{key:"getTopLeftCorner",value:function(){return new r.default(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new r.default(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new r.default(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new r.default(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getTopLeftCorner().isEqual(new r.default(e.from.row,e.from.col))||this.getTopRightCorner().isEqual(new r.default(e.from.row,e.to.col))||this.getBottomLeftCorner().isEqual(new r.default(e.to.row,e.from.col))||this.getBottomRightCorner().isEqual(new r.default(e.to.row,e.to.col))))||t.isEqual(this.getTopLeftCorner())||t.isEqual(this.getTopRightCorner())||t.isEqual(this.getBottomLeftCorner())||t.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof r.default))return!1;if(e&&e.includes(t)){if(this.getTopLeftCorner().isEqual(new r.default(e.from.row,e.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new r.default(e.from.row,e.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new r.default(e.to.row,e.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new r.default(e.to.row,e.to.col)))return this.getTopLeftCorner()}return t.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():t.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():t.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():t.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),i=Math.min(this.from.col,this.to.col),r=Math.max(this.from.col,this.to.col),o=Math.min(t.from.row,t.to.row),a=Math.max(t.from.row,t.to.row),s=Math.min(t.from.col,t.to.col),l=Math.max(t.from.col,t.to.col),u=[];return e==o&&u.push("top"),r==l&&u.push("right"),n==a&&u.push("bottom"),i==s&&u.push("left"),u}},{key:"getInner",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],i=t.row;e.row>=i;i++)for(var o=t.col;e.col>=o;o++)this.from.row===i&&this.from.col===o||this.to.row===i&&this.to.col===o||n.push(new r.default(i,o));return n}},{key:"getAll",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],i=t.row;e.row>=i;i++)for(var o=t.col;e.col>=o;o++)n.push(t.row===i&&t.col===o?t:e.row===i&&e.col===o?e:new r.default(i,o));return n}},{key:"forAll",value:function(t){for(var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),i=e.row;n.row>=i;i++)for(var r=e.col;n.col>=r;r++){if(!1===t(i,r))return}}}]),t}()},function(t,n){t.exports=e},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n=e.editor,i=e.renderer,r=e.validator;n&&(0,a.registerEditor)(t,n),i&&(0,s.registerRenderer)(t,i),r&&(0,l.registerValidator)(t,r),w(t,e)}e.__esModule=!0,e.getRegisteredCellTypes=e.getRegisteredCellTypeNames=e.hasCellType=e.getCellType=e.registerCellType=void 0;var o=i(n(42)),a=n(16),s=n(9),l=n(28),u=i(n(235)),c=i(n(236)),h=i(n(237)),d=i(n(238)),f=i(n(239)),p=i(n(240)),m=i(n(241)),g=i(n(242)),v=i(n(243)),y=(0,o.default)("cellTypes"),w=y.register,b=y.getItem,_=y.hasItem,E=y.getNames,T=y.getValues;r("autocomplete",u.default),r("checkbox",c.default),r("date",h.default),r("dropdown",d.default),r("handsontable",f.default),r("numeric",p.default),r("password",m.default),r("text",g.default),r("time",v.default),e.registerCellType=r,e.getCellType=function(t){if(!_(t))throw Error('You declared cell type "'+t+'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method');return b(t)},e.hasCellType=_,e.getRegisteredCellTypeNames=E,e.getRegisteredCellTypes=T},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);t.length>e;e++)n[e]=t[e];return n}return Array.from(t)}e.__esModule=!0;var o=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=function(t,e){function n(t){var e=(0,L.normalizeLanguageCode)(t);(0,k.hasLanguageDictionary)(e)?(q.runHooks("beforeLanguageChange",e),j.settings.language=e,q.runHooks("afterLanguageChange",e)):(0,L.warnUserAboutLanguageRegistration)(t)}function i(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=0>this.validatorsInQueue-1?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(t){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==t&&(t=!0,this.onQueueEmpty(this.valid))}}}function I(t,e,n){var r=new i;r.onQueueEmpty=function(){var i;t.length&&(i=q.runHooks("beforeChange",t,e),(0,c.isFunction)(i)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===i&&t.splice(0,t.length)),n()};for(var o=t.length-1;o>=0;o--)if(null===t[o])t.splice(o,1);else{var a=t[o][0],u=z.propToCol(t[o][1]),d=q.getCellMeta(a,u),f=d.numericFormat,p=f&&f.culture,m=f&&f.pattern;if("numeric"===d.type&&"string"==typeof t[o][3]&&t[o][3].length>0&&(/^-?[\d\s]*(\.|,)?\d*$/.test(t[o][3])||m)){var g=t[o][3].length;s.default.culture((0,h.isUndefined)(p)?"en-US":t[o][3].indexOf(".")===g-3&&-1===t[o][3].indexOf(",")?"en-US":p),t[o][3]=s.default.validate(t[o][3])&&!isNaN(t[o][3])?parseFloat(t[o][3]):(0,s.default)().unformat(t[o][3])||t[o][3]}q.getCellValidator(d)&&(r.addValidatorToQueue(),q.validateCell(t[o][3],d,function(e,n){return function(i){if("boolean"!=typeof i)throw Error("Validation error: result is not boolean");if(!1===i&&!1===n.allowInvalid){t.splice(e,1),n.valid=!0;var o=q.getCell(n.visualRow,n.visualCol);(0,l.removeClass)(o,q.getSettings().invalidCellClassName),--e}r.removeValidatorFormQueue()}}(o,d),e))}r.checkIfQueueIsEmpty()}function H(t,e){var n=t.length-1;if(n>=0){for(;n>=0;n--){var i=!1;if(null!==t[n]){if(null!=t[n][2]||null!=t[n][3]){if(j.settings.allowInsertRow)for(;t[n][0]>q.countRows()-1;)if(0===z.createRow(void 0,void 0,e)){i=!0;break}if(!i){if("array"===q.dataType&&(!j.settings.columns||0===j.settings.columns.length)&&j.settings.allowInsertColumn)for(;z.propToCol(t[n][1])>q.countCols()-1;)z.createCol(void 0,void 0,e);z.set(t[n][0],t[n][1],t[n][3])}}}else t.splice(n,1)}q.forceFullRender=!0,W.adjustRowsAndCols(),q.runHooks("beforeChangeRender",t,e),G.refreshBorders(null,!0),q.view.wt.wtOverlays.adjustElementsSize(),q.runHooks("afterChange",t,e||"edit");var r=q.getActiveEditor();r&&(0,h.isDefined)(r.refreshValue)&&r.refreshValue()}}function U(t,e,n){return"object"===(void 0===t?"undefined":a(t))?t:[[t,e,n]]}function F(t){if((0,g.hasOwnProperty)(t,"type")){var e,n={};"object"===a(t.type)?e=t.type:"string"==typeof t.type&&(e=(0,P.getCellType)(t.type));for(var i in e)(0,g.hasOwnProperty)(e,i)&&!(0,g.hasOwnProperty)(t,i)&&(n[i]=e[i]);return n}}function B(){throw Error("This method cannot be called because this Handsontable instance has been destroyed")}var j,z,V,W,G,Y,X=arguments.length>2&&void 0!==arguments[2]&&arguments[2],q=this,J=function(){},K=new m.default(q);(0,g.extend)(J.prototype,A.default.prototype),(0,g.extend)(J.prototype,e),(0,g.extend)(J.prototype,F(e)),(0,L.applyLanguageSetting)(e.language,J.prototype),(0,M.hasValidParameter)(X)&&(0,M.registerAsRootInstance)(this),this.rootElement=t,this.isHotTableEnv=(0,l.isChildOfWebComponentTable)(this.rootElement),m.default.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),this.guid="ht_"+(0,_.randomString)();var Z=(0,S.getTranslator)(q);V=new C.default(q),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),j={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new J,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},W={alter:function(t,e,n,i,o){function a(t,e,n,i){var o=(0,v.arrayMap)(Array(n),function(){return function(){var t=void 0;return"array"===i?t=[]:"object"===i&&(t={}),t}()});o.unshift(e,0),t.splice.apply(t,r(o))}var s;switch(n=n||1,t){case"insert_row":var l=q.countSourceRows();if(q.getSettings().maxRows===l)return;e=(0,h.isDefined)(e)?e:l,s=z.createRow(e,n,i),a(j.cellSettings,e,n,"array"),s&&(G.isSelected()&&j.selRange.from.row>=e?(j.selRange.from.row+=s,G.transformEnd(s,0)):G.refreshBorders());break;case"insert_col":s=z.createCol(e,n,i);for(var u=0,c=q.countSourceRows();c>u;u++)j.cellSettings[u]&&a(j.cellSettings[u],e,n);if(s){if(Array.isArray(q.getSettings().colHeaders)){var d=[e,0];d.length+=s,Array.prototype.splice.apply(q.getSettings().colHeaders,d)}G.isSelected()&&j.selRange.from.col>=e?(j.selRange.from.col+=s,G.transformEnd(0,s)):G.refreshBorders()}break;case"remove_row":z.removeRow(e,n,i),j.cellSettings.splice(e,n);var f=q.countRows(),p=q.getSettings().fixedRowsTop;e+1>p||(q.getSettings().fixedRowsTop-=Math.min(n,p-e));var m=q.getSettings().fixedRowsBottom;m&&e>=f-m&&(q.getSettings().fixedRowsBottom-=Math.min(n,m)),W.adjustRowsAndCols(),G.refreshBorders();break;case"remove_col":var g=Z.toPhysicalColumn(e);z.removeCol(e,n,i);for(var y=0,w=q.countSourceRows();w>y;y++)j.cellSettings[y]&&j.cellSettings[y].splice(g,n);var b=q.getSettings().fixedColumnsLeft;e+1>b||(q.getSettings().fixedColumnsLeft-=Math.min(n,b-e)),Array.isArray(q.getSettings().colHeaders)&&(void 0===g&&(g=-1),q.getSettings().colHeaders.splice(g,n)),W.adjustRowsAndCols(),G.refreshBorders();break;default:throw Error('There is no such action "'+t+'"')}o||W.adjustRowsAndCols()},adjustRowsAndCols:function(){if(j.settings.minRows){var t=q.countRows();if(j.settings.minRows>t)for(var e=0,n=j.settings.minRows;n-t>e;e++)z.createRow(q.countRows(),1,"auto")}if(j.settings.minSpareRows){var i=q.countEmptyRows(!0);if(j.settings.minSpareRows>i)for(;j.settings.minSpareRows>i&&q.countSourceRows()<j.settings.maxRows;i++)z.createRow(q.countRows(),1,"auto")}var r=void 0;if((j.settings.minCols||j.settings.minSpareCols)&&(r=q.countEmptyCols(!0)),j.settings.minCols&&!j.settings.columns&&q.countCols()<j.settings.minCols)for(;q.countCols()<j.settings.minCols;r++)z.createCol(q.countCols(),1,"auto");if(j.settings.minSpareCols&&!j.settings.columns&&"array"===q.dataType&&j.settings.minSpareCols>r)for(;j.settings.minSpareCols>r&&q.countCols()<j.settings.maxCols;r++)z.createCol(q.countCols(),1,"auto");var o=q.countRows(),a=q.countCols();if(0!==o&&0!==a||G.deselect(),G.isSelected()){var s=!1,l=j.selRange.from.row,u=j.selRange.from.col,c=j.selRange.to.row,h=j.selRange.to.col;l>o-1?(l=o-1,s=!0,c>l&&(c=l)):c>o-1&&(c=o-1,s=!0,l>c&&(l=c)),u>a-1?(u=a-1,s=!0,h>u&&(h=u)):h>a-1&&(h=a-1,s=!0,u>h&&(u=h)),s&&q.selectCell(l,u,c,h)}q.view&&q.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(t,e,n,i,o,s,l){var u,c,d,f,p=[],m={};if(0===(c=e.length))return!1;var v,y,w,b;switch(o){case"shift_down":for(v=n?n.col-t.col+1:0,y=n?n.row-t.row+1:0,d=0,f=(e=(0,x.translateRowsToColumns)(e)).length,w=Math.max(f,v);w>d;d++)if(f>d){var _;for(u=0,c=e[d].length;y-c>u;u++)e[d].push(e[d][u%c]);e[d].unshift(t.col+d,t.row,0),(_=q).spliceCol.apply(_,r(e[d]))}else{var E;e[d%f][0]=t.col+d,(E=q).spliceCol.apply(E,r(e[d%f]))}break;case"shift_right":for(v=n?n.col-t.col+1:0,y=n?n.row-t.row+1:0,u=0,c=e.length,b=Math.max(c,y);b>u;u++)if(c>u){var T;for(d=0,f=e[u].length;v-f>d;d++)e[u].push(e[u][d%f]);e[u].unshift(t.row+u,t.col,0),(T=q).spliceRow.apply(T,r(e[u]))}else{var C;e[u%c][0]=t.row+u,(C=q).spliceRow.apply(C,r(e[u%c]))}break;case"overwrite":default:m.row=t.row,m.col=t.col;var S={row:n&&t?n.row-t.row+1:1,col:n&&t?n.col-t.col+1:1},M=0,O=0,R=!0,A=void 0,P=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=e[t%e.length];return null!==n?i[n%i.length]:i},N=e.length,k=n?n.row-t.row+1:0;for(c=n?k:Math.max(N,k),u=0;c>u&&!(n&&m.row>n.row&&k>N||!j.settings.allowInsertRow&&m.row>q.countRows()-1)&&m.row<j.settings.maxRows;u++){var L=u-M,D=P(L).length,I=n?n.col-t.col+1:0;if(f=n?I:Math.max(D,I),m.col=t.col,A=q.getCellMeta(m.row,m.col),"CopyPaste.paste"!==i&&"Autofill.autofill"!==i||!A.skipRowOnPaste){for(O=0,d=0;f>d&&!(n&&m.col>n.col&&I>D||!j.settings.allowInsertColumn&&m.col>q.countCols()-1)&&m.col<j.settings.maxCols;d++)if(A=q.getCellMeta(m.row,m.col),"CopyPaste.paste"!==i&&"Autofill.fill"!==i||!A.skipColumnOnPaste)if(A.readOnly)m.col++;else{var H=d-O,U=P(L,H),F=q.getDataAtCell(m.row,m.col),B={row:L,col:H};if("Autofill.fill"===i){var z=q.runHooks("beforeAutofillInsidePopulate",B,s,e,l,{},S);z&&(U=(0,h.isUndefined)(z.value)?U:z.value)}if(null!==U&&"object"===(void 0===U?"undefined":a(U)))if(null===F||"object"!==(void 0===F?"undefined":a(F)))R=!1;else{var V=(0,g.duckSchema)(F[0]||F),W=(0,g.duckSchema)(U[0]||U);(0,g.isObjectEquals)(V,W)?U=(0,g.deepClone)(U):R=!1}else null!==F&&"object"===(void 0===F?"undefined":a(F))&&(R=!1);R&&p.push([m.row,m.col,U]),R=!0,m.col++}else O++,m.col++,f++;m.row++}else M++,m.row++,c++}q.setDataAtCell(p,null,null,i||"populateFromArray")}}},this.selection=G={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];q.selection.selectedHeader.rows=t,q.selection.selectedHeader.cols=e,q.selection.selectedHeader.corner=n},begin:function(){q.selection.inProgress=!0},finish:function(){var t=q.getSelected();q.runHooks("afterSelectionEnd",t[0],t[1],t[2],t[3]),q.runHooks("afterSelectionEndByProp",t[0],q.colToProp(t[1]),t[2],q.colToProp(t[3])),q.selection.inProgress=!1},isInProgress:function(){return q.selection.inProgress},setRangeStart:function(t,e){q.runHooks("beforeSetRangeStart",t),j.selRange=new O.CellRange(t,t,t),G.setRangeEnd(t,null,e)},setRangeStartOnly:function(t){q.runHooks("beforeSetRangeStartOnly",t),j.selRange=new O.CellRange(t,t,t)},setRangeEnd:function(t,e,n){if(null!==j.selRange){var i,r=!1,o=!0,a=q.view.wt.wtTable.getFirstVisibleRow(),s=q.view.wt.wtTable.getFirstVisibleColumn(),u={row:null,col:null};q.runHooks("beforeSetRangeEnd",t),q.selection.begin(),u.row=0>t.row?a:t.row,u.col=0>t.col?s:t.col,j.selRange.to=new O.CellCoords(u.row,u.col),j.settings.multiSelect||(j.selRange.from=t),q.view.wt.selections.current.clear(),"string"==typeof(i=q.getCellMeta(j.selRange.highlight.row,j.selRange.highlight.col).disableVisualSelection)&&(i=[i]),(!1===i||Array.isArray(i)&&-1===i.indexOf("current"))&&q.view.wt.selections.current.add(j.selRange.highlight),q.view.wt.selections.area.clear(),(!1===i||Array.isArray(i)&&-1===i.indexOf("area"))&&G.isMultiple()&&(q.view.wt.selections.area.add(j.selRange.from),q.view.wt.selections.area.add(j.selRange.to)),(j.settings.currentHeaderClassName||j.settings.currentRowClassName||j.settings.currentColClassName)&&(q.view.wt.selections.highlight.clear(),q.view.wt.selections.highlight.add(j.selRange.from),q.view.wt.selections.highlight.add(j.selRange.to));var c=(0,g.createObjectPropListener)("value");q.runHooks("afterSelection",j.selRange.from.row,j.selRange.from.col,j.selRange.to.row,j.selRange.to.col,c),q.runHooks("afterSelectionByProp",j.selRange.from.row,z.colToProp(j.selRange.from.col),j.selRange.to.row,z.colToProp(j.selRange.to.col),c),(q.selection.selectedHeader.cols||q.selection.selectedHeader.rows)&&(r=!0),(0>t.row||0>t.col)&&(o=!1),c.isTouched()&&(e=!c.value),!1!==e&&!r&&o&&q.view.scrollViewport(j.selRange.from&&!G.isMultiple()?j.selRange.from:t),G.selectedHeader.rows&&G.selectedHeader.cols?(0,l.addClass)(q.rootElement,["ht__selection--rows","ht__selection--columns"]):G.selectedHeader.rows?((0,l.removeClass)(q.rootElement,"ht__selection--columns"),(0,l.addClass)(q.rootElement,"ht__selection--rows")):G.selectedHeader.cols?((0,l.removeClass)(q.rootElement,"ht__selection--rows"),(0,l.addClass)(q.rootElement,"ht__selection--columns")):(0,l.removeClass)(q.rootElement,["ht__selection--rows","ht__selection--columns"]),G.refreshBorders(null,n)}},refreshBorders:function(t,e){e||Y.destroyEditor(t),q.view.render(),G.isSelected()&&!e&&Y.prepareEditor()},isMultiple:function(){var t=!(j.selRange.to.col===j.selRange.from.col&&j.selRange.to.row===j.selRange.from.row),e=q.runHooks("afterIsMultipleSelection",t);if(t)return e},transformStart:function(t,e,n,i){var r,o,a,s,l=new O.CellCoords(t,e),u=0,c=0;q.runHooks("modifyTransformStart",l),r=q.countRows(),o=q.countCols(),s=q.getSettings().fixedRowsBottom,j.selRange.highlight.row+t>r-1?n&&j.settings.minSpareRows>0&&(!s||r-s-1>j.selRange.highlight.row)?(q.alter("insert_row",r),r=q.countRows()):j.settings.autoWrapCol&&(l.row=1-r,l.col=j.selRange.highlight.col+l.col==o-1?1-o:1):j.settings.autoWrapCol&&0>j.selRange.highlight.row+l.row&&j.selRange.highlight.col+l.col>=0&&(l.row=r-1,l.col=j.selRange.highlight.col+l.col==0?o-1:-1),j.selRange.highlight.col+l.col>o-1?n&&j.settings.minSpareCols>0?(q.alter("insert_col",o),o=q.countCols()):j.settings.autoWrapRow&&(l.row=j.selRange.highlight.row+l.row==r-1?1-r:1,l.col=1-o):j.settings.autoWrapRow&&0>j.selRange.highlight.col+l.col&&j.selRange.highlight.row+l.row>=0&&(l.row=j.selRange.highlight.row+l.row==0?r-1:-1,l.col=o-1),0>(a=new O.CellCoords(j.selRange.highlight.row+l.row,j.selRange.highlight.col+l.col)).row?(u=-1,a.row=0):a.row>0&&a.row>=r&&(u=1,a.row=r-1),0>a.col?(c=-1,a.col=0):a.col>0&&a.col>=o&&(c=1,a.col=o-1),q.runHooks("afterModifyTransformStart",a,u,c),G.setRangeStart(a,i)},transformEnd:function(t,e){var n,i,r,o=new O.CellCoords(t,e),a=0,s=0;q.runHooks("modifyTransformEnd",o),n=q.countRows(),i=q.countCols(),0>(r=new O.CellCoords(j.selRange.to.row+o.row,j.selRange.to.col+o.col)).row?(a=-1,r.row=0):r.row>0&&r.row>=n&&(a=1,r.row=n-1),0>r.col?(s=-1,r.col=0):r.col>0&&r.col>=i&&(s=1,r.col=i-1),q.runHooks("afterModifyTransformEnd",r,a,s),G.setRangeEnd(r,!0)},isSelected:function(){return null!==j.selRange},inInSelection:function(t){return!!G.isSelected()&&j.selRange.includes(t)},deselect:function(){G.isSelected()&&(q.selection.inProgress=!1,j.selRange=null,q.view.wt.selections.current.clear(),q.view.wt.selections.area.clear(),(j.settings.currentHeaderClassName||j.settings.currentRowClassName||j.settings.currentColClassName)&&q.view.wt.selections.highlight.clear(),Y.destroyEditor(),G.refreshBorders(),(0,l.removeClass)(q.rootElement,["ht__selection--rows","ht__selection--columns"]),q.runHooks("afterDeselect"))},selectAll:function(){j.settings.multiSelect&&(G.setSelectedHeaders(!0,!0,!0),G.setRangeStart(new O.CellCoords(0,0)),G.setRangeEnd(new O.CellCoords(q.countRows()-1,q.countCols()-1),!1))},empty:function(){if(G.isSelected()){var t,e,n=j.selRange.getTopLeftCorner(),i=j.selRange.getBottomRightCorner(),r=[];for(t=n.row;i.row>=t;t++)for(e=n.col;i.col>=e;e++)q.getCellMeta(t,e).readOnly||r.push([t,e,""]);q.setDataAtCell(r)}}},this.init=function(){V.setData(j.settings.data),q.runHooks("beforeInit"),(0,d.isMobileBrowser)()&&(0,l.addClass)(q.rootElement,"mobile"),this.updateSettings(j.settings,!0),this.view=new T.default(this),Y=new p.default(q,j,G,z),this.forceFullRender=!0,q.runHooks("init"),this.view.render(),"object"===a(j.firstRun)&&(q.runHooks("afterChange",j.firstRun[0],j.firstRun[1]),j.firstRun=!1),q.runHooks("afterInit")},this.validateCell=function(t,e,n,i){function r(t){var i=e.visualCol,r=e.visualRow,o=q.getCell(r,i,!0);o&&"TH"!=o.nodeName&&q.view.wt.wtSettings.settings.cellRenderer(r,i,o),n(t)}var o=q.getCellValidator(e);(0,h.isRegExp)(o)&&(o=function(t){return function(e,n){n(t.test(e))}}(o)),(0,c.isFunction)(o)?(t=q.runHooks("beforeValidate",t,e.visualRow,e.prop,i),q._registerTimeout(setTimeout(function(){o.call(e,t,function(n){n=q.runHooks("afterValidate",n,t,e.visualRow,e.prop,i),e.valid=n,r(n),q.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,i)})},0))):q._registerTimeout(setTimeout(function(){e.valid=!0,r(e.valid)},0))},this.setDataAtCell=function(t,e,n,i){var r,o,s,l=U(t,e,n),u=[];for(r=0,o=l.length;o>r;r++){if("object"!==a(l[r]))throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof l[r][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=z.colToProp(l[r][1]),u.push([l[r][0],s,V.getAtCell(Z.toPhysicalRow(l[r][0]),l[r][1]),l[r][2]])}i||"object"!==(void 0===t?"undefined":a(t))||(i=e),q.runHooks("afterSetDataAtCell",u,i),I(u,i,function(){H(u,i)})},this.setDataAtRowProp=function(t,e,n,i){var r,o,s=U(t,e,n),l=[];for(r=0,o=s.length;o>r;r++)l.push([s[r][0],s[r][1],V.getAtCell(Z.toPhysicalRow(s[r][0]),s[r][1]),s[r][2]]);i||"object"!==(void 0===t?"undefined":a(t))||(i=e),q.runHooks("afterSetDataAtRowProp",l,i),I(l,i,function(){H(l,i)})},this.listen=function(){if(0>=arguments.length||void 0===arguments[0]||arguments[0]){var t=!document.activeElement||document.activeElement&&void 0===document.activeElement.nodeName;document.activeElement&&document.activeElement!==document.body&&!t?document.activeElement.blur():t&&document.body.focus()}q&&!q.isListening()&&(D=q.guid,q.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(D=null,q.runHooks("afterUnlisten"))},this.isListening=function(){return D===q.guid},this.destroyEditor=function(t){G.refreshBorders(t)},this.populateFromArray=function(t,e,n,i,r,o,s,l,u){var c;if("object"!==(void 0===n?"undefined":a(n))||"object"!==a(n[0]))throw Error("populateFromArray parameter `input` must be an array of arrays");return c="number"==typeof i?new O.CellCoords(i,r):null,W.populateFromArray(new O.CellCoords(t,e),n,c,o,s,l,u)},this.spliceCol=function(t,e,n){var i;return(i=z).spliceCol.apply(i,arguments)},this.spliceRow=function(t,e,n){var i;return(i=z).spliceRow.apply(i,arguments)},this.getSelected=function(){if(G.isSelected())return[j.selRange.from.row,j.selRange.from.col,j.selRange.to.row,j.selRange.to.col]},this.getSelectedRange=function(){if(G.isSelected())return j.selRange},this.render=function(){q.view&&(q.renderCall=!0,q.forceFullRender=!0,G.refreshBorders(null,!0))},this.loadData=function(t){if(q.dataType=Array.isArray(j.settings.dataSchema)?"array":(0,c.isFunction)(j.settings.dataSchema)?"function":"object",z&&z.destroy(),z=new f.default(q,j,J),"object"===(void 0===t?"undefined":a(t))&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw Error("loadData only accepts array of objects or array of arrays ("+(void 0===t?"undefined":a(t))+" given)");t=[];var e,n=0,i=0,r=z.getSchema();for(n=0,i=j.settings.startRows;i>n;n++)if("object"!==q.dataType&&"function"!==q.dataType||!j.settings.dataSchema)if("array"===q.dataType)e=(0,g.deepClone)(r[0]),t.push(e);else{e=[];for(var o=0,s=j.settings.startCols;s>o;o++)e.push(null);t.push(e)}else e=(0,g.deepClone)(r),t.push(e)}j.isPopulated=!1,J.prototype.data=t,Array.isArray(t[0])&&(q.dataType="array"),z.dataSource=t,V.data=t,V.dataType=q.dataType,V.colToProp=z.colToProp.bind(z),V.propToCol=z.propToCol.bind(z),j.cellSettings.length=0,W.adjustRowsAndCols(),q.runHooks("afterLoadData",j.firstRun),j.firstRun?j.firstRun=[null,"loadData"]:(q.runHooks("afterChange",null,"loadData"),q.render()),j.isPopulated=!0},this.getData=function(t,e,n,i){return(0,h.isUndefined)(t)?z.getAll():z.getRange(new O.CellCoords(t,e),new O.CellCoords(n,i),z.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,i){return z.getCopyableText(new O.CellCoords(t,e),new O.CellCoords(n,i))},this.getCopyableData=function(t,e){return z.getCopyable(t,z.colToProp(e))},this.getSchema=function(){return z.getSchema()},this.updateSettings=function(t,e){var i=!1,r=void 0,o=void 0,a=void 0;if((0,h.isDefined)(t.rows))throw Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if((0,h.isDefined)(t.cols))throw Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(r in t)"data"!==r&&("language"!==r?R.default.getSingleton().getRegistered().indexOf(r)>-1?((0,c.isFunction)(t[r])||Array.isArray(t[r]))&&(t[r].initialHook=!0,q.addHook(r,t[r])):!e&&(0,g.hasOwnProperty)(t,r)&&(J.prototype[r]=t[r]):n(t.language));void 0===t.data&&void 0===j.settings.data?q.loadData(null):void 0!==t.data?q.loadData(t.data):void 0!==t.columns&&z.createMap(),a=q.countCols();var s=t.columns||J.prototype.columns;if(s&&(0,c.isFunction)(s)&&(a=q.countSourceCols(),i=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||(j.cellSettings.length=0),a>0){var d=void 0,f=void 0;for(r=0,o=0;a>r;r++)i&&!s(r)||(j.columnSettings[o]=(0,u.columnFactory)(J,j.columnsSettingConflicts),d=j.columnSettings[o].prototype,s&&(f=i?s(r):s[o])&&((0,g.extend)(d,f),(0,g.extend)(d,F(f))),o++)}if((0,h.isDefined)(t.cell))for(var p in t.cell)if((0,g.hasOwnProperty)(t.cell,p)){var m=t.cell[p];q.setCellMetaObject(m.row,m.col,m)}q.runHooks("afterCellMetaReset"),(0,h.isDefined)(t.className)&&(J.prototype.className&&(0,l.removeClass)(q.rootElement,J.prototype.className),t.className&&(0,l.addClass)(q.rootElement,t.className));var v=q.rootElement.style.height;""!==v&&(v=parseInt(q.rootElement.style.height,10));var y=t.height;if((0,c.isFunction)(y)&&(y=y()),e&&q.rootElement.getAttribute("style")&&q.rootElement.setAttribute("data-initialstyle",q.rootElement.getAttribute("style")),null===y){var w=q.rootElement.getAttribute("data-initialstyle");w&&(w.indexOf("height")>-1||w.indexOf("overflow")>-1)?q.rootElement.setAttribute("style",w):(q.rootElement.style.height="",q.rootElement.style.overflow="")}else void 0!==y&&(q.rootElement.style.height=y+"px",q.rootElement.style.overflow="hidden");if(void 0!==t.width){var b=t.width;(0,c.isFunction)(b)&&(b=b()),q.rootElement.style.width=b+"px"}e||(z.clearLengthCache(),q.view&&q.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),q.runHooks("afterUpdateSettings",t)),W.adjustRowsAndCols(),q.view&&!j.firstRun&&(q.forceFullRender=!0,G.refreshBorders(null,!0)),e||!q.view||""!==v&&""!==y&&void 0!==y||v===y||q.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=q.getSelected();if(J.prototype.getValue){if((0,c.isFunction)(J.prototype.getValue))return J.prototype.getValue.call(q);if(t)return q.getData()[t[0]][J.prototype.getValue]}else if(t)return q.getDataAtCell(t[0],t[1])},this.getSettings=function(){return j.settings},this.clear=function(){G.selectAll(),G.empty()},this.alter=function(t,e,n,i,r){W.alter(t,e,n,i,r)},this.getCell=function(t,e,n){return q.view.getCellAtCoords(new O.CellCoords(t,e),n)},this.getCoords=function(t){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,t)},this.colToProp=function(t){return z.colToProp(t)},this.propToCol=function(t){return z.propToCol(t)},this.toVisualRow=function(t){return Z.toVisualRow(t)},this.toVisualColumn=function(t){return Z.toVisualColumn(t)},this.toPhysicalRow=function(t){return Z.toPhysicalRow(t)},this.toPhysicalColumn=function(t){return Z.toPhysicalColumn(t)},this.getDataAtCell=function(t,e){return z.get(t,z.colToProp(e))},this.getDataAtRowProp=function(t,e){return z.get(t,e)},this.getDataAtCol=function(t){var e=[];return e.concat.apply(e,r(z.getRange(new O.CellCoords(0,t),new O.CellCoords(j.settings.data.length-1,t),z.DESTINATION_RENDERER)))},this.getDataAtProp=function(t){var e,n=[];return e=z.getRange(new O.CellCoords(0,z.propToCol(t)),new O.CellCoords(j.settings.data.length-1,z.propToCol(t)),z.DESTINATION_RENDERER),n.concat.apply(n,r(e))},this.getSourceData=function(t,e,n,i){return void 0===t?V.getData():V.getByRange(new O.CellCoords(t,e),new O.CellCoords(n,i))},this.getSourceDataArray=function(t,e,n,i){return void 0===t?V.getData(!0):V.getByRange(new O.CellCoords(t,e),new O.CellCoords(n,i),!0)},this.getSourceDataAtCol=function(t){return V.getAtColumn(t)},this.getSourceDataAtRow=function(t){return V.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return V.getAtCell(t,e)},this.getDataAtRow=function(t){return z.getRange(new O.CellCoords(t,0),new O.CellCoords(t,this.countCols()-1),z.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,i){var r=this,o=null,a=null;void 0===t&&(t=0,n=this.countRows(),e=0,i=this.countCols()),void 0===n&&(n=t),void 0===i&&(i=e);var s="mixed";return(0,E.rangeEach)(Math.min(t,n),Math.max(t,n),function(t){var n=!0;return(0,E.rangeEach)(Math.min(e,i),Math.max(e,i),function(e){var i=r.getCellMeta(t,e);return a=i.type,o?n=o===a:o=a,n}),s=n?a:"mixed",n}),s},this.removeCellMeta=function(t,e,n){var i=Z.toPhysical(t,e),r=o(i,2),a=r[0],s=r[1],l=j.cellSettings[a][s][n];!1!==q.runHooks("beforeRemoveCellMeta",t,e,n,l)&&(delete j.cellSettings[a][s][n],q.runHooks("afterRemoveCellMeta",t,e,n,l)),l=null},this.spliceCellsMeta=function(t,e){for(var n,i=arguments.length,r=Array(i>2?i-2:0),o=2;i>o;o++)r[o-2]=arguments[o];(n=j.cellSettings).splice.apply(n,[t,e].concat(r))},this.setCellMetaObject=function(t,e,n){if("object"===(void 0===n?"undefined":a(n)))for(var i in n)if((0,g.hasOwnProperty)(n,i)){var r=n[i];this.setCellMeta(t,e,i,r)}},this.setCellMeta=function(t,e,n,i){var r=Z.toPhysical(t,e),a=o(r,2),s=a[0],l=a[1];j.columnSettings[l]||(j.columnSettings[l]=(0,u.columnFactory)(J,j.columnsSettingConflicts)),j.cellSettings[s]||(j.cellSettings[s]=[]),j.cellSettings[s][l]||(j.cellSettings[s][l]=new j.columnSettings[l]),j.cellSettings[s][l][n]=i,q.runHooks("afterSetCellMeta",t,e,n,i)},this.getCellsMeta=function(){return(0,v.arrayFlatten)(j.cellSettings)},this.getCellMeta=function(t,e){var n=z.colToProp(e),i=void 0,r=Z.toPhysical(t,e),a=o(r,2),s=a[0],l=a[1];if(j.columnSettings[l]||(j.columnSettings[l]=(0,u.columnFactory)(J,j.columnsSettingConflicts)),j.cellSettings[s]||(j.cellSettings[s]=[]),j.cellSettings[s][l]||(j.cellSettings[s][l]=new j.columnSettings[l]),i=j.cellSettings[s][l],i.row=s,i.col=l,i.visualRow=t,i.visualCol=e,i.prop=n,i.instance=q,q.runHooks("beforeGetCellMeta",t,e,i),(0,g.extend)(i,F(i)),i.cells){var c=i.cells.call(i,s,l,n);c&&((0,g.extend)(i,c),(0,g.extend)(i,F(c)))}return q.runHooks("afterGetCellMeta",t,e,i),i},this.getCellMetaAtRow=function(t){return j.cellSettings[t]},this.isColumnModificationAllowed=function(){return!("object"===q.dataType||q.getSettings().columns)};var $=(0,x.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(t,e){return(0,w.getRenderer)($.call(this,t,e))},this.getCellEditor=(0,x.cellMethodLookupFactory)("editor");var Q=(0,x.cellMethodLookupFactory)("validator");this.getCellValidator=function(t,e){var n=Q.call(this,t,e);return"string"==typeof n&&(n=(0,b.getValidator)(n)),n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var r=new i;t&&(r.onQueueEmpty=t);for(var o=q.countRows()-1;o>=0;)if(void 0===e||-1!==e.indexOf(o)){for(var a=q.countCols()-1;a>=0;)void 0===n||-1!==n.indexOf(a)?(r.addValidatorToQueue(),q.validateCell(q.getDataAtCell(o,a),q.getCellMeta(o,a),function(t){if("boolean"!=typeof t)throw Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),a--):a--;o--}else o--;r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=j.settings.rowHeaders;return void 0!==t&&(t=q.runHooks("modifyRowHeader",t)),void 0===t?(e=[],(0,E.rangeEach)(q.countRows()-1,function(t){e.push(q.getRowHeader(t))})):Array.isArray(e)&&void 0!==e[t]?e=e[t]:(0,c.isFunction)(e)?e=e(t):e&&"string"!=typeof e&&"number"!=typeof e&&(e=t+1),e},this.hasRowHeaders=function(){return!!j.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==j.settings.colHeaders&&null!==j.settings.colHeaders)return!!j.settings.colHeaders;for(var t=0,e=q.countCols();e>t;t++)if(q.getColHeader(t))return!0;return!1},this.getColHeader=function(t){var e=j.settings.columns&&(0,c.isFunction)(j.settings.columns),n=j.settings.colHeaders;if(void 0===(t=q.runHooks("modifyColHeader",t))){for(var i=[],r=e?q.countSourceCols():q.countCols(),o=0;r>o;o++)i.push(q.getColHeader(o));n=i}else{var a=t,s=function(t){for(var e=[],n=q.countSourceCols(),i=0;n>i;i++)(0,c.isFunction)(q.getSettings().columns)&&q.getSettings().columns(i)&&e.push(i);return e[t]}(t=q.runHooks("modifyCol",t));j.settings.columns&&(0,c.isFunction)(j.settings.columns)&&j.settings.columns(s)&&j.settings.columns(s).title?n=j.settings.columns(s).title:j.settings.columns&&j.settings.columns[t]&&j.settings.columns[t].title?n=j.settings.columns[t].title:Array.isArray(j.settings.colHeaders)&&void 0!==j.settings.colHeaders[t]?n=j.settings.colHeaders[t]:(0,c.isFunction)(j.settings.colHeaders)?n=j.settings.colHeaders(t):j.settings.colHeaders&&"string"!=typeof j.settings.colHeaders&&"number"!=typeof j.settings.colHeaders&&(n=(0,x.spreadsheetColumnLabel)(a))}return n},this._getColWidthFromSettings=function(t){var e=q.getCellMeta(0,t),n=e.width;if(void 0!==n&&n!==j.settings.width||(n=e.colWidths),void 0!==n&&null!==n){switch(void 0===n?"undefined":a(n)){case"object":n=n[t];break;case"function":n=n(t)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(t){var e=q._getColWidthFromSettings(t);return void 0===(e=q.runHooks("modifyColWidth",e,t))&&(e=O.ViewportColumnsCalculator.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=j.settings.rowHeights;if(void 0!==e&&null!==e){switch(void 0===e?"undefined":a(e)){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=q._getRowHeightFromSettings(t);return e=q.runHooks("modifyRowHeight",e,t)},this.countSourceRows=function(){return q.runHooks("modifySourceLength")||(q.getSourceData()?q.getSourceData().length:0)},this.countSourceCols=function(){var t=q.getSourceData()&&q.getSourceData()[0]?q.getSourceData()[0]:[];return(0,g.isObject)(t)?(0,g.deepObjectSize)(t):t.length||0},this.countRows=function(){return z.getLength()},this.countCols=function(){var t=this.getSettings().maxCols,e=!1,n=0;if("array"===q.dataType&&(e=j.settings.data&&j.settings.data[0]&&j.settings.data[0].length),e&&(n=j.settings.data[0].length),j.settings.columns)if((0,c.isFunction)(j.settings.columns))if("array"===q.dataType){for(var i=0,r=0;n>r;r++)j.settings.columns(r)&&i++;n=i}else"object"!==q.dataType&&"function"!==q.dataType||(n=z.colToPropCache.length);else n=j.settings.columns.length;else"object"!==q.dataType&&"function"!==q.dataType||(n=z.colToPropCache.length);return Math.min(t,n)},this.rowOffset=function(){return q.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return q.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return q.view.wt.drawn?q.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return q.view.wt.drawn?q.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return q.view.wt.drawn?q.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return q.view.wt.drawn?q.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(t){for(var e,n=q.countRows()-1,i=0;n>=0;){if(e=q.runHooks("modifyRow",n),q.isEmptyRow(e))i++;else if(t)break;n--}return i},this.countEmptyCols=function(t){if(1>q.countRows())return 0;for(var e=q.countCols()-1,n=0;e>=0;){if(q.isEmptyCol(e))n++;else if(t)break;e--}return n},this.isEmptyRow=function(t){return j.settings.isEmptyRow.call(q,t)},this.isEmptyCol=function(t){return j.settings.isEmptyCol.call(q,t)},this.selectCell=function(t,e,n,i,r,o){var a;if(o=(0,h.isUndefined)(o)||!0===o,"number"!=typeof t||0>t||t>=q.countRows())return!1;if("number"!=typeof e||0>e||e>=q.countCols())return!1;if((0,h.isDefined)(n)){if("number"!=typeof n||0>n||n>=q.countRows())return!1;if("number"!=typeof i||0>i||i>=q.countCols())return!1}return a=new O.CellCoords(t,e),j.selRange=new O.CellRange(a,a,a),o&&q.listen(),(0,h.isUndefined)(n)?G.setRangeEnd(j.selRange.from,r):G.setRangeEnd(new O.CellCoords(n,i),r),q.selection.finish(),!0},this.selectCellByProp=function(t,e,n,i,r){var o;return arguments[1]=z.propToCol(arguments[1]),(0,h.isDefined)(arguments[3])&&(arguments[3]=z.propToCol(arguments[3])),(o=q).selectCell.apply(o,arguments)},this.deselectCell=function(){G.deselect()},this.scrollViewportTo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(void 0!==t&&(0>t||t>=q.countRows()))return!1;if(void 0!==e&&(0>e||e>=q.countCols()))return!1;var r=!1;return void 0!==t&&void 0!==e&&(q.view.wt.wtOverlays.topOverlay.scrollTo(t,n),q.view.wt.wtOverlays.leftOverlay.scrollTo(e,i),r=!0),"number"==typeof t&&"number"!=typeof e&&(q.view.wt.wtOverlays.topOverlay.scrollTo(t,n),r=!0),"number"==typeof e&&"number"!=typeof t&&(q.view.wt.wtOverlays.leftOverlay.scrollTo(e,i),r=!0),r},this.destroy=function(){q._clearTimeouts(),q.view&&q.view.destroy(),V&&V.destroy(),V=null,(0,l.empty)(q.rootElement),K.destroy(),q.runHooks("afterDestroy"),R.default.getSingleton().destroy(q);for(var t in q)(0,g.hasOwnProperty)(q,t)&&((0,c.isFunction)(q[t])?q[t]=B:"guid"!==t&&(q[t]=null));z&&z.destroy(),z=null,j=null,W=null,G=null,Y=null,q=null,J=null},this.getActiveEditor=function(){return Y.getActiveEditor()},this.getPlugin=function(t){return(0,y.getPlugin)(this,t)},this.getInstance=function(){return q},this.addHook=function(t,e){R.default.getSingleton().add(t,e,q)},this.hasHook=function(t){return R.default.getSingleton().has(t,q)},this.addHookOnce=function(t,e){R.default.getSingleton().once(t,e,q)},this.removeHook=function(t,e){R.default.getSingleton().remove(t,e,q)},this.runHooks=function(t,e,n,i,r,o,a){return R.default.getSingleton().run(q,t,e,n,i,r,o,a)},this.getTranslatedPhrase=function(t,e){return(0,N.getTranslatedPhrase)(j.settings.language,t,e)},this.timeouts=[],this._registerTimeout=function(t){this.timeouts.push(t)},this._clearTimeouts=function(){for(var t=0,e=this.timeouts.length;e>t;t++)clearTimeout(this.timeouts[t])},R.default.getSingleton().run(q,"construct")};var s=i(n(82)),l=n(0),u=n(85),c=n(36),h=n(17),d=n(27),f=i(n(244)),p=i(n(247)),m=i(n(4)),g=n(1),v=n(2),y=n(6),w=n(9),b=n(28),_=n(33),E=n(5),T=i(n(248)),C=i(n(249)),x=n(86),S=n(175),M=n(176),O=n(13),R=i(n(8)),A=i(n(177)),P=n(83),N=n(178),k=n(65),L=n(179),D=null},function(t,e,n){"use strict";e.__esModule=!0,e.columnFactory=function(t,e){function n(){}(0,i.inherit)(n,t);for(var r=0,o=e.length;o>r;r++)n.prototype[e[r]]=void 0;return n};var i=n(1)},function(t,e,n){"use strict";function i(t){for(var e=t+1,n="",i=void 0;e>0;)i=(e-1)%s,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/s,10);return n}e.__esModule=!0,e.spreadsheetColumnLabel=i,e.spreadsheetColumnIndex=function(t){var e=0;if(t)for(var n=0,i=t.length-1;t.length>n;n+=1,i-=1)e+=Math.pow(s,i)*(a.indexOf(t[n])+1);return--e},e.createSpreadsheetData=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;n>t;t++){var a=[];for(e=0;r>e;e++)a.push(i(e)+(t+1));o.push(a)}return o},e.createSpreadsheetObjectData=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;n>t;t++){var a={};for(e=0;r>e;e++)a["prop"+e]=i(e)+(t+1);o.push(a)}return o},e.createEmptySpreadsheetData=function(t,e){for(var n=[],i=void 0,r=0;t>r;r++){i=[];for(var o=0;e>o;o++)i.push("");n.push(i)}return n},e.translateRowsToColumns=function(t){var e,n,i,r,o=[],a=0;for(e=0,n=t.length;n>e;e++)for(i=0,r=t[e].length;r>i;i++)i==a&&(o.push([]),a++),o[i].push(t[e][i]);return o},e.cellMethodLookupFactory=function(t,e){return e=void 0===e||e,function(n,i){return function n(i){if(i){if((0,o.hasOwnProperty)(i,t)&&void 0!==i[t])return i[t];if((0,o.hasOwnProperty)(i,"type")&&i.type){var a;if("string"!=typeof i.type)throw Error("Cell type must be a string ");if(a=(0,r.getCellType)(i.type),(0,o.hasOwnProperty)(a,t))return a[t];if(e)return}return n(Object.getPrototypeOf(i))}}("number"==typeof n?this.getCellMeta(n,i):n)}};var r=n(83),o=n(1),a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s=a.length},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(2);e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return i(t,[{key:"addRow",value:function(t,e){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){if(null!=this.hot.getColHeader(0)){var e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}},{key:"addColumn",value:function(t,e){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),(0,o.arrayEach)(this.rows,function(e){t(e.row,(0,r.outerHeight)(e.table)-1)})}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),(0,o.arrayEach)(this.columns,function(e){t(e.col,(0,r.outerWidth)(e.table))})}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,e){this.settings||(this.settings={}),this.settings[t]=e}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,e=document.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach(function(n){(0,o.arrayEach)(n.strings,function(n){e.appendChild(t.createColElement(n.col))})}),e}},{key:"createRow",value:function(t){var e=this,n=document,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,r),i.appendChild(r)),this.samples.forEach(function(r){(0,o.arrayEach)(r.strings,function(r){var o=r.col,a=e.hot.getCellMeta(t,o);a.col=o,a.row=t;var s=e.hot.getCellRenderer(a),l=n.createElement("td");s(e.hot,l,t,o,e.hot.colToProp(o),r.value,a),i.appendChild(l)})}),i}},{key:"createColumnHeadersRow",value:function(){var t=this,e=document,n=e.createDocumentFragment();if(this.hot.hasRowHeaders()){var i=e.createElement("th");this.hot.view.appendColHeader(-1,i),n.appendChild(i)}return this.samples.forEach(function(i){(0,o.arrayEach)(i.strings,function(i){var r=i.col,o=e.createElement("th");t.hot.view.appendColHeader(r,o),n.appendChild(o)})}),n}},{key:"createCol",value:function(t){var e=this,n=document,i=n.createDocumentFragment();return this.samples.forEach(function(r){(0,o.arrayEach)(r.strings,function(r){var o=r.row,a=e.hot.getCellMeta(o,t);a.col=t,a.row=o;var s=e.hot.getCellRenderer(a),l=n.createElement("td"),u=n.createElement("tr");s(e.hot,l,o,t,e.hot.colToProp(t),r.value,a),u.appendChild(l),i.appendChild(u)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var e=document.createElement("col");return e.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(t)+"px",e}},{key:"createTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=document,n=e.createDocumentFragment(),i=e.createElement("table"),o=e.createElement("thead"),a=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),u=e.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&a.appendChild(l),i.appendChild(a),(0,r.addClass)(i,t),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:a,colGroup:s,tr:l,th:u}}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=document,n=e.createDocumentFragment(),i=e.createElement("div");return t="htGhostTable htAutoSize "+t.trim(),(0,r.addClass)(i,t),n.appendChild(i),{fragment:n,container:i}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(){return{name:i}};var i=e.KEY="---------"},function(t,e,n){"use strict";e.__esModule=!0;var i=n(2),r=n(1),o={_localHooks:Object.create(null),addLocalHook:function(t,e){this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e)},runLocalHooks:function(t){for(var e=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;n>o;o++)r[o-1]=arguments[o];this._localHooks[t]&&(0,i.arrayEach)(this._localHooks[t],function(t){return t.apply(e,r)})},clearLocalHooks:function(){this._localHooks={}}};(0,r.defineGetter)(o,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.default=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}e.__esModule=!0,e.ITEMS=e.UNDO=e.SEPARATOR=e.ROW_BELOW=e.ROW_ABOVE=e.REMOVE_ROW=e.REMOVE_COLUMN=e.REDO=e.READ_ONLY=e.COLUMN_RIGHT=e.COLUMN_LEFT=e.CLEAR_COLUMN=e.ALIGNMENT=void 0;var o,a=n(269);Object.defineProperty(e,"ALIGNMENT",{enumerable:!0,get:function(){return a.KEY}});var s=n(270);Object.defineProperty(e,"CLEAR_COLUMN",{enumerable:!0,get:function(){return s.KEY}});var l=n(271);Object.defineProperty(e,"COLUMN_LEFT",{enumerable:!0,get:function(){return l.KEY}});var u=n(272);Object.defineProperty(e,"COLUMN_RIGHT",{enumerable:!0,get:function(){return u.KEY}});var c=n(273);Object.defineProperty(e,"READ_ONLY",{enumerable:!0,get:function(){return c.KEY}});var h=n(274);Object.defineProperty(e,"REDO",{enumerable:!0,get:function(){return h.KEY}});var d=n(275);Object.defineProperty(e,"REMOVE_COLUMN",{enumerable:!0,get:function(){return d.KEY}});var f=n(276);Object.defineProperty(e,"REMOVE_ROW",{enumerable:!0,get:function(){return f.KEY}});var p=n(277);Object.defineProperty(e,"ROW_ABOVE",{enumerable:!0,get:function(){return p.KEY}});var m=n(278);Object.defineProperty(e,"ROW_BELOW",{enumerable:!0,get:function(){return m.KEY}});var g=n(88);Object.defineProperty(e,"SEPARATOR",{enumerable:!0,get:function(){return g.KEY}});var v=n(279);Object.defineProperty(e,"UNDO",{enumerable:!0,get:function(){return v.KEY}}),e.predefinedItems=function(){var t={};return(0,y.objectEach)(N,function(e,n){t[n]=e()}),t},e.addItem=function(t,e){-1===P.indexOf(t)&&(N[t]=e)};var y=n(1),w=i(a),b=i(s),_=i(l),E=i(u),T=i(c),C=i(h),x=i(d),S=i(f),M=i(p),O=i(m),R=i(g),A=i(v),P=e.ITEMS=[p.KEY,m.KEY,l.KEY,u.KEY,s.KEY,f.KEY,d.KEY,v.KEY,h.KEY,c.KEY,a.KEY,g.KEY],N=(o={},r(o,g.KEY,R.default),r(o,p.KEY,M.default),r(o,m.KEY,O.default),r(o,l.KEY,_.default),r(o,u.KEY,E.default),r(o,s.KEY,b.default),r(o,f.KEY,S.default),r(o,d.KEY,x.default),r(o,v.KEY,A.default),r(o,h.KEY,C.default),r(o,c.KEY,T.default),r(o,a.KEY,w.default),o)},function(t,e,n){"use strict";var i=n(92),r=n(40);t.exports=n(61)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=i.getEntry(r(this,"Map"),t);return e&&e.v},set:function(t,e){return i.def(r(this,"Map"),0===t?0:t,e)}},i,!0)},function(t,e,n){"use strict";var i=n(19).f,r=n(68),o=n(56),a=n(31),s=n(58),l=n(59),u=n(101),c=n(102),h=n(103),d=n(22),f=n(49).fastKey,p=n(40),m=d?"_s":"size",g=function(t,e){var n,i=f(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,u){var c=t(function(t,i){s(t,c,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=i&&l(i,n,t[u],t)});return o(c.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var n=p(this,e),i=g(n,t);if(i){var r=i.n,o=i.p;delete n._i[i.i],i.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==i&&(n._f=r),n._l==i&&(n._l=o),n[m]--}return!!i},forEach:function(t){p(this,e);for(var n,i=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(p(this,e),t)}}),d&&i(c.prototype,"size",{get:function(){return p(this,e)[m]}}),c},def:function(t,e,n){var i,r,o=g(t,e);return o?o.v=n:(t._l=o={i:r=f(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=o),i&&(i.n=o),t[m]++,"F"!==r&&(t._i[r]=o)),t},getEntry:g,setStrong:function(t,e,n){u(t,e,function(t,n){this._t=p(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?c(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,c(1))},n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){t.exports=!n(22)&&!n(24)(function(){return 7!=Object.defineProperty(n(66)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(25),r=n(26),o=n(95)(!1),a=n(70)("IE_PROTO");t.exports=function(t,e){var n,s=r(t),l=0,u=[];for(n in s)n!=a&&i(s,n)&&u.push(n);for(;e.length>l;)i(s,n=e[l++])&&(~o(u,n)||u.push(n));return u}},function(t,e,n){var i=n(26),r=n(23),o=n(55);t.exports=function(t){return function(e,n,a){var s,l=i(e),u=r(l.length),c=o(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){var i=n(12).document;t.exports=i&&i.documentElement},function(t,e,n){var i=n(18);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},function(t,e,n){var i=n(47),r=n(10)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(100),r=n(10)("iterator"),o=n(47);t.exports=n(46).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){var i=n(38),r=n(10)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:o?i(e):"Object"==(a=i(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){"use strict";var i=n(60),r=n(3),o=n(29),a=n(30),s=n(25),l=n(47),u=n(187),c=n(48),h=n(188),d=n(10)("iterator"),f=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,m,g,v,y){u(n,e,m);var w,b,_,E=function(t){if(!f&&t in S)return S[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},T=e+" Iterator",C="values"==g,x=!1,S=t.prototype,M=S[d]||S["@@iterator"]||g&&S[g],O=M||E(g),R=g?C?E("entries"):O:void 0,A="Array"==e?S.entries||M:M;if(A&&(_=h(A.call(new t)))!==Object.prototype&&_.next&&(c(_,T,!0),i||s(_,d)||a(_,d,p)),C&&M&&"values"!==M.name&&(x=!0,O=function(){return M.call(this)}),i&&!y||!f&&!x&&S[d]||a(S,d,O),l[e]=O,l[T]=p,g)if(w={values:C?O:E("values"),keys:v?O:E("keys"),entries:R},y)for(b in w)b in S||o(S,b,w[b]);else r(r.P+r.F*(f||x),e,w);return w}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var i=n(12),r=n(19),o=n(22),a=n(10)("species");t.exports=function(t){var e=i[t];o&&e&&!e[a]&&r.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(15),r=n(18),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(31)(Function.call,n(74).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){"use strict";var i=n(92),r=n(40);t.exports=n(61)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(r(this,"Set"),t=0===t?0:t,t)}},i)},function(t,e,n){"use strict";var i,r=n(62)(0),o=n(29),a=n(49),s=n(108),l=n(109),u=n(15),c=n(24),h=n(40),d=a.getWeak,f=Object.isExtensible,p=l.ufstore,m={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(u(t)){var e=d(t);return!0===e?p(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(h(this,"WeakMap"),t,e)}},y=t.exports=n(61)("WeakMap",g,v,l,!0,!0);c(function(){return 7!=(new y).set((Object.freeze||Object)(m),7).get(m)})&&(i=l.getConstructor(g,"WeakMap"),s(i.prototype,v),a.NEED=!0,r(["delete","has","get","set"],function(t){var e=y.prototype,n=e[t];o(e,t,function(e,r){if(u(e)&&!f(e)){this._f||(this._f=new i);var o=this._f[t](e,r);return"set"==t?this:o}return n.call(this,e,r)})}))},function(t,e,n){var i=n(38);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){"use strict";var i=n(37),r=n(63),o=n(50),a=n(39),s=n(69),l=Object.assign;t.exports=!l||n(24)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=i})?function(t,e){for(var n=a(t),l=arguments.length,u=1,c=r.f,h=o.f;l>u;)for(var d,f=s(arguments[u++]),p=c?i(f).concat(c(f)):i(f),m=p.length,g=0;m>g;)h.call(f,d=p[g++])&&(n[d]=f[d]);return n}:l},function(t,e,n){"use strict";var i=n(56),r=n(49).getWeak,o=n(18),a=n(15),s=n(58),l=n(59),u=n(62),c=n(25),h=n(40),d=u(5),f=u(6),p=0,m=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},v=function(t,e){return d(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=v(this,t);if(e)return e[1]},has:function(t){return!!v(this,t)},set:function(t,e){var n=v(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=f(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var u=t(function(t,i){s(t,u,e,"_i"),t._t=e,t._i=p++,t._l=void 0,void 0!=i&&l(i,n,t[o],t)});return i(u.prototype,{delete:function(t){if(!a(t))return!1;var n=r(t);return!0===n?m(h(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=r(t);return!0===n?m(h(this,e)).has(t):n&&c(n,this._i)}}),u},def:function(t,e,n){var i=r(o(e),!0);return!0===i?m(t).set(e,n):i[t._i]=n,t},ufstore:m}},function(t,e,n){"use strict";var i=n(109),r=n(40);n(61)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(r(this,"WeakSet"),t,!0)}},i,!1,!0)},function(t,e,n){"use strict";var i,r,o,a,s=n(60),l=n(12),u=n(31),c=n(100),h=n(3),d=n(15),f=n(57),p=n(58),m=n(59),g=n(192),v=n(75).set,y=n(194)(),w=n(112),b=n(195),_=n(196),E=l.TypeError,T=l.process,C=l.Promise,x="process"==c(T),S=function(){},M=r=w.f,O=!!function(){try{var t=C.resolve(1),e=(t.constructor={})[n(10)("species")]=function(t){t(S,S)};return(x||"function"==typeof PromiseRejectionEvent)&&t.then(S)instanceof e}catch(t){}}(),R=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},A=function(t,e){if(!t._n){t._n=!0;var n=t._c;y(function(){for(var i=t._v,r=1==t._s,o=0;n.length>o;)!function(e){var n,o,a=r?e.ok:e.fail,s=e.resolve,l=e.reject,u=e.domain;try{a?(r||(2==t._h&&k(t),t._h=1),!0===a?n=i:(u&&u.enter(),n=a(i),u&&u.exit()),n===e.promise?l(E("Promise-chain cycle")):(o=R(n))?o.call(n,s,l):s(n)):l(i)}catch(t){l(t)}}(n[o++]);t._c=[],t._n=!1,e&&!t._h&&P(t)})}},P=function(t){v.call(l,function(){var e,n,i,r=t._v,o=N(t);if(o&&(e=b(function(){x?T.emit("unhandledRejection",r,t):(n=l.onunhandledrejection)?n({promise:t,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)}),t._h=x||N(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},N=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,i=0;n.length>i;)if((e=n[i++]).fail||!N(e.promise))return!1;return!0},k=function(t){v.call(l,function(){var e;x?T.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},L=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),A(e,!0))},D=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw E("Promise can't be resolved itself");(e=R(t))?y(function(){var i={_w:n,_d:!1};try{e.call(t,u(D,i,1),u(L,i,1))}catch(t){L.call(i,t)}}):(n._v=t,n._s=1,A(n,!1))}catch(t){L.call({_w:n,_d:!1},t)}}};O||(C=function(t){p(this,C,"Promise","_h"),f(t),i.call(this);try{t(u(D,this,1),u(L,this,1))}catch(t){L.call(this,t)}},i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(56)(C.prototype,{then:function(t,e){var n=M(g(this,C));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=x?T.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&A(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new i;this.promise=t,this.resolve=u(D,t,1),this.reject=u(L,t,1)},w.f=M=function(t){return t===C||t===a?new o(t):r(t)}),h(h.G+h.W+h.F*!O,{Promise:C}),n(48)(C,"Promise"),n(103)("Promise"),a=n(46).Promise,h(h.S+h.F*!O,"Promise",{reject:function(t){var e=M(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!O),"Promise",{resolve:function(t){return _(s&&this===a?C:this,t)}}),h(h.S+h.F*!(O&&n(73)(function(t){C.all(t).catch(S)})),"Promise",{all:function(t){var e=this,n=M(e),i=n.resolve,r=n.reject,o=b(function(){var n=[],o=0,a=1;m(t,!1,function(t){var s=o++,l=!1;n.push(void 0),a++,e.resolve(t).then(function(t){l||(l=!0,n[s]=t,--a||i(n))},r)}),--a||i(n)});return o.e&&r(o.v),n.promise},race:function(t){var e=this,n=M(e),i=n.reject,r=b(function(){m(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},function(t,e,n){"use strict";var i=n(57);t.exports.f=function(t){return new function(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=i(e),this.reject=i(n)}(t)}},function(t,e,n){"use strict";var i=n(12),r=n(25),o=n(22),a=n(3),s=n(29),l=n(49).KEY,u=n(24),c=n(71),h=n(48),d=n(44),f=n(10),p=n(114),m=n(197),g=n(198),v=n(107),y=n(18),w=n(26),b=n(67),_=n(45),E=n(68),T=n(199),C=n(74),x=n(19),S=n(37),M=C.f,O=x.f,R=T.f,A=i.Symbol,P=i.JSON,N=P&&P.stringify,k=f("_hidden"),L=f("toPrimitive"),D={}.propertyIsEnumerable,I=c("symbol-registry"),H=c("symbols"),U=c("op-symbols"),F=Object.prototype,B="function"==typeof A,j=i.QObject,z=!j||!j.prototype||!j.prototype.findChild,V=o&&u(function(){return 7!=E(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=M(F,e);i&&delete F[e],O(t,e,n),i&&t!==F&&O(F,e,i)}:O,W=function(t){var e=H[t]=E(A.prototype);return e._k=t,e},G=B&&"symbol"==typeof A.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof A},Y=function(t,e,n){return t===F&&Y(U,e,n),y(t),e=b(e,!0),y(n),r(H,e)?(n.enumerable?(r(t,k)&&t[k][e]&&(t[k][e]=!1),n=E(n,{enumerable:_(0,!1)})):(r(t,k)||O(t,k,_(1,{})),t[k][e]=!0),V(t,e,n)):O(t,e,n)},X=function(t,e){y(t);for(var n,i=g(e=w(e)),r=0,o=i.length;o>r;)Y(t,n=i[r++],e[n]);return t},q=function(t){var e=D.call(this,t=b(t,!0));return!(this===F&&r(H,t)&&!r(U,t))&&(!(e||!r(this,t)||!r(H,t)||r(this,k)&&this[k][t])||e)},J=function(t,e){if(t=w(t),e=b(e,!0),t!==F||!r(H,e)||r(U,e)){var n=M(t,e);return!n||!r(H,e)||r(t,k)&&t[k][e]||(n.enumerable=!0),n}},K=function(t){for(var e,n=R(w(t)),i=[],o=0;n.length>o;)r(H,e=n[o++])||e==k||e==l||i.push(e);return i},Z=function(t){for(var e,n=t===F,i=R(n?U:w(t)),o=[],a=0;i.length>a;)!r(H,e=i[a++])||n&&!r(F,e)||o.push(H[e]);return o};B||(A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(n){this===F&&e.call(U,n),r(this,k)&&r(this[k],t)&&(this[k][t]=!1),V(this,t,_(1,n))};return o&&z&&V(F,t,{configurable:!0,set:e}),W(t)},s(A.prototype,"toString",function(){return this._k}),C.f=J,x.f=Y,n(76).f=T.f=K,n(50).f=q,n(63).f=Z,o&&!n(60)&&s(F,"propertyIsEnumerable",q,!0),p.f=function(t){return W(f(t))}),a(a.G+a.W+a.F*!B,{Symbol:A});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Q=0;$.length>Q;)f($[Q++]);for(var tt=S(f.store),et=0;tt.length>et;)m(tt[et++]);a(a.S+a.F*!B,"Symbol",{for:function(t){return r(I,t+="")?I[t]:I[t]=A(t)},keyFor:function(t){if(!G(t))throw TypeError(t+" is not a symbol!");for(var e in I)if(I[e]===t)return e},useSetter:function(){z=!0},useSimple:function(){z=!1}}),a(a.S+a.F*!B,"Object",{create:function(t,e){return void 0===e?E(t):X(E(t),e)},defineProperty:Y,defineProperties:X,getOwnPropertyDescriptor:J,getOwnPropertyNames:K,getOwnPropertySymbols:Z}),P&&a(a.S+a.F*(!B||u(function(){var t=A();return"[null]"!=N([t])||"{}"!=N({a:t})||"{}"!=N(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!G(t)){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);return"function"==typeof(e=i[1])&&(n=e),!n&&v(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!G(e))return e}),i[1]=e,N.apply(P,i)}}}),A.prototype[L]||n(30)(A.prototype,L,A.prototype.valueOf),h(A,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){e.f=n(10)},function(t,e,n){var i=n(3);i(i.S+i.F,"Object",{assign:n(108)})},function(t,e,n){var i=n(3);i(i.S,"Object",{is:n(200)})},function(t,e,n){var i=n(3);i(i.S,"Object",{setPrototypeOf:n(104).set})},function(t,e,n){var i=n(19).f,r=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in r||n(22)&&i(r,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){var i=n(3),r=n(26),o=n(23);i(i.S,"String",{raw:function(t){for(var e=r(t.raw),n=o(e.length),i=arguments.length,a=[],s=0;n>s;)a.push(e[s++]+""),i>s&&a.push(arguments[s]+"");return a.join("")}})},function(t,e,n){var i=n(3),r=n(55),o=String.fromCharCode,a=String.fromCodePoint;i(i.S+i.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],i=arguments.length,a=0;i>a;){if(e=+arguments[a++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(65536>e?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){"use strict";var i=n(3),r=n(201)(!1);i(i.P,"String",{codePointAt:function(t){return r(this,t)}})},function(t,e,n){var i=n(3);i(i.P,"String",{repeat:n(123)})},function(t,e,n){"use strict";var i=n(54),r=n(34);t.exports=function(t){var e=r(this)+"",n="",o=i(t);if(0>o||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e,n){"use strict";var i=n(3),r=n(23),o=n(77),a="".startsWith;i(i.P+i.F*n(78)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=t+"";return a?a.call(e,i,n):e.slice(n,n+i.length)===i}})},function(t,e,n){var i=n(15),r=n(38),o=n(10)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},function(t,e,n){"use strict";var i=n(3),r=n(23),o=n(77),a="".endsWith;i(i.P+i.F*n(78)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,i=r(e.length),s=void 0===n?i:Math.min(r(n),i),l=t+"";return a?a.call(e,l,s):e.slice(s-l.length,s)===l}})},function(t,e,n){"use strict";var i=n(3),r=n(77);i(i.P+i.F*n(78)("includes"),"String",{includes:function(t){return!!~r(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){n(22)&&"g"!=/./g.flags&&n(19).f(RegExp.prototype,"flags",{configurable:!0,get:n(202)})},function(t,e,n){n(64)("match",1,function(t,e,n){return[function(n){"use strict";var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):RegExp(n)[e](i+"")},n]})},function(t,e,n){n(64)("replace",2,function(t,e,n){return[function(i,r){"use strict";var o=t(this),a=void 0==i?void 0:i[e];return void 0!==a?a.call(i,o,r):n.call(o+"",i,r)},n]})},function(t,e,n){n(64)("split",2,function(t,e,i){"use strict";var r=n(125),o=i,a=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var s=void 0===/()??/.exec("")[1];i=function(t,e){var n=this+"";if(void 0===t&&0===e)return[];if(!r(t))return o.call(n,t,e);var i,l,u,c,h,d=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,m=void 0===e?4294967295:e>>>0,g=RegExp(t.source,f+"g");for(s||(i=RegExp("^"+g.source+"$(?!\\s)",f));(l=g.exec(n))&&((u=l.index+l[0].length)<=p||(d.push(n.slice(p,l.index)),!s&&l.length>1&&l[0].replace(i,function(){for(h=1;arguments.length-2>h;h++)void 0===arguments[h]&&(l[h]=void 0)}),l.length>1&&n.length>l.index&&a.apply(d,l.slice(1)),c=l[0].length,p=u,m>d.length));)g.lastIndex===l.index&&g.lastIndex++;return p===n.length?!c&&g.test("")||d.push(""):d.push(n.slice(p)),d.length>m?d.slice(0,m):d}}else"0".split(void 0,0).length&&(i=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(n,r){var o=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,o,r):i.call(o+"",n,r)},i]})},function(t,e,n){n(64)("search",1,function(t,e,n){return[function(n){"use strict";var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):RegExp(n)[e](i+"")},n]})},function(t,e,n){"use strict";var i=n(31),r=n(3),o=n(39),a=n(97),s=n(98),l=n(23),u=n(79),c=n(99);r(r.S+r.F*!n(73)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,h,d=o(t),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,v=0,y=c(d);if(g&&(m=i(m,p>2?arguments[2]:void 0,2)),void 0==y||f==Array&&s(y))for(e=l(d.length),n=new f(e);e>v;v++)u(n,v,g?m(d[v],v):d[v]);else for(h=y.call(d),n=new f;!(r=h.next()).done;v++)u(n,v,g?a(h,m,[r.value,v],!0):r.value);return n.length=v,n}})},function(t,e,n){"use strict";var i=n(3),r=n(79);i(i.S+i.F*n(24)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)r(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){var i=n(3);i(i.P,"Array",{copyWithin:n(203)}),n(41)("copyWithin")},function(t,e,n){"use strict";var i=n(3),r=n(62)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),i(i.P+i.F*o,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(41)("find")},function(t,e,n){"use strict";var i=n(3),r=n(62)(6),o=!0;"findIndex"in[]&&Array(1).findIndex(function(){o=!1}),i(i.P+i.F*o,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(41)("findIndex")},function(t,e,n){var i=n(3);i(i.P,"Array",{fill:n(204)}),n(41)("fill")},function(t,e,n){var i=n(3),r=n(12).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},function(t,e,n){var i=n(3);i(i.S,"Number",{isInteger:n(141)})},function(t,e,n){var i=n(15),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},function(t,e,n){var i=n(3),r=n(141),o=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return r(t)&&9007199254740991>=o(t)}})},function(t,e,n){var i=n(3);i(i.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var i=n(3);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var i=n(3);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var i=n(3);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){"use strict";var i=n(3),r=n(95)(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(41)("includes")},function(t,e,n){var i=n(3),r=n(149)(!1);i(i.S,"Object",{values:function(t){return r(t)}})},function(t,e,n){var i=n(37),r=n(26),o=n(50).f;t.exports=function(t){return function(e){for(var n,a=r(e),s=i(a),l=s.length,u=0,c=[];l>u;)o.call(a,n=s[u++])&&c.push(t?[n,a[n]]:a[n]);return c}}},function(t,e,n){var i=n(3),r=n(149)(!0);i(i.S,"Object",{entries:function(t){return r(t)}})},function(t,e,n){var i=n(3),r=n(205),o=n(26),a=n(74),s=n(79);i(i.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,i=o(t),l=a.f,u=r(i),c={},h=0;u.length>h;)void 0!==(n=l(i,e=u[h++]))&&s(c,e,n);return c}})},function(t,e,n){"use strict";var i=n(3),r=n(153);i(i.P,"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){var i=n(23),r=n(123),o=n(34);t.exports=function(t,e,n,a){var s=o(t)+"",l=s.length,u=void 0===n?" ":n+"",c=i(e);if(l>=c||""==u)return s;var h=c-l,d=r.call(u,Math.ceil(h/u.length));return d.length>h&&(d=d.slice(0,h)),a?d+s:s+d}},function(t,e,n){"use strict";var i=n(3),r=n(153);i(i.P,"String",{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){var i=n(3),r=n(75);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},function(t,e,n){for(var i=n(80),r=n(37),o=n(29),a=n(12),s=n(30),l=n(47),u=n(10),c=u("iterator"),h=u("toStringTag"),d=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(f),m=0;p.length>m;m++){var g,v=p[m],y=f[v],w=a[v],b=w&&w.prototype;if(b&&(b[c]||s(b,c,d),b[h]||s(b,h,v),l[v]=d,y))for(g in i)b[g]||o(b,g,i[g],!0)}},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=new WeakMap;e.default=function(){function t(e,n,i,o,a,s,l){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(t){return t};(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),r.set(this,{viewportWidth:e,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:a,onlyFullyVisible:s,stretchingColumnWidthFn:u}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return i(t,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),i(t,[{key:"calculate",value:function(){for(var t=0,e=!0,n=[],i=void 0,o=r.get(this),a=o.onlyFullyVisible,s=o.overrideFn,l=o.scrollOffset,u=o.totalColumns,c=o.viewportWidth,h=0;u>h;h++){i=this._getColumnWidth(h),t>l||a||(this.startColumn=h);if(l>t||t+i>l+(l>0?c+1:c)||(null==this.startColumn&&(this.startColumn=h),this.endColumn=h),n.push(t),t+=i,a||(this.endColumn=h),t>=l+c){e=!1;break}}if(this.endColumn===u-1&&e)for(this.startColumn=this.endColumn;this.startColumn>0;){var d=n[this.endColumn]+i-n[this.startColumn-1];if(d>c&&a||this.startColumn--,d>c)break}null!==this.startColumn&&s&&s(this),this.startPosition=n[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){this.totalTargetWidth=t;for(var e=r.get(this),n=e.totalColumns,i=0,o=0;n>o;o++){var a=this._getColumnWidth(o),s=e.stretchingColumnWidthFn(void 0,o);"number"==typeof s?t-=s:i+=a}var l=t-i;if("all"===this.stretch&&l>0)this.stretchAllRatio=t/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var u=this._getColumnWidth(n-1),c=l+u;this.stretchLastWidth=0>c?u:c}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,i=r.get(this),o=i.totalColumns;if(!this.stretchAllColumnsWidth[t]){var a=Math.round(e*this.stretchAllRatio),s=i.stretchingColumnWidthFn(a,t);this.stretchAllColumnsWidth[t]=void 0===s?a:isNaN(s)?this._getColumnWidth(t):s}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;this.stretchAllColumnsWidth.length>l;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===r.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=r.get(this).columnWidthFn(e);return void 0===n&&(n=t.DEFAULT_WIDTH),n}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=new WeakMap;e.default=function(){function t(e,n,i,o,a,s,l){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),r.set(this,{viewportHeight:e,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:a,onlyFullyVisible:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return i(t,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),i(t,[{key:"calculate",value:function(){for(var e=0,n=!0,i=[],o=r.get(this),a=o.onlyFullyVisible,s=o.overrideFn,l=o.rowHeightFn,u=o.scrollOffset,c=o.totalRows,h=o.viewportHeight,d=o.horizontalScrollbarHeight||0,f=void 0,p=0;c>p;p++)if(void 0===(f=l(p))&&(f=t.DEFAULT_HEIGHT),e>u||a||(this.startRow=p),u>e||e+f>u+h-d||(null===this.startRow&&(this.startRow=p),this.endRow=p),i.push(e),e+=f,a||(this.endRow=p),e>=u+h-d){n=!1;break}if(this.endRow===c-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var m=i[this.endRow]+f-i[this.startRow-1];if(m>h-d&&a||this.startRow--,m>=h-d)break}null!==this.startRow&&s&&s(this),this.startPosition=i[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.default=function(){function t(e,n,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.offset=e,this.total=n,this.countTH=i}return i(t,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.default=function(){function t(e,n,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.offset=e,this.total=n,this.countTH=i}return i(t,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),a=n(1),s=n(33),l=i(n(163)),u=i(n(164)),c=i(n(165)),h=i(n(166)),d=i(n(167)),f=i(n(169));e.default=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=[];if(this.guid="wt_"+(0,s.randomString)(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new d.default(this,e.table,e.wtRootElement),this.wtScroll=new c.default(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new l.default(this),this.selections=this.cloneSource.selections):(this.wtSettings=new h.default(this,e),this.wtTable=new d.default(this,e.table),this.wtScroll=new c.default(this),this.wtViewport=new f.default(this),this.wtEvent=new l.default(this),this.selections=this.getSetting("selections"),this.wtOverlays=new u.default(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var i=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;r>i;i++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(t,e){(0,o.fastInnerText)(e,n[t])}])}this.drawn=!1,this.drawInterrupted=!1}return r(t,[{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||(0,o.isVisible)(this.wtTable.TABLE)?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){if(1>=arguments.length||void 0===arguments[1]||!arguments[1])return this.wtTable.getCell(t);var e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),r=this.wtSettings.getSetting("fixedColumnsLeft");if(n>t.row&&r>t.col)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(t);if(n>t.row)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(r>t.col&&t.row>=e-i){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(t)}else{if(r>t.col)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(t);if(e>t.row&&t.row>e-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"update",value:function(t,e){return this.wtSettings.update(t,e)}},{key:"scrollVertical",value:function(t){return this.wtOverlays.topOverlay.scrollTo(t),this.getSetting("onScrollVertically"),this}},{key:"scrollHorizontal",value:function(t){return this.wtOverlays.leftOverlay.scrollTo(t),this.getSetting("onScrollHorizontally"),this}},{key:"scrollViewport",value:function(t){return this.wtScroll.scrollViewport(t),this}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(t){return!!this.cloneOverlay&&this.cloneOverlay.type===t}},{key:"exportSettingsAsClassNames",value:function(){var t=this,e=[],n=[];(0,a.objectEach)({rowHeaders:["array"],columnHeaders:["array"]},function(i,r){i.indexOf("array")>-1&&t.getSetting(r).length&&n.push("ht"+(0,s.toUpperCaseFirst)(r)),e.push("ht"+(0,s.toUpperCaseFirst)(r))}),(0,o.removeClass)(this.wtTable.wtRootElement.parentNode,e),(0,o.addClass)(this.wtTable.wtRootElement.parentNode,n)}},{key:"getSetting",value:function(t,e,n,i,r){return this.wtSettings.getSetting(t,e,n,i,r)}},{key:"hasSetting",value:function(t){return this.wtSettings.has(t)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0,e.toSingleLine=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return(0,i.arrayReduce)(t,function(t,e,i){return t+e.replace(/(?:\r?\n\s+)/g,"")+(n[i]?n[i]:"")},"").trim()};var i=n(2)},function(t,e,n){"use strict";function i(t){var e=this,n=new s.default(t);this.instance=t;var i=[null,null];this.dblClickTimeout=[null,null];var l=function(t){var n=document.activeElement,a=(0,o.partial)(r.getParent,t.realTarget),s=t.realTarget;if(s!==n&&a(0)!==n&&a(1)!==n){var l=e.parentCell(s);(0,r.hasClass)(s,"corner")?e.instance.getSetting("onCellCornerMouseDown",t,s):l.TD&&e.instance.hasSetting("onCellMouseDown")&&e.instance.getSetting("onCellMouseDown",t,l.coords,l.TD,e.instance),2!==t.button&&l.TD&&(i[0]=l.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout(function(){i[0]=null},1e3))}},u=function(t){e.instance.touchMoving=!0},c=function(t){if(2!==t.button){var n=e.parentCell(t.realTarget);n.TD===i[0]&&n.TD===i[1]?((0,r.hasClass)(t.realTarget,"corner")?e.instance.getSetting("onCellCornerDblClick",t,n.coords,n.TD,e.instance):e.instance.getSetting("onCellDblClick",t,n.coords,n.TD,e.instance),i[0]=null,i[1]=null):n.TD===i[0]?(e.instance.getSetting("onCellMouseUp",t,n.coords,n.TD,e.instance),i[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout(function(){i[1]=null},500)):n.TD&&e.instance.hasSetting("onCellMouseUp")&&e.instance.getSetting("onCellMouseUp",t,n.coords,n.TD,e.instance)}};if(n.addEventListener(this.instance.wtTable.holder,"mousedown",l),n.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(t){var n,i,o;e.instance.hasSetting("onCellMouseOver")&&(n=e.instance.wtTable.TABLE,i=(0,r.closestDown)(t.realTarget,["TD","TH"],n),o=e.instance.cloneSource||e.instance,i&&i!==o.lastMouseOver&&(0,r.isChildOf)(i,n)&&(o.lastMouseOver=i,e.instance.getSetting("onCellMouseOver",t,e.instance.wtTable.getCoords(i),i,e.instance)))}),n.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(t){var n=void 0,i=void 0,o=void 0;e.instance.hasSetting("onCellMouseOut")&&(n=e.instance.wtTable.TABLE,i=(0,r.closestDown)(t.realTarget,["TD","TH"],n),o=(0,r.closestDown)(t.relatedTarget,["TD","TH"],n),i&&i!==o&&(0,r.isChildOf)(i,n)&&e.instance.getSetting("onCellMouseOut",t,e.instance.wtTable.getCoords(i),i,e.instance))}),n.addEventListener(this.instance.wtTable.holder,"mouseup",c),this.instance.wtTable.holder.parentNode.parentNode&&(0,a.isMobileBrowser)()&&!e.instance.wtTable.isWorkingOnClone()){var h="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");n.addEventListener(this.instance.wtTable.holder,"touchstart",function(t){e.instance.touchApplied=!0,(0,r.isChildOf)(t.target,h)&&function(t){n.addEventListener(this,"touchmove",u),e.checkIfTouchMove=setTimeout(function(){!0===e.instance.touchMoving&&(e.instance.touchMoving=void 0,n.removeEventListener("touchmove",u,!1)),l(t)},30)}.call(t.target,t)}),n.addEventListener(this.instance.wtTable.holder,"touchend",function(t){e.instance.touchApplied=!1,(0,r.isChildOf)(t.target,h)&&function(t){clearTimeout(void 0),t.preventDefault(),c(t)}.call(t.target,t)}),e.instance.momentumScrolling||(e.instance.momentumScrolling={}),n.addEventListener(this.instance.wtTable.holder,"scroll",function(t){clearTimeout(e.instance.momentumScrolling._timeout),e.instance.momentumScrolling.ongoing||e.instance.getSetting("onBeforeTouchScroll"),e.instance.momentumScrolling.ongoing=!0,e.instance.momentumScrolling._timeout=setTimeout(function(){e.instance.touchApplied||(e.instance.momentumScrolling.ongoing=!1,e.instance.getSetting("onAfterMomentumScroll"))},200)})}n.addEventListener(window,"resize",function(){"none"!==e.instance.getSetting("stretchH")&&e.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),n.destroy()}}e.__esModule=!0;var r=n(0),o=n(36),a=n(27),s=function(t){return t&&t.__esModule?t:{default:t}}(n(4));i.prototype.parentCell=function(t){var e={},n=this.instance.wtTable.TABLE,i=(0,r.closestDown)(t,["TD","TH"],n);return i?(e.coords=this.instance.wtTable.getCoords(i),e.TD=i):(0,r.hasClass)(t,"wtBorder")&&(0,r.hasClass)(t,"current")?(e.coords=this.instance.selections.current.cellRange.highlight,e.TD=this.instance.wtTable.getCell(e.coords)):(0,r.hasClass)(t,"wtBorder")&&(0,r.hasClass)(t,"area")&&this.instance.selections.area.cellRange&&(e.coords=this.instance.selections.area.cellRange.to,e.TD=this.instance.wtTable.getCell(e.coords)),e},e.default=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),a=n(2),s=n(20),l=n(27),u=i(n(4)),c=i(n(32));e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wot=e,this.instance=this.wot,this.eventManager=new u.default(this.wot),this.wot.update("scrollbarWidth",(0,o.getScrollbarWidth)()),this.wot.update("scrollbarHeight",(0,o.getScrollbarWidth)()),this.scrollableElement=(0,o.getScrollableElement)(this.wot.wtTable.TABLE),this.prepareOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.registerListeners()}return r(t,[{key:"prepareOverlays",value:function(){var t=!1;return this.topOverlay?t=this.topOverlay.updateStateOfRendering()||t:this.topOverlay=c.default.createOverlay(c.default.CLONE_TOP,this.wot),c.default.hasOverlay(c.default.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),c.default.hasOverlay(c.default.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?t=this.bottomOverlay.updateStateOfRendering()||t:this.bottomOverlay=c.default.createOverlay(c.default.CLONE_BOTTOM,this.wot),this.leftOverlay?t=this.leftOverlay.updateStateOfRendering()||t:this.leftOverlay=c.default.createOverlay(c.default.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?t=this.topLeftCornerOverlay.updateStateOfRendering()||t:this.topLeftCornerOverlay=c.default.createOverlay(c.default.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?t=this.bottomLeftCornerOverlay.updateStateOfRendering()||t:this.bottomLeftCornerOverlay=c.default.createOverlay(c.default.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=c.default.createOverlay(c.default.CLONE_DEBUG,this.wot)),t}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var t=this,e=this.topOverlay.mainTableScrollableElement,n=this.leftOverlay.mainTableScrollableElement,i=[];for(i.push([document.documentElement,"keydown",function(e){return t.onKeyDown(e)}]),i.push([document.documentElement,"keyup",function(){return t.onKeyUp()}]),i.push([document,"visibilitychange",function(){return t.onKeyUp()}]),i.push([e,"scroll",function(e){return t.onTableScroll(e)}]),e!==n&&i.push([n,"scroll",function(e){return t.onTableScroll(e)}]),this.topOverlay.needFullRender&&(i.push([this.topOverlay.clone.wtTable.holder,"scroll",function(e){return t.onTableScroll(e)}]),i.push([this.topOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}])),this.bottomOverlay.needFullRender&&(i.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(e){return t.onTableScroll(e)}]),i.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}])),this.leftOverlay.needFullRender&&(i.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(e){return t.onTableScroll(e)}]),i.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}])),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&i.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&i.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(e){return t.onTableScroll(e)}]),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&i.push([window,"wheel",function(e){var n=void 0,i=e.wheelDeltaY||e.deltaY,r=e.wheelDeltaX||e.deltaX;t.topOverlay.clone.wtTable.holder.contains(e.realTarget)?n="top":t.bottomOverlay.clone&&t.bottomOverlay.clone.wtTable.holder.contains(e.realTarget)?n="bottom":t.leftOverlay.clone.wtTable.holder.contains(e.realTarget)?n="left":t.topLeftCornerOverlay&&t.topLeftCornerOverlay.clone&&t.topLeftCornerOverlay.clone.wtTable.holder.contains(e.realTarget)?n="topLeft":t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&t.bottomLeftCornerOverlay.clone.wtTable.holder.contains(e.realTarget)&&(n="bottomLeft"),("top"==n&&0!==i||"left"==n&&0!==r||"bottom"==n&&0!==i||("topLeft"===n||"bottomLeft"===n)&&(0!==i||0!==r))&&e.preventDefault()}]);i.length;){var r=i.pop();this.eventManager.addEventListener(r[0],r[1],r[2]),this.registeredListeners.push(r)}}},{key:"deregisterListeners",value:function(){for(;this.registeredListeners.length;){var t=this.registeredListeners.pop();this.eventManager.removeEventListener(t[0],t[1],t[2])}}},{key:"onTableScroll",value:function(t){if(!(0,l.isMobileBrowser)()){var e=this.leftOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(n!==window&&i!==window&&!t.target.contains(n)||e!==window&&i!==window&&!t.target.contains(e))||("scroll"===t.type?this.syncScrollPositions(t):this.translateMouseWheelToScroll(t))}}},{key:"onKeyDown",value:function(t){this.keyPressed=(0,s.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=this.topOverlay.clone.wtTable.holder,n=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,i=this.leftOverlay.clone.wtTable.holder,r=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,o=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,a=t.wheelDeltaY||-1*t.deltaY,s=t.wheelDeltaX||-1*t.deltaX,l=null,u={type:"wheel"},c=t.target,h=null;for(1===t.deltaMode&&(a*=120,s*=120);c!=document&&null!=c;){if(c.className.indexOf("wtHolder")>-1){l=c;break}c=c.parentNode}return u.target=l,l===r||l===o?(this.syncScrollPositions(u,-.2*s,"x"),this.syncScrollPositions(u,-.2*a,"y")):(l===e||l===n?h=a:l===i&&(h=s),this.syncScrollPositions(u,-.2*h)),!1}},{key:"syncScrollPositions",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.destroyed){if(0===arguments.length)return void this.syncScrollWithMaster();var i=this.leftOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,a=t.target,s=0,l=!1,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=!1,m=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(u=this.topOverlay.clone.wtTable.holder),this.bottomOverlay.needFullRender&&(f=this.bottomOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(c=this.leftOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(h=this.topLeftCornerOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(d=this.bottomLeftCornerOverlay.clone.wtTable.holder),a===document&&(a=window),a===i||a===r?(s=(0,o.getScrollLeft)(m?this.scrollableElement:a),this.horizontalScrolling=this.overlayScrollPositions.master.left!==s,this.overlayScrollPositions.master.left=s,l=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(u&&u.scrollLeft!==s&&(null==e&&this.pendingScrollCallbacks.top.left++,u.scrollLeft=s,p=i!==window),f&&f.scrollLeft!==s&&(null==e&&this.pendingScrollCallbacks.bottom.left++,f.scrollLeft=s,p=i!==window)),s=(0,o.getScrollTop)(a),this.verticalScrolling=this.overlayScrollPositions.master.top!==s,this.overlayScrollPositions.master.top=s,l=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:c&&c.scrollTop!==s&&(null==e&&this.pendingScrollCallbacks.left.top++,c.scrollTop=s,p=r!==window)):a===f?(s=(0,o.getScrollLeft)(a),this.overlayScrollPositions.bottom.left=s,l=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(null==e&&this.pendingScrollCallbacks.master.left++,i.scrollLeft=s,u&&u.scrollLeft!==s&&(null==e&&this.pendingScrollCallbacks.top.left++,u.scrollLeft=s,p=r!==window)),null!==e&&(l=!0,r.scrollTop+=e)):a===u?(s=(0,o.getScrollLeft)(a),this.overlayScrollPositions.top.left=s,l=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(null==e&&this.pendingScrollCallbacks.master.left++,i.scrollLeft=s),null!==e&&(l=!0,r.scrollTop+=e),f&&f.scrollLeft!==s&&(null==e&&this.pendingScrollCallbacks.bottom.left++,f.scrollLeft=s,p=r!==window)):a===c?(s=(0,o.getScrollTop)(a),this.overlayScrollPositions.left.top!==s&&(this.overlayScrollPositions.left.top=s,l=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(null==e&&this.pendingScrollCallbacks.master.top++,r.scrollTop=s)),null!==e&&(l=!0,r.scrollLeft+=e)):a!==h&&a!==d||null!==e&&(l=!0,"x"===n?r.scrollLeft+=e:"y"===n&&(r.scrollTop+=e)),!this.keyPressed&&l&&"scroll"===t.type&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),p&&(this.delegatedScrollCallback=!0))}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=(0,o.getScrollableElement)(this.wot.wtTable.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var e=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=e.clientWidth,i=e.clientHeight;n===this.spreaderLastSize.width&&i===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.leftOverlay.refresh(t),this.topOverlay.refresh(t),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(t),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(t),this.debug&&this.debug.refresh(t)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot.getSetting("totalColumns"),n=this.wot.getSetting("totalRows"),i=this.wot.wtViewport.getRowHeaderWidth(),r=this.wot.wtViewport.getColumnHeaderHeight(),o=this.wot.wtTable.hider.style;o.width=i+this.leftOverlay.sumCellSizes(0,e)+"px",o.height=r+this.topOverlay.sumCellSizes(0,n)+1+"px",this.topOverlay.adjustElementsSize(t),this.leftOverlay.adjustElementsSize(t),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(t){if(!t)return null;var e=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return(0,a.arrayEach)(e,function(e,i){e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)}),n}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(5);e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wot=e,this.instance=e}return i(t,[{key:"scrollViewport",value:function(t){if(this.wot.drawn){var e=this._getVariables(),n=e.topOverlay,i=e.leftOverlay,r=e.totalRows,o=e.totalColumns,a=e.fixedRowsTop,s=e.fixedRowsBottom,l=e.fixedColumnsLeft;if(0>t.row||t.row>Math.max(r-1,0))throw Error("row "+t.row+" does not exist");if(0>t.col||t.col>Math.max(o-1,0))throw Error("column "+t.col+" does not exist");t.row>=a&&t.row<this.getFirstVisibleRow()?n.scrollTo(t.row):t.row>this.getLastVisibleRow()&&r-s>t.row&&n.scrollTo(t.row,!0),t.col>=l&&t.col<this.getFirstVisibleColumn()?i.scrollTo(t.col):t.col>this.getLastVisibleColumn()&&i.scrollTo(t.col,!0)}}},{key:"getFirstVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,i=t.wtViewport,a=t.totalRows,s=t.fixedRowsTop,l=n.getFirstVisibleRow();if(e.mainTableScrollableElement===window){var u=(0,r.offset)(n.wtRootElement),c=(0,r.innerHeight)(n.hider),h=(0,r.innerHeight)(window),d=(0,r.getScrollTop)(window);if(d>=u.top+c-h){var f=i.getColumnHeaderHeight();f+=e.sumCellSizes(0,s),(0,o.rangeEachReverse)(a,1,function(t){if(f+=e.sumCellSizes(t-1,t),d>=u.top+c-f)return l=t,!1})}}return l}},{key:"getLastVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,i=t.wtViewport,a=t.totalRows,s=n.getLastVisibleRow();if(e.mainTableScrollableElement===window){var l=(0,r.offset)(n.wtRootElement),u=(0,r.innerHeight)(window),c=(0,r.getScrollTop)(window);if(l.top>c){var h=i.getColumnHeaderHeight();(0,o.rangeEach)(1,a,function(t){if(h+=e.sumCellSizes(t-1,t),l.top+h-c>=u)return s=t-2,!1})}}return s}},{key:"getFirstVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,i=t.wtViewport,a=t.totalColumns,s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===window){var l=(0,r.offset)(n.wtRootElement),u=(0,r.innerWidth)(n.hider),c=(0,r.innerWidth)(window),h=(0,r.getScrollLeft)(window);if(h>=l.left+u-c){var d=i.getRowHeaderWidth();(0,o.rangeEachReverse)(a,1,function(t){if(d+=e.sumCellSizes(t-1,t),h>=l.left+u-d)return s=t,!1})}}return s}},{key:"getLastVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,i=t.wtViewport,a=t.totalColumns,s=n.getLastVisibleColumn();if(e.mainTableScrollableElement===window){var l=(0,r.offset)(n.wtRootElement),u=(0,r.innerWidth)(window),c=(0,r.getScrollLeft)(window);if(l.left>c){var h=i.getRowHeaderWidth();(0,o.rangeEach)(1,a,function(t){if(h+=e.sumCellSizes(t-1,t),l.left+h-c>=u)return s=t-2,!1})}}return s}},{key:"_getVariables",value:function(){var t=this.wot;return{topOverlay:t.wtOverlays.topOverlay,leftOverlay:t.wtOverlays.leftOverlay,wtTable:t.wtTable,wtViewport:t.wtViewport,totalRows:t.getSetting("totalRows"),totalColumns:t.getSetting("totalColumns"),fixedRowsTop:t.getSetting("fixedRowsTop"),fixedRowsBottom:t.getSetting("fixedRowsBottom"),fixedColumnsLeft:t.getSetting("fixedColumnsLeft")}}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(1);e.default=function(){function t(e,n){var i=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wot=e,this.instance=e,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,e,n){var o=i.getSetting("data",t,e);(0,r.fastInnerText)(n,void 0===o||null===o?"":o)},columnWidth:function(t){},rowHeight:function(t){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={};for(var a in this.defaults)if((0,o.hasOwnProperty)(this.defaults,a))if(void 0!==n[a])this.settings[a]=n[a];else{if(void 0===this.defaults[a])throw Error('A required setting "'+a+'" was not provided');this.settings[a]=this.defaults[a]}}return i(t,[{key:"update",value:function(t,e){if(void 0===e)for(var n in t)(0,o.hasOwnProperty)(t,n)&&(this.settings[n]=t[n]);else this.settings[t]=e;return this.wot}},{key:"getSetting",value:function(t,e,n,i,r){return"function"==typeof this.settings[t]?this.settings[t](e,n,i,r):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}]),t}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(0),s=n(36),l=i(n(51)),u=i((i(n(81)),n(159))),c=i(n(160)),h=i(n(168)),d=i(n(32));e.default=function(){function t(e,n){var i=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wot=e,this.instance=this.wot,this.TABLE=n,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,(0,a.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var r=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return i._modifyRowHeaderWidth(r)}}return o(t,[{key:"fixTableDomTree",value:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))}},{key:"createSpreader",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&(0,a.hasClass)(e,"wtHolder")||(n=document.createElement("div"),n.className="wtSpreader",e&&e.insertBefore(n,t),n.appendChild(t)),n.style.position="relative",n}},{key:"createHider",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&(0,a.hasClass)(e,"wtHolder")||(n=document.createElement("div"),n.className="wtHider",e&&e.insertBefore(n,t),n.appendChild(t)),n}},{key:"createHolder",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&(0,a.hasClass)(e,"wtHolder")||(n=document.createElement("div"),n.style.position="relative",n.className="wtHolder",e&&e.insertBefore(n,t),this.isWorkingOnClone()||(n.parentNode.className+="ht_master handsontable"),n.appendChild(t)),n}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=(0,a.getTrimmingContainer)(this.wtRootElement);if(!this.isWorkingOnClone())if(this.holder.parentNode.style.position="relative",t===window){this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else this.holder.style.width=(0,a.getStyle)(t,"width"),this.holder.style.height=(0,a.getStyle)(t,"height"),this.holder.style.overflow=""}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(t){var e=this.wot,n=e.wtOverlays,i=e.wtViewport,r=this.instance.getSetting("totalRows"),o=this.wot.getSetting("rowHeaders").length,s=this.wot.getSetting("columnHeaders").length,l=!1;if(!this.isWorkingOnClone()&&(this.holderOffset=(0,a.offset)(this.holder),t=i.createRenderCalculators(t),o&&!this.wot.getSetting("fixedColumnsLeft"))){var h=n.leftOverlay.getScrollPosition(),f=this.correctHeaderWidth;this.correctHeaderWidth=h>0,f!==this.correctHeaderWidth&&(t=!1)}if(this.isWorkingOnClone()||(l=n.prepareOverlays()),t)this.isWorkingOnClone()||i.createVisibleCalculators(),n&&n.refresh(!0);else{this.tableOffset=this.isWorkingOnClone()?this.wot.cloneSource.wtTable.tableOffset:(0,a.offset)(this.TABLE);var p=void 0;p=d.default.isOverlayTypeOf(this.wot.cloneOverlay,d.default.CLONE_DEBUG)||d.default.isOverlayTypeOf(this.wot.cloneOverlay,d.default.CLONE_TOP)||d.default.isOverlayTypeOf(this.wot.cloneOverlay,d.default.CLONE_TOP_LEFT_CORNER)?0:d.default.isOverlayTypeOf(this.instance.cloneOverlay,d.default.CLONE_BOTTOM)||d.default.isOverlayTypeOf(this.instance.cloneOverlay,d.default.CLONE_BOTTOM_LEFT_CORNER)?Math.max(r-this.wot.getSetting("fixedRowsBottom"),0):i.rowsRenderCalculator.startRow;var m=void 0;m=d.default.isOverlayTypeOf(this.wot.cloneOverlay,d.default.CLONE_DEBUG)||d.default.isOverlayTypeOf(this.wot.cloneOverlay,d.default.CLONE_LEFT)||d.default.isOverlayTypeOf(this.wot.cloneOverlay,d.default.CLONE_TOP_LEFT_CORNER)||d.default.isOverlayTypeOf(this.wot.cloneOverlay,d.default.CLONE_BOTTOM_LEFT_CORNER)?0:i.columnsRenderCalculator.startColumn,this.rowFilter=new c.default(p,r,s),this.columnFilter=new u.default(m,this.wot.getSetting("totalColumns"),o),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(t),this.isWorkingOnClone()||(n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&n.bottomOverlay.resetFixedPosition(),n.leftOverlay.resetFixedPosition(),n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition()),l&&n.syncScrollWithMaster(),this.wot.drawn=!0,this}},{key:"_doDraw",value:function(){new h.default(this).render()}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll("."+t),n=0,i=e.length;i>n;n++)(0,a.removeClass)(e[n],t)}},{key:"refreshSelections",value:function(t){if(this.wot.selections){var e=this.wot.selections.length;if(t)for(var n=0;e>n;n++)this.wot.selections[n].settings.className&&this.removeClassFromCells(this.wot.selections[n].settings.className),this.wot.selections[n].settings.highlightHeaderClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightHeaderClassName),this.wot.selections[n].settings.highlightRowClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightRowClassName),this.wot.selections[n].settings.highlightColumnClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightColumnClassName);for(var i=0;e>i;i++)this.wot.selections[i].draw(this.wot,t)}}},{key:"getCell",value:function(t){if(this.isRowBeforeRenderedRows(t.row))return-1;if(this.isRowAfterRenderedRows(t.row))return-2;var e=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t.row)];return e?e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t.col)]:void 0}},{key:"getColumnHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[e];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getRowHeader",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var e=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return e?e.childNodes[0]:void 0}},{key:"getCoords",value:function(t){if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=(0,a.closest)(t,["TD","TH"])),null===t)return null;var e=t.parentNode,n=e.parentNode,i=(0,a.index)(e),r=t.cellIndex;return(0,a.overlayContainsElement)(d.default.CLONE_TOP_LEFT_CORNER,t)||(0,a.overlayContainsElement)(d.default.CLONE_TOP,t)?"THEAD"===n.nodeName&&(i-=n.childNodes.length):i=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i),r=(0,a.overlayContainsElement)(d.default.CLONE_TOP_LEFT_CORNER,t)||(0,a.overlayContainsElement)(d.default.CLONE_LEFT,t)?this.columnFilter.offsettedTH(r):this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),new l.default(i,r)}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(t){return this.rowFilter&&0>this.rowFilter.sourceToRendered(t)&&t>=0}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&0>this.columnFilter.sourceToRendered(t)&&t>=0}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)>this.getLastVisibleColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var t=this.wot.wtViewport.columnsRenderCalculator.count,e=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(d.default.CLONE_DEBUG))t=e;else if(this.wot.isOverlayName(d.default.CLONE_LEFT)||this.wot.isOverlayName(d.default.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(d.default.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),e);return t}},{key:"getRenderedRowsCount",value:function(){var t=this.wot.wtViewport.rowsRenderCalculator.count,e=this.wot.getSetting("totalRows");return this.wot.isOverlayName(d.default.CLONE_DEBUG)?t=e:this.wot.isOverlayName(d.default.CLONE_TOP)||this.wot.isOverlayName(d.default.CLONE_TOP_LEFT_CORNER)?t=Math.min(this.wot.getSetting("fixedRowsTop"),e):(this.wot.isOverlayName(d.default.CLONE_BOTTOM)||this.wot.isOverlayName(d.default.CLONE_BOTTOM_LEFT_CORNER))&&(t=Math.min(this.wot.getSetting("fixedRowsBottom"),e)),t}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(t){var e=this.wot.wtSettings.settings.rowHeight(t),n=this.wot.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}},{key:"getColumnHeaderHeight",value:function(t){var e=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(t){var e=this.wot.wtSettings.settings.columnWidth;return"function"==typeof e?e=e(t):"object"===(void 0===e?"undefined":r(e))&&(e=e[t]),e||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(t){var e=this.getColumnWidth(t),n=null==e?this.instance.wtSettings.settings.defaultColumnWidth:e,i=this.wot.wtViewport.columnsRenderCalculator;if(i){var r=i.getStretchedColumnWidth(t,n);r&&(n=r)}return n}},{key:"_modifyRowHeaderWidth",value:function(t){var e=(0,s.isFunction)(t)?t():null;return Array.isArray(e)?(e=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);t.length>e;e++)n[e]=t[e];return n}return Array.from(t)}(e)),e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){return"number"!=typeof t&&(t=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&t++,t}}]),t}()},function(t,e,n){"use strict";function i(t,e){var n=document.createElement("TH");return e.insertBefore(n,t),e.removeChild(t),n}function r(t,e){var n=document.createElement("TD");return e.insertBefore(n,t),e.removeChild(t),n}e.__esModule=!0;var o=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(0),s=function(t){return t&&t.__esModule?t:{default:t}}(n(32)),l=!1;e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wtTable=e,this.wot=e.instance,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0}return o(t,[{key:"render",value:function(){if(!this.wtTable.isWorkingOnClone()){var t={};if(this.wot.getSetting("beforeDraw",!0,t),!0===t.skipRender)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e=this.wtTable.getRenderedColumnsCount(),n=this.wtTable.getRenderedRowsCount(),i=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),o=void 0,l=!1;if((s.default.isOverlayTypeOf(this.wot.cloneOverlay,s.default.CLONE_BOTTOM)||s.default.isOverlayTypeOf(this.wot.cloneOverlay,s.default.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),0>i||(this.adjustAvailableNodes(),l=!0,this.renderColumnHeaders(),this.renderRows(r,n,e),this.wtTable.isWorkingOnClone()||(o=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(e),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),l||this.adjustAvailableNodes(),this.removeRedundantRows(n),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(s.default.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(s.default.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var u=(0,a.outerWidth)(this.wtTable.hider),c=(0,a.outerWidth)(this.wtTable.TABLE);if(0!==u&&c!==u&&this.adjustColumnWidths(e),o!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var h=this.wtTable.getFirstRenderedColumn(),d=this.wtTable.getLastRenderedColumn(),f=this.wot.getSetting("defaultColumnWidth"),p=this.wot.getSetting("rowHeaderWidth");if(null!=(p=this.instance.getSetting("onModifyRowHeaderWidth",p)))for(var m=0;this.rowHeaderCount>m;m++){var g=Array.isArray(p)?p[m]:p;g=null==g?f:g,this.COLGROUP.childNodes[m].style.width=g+"px"}for(var v=h;d>v;v++){var y=this.wtTable.getStretchedColumnWidth(v);this.COLGROUP.childNodes[this.columnFilter.sourceToRendered(v)+this.rowHeaderCount].style.width=y+"px"}}this.wot.getSetting("onDraw",!0)}}},{key:"removeRedundantRows",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{key:"renderRows",value:function(t,e,n){for(var i=void 0,r=0,o=this.rowFilter.renderedToSource(r),a=this.wtTable.isWorkingOnClone();t>o&&o>=0&&(!l&&r>1e3&&(l=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),void 0===e||r!==e);){if(i=this.getOrCreateTrForRow(r,i),this.renderRowHeaders(o,i),this.adjustColumns(i,n+this.rowHeaderCount),this.renderCells(o,i,n),a&&!this.wot.isOverlayName(s.default.CLONE_BOTTOM)||this.resetOversizedRow(o),i.firstChild){var u=this.wot.wtTable.getRowHeight(o);u?(u--,i.firstChild.style.height=u+"px"):i.firstChild.style.height=""}r++,o=this.rowFilter.renderedToSource(r)}}},{key:"resetOversizedRow",value:function(t){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[t]&&(this.wot.wtViewport.oversizedRows[t]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var t=this.instance.wtTable.TBODY.childNodes.length,e=t*this.instance.wtSettings.settings.defaultRowHeight,n=(0,a.innerHeight)(this.instance.wtTable.TBODY)-1,i=void 0,r=void 0,o=void 0,s=void 0,l=void 0;if(this.instance.getSetting("totalRows"),e!==n||this.instance.getSetting("fixedRowsBottom"))for(;t;)t--,o=this.instance.wtTable.rowFilter.renderedToSource(t),i=this.instance.wtTable.getRowHeight(o),s=this.instance.wtTable.getTrForRow(o),l=s.querySelector("th"),r=l?(0,a.innerHeight)(l):(0,a.innerHeight)(s)-1,(!i&&r>this.instance.wtSettings.settings.defaultRowHeight||r>i)&&(this.instance.wtViewport.oversizedRows[o]=++r)}}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]&&!this.wtTable.isWorkingOnClone()){for(var e=this.wtTable.getRenderedColumnsCount(),n=0;this.columnHeaderCount>n;n++)for(var i=-1*this.rowHeaderCount;e>i;i++)this.markIfOversizedColumnHeader(i);this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wot.getSetting("columnHeaders"),e=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,i=0,r=t.length;r>i;i++)if(n[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height=n[i]+"px"}}},{key:"markIfOversizedColumnHeader",value:function(t){for(var e=this.wot.wtTable.columnFilter.renderedToSource(t),n=this.columnHeaderCount,i=this.wot.wtSettings.settings.defaultRowHeight,r=void 0,o=void 0,s=void 0,l=this.wot.getSetting("columnHeaderHeight")||[];n;)n--,r=this.wot.wtTable.getColumnHeaderHeight(n),(o=this.wot.wtTable.getColumnHeader(e,n))&&(s=(0,a.innerHeight)(o),(!r&&s>i||s>r)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(l)?null!=l[n]&&(this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.wot.wtViewport.oversizedColumnHeaders[n]=l),(l[n]||l)>this.wot.wtViewport.oversizedColumnHeaders[n]&&(this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}},{key:"renderCells",value:function(t,e,n){for(var i=void 0,o=void 0,s=0;n>s;s++)o=this.columnFilter.renderedToSource(s),"TH"==(i=0===s?e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)]:i.nextSibling).nodeName&&(i=r(i,e)),(0,a.hasClass)(i,"hide")||(i.className=""),i.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(t,o,i);return i}},{key:"adjustColumnWidths",value:function(t){var e=0,n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=this.wot.getSetting("defaultColumnWidth"),r=this.wot.getSetting("rowHeaderWidth");if(n.scrollHeight>n.offsetHeight&&(e=(0,a.getScrollbarWidth)()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-e),null!=(r=this.instance.getSetting("onModifyRowHeaderWidth",r)))for(var o=0;this.rowHeaderCount>o;o++){var s=Array.isArray(r)?r[o]:r;s=null==s?i:s,this.COLGROUP.childNodes[o].style.width=s+"px"}for(var l=0;t>l;l++)this.COLGROUP.childNodes[l+this.rowHeaderCount].style.width=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(l))+"px"}},{key:"appendToTbody",value:function(t){this.TBODY.appendChild(t),this.wtTable.tbodyChildrenLength++}},{key:"getOrCreateTrForRow",value:function(t,e){var n=void 0;return this.wtTable.tbodyChildrenLength>t?n=0===t?this.TBODY.firstChild:e.nextSibling:(n=this.createRow(),this.appendToTbody(n)),n.className&&n.removeAttribute("class"),n}},{key:"createRow",value:function(){for(var t=document.createElement("TR"),e=0;this.rowHeaderCount>e;e++)t.appendChild(document.createElement("TH"));return t}},{key:"renderRowHeader",value:function(t,e,n){n.className="",n.removeAttribute("style"),this.rowHeaders[e](t,n,e)}},{key:"renderRowHeaders",value:function(t,e){for(var n=e.firstChild,r=0;this.rowHeaderCount>r;r++)n?"TD"==n.nodeName&&(n=i(n,e)):(n=document.createElement("TH"),e.appendChild(n)),this.renderRowHeader(t,r,n),n=n.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups(),this.adjustThead()}},{key:"renderColumnHeaders",value:function(){if(this.columnHeaderCount)for(var t=this.wtTable.getRenderedColumnsCount(),e=0;this.columnHeaderCount>e;e++)for(var n=this.getTrForColumnHeaders(e),i=-1*this.rowHeaderCount;t>i;i++){var r=this.columnFilter.renderedToSource(i);this.renderColumnHeader(e,r,n.childNodes[i+this.rowHeaderCount])}}},{key:"adjustColGroups",value:function(){for(var t=this.wtTable.getRenderedColumnsCount();t+this.rowHeaderCount>this.wtTable.colgroupChildrenLength;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>t+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&(0,a.addClass)(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var t=this.wtTable.getRenderedColumnsCount(),e=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,i=this.columnHeaders.length;i>n;n++){for((e=this.THEAD.childNodes[n])||(e=document.createElement("TR"),this.THEAD.appendChild(e)),this.theadChildrenLength=e.childNodes.length;t+this.rowHeaderCount>this.theadChildrenLength;)e.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>t+this.rowHeaderCount;)e.removeChild(e.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(var o=this.columnHeaders.length;r>o;o++)this.THEAD.removeChild(this.THEAD.lastChild)}else e&&(0,a.empty)(e)}},{key:"getTrForColumnHeaders",value:function(t){return this.THEAD.childNodes[t]}},{key:"renderColumnHeader",value:function(t,e,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[t](e,n,t)}},{key:"adjustColumns",value:function(t,e){for(var n=t.childNodes.length;e>n;)t.appendChild(document.createElement("TD")),n++;for(;n>e;)t.removeChild(t.lastChild),n--}},{key:"removeRedundantColumns",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}}]),t}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),a=n(1),s=i(n(4)),l=i(n(157)),u=i(n(158));e.default=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wot=e,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new s.default(this.wot),this.eventManager.addEventListener(window,"resize",function(){n.clientHeight=n.getWorkspaceHeight()})}return r(t,[{key:"getWorkspaceHeight",value:function(){var t=this.instance.wtOverlays.topOverlay.trimmingContainer,e=void 0,n=0;return t===window?n=document.documentElement.clientHeight:(e=(0,o.outerHeight)(t),n=e>0&&t.clientHeight>0?t.clientHeight:1/0),n}},{key:"getWorkspaceWidth",value:function(){var t=void 0,e=this.wot.getSetting("totalColumns"),n=this.instance.wtOverlays.leftOverlay.trimmingContainer,i=void 0,r=this.wot.getSetting("stretchH"),a=document.documentElement.offsetWidth;return this.wot.getSetting("preventOverflow")?(0,o.outerWidth)(this.instance.wtTable.wtRootElement):(t=this.wot.getSetting("freezeOverlays")?Math.min(a-this.getWorkspaceOffset().left,a):Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a),n===window&&e>0&&this.sumColumnWidths(0,e-1)>t?document.documentElement.clientWidth:n===window||"scroll"!=(i=(0,o.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"))&&"hidden"!=i&&"auto"!=i?"none"!==r&&r?t:Math.max(t,(0,o.outerWidth)(this.instance.wtTable.TABLE)):Math.max(t,n.clientWidth))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){for(var n=0;e>t;)n+=this.wot.wtTable.getColumnWidth(t),t++;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.instance.wtTable.holder,e=void 0,n=void 0;return n=document.createElement("div"),n.style.width="100%",n.style.height="1px",t.appendChild(n),e=n.offsetWidth,this.containerWidth=e,t.removeChild(n),e}},{key:"getWorkspaceOffset",value:function(){return(0,o.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return(0,o.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return(0,o.outerWidth)(this.wot.wtTable.TABLE)||(0,o.outerWidth)(this.wot.wtTable.TBODY)||(0,o.outerWidth)(this.wot.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,o.outerHeight)(this.wot.wtTable.THEAD)),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight(),e=void 0;return t===1/0?t:((e=this.getColumnHeaderHeight())>0&&(t-=e),t)}},{key:"getRowHeaderWidth",value:function(){var t=this.instance.getSetting("rowHeaderWidth"),e=this.instance.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var n=0,i=e.length;i>n;n++)this.rowHeaderWidth+=t[n]||t}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(e.length){var r=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,s=e.length;s>a;a++)r?(this.rowHeaderWidth+=(0,o.outerWidth)(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth(),e=void 0;return t===1/0?t:(e=this.getRowHeaderWidth())>0?t-e:t}},{key:"createRowsCalculator",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=void 0,i=void 0,r=void 0,a=void 0,s=void 0,l=void 0,c=void 0;return this.rowHeaderWidth=NaN,n=this.wot.wtSettings.settings.renderAllRows&&!e?1/0:this.getViewportHeight(),0>(i=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset())&&(i=0),r=this.wot.getSetting("fixedRowsTop"),s=this.wot.getSetting("fixedRowsBottom"),c=this.wot.getSetting("totalRows"),r&&(l=this.wot.wtOverlays.topOverlay.sumCellSizes(0,r),i+=l,n-=l),s&&this.wot.wtOverlays.bottomOverlay.clone&&(l=this.wot.wtOverlays.bottomOverlay.sumCellSizes(c-s,c),n-=l),a=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:(0,o.getScrollbarWidth)(),new u.default(n,i,this.wot.getSetting("totalRows"),function(e){return t.wot.wtTable.getRowHeight(e)},e?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,e,a)}},{key:"createColumnsCalculator",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.getViewportWidth(),i=void 0,r=void 0;if(this.columnHeaderHeight=NaN,0>(i=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset())&&(i=0),r=this.wot.getSetting("fixedColumnsLeft")){var a=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,r);i+=a,n-=a}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(n-=(0,o.getScrollbarWidth)()),new l.default(n,i,this.wot.getSetting("totalColumns"),function(e){return t.wot.wtTable.getColumnWidth(e)},e?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,e,this.wot.getSetting("stretchH"),function(e,n){return t.wot.getSetting("onBeforeStretchingColumnWidth",e,n)})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){var e=this.createRowsCalculator(!0),n=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(e)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){return!(!this.rowsVisibleCalculator||this.rowsRenderCalculator.startRow>t.startRow||t.startRow===this.rowsRenderCalculator.startRow&&t.startRow>0||t.endRow>this.rowsRenderCalculator.endRow||t.endRow===this.rowsRenderCalculator.endRow&&t.endRow<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){return!(!this.columnsVisibleCalculator||this.columnsRenderCalculator.startColumn>t.startColumn||t.startColumn===this.columnsRenderCalculator.startColumn&&t.startColumn>0||t.endColumn>this.columnsRenderCalculator.endColumn||t.endColumn===this.columnsRenderCalculator.endColumn&&t.endColumn<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){(0,a.objectEach)(this.hasOversizedColumnHeadersMarked,function(t,e,n){n[e]=void 0})}}]),t}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),a=n(11),s=n(1),l=n(27),u=i(n(4)),c=i(n(51));i(n(32)),e.default=function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),n&&(this.eventManager=new u.default(e),this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return r(t,[{key:"registerListeners",value:function(){var t=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return t.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return t.onMouseUp()});for(var e=0,n=this.main.childNodes.length;n>e;e++)!function(e,n){t.eventManager.addEventListener(t.main.childNodes[e],"mouseenter",function(n){return t.onMouseEnter(n,t.main.childNodes[e])})}(e)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){function n(t){(function(t){return t.clientY<Math.floor(r.top)||t.clientY>Math.ceil(r.top+r.height)||t.clientX<Math.floor(r.left)||t.clientX>Math.ceil(r.left+r.width)||void 0})(t)&&(i.eventManager.removeEventListener(document.body,"mousemove",n),e.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),(0,a.stopImmediatePropagation)(t);var i=this,r=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(document.body,"mousemove",n)}}},{key:"createBorders",value:function(t){this.main=document.createElement("div");var e=["top","left","bottom","right","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(var i=0;5>i;i++){var r=e[i],o=document.createElement("div");o.className="wtBorder "+(this.settings.className||""),this.settings[r]&&this.settings[r].hide&&(o.className+=" hidden"),(n=o.style).backgroundColor=this.settings[r]&&this.settings[r].color?this.settings[r].color:t.border.color,n.height=this.settings[r]&&this.settings[r].width?this.settings[r].width+"px":t.border.width+"px",n.width=this.settings[r]&&this.settings[r].width?this.settings[r].width+"px":t.border.width+"px",this.main.appendChild(o)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,l.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear(),this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder)),this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)}},{key:"createMultipleSelectorHandles",value:function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var t={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"};for(var e in t)(0,s.hasOwnProperty)(t,e)&&(this.selectionHandles.styles.bottomRightHitArea[e]=t[e],this.selectionHandles.styles.topLeftHitArea[e]=t[e]);var n={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var i in n)(0,s.hasOwnProperty)(n,i)&&(this.selectionHandles.styles.bottomRight[i]=n[i],this.selectionHandles.styles.topLeft[i]=n[i]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(t,e){return!(!this.wot.selections.area.cellRange||t==this.wot.selections.area.cellRange.to.row&&e==this.wot.selections.area.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,e,n,i,r,o){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(n-a,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(i-a,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(n-s/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(i-s/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(n+o,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(i+r,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(n+o-s/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(i+r-s/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(t,e)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),t==this.wot.wtSettings.getSetting("fixedRowsTop")||e==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){var e,n,i,r,a,s,u,h,d,f,p,m,g,v,y,w,b,_;_=this.wot.wtTable.getRenderedRowsCount();for(var E=0;_>E;E++){var T=this.wot.wtTable.rowFilter.renderedToSource(E);if(T>=t[0]&&t[2]>=T){g=T;break}}for(var C=_-1;C>=0;C--){var x=this.wot.wtTable.rowFilter.renderedToSource(C);if(x>=t[0]&&t[2]>=x){y=x;break}}_=this.wot.wtTable.getRenderedColumnsCount();for(var S=0;_>S;S++){var M=this.wot.wtTable.columnFilter.renderedToSource(S);if(M>=t[1]&&t[3]>=M){v=M;break}}for(var O=_-1;O>=0;O--){var R=this.wot.wtTable.columnFilter.renderedToSource(O);if(R>=t[1]&&t[3]>=R){w=R;break}}if(void 0===g||void 0===v)return void this.disappear();e=g!==y||v!==w,n=this.wot.wtTable.getCell(new c.default(g,v)),i=e?this.wot.wtTable.getCell(new c.default(y,w)):n,r=(0,o.offset)(n),a=e?(0,o.offset)(i):r,s=(0,o.offset)(this.wot.wtTable.TABLE),h=r.top,p=a.top+(0,o.outerHeight)(i)-h,f=r.left,m=a.left+(0,o.outerWidth)(i)-f,u=h-s.top-1,d=f-s.left-1;var A=(0,o.getComputedStyle)(n);parseInt(A.borderTopWidth,10)>0&&(u+=1,p=p>0?p-1:0),parseInt(A.borderLeftWidth,10)>0&&(d+=1,m=m>0?m-1:0),this.topStyle.top=u+"px",this.topStyle.left=d+"px",this.topStyle.width=m+"px",this.topStyle.display="block",this.leftStyle.top=u+"px",this.leftStyle.left=d+"px",this.leftStyle.height=p+"px",this.leftStyle.display="block";var P=Math.floor(this.settings.border.width/2);this.bottomStyle.top=u+p-P+"px",this.bottomStyle.left=d+"px",this.bottomStyle.width=m+"px",this.bottomStyle.display="block",this.rightStyle.top=u+"px",this.rightStyle.left=d+m-P+"px",this.rightStyle.height=p+1+"px",this.rightStyle.display="block",(0,l.isMobileBrowser)()||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(y,w)?this.cornerStyle.display="none":(this.cornerStyle.top=u+p-4+"px",this.cornerStyle.left=d+m-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none",b=(0,o.getTrimmingContainer)(this.wot.wtTable.TABLE),w===this.wot.getSetting("totalColumns")-1&&i.offsetLeft+(0,o.outerWidth)(i)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,o.innerWidth)(b)&&(this.cornerStyle.left=Math.floor(d+m-3-parseInt(this.cornerDefaultStyle.width,10)/2)+"px",this.cornerStyle.borderRightWidth=0),y===this.wot.getSetting("totalRows")-1&&i.offsetTop+(0,o.outerHeight)(i)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,o.innerHeight)(b)&&(this.cornerStyle.top=Math.floor(u+p-3-parseInt(this.cornerDefaultStyle.height,10)/2)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"),(0,l.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(g,v,u,d,m,p)}}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",(0,l.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"hasSetting",value:function(t){return"function"==typeof t?t():!!t}}]),t}()},function(t,e,n){"use strict";function i(t){h=!1;var e=this.getActiveEditor();if((0,r.isPrintableChar)(t.keyCode)||t.keyCode===r.KEY_CODES.BACKSPACE||t.keyCode===r.KEY_CODES.DELETE||t.keyCode===r.KEY_CODES.INSERT){var n=0;if(t.keyCode===r.KEY_CODES.C&&(t.ctrlKey||t.metaKey))return;e.isOpened()||(n+=10),e.htEditor&&e.instance._registerTimeout(setTimeout(function(){e.queryChoices(e.TEXTAREA.value),h=!0},n))}}e.__esModule=!0;var r=n(20),o=n(17),a=n(33),s=n(2),l=n(0),u=function(t){return t&&t.__esModule?t:{default:t}}(n(172)),c=u.default.prototype.extend();c.prototype.init=function(){u.default.prototype.init.apply(this,arguments),this.query=null,this.strippedChoices=[],this.rawChoices=[]},c.prototype.getValue=function(){var t=this,e=this.rawChoices.find(function(e){return t.stripValueIfNeeded(e)===t.TEXTAREA.value});return(0,o.isDefined)(e)?e:this.TEXTAREA.value},c.prototype.createElements=function(){u.default.prototype.createElements.apply(this,arguments),(0,l.addClass)(this.htContainer,"autocompleteEditor"),(0,l.addClass)(this.htContainer,-1===window.navigator.platform.indexOf("Mac")?"":"htMacScroll")};var h=!1;c.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",i),u.default.prototype.prepare.apply(this,arguments)},c.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto",u.default.prototype.open.apply(this,arguments),this.TEXTAREA_PARENT.style.overflow="";var t=this.htEditor.getInstance(),e=this,n=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible",this.focus(),t.updateSettings({colWidths:n?[(0,l.outerWidth)(this.TEXTAREA)-2]:void 0,width:n?(0,l.outerWidth)(this.TEXTAREA)+(0,l.getScrollbarWidth)()+2:void 0,afterRenderer:function(t,n,i,r,a,s){var l=e.cellProperties,u=l.filteringCaseSensitive,c=l.allowHtml,h=void 0,d=void 0;(a=(0,o.stringify)(a))&&!c&&-1!==(h=!0===u?a.indexOf(this.query):a.toLowerCase().indexOf(e.query.toLowerCase()))&&(d=a.substr(h,e.query.length),a=a.replace(d,"<strong>"+d+"</strong>")),t.innerHTML=a},autoColumnSize:!0,modifyColWidth:function(t,e){var i=this.getPlugin("autoColumnSize").widths;return i[e]&&(t=i[e]),n?t:t+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=(0,l.getScrollbarWidth)()+2+"px",h&&(h=!1),e.instance._registerTimeout(setTimeout(function(){e.queryChoices(e.TEXTAREA.value)},0))},c.prototype.close=function(){u.default.prototype.close.apply(this,arguments)},c.prototype.queryChoices=function(t){var e=this;this.query=t;var n=this.cellProperties.source;"function"==typeof n?n.call(this.cellProperties,t,function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])},c.prototype.updateChoicesList=function(t){var e=(0,l.getCaretPosition)(this.TEXTAREA),n=(0,l.getSelectionEndPosition)(this.TEXTAREA),i=this.cellProperties.sortByRelevance,r=this.cellProperties.filter,o=null,a=null;i&&(o=c.sortByRelevance(this.stripValueIfNeeded(this.getValue()),t,this.cellProperties.filteringCaseSensitive));var u=Array.isArray(o)?o.length:0;if(!1===r)u&&(a=o[0]);else{for(var h=[],d=0,f=t.length;f>d&&(!i||d<u);d++)h.push(u?t[o[d]]:t[d]);a=0,t=h}this.strippedChoices=t,this.htEditor.loadData((0,s.pivot)([t])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.instance.listen(!1),(0,l.setCaretPosition)(this.TEXTAREA,e,e===n?void 0:n)},c.prototype.flipDropdownIfNeeded=function(){var t=(0,l.offset)(this.TEXTAREA),e=(0,l.outerHeight)(this.TEXTAREA),n=this.getDropdownHeight(),i=(0,l.getTrimmingContainer)(this.instance.view.wt.wtTable.TABLE),r=i.scrollTop,o=(0,l.outerHeight)(this.instance.view.wt.wtTable.THEAD),a={row:0,col:0};i!==window&&(a=(0,l.offset)(i));var s=t.top-a.top-o+r,u=i.scrollHeight-s-o-e,c=n>u&&s>u;return c?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(c?s:u,n),c},c.prototype.limitDropdownIfNeeded=function(t,e){if(e>t){var n=0,i=0,r=0,o=null;do{n+=r=this.htEditor.getRowHeight(i)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,i++}while(t>n);o=n-r,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-o+"px"),this.setDropdownHeight(n-r)}},c.prototype.flipDropdown=function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0},c.prototype.unflipDropdown=function(){var t=this.htEditor.rootElement.style;"absolute"===t.position&&(t.position="",t.top=""),this.htEditor.flipped=void 0},c.prototype.updateDropdownHeight=function(){var t=this.htEditor.getColWidth(0)+(0,l.getScrollbarWidth)()+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},c.prototype.setDropdownHeight=function(t){this.htEditor.updateSettings({height:t})},c.prototype.finishEditing=function(t){t||this.instance.removeHook("beforeKeyDown",i),u.default.prototype.finishEditing.apply(this,arguments)},c.prototype.highlightBestMatchingChoice=function(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()},c.sortByRelevance=function(t,e,n){var i=[],r=void 0,s=t.length,l=void 0,u=void 0,c=[],h=void 0,d=e.length;if(0===s){for(h=0;d>h;h++)c.push(h);return c}for(h=0;d>h;h++)r=(0,a.stripTags)((0,o.stringify)(e[h])),-1!==(l=n?r.indexOf(t):r.toLowerCase().indexOf(t.toLowerCase()))&&(u=r.length-l-s,i.push({baseIndex:h,index:l,charsLeft:u,value:r}));for(i.sort(function(t,e){if(-1===e.index)return-1;if(-1===t.index)return 1;if(e.index>t.index)return-1;if(t.index>e.index)return 1;if(t.index===e.index){if(e.charsLeft>t.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0}),h=0,d=i.length;d>h;h++)c.push(i[h].baseIndex);return c},c.prototype.getDropdownHeight=function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return e>this.strippedChoices.length?this.strippedChoices.length*t+8:e*t},c.prototype.stripValueIfNeeded=function(t){return this.stripValuesIfNeeded([t])[0]},c.prototype.stripValuesIfNeeded=function(t){var e=this.cellProperties.allowHtml,n=(0,s.arrayMap)(t,function(t){return(0,o.stringify)(t)});return(0,s.arrayMap)(n,function(t){return e?t:(0,a.stripTags)(t)})},c.prototype.allowKeyEventPropagation=function(t){var e=this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1,n=!1;return t===r.KEY_CODES.ARROW_DOWN&&e>0&&e<this.htEditor.countRows()-1&&(n=!0),t===r.KEY_CODES.ARROW_UP&&e>-1&&(n=!0),n},c.prototype.discardEditor=function(t){u.default.prototype.discardEditor.apply(this,arguments),this.instance.view.render()},e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var i=n(20),r=n(1),o=n(0),a=n(11),s=function(t){return t&&t.__esModule?t:{default:t}}(n(53)),l=s.default.prototype.extend();l.prototype.createElements=function(){s.default.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()},l.prototype.prepare=function(t,e,n,i,o,a){s.default.prototype.prepare.apply(this,arguments);var l=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(t,e){var n=this.getSourceData(e.row,e.col);void 0!==n&&l.setValue(n),l.instance.destroyEditor()}};this.cellProperties.handsontable&&(0,r.extend)(u,a.handsontable),this.htOptions=u};var u=function(t){if(!(0,a.isImmediatePropagationStopped)(t)){var e,n,r=this.getActiveEditor(),o=r.htEditor.getInstance();if(t.keyCode==i.KEY_CODES.ARROW_DOWN)if(o.getSelected()||o.flipped){if(o.getSelected())if(o.flipped)e=o.getSelected()[0]+1;else if(!o.flipped){n=o.getSelected()[0];var s=o.countRows()-1;e=Math.min(s,n+1)}}else e=0;else t.keyCode==i.KEY_CODES.ARROW_UP&&(!o.getSelected()&&o.flipped?e=o.countRows()-1:o.getSelected()&&(o.flipped?(n=o.getSelected()[0],e=Math.max(0,n-1)):(n=o.getSelected()[0],e=n-1)));void 0!==e&&(0>e||o.flipped&&e>o.countRows()-1?o.deselectCell():o.selectCell(e,0),o.getData().length&&(t.preventDefault(),(0,a.stopImmediatePropagation)(t),r.instance.listen(),r.TEXTAREA.focus()))}};l.prototype.open=function(){this.instance.addHook("beforeKeyDown",u),s.default.prototype.open.apply(this,arguments),this.htEditor&&this.htEditor.destroy(),this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),(0,o.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)},l.prototype.close=function(){this.instance.removeHook("beforeKeyDown",u),this.instance.listen(),s.default.prototype.close.apply(this,arguments)},l.prototype.focus=function(){this.instance.listen(),s.default.prototype.focus.apply(this,arguments)},l.prototype.beginEditing=function(t){var e=this.instance.getSettings().onBeginEditing;e&&!1===e()||s.default.prototype.beginEditing.apply(this,arguments)},l.prototype.finishEditing=function(t,e){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}return s.default.prototype.finishEditing.apply(this,arguments)},l.prototype.assignHooks=function(){var t=this;this.instance.addHook("afterDestroy",function(){t.htEditor&&t.htEditor.destroy()})},e.default=l},function(t,e,n){"use strict";e.__esModule=!0,e.getNormalizedDate=function(t){var e=new Date(t);return isNaN(new Date(t+"T00:00").getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}},function(t,e,n){"use strict";!function(t){function n(t){return t.split('"').length-1}var i=function(t){var e,i,r,o,a,s,l,u=[],c=0;for((r=t.split("\n")).length>1&&""===r[r.length-1]&&r.pop(),e=0,i=r.length;i>e;e+=1){for(r[e]=r[e].split("\t"),o=0,a=r[e].length;a>o;o+=1)u[c]||(u[c]=[]),s&&0===o?(l=u[c].length-1,u[c][l]=u[c][l]+"\n"+r[e][0],s&&1&n(r[e][0])&&(s=!1,u[c][l]=u[c][l].substring(0,u[c][l].length-1).replace(/""/g,'"'))):o===a-1&&0===r[e][o].indexOf('"')&&1&n(r[e][o])?(u[c].push(r[e][o].substring(1).replace(/""/g,'"')),s=!0):(u[c].push(r[e][o].replace(/""/g,'"')),s=!1);s||(c+=1)}return u},r=function(t){var e,n,i,r,o,a="";for(e=0,n=t.length;n>e;e+=1){for(r=t[e].length,i=0;r>i;i+=1)i>0&&(a+="\t"),"string"==typeof(o=t[e][i])?o.indexOf("\n")>-1?a+='"'+o.replace(/"/g,'""')+'"':a+=o:a+=null===o||void 0===o?"":o;e!==n-1&&(a+="\n")}return a};e.parse=i,e.stringify=r}(window)},function(t,e,n){"use strict";e.__esModule=!0,e.RecordTranslator=void 0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.registerIdentity=function(t,e){s.set(t,e)},e.getTranslator=function(t){var e=void 0;if(!(t instanceof r.default)){if(!s.has(t))throw Error("Record translator was not registered for this object identity");t=s.get(t)}return l.has(t)?e=l.get(t):(e=new a(t),l.set(t,e)),e};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(84)),o=n(1),a=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.hot=e}return i(t,[{key:"toVisualRow",value:function(t){return this.hot.runHooks("unmodifyRow",t)}},{key:"toVisualColumn",value:function(t){return this.hot.runHooks("unmodifyCol",t)}},{key:"toVisual",value:function(t,e){return(0,o.isObject)(t)?{row:this.toVisualRow(t.row),column:this.toVisualColumn(t.column)}:[this.toVisualRow(t),this.toVisualColumn(e)]}},{key:"toPhysicalRow",value:function(t){return this.hot.runHooks("modifyRow",t)}},{key:"toPhysicalColumn",value:function(t){return this.hot.runHooks("modifyCol",t)}},{key:"toPhysical",value:function(t,e){return(0,o.isObject)(t)?{row:this.toPhysicalRow(t.row),column:this.toPhysicalColumn(t.column)}:[this.toPhysicalRow(t),this.toPhysicalColumn(e)]}}]),t}();e.RecordTranslator=a;var s=new WeakMap,l=new WeakMap},function(t,e,n){"use strict";e.__esModule=!0,e.registerAsRootInstance=function(t){i.set(t,!0)},e.hasValidParameter=function(t){return t===r},e.isRootInstance=function(t){return i.has(t)};var i=e.holder=new WeakMap,r=e.rootInstanceSymbol=Symbol("rootInstance")},function(t,e,n){"use strict";function i(){}e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(17),a=n(1);i.prototype={licenseKey:"trial",data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(t){var e,n,i,s;for(e=0,n=this.countCols();n>e;e++)if(""!==(i=this.getDataAtCell(t,e))&&null!==i&&(0,o.isDefined)(i))return"object"===(void 0===i?"undefined":r(i))&&(s=this.getCellMeta(t,e),(0,a.isObjectEquals)(this.getSchema()[s.prop],i));return!0},isEmptyCol:function(t){var e,n,i;for(e=0,n=this.countRows();n>e;e++)if(""!==(i=this.getDataAtCell(e,t))&&null!==i&&(0,o.isDefined)(i))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1},e.default=i},function(t,e,n){"use strict";e.__esModule=!0,e.getTranslatedPhrase=function(t,e,n){var s=(0,r.getLanguageDictionary)(t);if(null===s)return null;var l=s[e];if((0,a.isUndefined)(l))return null;var u=function(t,e){var n=t;return(0,i.arrayEach)((0,o.getPhraseFormatters)(),function(i){n=i(t,e)}),n}(l,n);return Array.isArray(u)?u[0]:u};var i=n(2),r=n(65),o=n(251),a=n(17)},function(t,e,n){"use strict";function i(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?e[1].toLowerCase()+"-"+e[2].toUpperCase():t}function r(t){(0,a.isDefined)(t)&&console.error((0,l.toSingleLine)(o,t))}e.__esModule=!0;var o=Object.freeze(Object.defineProperties(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],{raw:{value:Object.freeze(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])}}));e.extendNotExistingKeys=function(t,e){return(0,s.objectEach)(e,function(e,n){(0,a.isUndefined)(t[n])&&(t[n]=e)}),t},e.createCellHeadersRange=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;if(t>e){var r=[i,n];n=r[0],i=r[1]}return n+"-"+i},e.normalizeLanguageCode=i,e.applyLanguageSetting=function(t,e){var n=i(t);(0,u.hasLanguageDictionary)(n)?e.language=n:(e.language=u.DEFAULT_LANGUAGE_CODE,r(t))},e.warnUserAboutLanguageRegistration=r;var a=n(17),s=n(1),l=n(162),u=n(65)},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(1),o=n(5),a=n(17);e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return i(t,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),i(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,e){return this.generateSamples("row",e,t)}},{key:"generateColumnSamples",value:function(t,e){return this.generateSamples("col",e,t)}},{key:"generateSamples",value:function(t,e,n){var i=this,r=new Map;return"number"==typeof n&&(n={from:n,to:n}),(0,o.rangeEach)(n.from,n.to,function(n){var o=i.generateSample(t,e,n);r.set(n,o)}),r}},{key:"generateSample",value:function(t,e,n){var i=this,s=new Map,l=[],u=void 0;return(0,o.rangeEach)(e.from,e.to,function(e){var o=void 0;if("row"===t)o=i.dataFactory(n,e);else{if("col"!==t)throw Error("Unsupported sample type");o=i.dataFactory(e,n)}u=(0,r.isObject)(o)?Object.keys(o).length:Array.isArray(o)?o.length:(0,a.stringify)(o).length,s.has(u)||s.set(u,{needed:i.getSampleCount(),strings:[]});var c=s.get(u);c.needed&&(l.indexOf(o)>-1&&!i.allowDuplicates||(c.strings.push(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({value:o},"row"===t?"col":"row",e)),l.push(o),c.needed--))}),s}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=n(2),r=n(1),o=n(5),a={_arrayMap:[],getValueByIndex:function(t){var e=void 0;return void 0===(e=this._arrayMap[t])?null:e},getIndexByValue:function(t){var e=void 0;return-1===(e=this._arrayMap.indexOf(t))?null:e},insertItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=(0,i.arrayMax)(this._arrayMap)+1,a=[];return(0,o.rangeEach)(n-1,function(n){a.push(e._arrayMap.splice(t+n,0,r+n))}),a},removeItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=[];if(Array.isArray(t)){var o=[].concat(this._arrayMap);t.sort(function(t,e){return e-t}),r=(0,i.arrayReduce)(t,function(t,n){return e._arrayMap.splice(n,1),t.concat(o.slice(n,n+1))},[])}else r=this._arrayMap.splice(t,n);return r},unshiftItems:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.removeItems(t,e);this._arrayMap=(0,i.arrayMap)(this._arrayMap,function(t,e){var r=function(t){return(0,i.arrayReduce)(n,function(e,n){return t>n&&e++,e},0)}(t);return r&&(t-=r),t})},shiftItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._arrayMap=(0,i.arrayMap)(this._arrayMap,function(e){return t>e||(e+=n),e}),(0,o.rangeEach)(n-1,function(n){e._arrayMap.splice(t+n,0,t+n)})},clearMap:function(){this._arrayMap.length=0}};(0,r.defineGetter)(a,"MIXIN_NAME","arrayMapper",{writable:!1,enumerable:!1}),e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(5),o=0;e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.hot=e,this._element=null,this.state=o}return i(t,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=o}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){(0,r.isNumeric)(t)&&(this._element.style.top=t+"px"),(0,r.isNumeric)(e)&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){(0,r.isNumeric)(t)&&(this._element.style.width=t+"px"),(0,r.isNumeric)(e)&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){(0,r.isNumeric)(t)&&(this._element.style.marginTop=t+"px"),(0,r.isNumeric)(e)&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=0;e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.hot=e,this._element=null,this.state=r}return i(t,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=r}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){void 0!==t&&(this._element.style.top=t+"px"),void 0!==e&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){t&&(this._element.style.width=t+"px"),e&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){t&&(this._element.style.marginTop=t+"px"),e&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}()},function(t,e,n){"use strict";var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=Error;!function(t){function e(t,n){switch(void 0===t?"undefined":r(t)){case"undefined":case"boolean":case"string":case"number":return t===n;case"object":if(null===t)return null===n;if(y(t)){if(!y(n)||t.length!==n.length)return!1;for(var i=0,o=t.length;o>i;i++)if(!e(t[i],n[i]))return!1;return!0}var a=h(n).length;if(h(t).length!==a)return!1;for(i=0;a>i;i++)if(!e(t[i],n[i]))return!1;return!0;default:return!1}}function n(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function i(t){return"object"===(void 0===t?"undefined":r(t))?JSON.parse(JSON.stringify(t)):t}function a(t){for(var e,n=0,i=m.length;i>n;n++)if(m[n].obj===t.object){e=m[n];break}s(e.value,t.object,t.patches,""),t.patches.length&&u(e.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function s(t,e,o,a){for(var l=h(e),u=h(t),c=!1,d=u.length-1;d>=0;d--){var f=t[m=u[d]];if(e.hasOwnProperty(m)){var p=e[m];"object"==(void 0===f?"undefined":r(f))&&null!=f&&"object"==(void 0===p?"undefined":r(p))&&null!=p?s(f,p,o,a+"/"+n(m)):f!=p&&o.push({op:"replace",path:a+"/"+n(m),value:i(p)})}else o.push({op:"remove",path:a+"/"+n(m)}),c=!0}if(c||l.length!=u.length)for(d=0;l.length>d;d++){var m=l[d];t.hasOwnProperty(m)||o.push({op:"add",path:a+"/"+n(m),value:i(e[m])})}}function l(t){for(var e,n=0,i=t.length;i>n;){if(48>(e=t.charCodeAt(n))||e>57)return!1;n++}return!0}function u(t,e,n){for(var i,r,o=!1,a=0,s=e.length;s>a;){i=e[a],a++;for(var u=(i.path||"").split("/"),c=t,h=1,m=u.length,g=void 0;;){if(r=u[h],n&&void 0===g&&(void 0===c[r]?g=u.slice(0,h).join("/"):h==m-1&&(g=i.path),void 0!==g&&this.validator(i,a-1,t,g)),h++,void 0===r&&h>=m){o=p[i.op].call(i,c,r,t);break}if(y(c)){if("-"===r)r=c.length;else{if(n&&!l(r))throw new w("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a-1,i.path,i);r=parseInt(r,10)}if(h>=m){if(n&&"add"===i.op&&r>c.length)throw new w("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a-1,i.path,i);o=f[i.op].call(i,c,r,t);break}}else if(r&&-1!=r.indexOf("~")&&(r=r.replace(/~1/g,"/").replace(/~0/g,"~")),h>=m){o=d[i.op].call(i,c,r,t);break}c=c[r]}}return o}function c(t){if(void 0===t)return!0;if("array"==typeof t||"object"==(void 0===t?"undefined":r(t)))for(var e in t)if(c(t[e]))return!0;return!1}var h=function(t){if(y(t)){for(var e=Array(t.length),n=0;e.length>n;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e},d={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,n){var i={op:"_get",path:this.from};return u(n,[i]),u(n,[{op:"remove",path:this.from}]),u(n,[{op:"add",path:this.path,value:i.value}]),!0},copy:function(t,e,n){var i={op:"_get",path:this.from};return u(n,[i]),u(n,[{op:"add",path:this.path,value:i.value}]),!0},test:function(t,n){return e(t[n],this.value)},_get:function(t,e){this.value=t[e]}},f={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:d.move,copy:d.copy,test:d.test,_get:d._get},p={add:function(t){p.remove.call(this,t);for(var e in this.value)this.value.hasOwnProperty(e)&&(t[e]=this.value[e]);return!0},remove:function(t){for(var e in t)t.hasOwnProperty(e)&&d.remove.call(this,t,e);return!0},replace:function(t){return u(t,[{op:"remove",path:this.path}]),u(t,[{op:"add",path:this.path,value:this.value}]),!0},move:d.move,copy:d.copy,test:function(t){return JSON.stringify(t)===JSON.stringify(this.value)},_get:function(t){this.value=t}},m=[],g=function(){return function(t){this.observers=[],this.obj=t}}(),v=function(){return function(t,e){this.callback=t,this.observer=e}}();t.unobserve=function(t,e){e.unobserve()},t.observe=function(t,e){var n,r=function(t){for(var e=0,n=m.length;n>e;e++)if(m[e].obj===t)return m[e]}(t);if(r?n=function(t,e){for(var n=0,i=t.observers.length;i>n;n++)if(t.observers[n].callback===e)return t.observers[n].observer}(r,e):(r=new g(t),m.push(r)),n)return n;if(n={},r.value=i(t),e){n.callback=e,n.next=null;var s=this.intervals||[100,1e3,1e4,6e4];if(void 0===s.push)throw new o("jsonpatch.intervals must be an array");var l=0,u=function(){a(n)},c=function(){clearTimeout(n.next),n.next=setTimeout(function(){u(),l=0,n.next=setTimeout(h,s[l++])},0)},h=function t(){u(),l==s.length&&(l=s.length-1),n.next=setTimeout(t,s[l++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",c),window.addEventListener("mouseup",c),window.addEventListener("keydown",c)):(document.documentElement.attachEvent("onmousedown",c),document.documentElement.attachEvent("onmouseup",c),document.documentElement.attachEvent("onkeydown",c))),n.next=setTimeout(h,s[l++])}return n.patches=[],n.object=t,n.unobserve=function(){a(n),clearTimeout(n.next),function(t,e){for(var n=0,i=t.observers.length;i>n;n++)if(t.observers[n].observer===e)return void t.observers.splice(n,1)}(r,n),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",c),window.removeEventListener("mouseup",c),window.removeEventListener("keydown",c)):(document.documentElement.detachEvent("onmousedown",c),document.documentElement.detachEvent("onmouseup",c),document.documentElement.detachEvent("onkeydown",c)))},r.observers.push(new v(e,n)),n},t.generate=a;var y;y=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},t.apply=u,t.compare=function(t,e){var n=[];return s(t,e,n,""),n};var w=function(t){function e(e,n,i,r,o){t.call(this,e),this.message=e,this.name=n,this.index=i,this.operation=r,this.tree=o}return function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(o);t.JsonPatchError=w,t.Error=w,t.validator=function(e,n,i,o){if("object"!==(void 0===e?"undefined":r(e))||null===e||y(e))throw new w("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,e,i);if(!d[e.op])throw new w("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,e,i);if("string"!=typeof e.path)throw new w("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,e,i);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new w("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,e,i);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new w("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,e,i);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&c(e.value))throw new w("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,e,i);if(i)if("add"==e.op){var a=e.path.split("/").length,s=o.split("/").length;if(a!==s+1&&a!==s)throw new w("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,e,i)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==o)throw new w("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,e,i)}else if("move"===e.op||"copy"===e.op){var l={op:"_get",path:e.from,value:void 0},u=t.validate([l],i);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new w("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,e,i)}},t.validate=function(t,e){try{if(!y(t))throw new w("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)e=JSON.parse(JSON.stringify(e)),u.call(this,e,t,!0);else for(var n=0;t.length>n;n++)this.validator(t[n],n)}catch(t){if(t instanceof w)return t;throw t}}}(i||(i={})),e.apply=i.apply,e.observe=i.observe,e.unobserve=i.unobserve,e.generate=i.generate,e.compare=i.compare,e.validate=i.validate,e.validator=i.validator,e.JsonPatchError=i.JsonPatchError,e.Error=i.Error},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var n=new c.default(t,e||{},k.rootInstanceSymbol);return n.init(),n}e.__esModule=!0,n(91),n(105),n(106),n(110),n(111),n(113),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(124),n(126),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(135),n(136),n(137),n(138),n(80),n(139),n(140),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(150),n(151),n(152),n(154),n(155),n(156),n(206),n(207),n(208);var a=n(16),s=n(9),l=n(28),u=n(83),c=r(n(84)),h=r(n(253)),d=n(4),f=r(d),p=r(n(8)),m=r(n(87)),g=i(n(2)),v=i(n(27)),y=i(n(86)),w=i(n(173)),b=i(n(35)),_=i(n(36)),E=i(n(17)),T=i(n(5)),C=i(n(1)),x=i(n(85)),S=i(n(33)),M=i(n(20)),O=i(n(0)),R=i(n(11)),A=i(n(254)),P=n(6),N=r(n(177)),k=n(176),L=n(178),D=i(n(7)),I=n(65);(0,h.default)(o),o.Core=c.default,o.DefaultSettings=N.default,o.EventManager=f.default,o._getListenersCounter=d.getListenersCounter,o.buildDate="06/12/2017 09:46:21",o.packageName="handsontable",o.version="0.35.0",o.hooks=p.default.getSingleton(),o.__GhostTable=m.default;var H=[g,v,y,w,b,_,E,T,C,x,S,M],U=[O,R];o.helper={},o.dom={},g.arrayEach(H,function(t){g.arrayEach(Object.getOwnPropertyNames(t),function(e){"_"!==e.charAt(0)&&(o.helper[e]=t[e])})}),g.arrayEach(U,function(t){g.arrayEach(Object.getOwnPropertyNames(t),function(e){"_"!==e.charAt(0)&&(o.dom[e]=t[e])})}),o.cellTypes={},g.arrayEach((0,u.getRegisteredCellTypeNames)(),function(t){o.cellTypes[t]=(0,u.getCellType)(t)}),o.cellTypes.registerCellType=u.registerCellType,o.cellTypes.getCellType=u.getCellType,o.editors={},g.arrayEach((0,a.getRegisteredEditorNames)(),function(t){o.editors[S.toUpperCaseFirst(t)+"Editor"]=(0,a.getEditor)(t)}),o.editors.registerEditor=a.registerEditor,o.editors.getEditor=a.getEditor,o.renderers={},g.arrayEach((0,s.getRegisteredRendererNames)(),function(t){var e=(0,s.getRenderer)(t);"base"===t&&(o.renderers.cellDecorator=e),o.renderers[S.toUpperCaseFirst(t)+"Renderer"]=e}),o.renderers.registerRenderer=s.registerRenderer,o.renderers.getRenderer=s.getRenderer,o.validators={},g.arrayEach((0,l.getRegisteredValidatorNames)(),function(t){o.validators[S.toUpperCaseFirst(t)+"Validator"]=(0,l.getValidator)(t)}),o.validators.registerValidator=l.registerValidator,o.validators.getValidator=l.getValidator,o.plugins={},g.arrayEach(Object.getOwnPropertyNames(A),function(t){var e=A[t];"Base"===t?o.plugins[t+"Plugin"]=e:o.plugins[t]=e}),o.plugins.registerPlugin=P.registerPlugin,(o.languages={}).dictionaryKeys=D,o.languages.getLanguageDictionary=I.getLanguageDictionary,o.languages.getLanguagesDictionaries=I.getLanguagesDictionaries,o.languages.registerLanguageDictionary=I.registerLanguageDictionary,o.languages.getTranslatedPhrase=function(){return L.getTranslatedPhrase.apply(void 0,arguments)},e.default=o},function(t,e,n){var i=n(19),r=n(18),o=n(37);t.exports=n(22)?Object.defineProperties:function(t,e){r(t);for(var n,a=o(e),s=a.length,l=0;s>l;)i.f(t,n=a[l++],e[n]);return t}},function(t,e,n){"use strict";var i=n(68),r=n(45),o=n(48),a={};n(30)(a,n(10)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var i=n(25),r=n(39),o=n(70)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var i=n(15),r=n(104).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&i(o)&&r&&r(t,o),t}},function(t,e,n){var i=n(191);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){var i=n(15),r=n(107),o=n(10)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){var i=n(18),r=n(57),o=n(10)("species");t.exports=function(t,e){var n,a=i(t).constructor;return void 0===a||void 0==(n=i(a)[o])?e:r(n)}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(12),r=n(75).set,o=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,l="process"==n(38)(a);t.exports=function(){var t,e,n,u=function(){var i,r;for(l&&(i=a.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(l)n=function(){a.nextTick(u)};else if(o){var c=!0,h=document.createTextNode("");new o(u).observe(h,{characterData:!0}),n=function(){h.data=c=!c}}else if(s&&s.resolve){var d=s.resolve();n=function(){d.then(u)}}else n=function(){r.call(i,u)};return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var i=n(18),r=n(15),o=n(112);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var i=n(12),r=n(46),o=n(60),a=n(114),s=n(19).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var i=n(37),r=n(63),o=n(50);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var a,s=n(t),l=o.f,u=0;s.length>u;)l.call(t,a=s[u++])&&e.push(a);return e}},function(t,e,n){var i=n(26),r=n(76).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return r(t)}catch(t){return a.slice()}}(t):r(i(t))}},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var i=n(54),r=n(34);t.exports=function(t){return function(e,n){var o,a,s=r(e)+"",l=i(n),u=s.length;return 0>l||l>=u?t?"":void 0:55296>(o=s.charCodeAt(l))||o>56319||l+1===u||56320>(a=s.charCodeAt(l+1))||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var i=n(18);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var i=n(39),r=n(55),o=n(23);t.exports=[].copyWithin||function(t,e){var n=i(this),a=o(n.length),s=r(t,a),l=r(e,a),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?a:r(u,a))-l,a-s),h=1;for(s>l&&l+c>s&&(h=-1,l+=c-1,s+=c-1);c-- >0;)l in n?n[s]=n[l]:delete n[s],s+=h,l+=h;return n}},function(t,e,n){"use strict";var i=n(39),r=n(55),o=n(23);t.exports=function(t){for(var e=i(this),n=o(e.length),a=arguments.length,s=r(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:r(l,n);u>s;)e[s++]=t;return e}},function(t,e,n){var i=n(76),r=n(63),o=n(18),a=n(12).Reflect;t.exports=a&&a.ownKeys||function(t){var e=i.f(o(t)),n=r.f;return n?e.concat(n(t)):e}},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var i=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n(32)),o=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(r.default.CLONE_DEBUG),n.clone.wtTable.holder.style.opacity=.4,n.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",(0,i.addClass)(n.clone.wtTable.holder.parentNode,"wtDebugVisible"),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),e}();r.default.registerOverlay(r.default.CLONE_DEBUG,o),e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=function(t){return t&&t.__esModule?t:{default:t}}(n(32)),a=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(o.default.CLONE_LEFT),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"horizontal"===n)e=this.getScrollPosition(),(0,r.resetCssTransform)(t);else{var i=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(i.left),a=Math.ceil(i.right),s=void 0,l=void 0;l=""===(l=this.wot.wtTable.hider.style.top)?0:l,e=s=0>o&&a-t.offsetWidth>0?-o:0,s+="px",(0,r.setOverlayPosition)(t,s,l)}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){this.mainTableScrollableElement===window?window.scrollTo(t,(0,r.getWindowScrollTop)()):this.mainTableScrollableElement.scrollLeft=t}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=0,i=this.wot.wtSettings.defaultColumnWidth;e>t;)n+=this.wot.wtTable.getStretchedColumnWidth(t)||i,t++;return n}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable.holder,e=t.clientHeight===t.offsetHeight?0:(0,r.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode.style,i=this.wot.getSetting("preventOverflow"),o=void 0;if(this.trimmingContainer!==window||"vertical"===i){var a=this.wot.wtViewport.getWorkspaceHeight()-e;a=Math.min(a,(0,r.innerHeight)(this.wot.wtTable.wtRootElement)),n.height=a+"px"}else n.height="";this.clone.wtTable.holder.style.height=n.height,o=(0,r.outerWidth)(this.clone.wtTable.TABLE),n.width=(0===o?o:o+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var t=(0,r.getScrollbarWidth)();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===t&&(t=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+t+"px"}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==t)throw Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.top="number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;e&&i.offsetWidth!==i.clientWidth&&(o=(0,r.getScrollbarWidth)()),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),t),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=0;return this.wot.getSetting("preventOverflow")||this.trimmingContainer!==window||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return(0,r.getScrollLeft)(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),i=this.wot.getSetting("fixedColumnsLeft");if(this.wot.getSetting("totalRows")?(0,r.removeClass)(e,"emptyRows"):(0,r.addClass)(e,"emptyRows"),i&&!n.length)(0,r.addClass)(e,"innerBorderLeft");else if(!i&&n.length){var o=(0,r.hasClass)(e,"innerBorderLeft");t?(0,r.addClass)(e,"innerBorderLeft"):(0,r.removeClass)(e,"innerBorderLeft"),(!o&&t||o&&!t)&&this.wot.wtOverlays.adjustElementsSize()}}}]),e}();o.default.registerOverlay(o.default.CLONE_LEFT,a),e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=function(t){return t&&t.__esModule?t:{default:t}}(n(32)),a=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(o.default.CLONE_TOP),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"vertical"===n)e=this.getScrollPosition(),(0,r.resetCssTransform)(t);else{var i=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(i.top),a=Math.ceil(i.bottom),s=void 0,l=void 0;s=""===(s=this.wot.wtTable.hider.style.left)?0:s,e=l=0>o&&a-t.offsetHeight>0?-o:0,l+="px",(0,r.setOverlayPosition)(t,s,l)}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){this.mainTableScrollableElement===window?window.scrollTo((0,r.getWindowScrollLeft)(),t):this.mainTableScrollableElement.scrollTop=t}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=0,i=this.wot.wtSettings.settings.defaultRowHeight;e>t;){var r=this.wot.wtTable.getRowHeight(t);n+=void 0===r?i:r,t++}return n}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable.holder,e=t.clientWidth===t.offsetWidth?0:(0,r.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode.style,i=this.wot.getSetting("preventOverflow"),o=void 0;if(this.trimmingContainer!==window||"horizontal"===i){var a=this.wot.wtViewport.getWorkspaceWidth()-e;a=Math.min(a,(0,r.innerWidth)(this.wot.wtTable.wtRootElement)),n.width=a+"px"}else n.width="";this.clone.wtTable.holder.style.width=n.width,o=(0,r.outerHeight)(this.clone.wtTable.TABLE),n.height=(0===o?o:o+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var t=(0,r.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t+"px"}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==t)throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left="number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;if(e&&i.offsetHeight!==i.clientHeight&&(o=(0,r.getScrollbarWidth)()),e){var a=this.wot.getSetting("fixedRowsBottom"),s=(this.wot.getSetting("fixedRowsTop"),this.wot.getSetting("totalRows"));n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(s-a,s),n+=1}else n+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),t);n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,r.getScrollTop)(this.mainTableScrollableElement)}},{key:"redrawSelectionBorders",value:function(t){if(t&&t.cellRange){var e=t.getBorder(this.wot);if(e){var n=t.getCorners();e.disappear(),e.appear(n)}}}},{key:"redrawAllSelectionsBorders",value:function(){var t=this.wot.selections;this.redrawSelectionBorders(t.current),this.redrawSelectionBorders(t.area),this.redrawSelectionBorders(t.fill),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode;if(this.wot.getSetting("totalColumns")?(0,r.removeClass)(e,"emptyColumns"):(0,r.addClass)(e,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var n=(0,r.hasClass)(e,"innerBorderTop");t||0===this.wot.getSetting("totalRows")?(0,r.addClass)(e,"innerBorderTop"):(0,r.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(0===this.wot.getSetting("rowHeaders").length){var i=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(i)for(var o=0;i.length>o;o++)i[o].style["border-left-width"]=0}}}]),e}();o.default.registerOverlay(o.default.CLONE_TOP,a),e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=function(t){return t&&t.__esModule?t:{default:t}}(n(32)),a=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.clone=n.makeClone(o.default.CLONE_TOP_LEFT_CORNER),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=(0,r.outerHeight)(this.clone.wtTable.TABLE),n=(0,r.outerWidth)(this.clone.wtTable.TABLE),i=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var o=this.wot.wtTable.hider.getBoundingClientRect(),a=Math.ceil(o.top),s=Math.ceil(o.left),l=Math.ceil(o.bottom),u=Math.ceil(o.right),c="0",h="0";i&&"vertical"!==i||0>s&&u-t.offsetWidth>0&&(c=-s+"px"),i&&"horizontal"!==i||0>a&&l-t.offsetHeight>0&&(h=-a+"px"),(0,r.setOverlayPosition)(t,c,h)}else(0,r.resetCssTransform)(t);t.style.height=(0===e?e:e+4)+"px",t.style.width=(0===n?n:n+4)+"px"}}}]),e}();o.default.registerOverlay(o.default.CLONE_TOP_LEFT_CORNER,a),e.default=a},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(0),s=i(n(170)),l=i(n(51)),u=i(n(81));e.default=function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.settings=e,this.cellRange=n||null,this.instanceBorders={}}return o(t,[{key:"getBorder",value:function(t){if(this.instanceBorders[t.guid])return this.instanceBorders[t.guid];this.instanceBorders[t.guid]=new s.default(t,this.settings)}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){this.isEmpty()?this.cellRange=new u.default(t,t,t):this.cellRange.expand(t)}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){this.cellRange=null}},{key:"getCorners",value:function(){var t=this.cellRange.getTopLeftCorner(),e=this.cellRange.getBottomRightCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,i){var o=t.wtTable.getCell(new l.default(e,n));"object"===(void 0===o?"undefined":r(o))&&(0,a.addClass)(o,i)}},{key:"draw",value:function(t){if(this.isEmpty()){if(this.settings.border){var e=this.getBorder(t);e&&e.disappear()}}else{for(var n=t.wtTable.getRenderedRowsCount(),i=t.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=void 0,s=void 0,l=void 0,u=0;i>u;u++)if((s=t.wtTable.columnFilter.renderedToSource(u))>=r[1]&&r[3]>=s&&(l=t.wtTable.getColumnHeader(s))){var c=[];this.settings.highlightHeaderClassName&&c.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&c.push(this.settings.highlightColumnClassName),(0,a.addClass)(l,c)}for(var h=0;n>h;h++){if((o=t.wtTable.rowFilter.renderedToSource(h))>=r[0]&&r[2]>=o&&(l=t.wtTable.getRowHeader(o))){var d=[];this.settings.highlightHeaderClassName&&d.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&d.push(this.settings.highlightRowClassName),(0,a.addClass)(l,d)}for(var f=0;i>f;f++)s=t.wtTable.columnFilter.renderedToSource(f),r[0]>o||o>r[2]||r[1]>s||s>r[3]?r[0]>o||o>r[2]?r[1]>s||s>r[3]||this.settings.highlightColumnClassName&&this.addClassAtCoords(t,o,s,this.settings.highlightColumnClassName):this.settings.highlightRowClassName&&this.addClassAtCoords(t,o,s,this.settings.highlightRowClassName):this.settings.className&&this.addClassAtCoords(t,o,s,this.settings.className)}if(t.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border){var p=this.getBorder(t);p&&p.appear(r)}}}}]),t}()},function(t,e,n){"use strict";t.exports=function(){function t(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}var e,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),a=function(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,!1)},s=function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)},l=function(a){var s,l;a?/^[a-zA-Z \.,\\\/\|0-9]$/.test(a)||(a="."):a="",void 0!==r.textContent?r.textContent=e.value+a:r.data=e.value+a,o.style.fontSize=t(e).fontSize,o.style.fontFamily=t(e).fontFamily,o.style.whiteSpace="pre",i.appendChild(o),s=o.clientWidth+2,i.removeChild(o),e.style.height=n.minHeight+"px",e.style.width=n.minWidth>s?n.minWidth+"px":s>n.maxWidth?n.maxWidth+"px":s+"px",l=e.scrollHeight?e.scrollHeight-1:0,n.minHeight>l?e.style.height=n.minHeight+"px":l>n.maxHeight?(e.style.height=n.maxHeight+"px",e.style.overflowY="visible"):e.style.height=l+"px"},u=function(){window.setTimeout(l,0)},c=function(t,i,s){e=t,function(t){if(t&&t.minHeight)if("inherit"==t.minHeight)n.minHeight=e.clientHeight;else{var i=parseInt(t.minHeight);isNaN(i)||(n.minHeight=i)}if(t&&t.maxHeight)if("inherit"==t.maxHeight)n.maxHeight=e.clientHeight;else{var a=parseInt(t.maxHeight);isNaN(a)||(n.maxHeight=a)}if(t&&t.minWidth)if("inherit"==t.minWidth)n.minWidth=e.clientWidth;else{var s=parseInt(t.minWidth);isNaN(s)||(n.minWidth=s)}if(t&&t.maxWidth)if("inherit"==t.maxWidth)n.maxWidth=e.clientWidth;else{var l=parseInt(t.maxWidth);isNaN(l)||(n.maxWidth=l)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}(i),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=n.minHeight+"px",e.style.minWidth=n.minWidth+"px",e.style.maxWidth=n.maxWidth+"px",e.style.overflowY="hidden"),s&&(a(e,"change",l),a(e,"cut",u),a(e,"paste",u),a(e,"drop",u),a(e,"keydown",u),a(e,"focus",l)),l()};return{init:function(t,e,n){c(t,e,n)},unObserve:function(){s(e,"change",l),s(e,"cut",u),s(e,"paste",u),s(e,"drop",u),s(e,"keydown",u),s(e,"focus",l)},resize:l}}},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(n(43)),o=n(0);e.default=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"beginEditing",value:function(t,e){if(void 0===e){var n=this.TD.querySelector('input[type="checkbox"]');(0,o.hasClass)(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),e}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=i(n(52)),s=i(n(217));n(218);var l=n(0),u=n(1),c=i(n(4)),h=n(20),d=n(11),f=i(n(53));e.default=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.defaultDateFormat="DD/MM/YYYY",n.isCellEdited=!1,n.parentDestroyed=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,f.default),r(e,[{key:"init",value:function(){var t=this;if("function"!=typeof a.default)throw Error("You need to include moment.js to your project.");if("function"!=typeof s.default)throw Error("You need to include Pikaday to your project.");o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){t.parentDestroyed=!0,t.destroyElements()})}},{key:"createElements",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createElements",this).call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,(0,l.addClass)(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new s.default(this.getDatePickerConfig()),new c.default(this).addEventListener(this.datePicker,"mousedown",function(t){return(0,d.stopPropagation)(t)}),this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(t,n,i,r,a,s){this._opened=!1,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"prepare",this).call(this,t,n,i,r,a,s)}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this),this.showDatepicker(t)}},{key:"close",value:function(){var t=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){t.instance.selection.refreshBorders()},0)),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var i=this.originalValue;void 0!==i&&this.setValue(i)}this.hideDatepicker(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"finishEditing",this).call(this,t,n)}},{key:"showDatepicker",value:function(t){this.$datePicker.config(this.getDatePickerConfig());var e=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.$datePicker.config(),r=void 0,o=this.instance.view.isMouseDown(),s=!!t&&(0,h.isMetaKey)(t.keyCode);this.datePickerStyle.top=window.pageYOffset+e.top+(0,l.outerHeight)(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+e.left+"px",this.$datePicker._onInputFocus=function(){},i.format=n,this.originalValue?(r=this.originalValue,(0,a.default)(r,n,!0).isValid()&&this.$datePicker.setMoment((0,a.default)(r,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||o||this.setValue("")):this.cellProperties.defaultDate?(r=this.cellProperties.defaultDate,i.defaultDate=r,(0,a.default)(r,n,!0).isValid()&&this.$datePicker.setMoment((0,a.default)(r,n),!0),s||o||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,u.deepExtend)(n,this.cellProperties.datePickerConfig);var i=n.onSelect,r=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(e){isNaN(e.getTime())||(e=(0,a.default)(e).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(e),t.hideDatepicker(),i&&i()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1),r&&r()},n}}]),e}()},function(t,e){t.exports=n},function(t,e){},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=i(n(171)),a=i(n(8)),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"prepare",value:function(t,n,i,r,o,a){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"prepare",this).call(this,t,n,i,r,o,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}]),e}();a.default.getSingleton().add("beforeValidate",function(t,e,n,i){var r=this.getCellMeta(e,this.propToCol(n));r.editor===s&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}),e.default=s},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(20),o=n(11),a=n(0),s=i(n(43)),l=i(n(4)),u=s.default.prototype.extend(),c={};u.prototype.valueChanged=function(){return this.initValue!=this.getValue()},u.prototype.init=function(){var t=this;this.eventManager=new l.default(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){t.destroy()})},u.prototype.getValue=function(){return this.TEXTAREA.value},u.prototype.setValue=function(t){this.initValue=t,this.TEXTAREA.value=t},u.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),(0,a.addClass)(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var t in this.controls)Object.prototype.hasOwnProperty.call(this.controls,t)&&this.positionControls.appendChild(this.controls[t])}.call(this),document.body.appendChild(this.editorContainer)},u.prototype.onBeforeKeyDown=function(t){var e=this.getActiveEditor();if(t.target===e.TEXTAREA&&!(0,o.isImmediatePropagationStopped)(t))switch(t.keyCode){case r.KEY_CODES.ENTER:e.close(),t.preventDefault();break;case r.KEY_CODES.BACKSPACE:(0,o.stopImmediatePropagation)(t)}},u.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),(0,a.addClass)(this.editorContainer,"active"),(0,a.removeClass)(this.cellPointer,"hidden"),this.updateEditorPosition()},u.prototype.focus=function(){this.TEXTAREA.focus(),(0,a.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},u.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),(0,a.removeClass)(this.editorContainer,"active")},u.prototype.scrollToView=function(){this.instance.view.scrollViewport(this.instance.getSelectedRange().highlight)},u.prototype.hideCellPointer=function(){(0,a.hasClass)(this.cellPointer,"hidden")||(0,a.addClass)(this.cellPointer,"hidden")},u.prototype.updateEditorPosition=function(t,e){if(t&&e)t=parseInt(t,10),e=parseInt(e,10),this.editorContainer.style.top=e+"px",this.editorContainer.style.left=t+"px";else{var n=this.instance.getSelected(),i=this.instance.getCell(n[0],n[1]);if(c.cellPointer||(c.cellPointer={height:(0,a.outerHeight)(this.cellPointer),width:(0,a.outerWidth)(this.cellPointer)}),c.editorContainer||(c.editorContainer={width:(0,a.outerWidth)(this.editorContainer)}),void 0!==i){var r=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:(0,a.getScrollLeft)(this.instance.view.wt.wtOverlays.leftOverlay.holder),o=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:(0,a.getScrollTop)(this.instance.view.wt.wtOverlays.topOverlay.holder),s=(0,a.offset)(i),l=(0,a.outerWidth)(i),u={x:r,y:o};this.editorContainer.style.top=parseInt(s.top+(0,a.outerHeight)(i)-u.y+c.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-c.editorContainer.width/2,10)+"px",s.left+l/2>parseInt(this.editorContainer.style.left,10)+c.editorContainer.width?this.editorContainer.style.left=window.innerWidth-c.editorContainer.width+"px":s.left+l/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(s.left-c.cellPointer.width/2-(0,a.offset)(this.editorContainer).left+l/2-u.x,10)+"px"}}},u.prototype.updateEditorData=function(){var t=this.instance.getSelected(),e=this.instance.getDataAtCell(t[0],t[1]);this.row=t[0],this.col=t[1],this.setValue(e),this.updateEditorPosition()},u.prototype.prepareAndSave=function(){var t;this.valueChanged()&&(t=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],this.saveValue(t))},u.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(e){t.prepareAndSave(),t.instance.selection.transformStart(0,-1,null,!0),t.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(e){t.prepareAndSave(),t.instance.selection.transformStart(0,1,null,!0),t.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(e){t.prepareAndSave(),t.instance.selection.transformStart(-1,0,null,!0),t.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(e){t.prepareAndSave(),t.instance.selection.transformStart(1,0,null,!0),t.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(e){if(1==e.touches.length){var n=e.touches[0],i={x:t.editorContainer.offsetLeft,y:t.editorContainer.offsetTop},r={x:n.pageX-i.x,y:n.pageY-i.y};t.eventManager.addEventListener(this,"touchmove",function(e){var n=e.touches[0];t.updateEditorPosition(n.pageX-r.x,n.pageY-r.y),t.hideCellPointer(),e.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(e){(0,a.isChildOf)(e.target,t.editorContainer)||(0,a.isChildOf)(e.target,t.instance.rootElement)||t.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(e){t.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&t.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(e){t.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&t.hideCellPointer()})},u.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=i(n(82)),a=i(n(53));e.default=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"beginEditing",value:function(t){if(void 0===t&&this.originalValue){var n=o.default.cultureData().delimiters.decimal,i=this.cellProperties.numericFormat,r=i&&i.culture;void 0!==r&&o.default.culture(r),t=(""+this.originalValue).replace(".",n)}(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"beginEditing",this).call(this,t)}}]),e}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=function(t){return t&&t.__esModule?t:{default:t}}(n(53));e.default=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"createElements",value:function(){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createElements",this).call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,(0,r.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),e}()},function(t,e,n){"use strict";e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(0),o=n(11),a=n(20),s=n(43),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=l.default.prototype.extend();u.prototype.init=function(){this.select=document.createElement("SELECT"),(0,r.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()},u.prototype.registerHooks=function(){var t=this;this.instance.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return t.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return t.refreshDimensions()})},u.prototype.prepare=function(){l.default.prototype.prepare.apply(this,arguments);var t,e=this.cellProperties.selectOptions;t=this.prepareOptions("function"==typeof e?e(this.row,this.col,this.prop):e),(0,r.empty)(this.select);for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=document.createElement("OPTION");i.value=n,(0,r.fastInnerHTML)(i,t[n]),this.select.appendChild(i)}},u.prototype.prepareOptions=function(t){var e={};if(Array.isArray(t))for(var n=0,r=t.length;r>n;n++)e[t[n]]=t[n];else"object"==(void 0===t?"undefined":i(t))&&(e=t);return e},u.prototype.getValue=function(){return this.select.value},u.prototype.setValue=function(t){this.select.value=t};var c=function(t){var e=this.getActiveEditor();switch(t.keyCode){case a.KEY_CODES.ARROW_UP:var n=e.select.selectedIndex-1;0>n||(e.select[n].selected=!0),(0,o.stopImmediatePropagation)(t),t.preventDefault();break;case a.KEY_CODES.ARROW_DOWN:var i=e.select.selectedIndex+1;i>e.select.length-1||(e.select[i].selected=!0),(0,o.stopImmediatePropagation)(t),t.preventDefault()}};u.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",c)},u.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",c)},u.prototype.focus=function(){this.select.focus()},u.prototype.refreshValue=function(){var t=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()},u.prototype.refreshDimensions=function(){if(this.state===s.EditorState.EDITING){if(!(this.TD=this.getEditedCell()))return void this.close();var t,e=(0,r.outerWidth)(this.TD)+1,n=(0,r.outerHeight)(this.TD)+1,i=(0,r.offset)(this.TD),o=(0,r.offset)(this.instance.rootElement),a=(0,r.getScrollableElement)(this.TD),l=i.top-o.top-1-(a.scrollTop||0),u=i.left-o.left-1-(a.scrollLeft||0),c=this.checkEditorSection();switch(this.instance.getSettings(),c){case"top":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=(0,r.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelected()[0]&&(l+=1),0===this.instance.getSelected()[1]&&(u+=1);var h=this.select.style;t&&-1!=t?h[t[0]]=t[1]:(0,r.resetCssTransform)(this.select);var d=(0,r.getComputedStyle)(this.TD);parseInt(d.borderTopWidth,10)>0&&(n-=1),parseInt(d.borderLeftWidth,10)>0&&(e-=1),h.height=n+"px",h.minWidth=e+"px",h.top=l+"px",h.left=u+"px",h.margin="0px"}},u.prototype.getEditedCell=function(){var t;switch(this.checkEditorSection()){case"top":t=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":t=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":t=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:t=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return-1!=t&&-2!=t?t:void 0},e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var i=n(0);e.default=function(t,e,n,r,o,a,s){s.className&&(e.className=e.className?e.className+" "+s.className:s.className),s.readOnly&&(0,i.addClass)(e,s.readOnlyCellClassName),!1===s.valid&&s.invalidCellClassName?(0,i.addClass)(e,s.invalidCellClassName):(0,i.removeClass)(e,s.invalidCellClassName),!1===s.wordWrap&&s.noWordWrapClassName&&(0,i.addClass)(e,s.noWordWrapClassName),!a&&s.placeholder&&(0,i.addClass)(e,s.placeholderCellClassName)}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n(4)),o=n(13),a=n(9),s=document.createElement("DIV");s.className="htAutocompleteWrapper";var l=document.createElement("DIV");l.className="htAutocompleteArrow",l.appendChild(document.createTextNode(String.fromCharCode(9660))),e.default=function(t,e,n,u,c,h,d){var f=(s.cloneNode(!0),l.cloneNode(!0));if(d.allowHtml?(0,a.getRenderer)("html").apply(this,arguments):(0,a.getRenderer)("text").apply(this,arguments),e.appendChild(f),(0,i.addClass)(e,"htAutocomplete"),e.firstChild||e.appendChild(document.createTextNode(String.fromCharCode(160))),!t.acArrowListener){var p=new r.default(t);t.acArrowListener=function(r){(0,i.hasClass)(r.target,"htAutocompleteArrow")&&t.view.wt.getSetting("onCellDblClick",null,new o.CellCoords(n,u),e)},p.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){p.destroy()})}}},function(t,e,n){"use strict";function i(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}e.__esModule=!0;var r=n(0),o=n(33),a=function(t){return t&&t.__esModule?t:{default:t}}(n(4)),s=n(20),l=n(36),u=n(11),c=n(9),h=new WeakMap,d=new WeakMap,f="htBadValue";e.default=function(t,e,n,p,m,g,v){function y(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getSelectedRange();if(n){for(var i=n.getTopLeftCorner(),r=i.row,o=i.col,a=n.getBottomRightCorner(),s=a.row,l=a.col,u=[],c=r;s>=c;c+=1)for(var h=o;l>=h;h+=1){var d=t.getCellMeta(c,h);if("checkbox"!==d.type)return;if(!0!==d.readOnly){void 0===d.checkedTemplate&&(d.checkedTemplate=!0),void 0===d.uncheckedTemplate&&(d.uncheckedTemplate=!1);var f=t.getDataAtCell(c,h);!1===e?[d.checkedTemplate,""+d.checkedTemplate].includes(f)?u.push([c,h,d.uncheckedTemplate]):[d.uncheckedTemplate,""+d.uncheckedTemplate,null,void 0].includes(f)&&u.push([c,h,d.checkedTemplate]):u.push([c,h,d.uncheckedTemplate])}}u.length>0&&t.setDataAtCell(u)}}(0,c.getRenderer)("base").apply(this,arguments);var w=(function(t){var e=d.get(t);e||((e=new a.default(t)).addEventListener(t.rootElement,"click",function(e){return function(t,e){if(!i(t.target))return!1;e.getCellMeta(parseInt(t.target.getAttribute("data-row"),10),parseInt(t.target.getAttribute("data-col"),10)).readOnly&&t.preventDefault()}(e,t)}),e.addEventListener(t.rootElement,"mouseup",function(e){return function(t,e){i(t.target)&&setTimeout(e.listen,10)}(e,t)}),e.addEventListener(t.rootElement,"change",function(e){return function(t,e){if(!i(t.target))return!1;var n=parseInt(t.target.getAttribute("data-row"),10),r=parseInt(t.target.getAttribute("data-col"),10),o=e.getCellMeta(n,r);if(!o.readOnly){var a=null;a=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,e.setDataAtCell(n,r,a)}}(e,t)}),d.set(t,e))}(t),function(){var t=document.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}()),b=v.label,_=!1;if(void 0===v.checkedTemplate&&(v.checkedTemplate=!0),void 0===v.uncheckedTemplate&&(v.uncheckedTemplate=!1),(0,r.empty)(e),g===v.checkedTemplate||(0,o.equalsIgnoreCase)(g,v.checkedTemplate)?w.checked=!0:g===v.uncheckedTemplate||(0,o.equalsIgnoreCase)(g,v.uncheckedTemplate)?w.checked=!1:null===g?(0,r.addClass)(w,"noValue"):(w.style.display="none",(0,r.addClass)(w,f),_=!0),w.setAttribute("data-row",n),w.setAttribute("data-col",p),!_&&b){var E="";b.value?E="function"==typeof b.value?b.value.call(this,n,p,m,g):b.value:b.property&&(E=t.getDataAtRowProp(n,b.property));var T=function(t){var e=document.createElement("label");return e.className="htCheckboxRendererLabel",e.appendChild(document.createTextNode(t)),e.cloneNode(!0)}(E);"before"===b.position?T.appendChild(w):T.insertBefore(w,T.firstChild),w=T}e.appendChild(w),_&&e.appendChild(document.createTextNode("#bad-value#")),h.has(t)||(h.set(t,!0),t.addHook("beforeKeyDown",function(e){var n=(0,l.partial)(s.isKey,e.keyCode);n("SPACE|ENTER|DELETE|BACKSPACE")&&!(0,u.isImmediatePropagationStopped)(e)&&function(e){var n=t.getSelectedRange();if(n)for(var i=n.getTopLeftCorner(),r=n.getBottomRightCorner(),o=i.row;r.row>=o;o++)for(var a=i.col;r.col>=a;a++){var s=t.getCellMeta(o,a);if("checkbox"!==s.type)return;var l=t.getCell(o,a);if(null==l)e(o,a,s);else{var u=l.querySelectorAll("input[type=checkbox]");u.length>0&&!s.readOnly&&e(u)}}}(function(){(0,u.stopImmediatePropagation)(e),e.preventDefault()}),n("SPACE|ENTER")&&y(),n("DELETE|BACKSPACE")&&y(!0)}))}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(0),r=n(9);e.default=function(t,e,n,o,a,s,l){(0,r.getRenderer)("base").apply(this,arguments),null!==s&&void 0!==s||(s=""),(0,i.fastInnerHTML)(e,s)}},function(t,e,n){"use strict";e.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(82)),r=n(9),o=n(5);e.default=function(t,e,n,a,s,l,u){if((0,o.isNumeric)(l)){var c=u.numericFormat,h=c&&c.culture,d=c&&c.pattern,f=u.className||"",p=f.length?f.split(" "):[];void 0!==h&&i.default.culture(h),l=(0,i.default)(l).format(d||"0"),0>p.indexOf("htLeft")&&0>p.indexOf("htCenter")&&0>p.indexOf("htRight")&&0>p.indexOf("htJustify")&&p.push("htRight"),0>p.indexOf("htNumeric")&&p.push("htNumeric"),u.className=p.join(" ")}(0,r.getRenderer)("text")(t,e,n,a,s,l,u)}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(0),r=n(9),o=n(5);e.default=function(t,e,n,a,s,l,u){(0,r.getRenderer)("text").apply(this,arguments),l=e.innerHTML;var c=u.hashLength||l.length,h=u.hashSymbol||"*",d="";(0,o.rangeEach)(c-1,function(){d+=h}),(0,i.fastInnerHTML)(e,d)}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(0),r=n(17),o=n(9);e.default=function(t,e,n,a,s,l,u){(0,o.getRenderer)("base").apply(this,arguments),!l&&u.placeholder&&(l=u.placeholder);var c=(0,r.stringify)(l);if(t.getSettings().trimWhitespace||(c=c.replace(/ /g,String.fromCharCode(160))),u.rendererTemplate){(0,i.empty)(e);var h=document.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=t.getSourceDataAtRow(n),e.appendChild(h)}else(0,i.fastInnerText)(e,c)}},function(t,e,n){"use strict";function i(t,e){var n=t;return function(t){for(var i=!1,r=0,o=t.length;o>r;r++)if(n===t[r]){i=!0;break}e(i)}}e.__esModule=!0,e.default=function(t,e){null==t&&(t=""),this.allowEmpty&&""===t?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(t,i(t,e)):i(t,e)(this.source):e(!0)}},function(t,e,n){"use strict";function i(t,e){var n=(0,r.default)((0,o.getNormalizedDate)(t)),i=(0,r.default)(t,e),a=t.search(/[A-z]/g)>-1;return(n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||a?n:i).format(e)}e.__esModule=!0,e.default=function(t,e){var n=!0,o=(0,a.getEditorInstance)("date",this.instance);null==t&&(t="");var s=(0,r.default)(new Date(t)).isValid()||(0,r.default)(t,o.defaultDateFormat).isValid(),l=(0,r.default)(t,this.dateFormat||o.defaultDateFormat,!0).isValid();if(this.allowEmpty&&""===t&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(!0===this.correctFormat){var u=i(t,this.dateFormat),c=this.instance.runHooks("unmodifyRow",this.row),h=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(c,h,u,"dateValidator"),n=!0}else n=!1;e(n)},e.correctFormat=i;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(52)),o=n(173),a=n(16)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){null==t&&(t=""),e(!(!this.allowEmpty||""!==t)||""!==t&&/^-?\d*(\.|,)?\d*$/.test(t))}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){var n=!0,o=this.timeFormat||"h:mm:ss a";null===t&&(t=""),t=/^\d{3,}$/.test(t)?parseInt(t,10):t;var a=/^\d{1,2}$/.test(t);a&&(t+=":00");var s=(0,i.default)(t,r,!0).isValid()?(0,i.default)(t):(0,i.default)(t,o),l=s.isValid(),u=(0,i.default)(t,o,!0).isValid()&&!a;if(this.allowEmpty&&""===t&&(l=!0,u=!0),l||(n=!1),!l&&u&&(n=!0),l&&!u)if(!0===this.correctFormat){var c=s.format(o),h=this.instance.runHooks("unmodifyRow",this.row),d=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(h,d,c,"timeValidator"),n=!0}else n=!1;e(n)};var i=function(t){return t&&t.__esModule?t:{default:t}}(n(52)),r=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"]},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),r=n(9),o=n(28);e.default={editor:(0,i.getEditor)("autocomplete"),renderer:(0,r.getRenderer)("autocomplete"),validator:(0,o.getValidator)("autocomplete")}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),r=n(9);e.default={editor:(0,i.getEditor)("checkbox"),renderer:(0,r.getRenderer)("checkbox")}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),r=n(9),o=n(28);e.default={editor:(0,i.getEditor)("date"),renderer:(0,r.getRenderer)("autocomplete"),validator:(0,o.getValidator)("date")}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),r=n(9),o=n(28);e.default={editor:(0,i.getEditor)("dropdown"),renderer:(0,r.getRenderer)("autocomplete"),validator:(0,o.getValidator)("autocomplete")}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),r=n(9);e.default={editor:(0,i.getEditor)("handsontable"),renderer:(0,r.getRenderer)("autocomplete")}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),r=n(9),o=n(28);e.default={editor:(0,i.getEditor)("numeric"),renderer:(0,r.getRenderer)("numeric"),validator:(0,o.getValidator)("numeric"),dataType:"number"}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),r=n(9);n(28),e.default={editor:(0,i.getEditor)("password"),renderer:(0,r.getRenderer)("password"),copyable:!1}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(27),r=n(16),o=n(9);e.default={editor:(0,r.getEditor)((0,i.isMobileBrowser)()?"mobile":"text"),renderer:(0,o.getRenderer)("text")}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),r=n(9),o=n(28);e.default={editor:(0,i.getEditor)("text"),renderer:(0,r.getRenderer)("text"),validator:(0,o.getValidator)("time")}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n){var i=this;this.instance=t,this.priv=e,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.duckSchema=this.dataSource&&this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{},this.createMap(),this.interval=h.default.create(function(){return i.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(t){return i.onSkipLengthCache(t)}),this.onSkipLengthCache(500)}e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=i(n(174)),s=n(86),l=n(85),u=n(1),c=n(2),h=i(n(245)),d=n(5),f=i(n(246));i(n(8)),r.prototype.DESTINATION_RENDERER=1,r.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,r.prototype.recursiveDuckSchema=function(t){return(0,u.duckSchema)(t)},r.prototype.recursiveDuckColumns=function(t,e,n){var i,r;if(void 0===e&&(e=0,n=""),"object"===(void 0===t?"undefined":o(t))&&!Array.isArray(t))for(r in t)(0,u.hasOwnProperty)(t,r)&&(null===t[r]?(i=n+r,this.colToPropCache.push(i),this.propToColCache.set(i,e),e++):e=this.recursiveDuckColumns(t[r],e,r+"."));return e},r.prototype.createMap=function(){var t=void 0,e=this.getSchema();if(void 0===e)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new f.default;var n=this.instance.getSettings().columns;if(n){var i=this.instance.getSettings().maxCols,r=Math.min(i,n.length),o=0,a=!1,s=(0,u.deepObjectSize)(e);for("function"==typeof n&&(r=s>0?s:this.instance.countSourceCols(),a=!0),t=0;r>t;t++){var l=a?n(t):n[t];if((0,u.isObject)(l)){if(void 0!==l.data){var c=a?o:t;this.colToPropCache[c]=l.data,this.propToColCache.set(l.data,c)}o++}}}else this.recursiveDuckColumns(e)},r.prototype.colToProp=function(t){return t=this.instance.runHooks("modifyCol",t),!isNaN(t)&&this.colToPropCache&&void 0!==this.colToPropCache[t]?this.colToPropCache[t]:t},r.prototype.propToCol=function(t){var e;return e=void 0===this.propToColCache.get(t)?t:this.propToColCache.get(t),e=this.instance.runHooks("unmodifyCol",e)},r.prototype.getSchema=function(){var t=this.instance.getSettings().dataSchema;return t?"function"==typeof t?t():t:this.duckSchema},r.prototype.createRow=function(t,e,n){var i,r=this.instance.countCols(),o=0;e||(e=1),"number"==typeof t&&t<this.instance.countSourceRows()||(t=this.instance.countSourceRows()),this.instance.runHooks("beforeCreateRow",t,e,n);for(var a=this.instance.getSettings().maxRows;e>o&&this.instance.countSourceRows()<a;)"array"===this.instance.dataType?this.instance.getSettings().dataSchema?i=(0,u.deepClone)(this.getSchema()):(i=[],(0,d.rangeEach)(r-1,function(){return i.push(null)})):"function"===this.instance.dataType?i=this.instance.getSettings().dataSchema(t):(i={},(0,u.deepExtend)(i,this.getSchema())),t===this.instance.countSourceRows()?this.dataSource.push(i):this.spliceData(t,0,i),o++,0;return this.instance.runHooks("afterCreateRow",t,o,n),this.instance.forceFullRender=!0,o},r.prototype.createCol=function(t,e,n){if(!this.instance.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i,r,o=this.instance.countSourceRows(),a=this.dataSource,s=0;e||(e=1),"number"==typeof t&&t<this.instance.countCols()||(t=this.instance.countCols()),this.instance.runHooks("beforeCreateCol",t,e,n),r=t;for(var u=this.instance.getSettings().maxCols;e>s&&this.instance.countCols()<u;){if(i=(0,l.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts),"number"==typeof t&&t<this.instance.countCols()){for(var c=0;o>c;c++)a[c].splice(r,0,null);this.priv.columnSettings.splice(r,0,i)}else{if(o>0)for(var h=0;o>h;h++)void 0===a[h]&&(a[h]=[]),a[h].push(null);else a.push([null]);this.priv.columnSettings.push(i)}s++,r++}return this.instance.runHooks("afterCreateCol",t,s,n),this.instance.forceFullRender=!0,s},r.prototype.removeRow=function(t,e,n){e||(e=1),"number"!=typeof t&&(t=-e),e=this.instance.runHooks("modifyRemovedAmount",e,t),t=(this.instance.countSourceRows()+t)%this.instance.countSourceRows();var i=this.visualRowsToPhysical(t,e);if(!1!==this.instance.runHooks("beforeRemoveRow",t,e,i,n)){var r=this.dataSource,o=void 0;(o=this.filterData(t,e))&&(r.length=0,Array.prototype.push.apply(r,o)),this.instance.runHooks("afterRemoveRow",t,e,i,n),this.instance.forceFullRender=!0}},r.prototype.removeCol=function(t,e,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw Error("cannot remove column with object data source or columns option specified");e||(e=1),"number"!=typeof t&&(t=-e),t=(this.instance.countCols()+t)%this.instance.countCols();var i=this.visualColumnsToPhysical(t,e),r=i.slice(0).sort(function(t,e){return e-t});if(!1!==this.instance.runHooks("beforeRemoveCol",t,e,i,n)){for(var o=!0,a=r.length,s=this.dataSource,l=0;a>l;l++)o&&i[0]!==i[l]-l&&(o=!1);if(o)for(var u=0,c=this.instance.countSourceRows();c>u;u++)s[u].splice(i[0],e);else{for(var h=0,d=this.instance.countSourceRows();d>h;h++)for(var f=0;a>f;f++)s[h].splice(r[f],1);for(var p=0;a>p;p++)this.priv.columnSettings.splice(i[p],1)}this.instance.runHooks("afterRemoveCol",t,e,i,n),this.instance.forceFullRender=!0}},r.prototype.spliceCol=function(t,e,n){var i=4>arguments.length?[]:[].slice.call(arguments,3),r=this.instance.getDataAtCol(t),o=r.slice(e,e+n),a=r.slice(e+n);(0,c.extendArray)(i,a);for(var s=0;n>s;)i.push(null),s++;return(0,c.to2dArray)(i),this.instance.populateFromArray(e,t,i,null,null,"spliceCol"),o},r.prototype.spliceRow=function(t,e,n){var i=4>arguments.length?[]:[].slice.call(arguments,3),r=this.instance.getSourceDataAtRow(t),o=r.slice(e,e+n),a=r.slice(e+n);(0,c.extendArray)(i,a);for(var s=0;n>s;)i.push(null),s++;return this.instance.populateFromArray(t,e,[i],null,null,"spliceRow"),o},r.prototype.spliceData=function(t,e,n){!1!==this.instance.runHooks("beforeDataSplice",t,e,n)&&this.dataSource.splice(t,e,n)},r.prototype.filterData=function(t,e){var n=this.visualRowsToPhysical(t,e);if(!1!==this.instance.runHooks("beforeDataFilter",t,e,n))return this.dataSource.filter(function(t,e){return-1==n.indexOf(e)})},r.prototype.get=function(t,e){t=this.instance.runHooks("modifyRow",t);var n=this.dataSource[t],i=this.instance.runHooks("modifyRowData",t),r=null;if((n=isNaN(i)?i:n)&&n.hasOwnProperty&&(0,u.hasOwnProperty)(n,e))r=n[e];else if("string"==typeof e&&e.indexOf(".")>-1){var o=e.split("."),a=n;if(!a)return null;for(var s=0,l=o.length;l>s;s++)if(void 0===(a=a[o[s]]))return null;r=a}else"function"==typeof e&&(r=e(this.dataSource.slice(t,t+1)[0]));if(this.instance.hasHook("modifyData")){var c=(0,u.createObjectPropListener)(r);this.instance.runHooks("modifyData",t,this.propToCol(e),c,"get"),c.isTouched()&&(r=c.value)}return r};var p=(0,s.cellMethodLookupFactory)("copyable",!1);r.prototype.getCopyable=function(t,e){return p.call(this.instance,t,this.propToCol(e))?this.get(t,e):""},r.prototype.set=function(t,e,n,i){t=this.instance.runHooks("modifyRow",t,i||"datamapGet");var r=this.dataSource[t],o=this.instance.runHooks("modifyRowData",t);if(r=isNaN(o)?o:r,this.instance.hasHook("modifyData")){var a=(0,u.createObjectPropListener)(n);this.instance.runHooks("modifyData",t,this.propToCol(e),a,"set"),a.isTouched()&&(n=a.value)}if(r&&r.hasOwnProperty&&(0,u.hasOwnProperty)(r,e))r[e]=n;else if("string"==typeof e&&e.indexOf(".")>-1){var s=e.split("."),l=r,c=0,h=void 0;for(c=0,h=s.length-1;h>c;c++)void 0===l[s[c]]&&(l[s[c]]={}),l=l[s[c]];l[s[c]]=n}else"function"==typeof e?e(this.dataSource.slice(t,t+1)[0],n):r[e]=n},r.prototype.visualRowsToPhysical=function(t,e){for(var n,i=this.instance.countSourceRows(),r=(i+t)%i,o=[],a=e;i>r&&a;)n=this.instance.runHooks("modifyRow",r),o.push(n),a--,r++;return o},r.prototype.visualColumnsToPhysical=function(t,e){for(var n=this.instance.countCols(),i=(n+t)%n,r=[],o=e;n>i&&o;)r.push(this.instance.runHooks("modifyCol",i)),o--,i++;return r},r.prototype.clear=function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")},r.prototype.clearLengthCache=function(){this.cachedLength=null},r.prototype.getLength=function(){var t=this,e=void 0,n=this.instance.getSettings().maxRows;e=0>n||0===n?0:n||1/0;var i=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var r=this.skipCache;this.interval.start(),i!==this.latestSourceRowsCount&&(r=!0),this.latestSourceRowsCount=i,null===this.cachedLength||r?((0,d.rangeEach)(i-1,function(e){null===(e=t.instance.runHooks("modifyRow",e))&&--i}),this.cachedLength=i):i=this.cachedLength}else this.interval.stop();return Math.min(i,e)},r.prototype.getAll=function(){var t={row:0,col:0},e={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-e.row!=0||this.instance.countSourceRows()?this.getRange(t,e,r.prototype.DESTINATION_RENDERER):[]},r.prototype.getRange=function(t,e,n){var i,r,o,a,s,l=[],u=this.instance.getSettings().maxRows,c=this.instance.getSettings().maxCols;if(0===u||0===c)return[];var h=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(r=Math.min(Math.max(u-1,0),Math.max(t.row,e.row)),a=Math.min(Math.max(c-1,0),Math.max(t.col,e.col)),i=Math.min(t.row,e.row);r>=i;i++){s=[];var d=this.instance.runHooks("modifyRow",i);for(o=Math.min(t.col,e.col);a>=o&&null!==d;o++)s.push(h.call(this,i,this.colToProp(o)));null!==d&&l.push(s)}return l},r.prototype.getText=function(t,e){return a.default.stringify(this.getRange(t,e,this.DESTINATION_RENDERER))},r.prototype.getCopyableText=function(t,e){return a.default.stringify(this.getRange(t,e,this.DESTINATION_CLIPBOARD_GENERATOR))},r.prototype.onSkipLengthCache=function(t){var e=this;this.skipCache=!0,setTimeout(function(){e.skipCache=!1},t)},r.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null},e.default=r},function(t,e,n){"use strict";function i(t){return"string"==typeof t&&/fps$/.test(t)&&(t=1e3/parseInt(t.replace("fps","")||0,10)),t}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.parseDelay=i;var o=n(35);e.default=function(){function t(e,n){var r=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.timer=null,this.func=e,this.delay=i(n),this.stopped=!0,this._then=null,this._callback=function(){return r.__callback()}}return r(t,null,[{key:"create",value:function(e,n){return new t(e,n)}}]),r(t,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=(0,o.requestAnimationFrame)(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,(0,o.cancelAnimationFrame)(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=(0,o.requestAnimationFrame)(this._callback),this.delay){var t=Date.now(),e=t-this._then;e>this.delay&&(this._then=t-e%this.delay,this.func())}else this.func()}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=function(){function t(t){return null!==t&&!function(t){return t!=t}(t)&&("string"==typeof t||"number"==typeof t)}function e(t){return null!==t&&("object"==(void 0===t?"undefined":i(t))||"function"==typeof t)}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(i){return t(i)?n.arrayMap[i]:e(i)?n.weakMap.get(i):void 0},set:function(i,r){if(t(i))n.arrayMap[i]=r;else{if(!e(i))throw Error("Invalid key type");n.weakMap.set(i,r)}},delete:function(i){t(i)?delete n.arrayMap[i]:e(i)&&n.weakMap.delete(i)}}}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(13),r=n(20),o=n(11),a=n(16),s=function(t){return t&&t.__esModule?t:{default:t}}(n(4)),l=n(43);e.default=function(t,e,n){function u(t){n.setSelectedHeaders(!1,!1,!1);var i="function"==typeof e.settings.enterMoves?e.settings.enterMoves(event):e.settings.enterMoves;t?n.transformStart(-i.row,-i.col):n.transformStart(i.row,i.col,!0)}function c(a){var s,c;if(t.isListening()&&(t.runHooks("beforeKeyDown",a),!p&&!(0,o.isImmediatePropagationStopped)(a)&&(e.lastKeyCode=a.keyCode,n.isSelected()))){if(s=(a.ctrlKey||a.metaKey)&&!a.altKey,d&&!d.isWaiting()&&!((0,r.isMetaKey)(a.keyCode)||(0,r.isCtrlKey)(a.keyCode)||s||f.isEditorOpened()))return void f.openEditor("",a);switch(c=a.shiftKey?n.setRangeEnd:n.setRangeStart,a.keyCode){case r.KEY_CODES.A:!f.isEditorOpened()&&s&&(n.selectAll(),a.preventDefault(),(0,o.stopPropagation)(a));break;case r.KEY_CODES.ARROW_UP:f.isEditorOpened()&&!d.isWaiting()&&f.closeEditorAndSaveChanges(s),function(t){t?(n.selectedHeader.cols&&n.setSelectedHeaders(n.selectedHeader.rows,!1,!1),n.transformEnd(-1,0)):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(-1,0))}(a.shiftKey),a.preventDefault(),(0,o.stopPropagation)(a);break;case r.KEY_CODES.ARROW_DOWN:f.isEditorOpened()&&!d.isWaiting()&&f.closeEditorAndSaveChanges(s),function(t){t?n.transformEnd(1,0):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(1,0))}(a.shiftKey),a.preventDefault(),(0,o.stopPropagation)(a);break;case r.KEY_CODES.ARROW_RIGHT:f.isEditorOpened()&&!d.isWaiting()&&f.closeEditorAndSaveChanges(s),function(t){t?n.transformEnd(0,1):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(0,1))}(a.shiftKey),a.preventDefault(),(0,o.stopPropagation)(a);break;case r.KEY_CODES.ARROW_LEFT:f.isEditorOpened()&&!d.isWaiting()&&f.closeEditorAndSaveChanges(s),function(t){t?(n.selectedHeader.rows&&n.setSelectedHeaders(!1,n.selectedHeader.cols,!1),n.transformEnd(0,-1)):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(0,-1))}(a.shiftKey),a.preventDefault(),(0,o.stopPropagation)(a);break;case r.KEY_CODES.TAB:n.setSelectedHeaders(!1,!1,!1);var h="function"==typeof e.settings.tabMoves?e.settings.tabMoves(a):e.settings.tabMoves;a.shiftKey?n.transformStart(-h.row,-h.col):n.transformStart(h.row,h.col,!0),a.preventDefault(),(0,o.stopPropagation)(a);break;case r.KEY_CODES.BACKSPACE:case r.KEY_CODES.DELETE:n.empty(a),f.prepareEditor(),a.preventDefault();break;case r.KEY_CODES.F2:f.openEditor(null,a),d&&d.enableFullEditMode(),a.preventDefault();break;case r.KEY_CODES.ENTER:f.isEditorOpened()?(d&&d.state!==l.EditorState.WAITING&&f.closeEditorAndSaveChanges(s),u(a.shiftKey)):t.getSettings().enterBeginsEditing?(f.openEditor(null,a),d&&d.enableFullEditMode()):u(a.shiftKey),a.preventDefault(),(0,o.stopImmediatePropagation)(a);break;case r.KEY_CODES.ESCAPE:f.isEditorOpened()&&f.closeEditorAndRestoreOriginalValue(s),a.preventDefault();break;case r.KEY_CODES.HOME:n.setSelectedHeaders(!1,!1,!1),c(a.ctrlKey||a.metaKey?new i.CellCoords(0,e.selRange.from.col):new i.CellCoords(e.selRange.from.row,0)),a.preventDefault(),(0,o.stopPropagation)(a);break;case r.KEY_CODES.END:n.setSelectedHeaders(!1,!1,!1),c(a.ctrlKey||a.metaKey?new i.CellCoords(t.countRows()-1,e.selRange.from.col):new i.CellCoords(e.selRange.from.row,t.countCols()-1)),a.preventDefault(),(0,o.stopPropagation)(a);break;case r.KEY_CODES.PAGE_UP:n.setSelectedHeaders(!1,!1,!1),n.transformStart(-t.countVisibleRows(),0),a.preventDefault(),(0,o.stopPropagation)(a);break;case r.KEY_CODES.PAGE_DOWN:n.setSelectedHeaders(!1,!1,!1),n.transformStart(t.countVisibleRows(),0),a.preventDefault(),(0,o.stopPropagation)(a)}}}var h,d,f=this,p=!1;h=new s.default(t),this.destroyEditor=function(t){this.closeEditor(t)},this.getActiveEditor=function(){return d},this.prepareEditor=function(){var n,i,r,o,s,l,u;d&&d.isWaiting()?this.closeEditor(!1,!1,function(t){t&&f.prepareEditor()}):(n=e.selRange.highlight.row,i=e.selRange.highlight.col,r=t.colToProp(i),o=t.getCell(n,i),s=t.getSourceDataAtCell(t.runHooks("modifyRow",n),i),l=t.getCellMeta(n,i),(u=t.getCellEditor(l))?(d=(0,a.getEditorInstance)(u,t)).prepare(n,i,r,o,s,l):d=void 0)},this.isEditorOpened=function(){return d&&d.isOpened()},this.openEditor=function(t,e){d&&!d.cellProperties.readOnly?d.beginEditing(t,e):d&&d.cellProperties.readOnly&&e&&e.keyCode===r.KEY_CODES.ENTER&&u()},this.closeEditor=function(t,e,n){d?d.finishEditing(t,e,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(t){return this.closeEditor(!1,t)},this.closeEditorAndRestoreOriginalValue=function(t){return this.closeEditor(!0,t)},t.addHook("afterDocumentKeyDown",c),h.addEventListener(document.documentElement,"keydown",function(e){p||t.runHooks("afterDocumentKeyDown",e)}),t.view.wt.update("onCellDblClick",function(t,e,n){"TD"==n.nodeName&&(f.openEditor(),d&&d.enableFullEditMode())}),t.addHook("afterDestroy",function(){p=!0})}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){var e=this,n=this;this.eventManager=new l.default(t),this.instance=t,this.settings=t.getSettings(),this.selectionMouseDown=!1;var i=t.rootElement.getAttribute("style");i&&t.rootElement.setAttribute("data-originalstyle",i),(0,a.addClass)(t.rootElement,"handsontable");var r=document.createElement("TABLE");(0,a.addClass)(r,"htCore"),t.getSettings().tableClassName&&(0,a.addClass)(r,t.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),r.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),r.appendChild(this.TBODY),t.table=r,t.container.insertBefore(r,t.container.firstChild),this.eventManager.addEventListener(t.rootElement,"mousedown",function(t){this.selectionMouseDown=!0,n.isTextSelectionAllowed(t.target)||(d(),t.preventDefault(),window.focus())}),this.eventManager.addEventListener(t.rootElement,"mouseup",function(t){this.selectionMouseDown=!1}),this.eventManager.addEventListener(t.rootElement,"mousemove",function(t){this.selectionMouseDown&&!n.isTextSelectionAllowed(t.target)&&(d(),t.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(e){t.selection.isInProgress()&&!e.shiftKey&&t.selection.finish()});var o;this.isMouseDown=function(){return o},this.eventManager.addEventListener(document.documentElement,"mouseup",function(e){t.selection.isInProgress()&&1===e.which&&t.selection.finish(),o=!1,!(0,a.isOutsideInput)(document.activeElement)&&t.selection.isSelected()||t.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){var i=e.target,r=e.target,s=e.x||e.clientX,l=e.y||e.clientY;if(!o&&t.rootElement){if(r===t.view.wt.wtTable.holder){var u=(0,a.getScrollbarWidth)();if(document.elementFromPoint(s+u,l)!==t.view.wt.wtTable.holder||document.elementFromPoint(s,l+u)!==t.view.wt.wtTable.holder)return}else for(;r!==document.documentElement;){if(null===r){if(e.isTargetWebComponent)break;return}if(r===t.rootElement)return;r=r.parentNode}("function"==typeof n.settings.outsideClickDeselects?n.settings.outsideClickDeselects(i):n.settings.outsideClickDeselects)?t.deselectCell():t.destroyEditor()}}),this.eventManager.addEventListener(r,"selectstart",function(t){n.settings.fragmentSelection||(0,a.isInput)(t.target)||t.preventDefault()});var d=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},f=[new c.Selection({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!t.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&!t.selection.isMultiple()}}}),new c.Selection({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&t.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&t.selection.isMultiple()}}}),new c.Selection({className:"highlight",highlightHeaderClassName:n.settings.currentHeaderClassName,highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName}),new c.Selection({className:"fill",border:{width:1,color:"red"}})];f.current=f[0],f.area=f[1],f.highlight=f[2],f.fill=f[3];var p={debug:function(){return n.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:r,preventOverflow:function(){return e.settings.preventOverflow},stretchH:function(){return n.settings.stretchH},data:t.getDataAtCell,totalRows:function(){return t.countRows()},totalColumns:function(){return t.countCols()},fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},fixedRowsBottom:function(){return n.settings.fixedRowsBottom},minSpareRows:function(){return n.settings.minSpareRows},renderAllRows:n.settings.renderAllRows,rowHeaders:function(){var e=[];return t.hasRowHeaders()&&e.push(function(t,e){n.appendRowHeader(t,e)}),t.runHooks("afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return t.hasColHeaders()&&e.push(function(t,e){n.appendColHeader(t,e)}),t.runHooks("afterGetColumnHeaderRenderers",e),e},columnWidth:t.getColWidth,rowHeight:t.getRowHeight,cellRenderer:function(t,e,i){var r=n.instance.getCellMeta(t,e),o=n.instance.colToProp(e),a=n.instance.getDataAtRowProp(t,o);n.instance.hasHook("beforeValueRender")&&(a=n.instance.runHooks("beforeValueRender",a)),n.instance.runHooks("beforeRenderer",i,t,e,o,a,r),n.instance.getCellRenderer(r)(n.instance,i,t,e,o,a,r),n.instance.runHooks("afterRenderer",i,t,e,o,a,r)},selections:f,hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(e,i,r,a){var s={row:!1,column:!1,cells:!1};if(t.listen(),n.activeWt=a,o=!0,t.runHooks("beforeOnCellMouseDown",e,i,r,s),!(0,u.isImmediatePropagationStopped)(e)){var l=t.getSelectedRange(),h=t.selection,d=h.selectedHeader;if(e.shiftKey&&l)0>i.row||0>i.col||s.cells?!d.cols&&!d.rows||0>i.row||0>i.col||s.cells?d.cols&&0>i.row&&!s.column?h.setRangeEnd(new c.CellCoords(l.to.row,i.col)):d.rows&&0>i.col&&!s.row?h.setRangeEnd(new c.CellCoords(i.row,l.to.col)):(!d.cols&&!d.rows&&0>i.col||d.cols&&0>i.col)&&!s.row?(h.setSelectedHeaders(!0,!1),h.setRangeStartOnly(new c.CellCoords(l.from.row,0)),h.setRangeEnd(new c.CellCoords(i.row,t.countCols()-1))):(!d.cols&&!d.rows&&0>i.row||d.rows&&0>i.row)&&!s.column&&(h.setSelectedHeaders(!1,!0),h.setRangeStartOnly(new c.CellCoords(0,l.from.col)),h.setRangeEnd(new c.CellCoords(t.countRows()-1,i.col))):(h.setSelectedHeaders(!1,!1),h.setRangeEnd(new c.CellCoords(i.row,i.col))):(h.setSelectedHeaders(!1,!1),h.setRangeEnd(i));else{var f=!0;if(l){var p=l.from,m=l.to,g=!h.inInSelection(i);if(0>i.row&&d.cols){var v=Math.min(p.col,m.col),y=Math.max(p.col,m.col);f=v>i.col||i.col>y}else if(0>i.col&&d.rows){var w=Math.min(p.row,m.row),b=Math.max(p.row,m.row);f=w>i.row||i.row>b}else f=g}var _=(0,u.isRightClick)(e),E=(0,u.isLeftClick)(e)||"touchstart"===e.type;i.row>=0||0>i.col||s.column?i.col>=0||0>i.row||s.row?0>i.col||0>i.row||s.cells?0>i.col&&0>i.row&&(i.row=0,i.col=0,h.setSelectedHeaders(!1,!1,!0),h.setRangeStart(i)):(E||_&&f)&&(h.setSelectedHeaders(!1,!1),h.setRangeStart(i)):(h.setSelectedHeaders(!0,!1),(E||_&&f)&&(h.setRangeStartOnly(new c.CellCoords(i.row,0)),h.setRangeEnd(new c.CellCoords(i.row,Math.max(t.countCols()-1,0)),!1))):(h.setSelectedHeaders(!1,!0),(E||_&&f)&&(h.setRangeStartOnly(new c.CellCoords(0,i.col)),h.setRangeEnd(new c.CellCoords(Math.max(t.countRows()-1,0),i.col),!1)))}t.runHooks("afterOnCellMouseDown",e,i,r),n.activeWt=n.wt}},onCellMouseOut:function(e,i,r,o){n.activeWt=o,t.runHooks("beforeOnCellMouseOut",e,i,r),(0,u.isImmediatePropagationStopped)(e)||(t.runHooks("afterOnCellMouseOut",e,i,r),n.activeWt=n.wt)},onCellMouseOver:function(e,i,r,a){var s={row:!1,column:!1,cell:!1};n.activeWt=a,t.runHooks("beforeOnCellMouseOver",e,i,r,s),(0,u.isImmediatePropagationStopped)(e)||(0===e.button&&o&&(t.selection.selectedHeader.cols&&!s.column?t.selection.setRangeEnd(new c.CellCoords(t.countRows()-1,i.col),!1):t.selection.selectedHeader.rows&&!s.row?t.selection.setRangeEnd(new c.CellCoords(i.row,t.countCols()-1),!1):s.cell||t.selection.setRangeEnd(i)),t.runHooks("afterOnCellMouseOver",e,i,r),n.activeWt=n.wt)},onCellMouseUp:function(e,i,r,o){n.activeWt=o,t.runHooks("beforeOnCellMouseUp",e,i,r),t.runHooks("afterOnCellMouseUp",e,i,r),n.activeWt=n.wt},onCellCornerMouseDown:function(e){e.preventDefault(),t.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(t,e){n.beforeRender(t,e)},onDraw:function(t){n.onDraw(t)},onScrollVertically:function(){t.runHooks("afterScrollVertically")},onScrollHorizontally:function(){t.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,n){t.runHooks("beforeDrawBorders",e,n)},onBeforeTouchScroll:function(){t.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){t.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,n){return t.runHooks("beforeStretchingColumnWidth",e,n)},onModifyRowHeaderWidth:function(e){return t.runHooks("modifyRowHeaderWidth",e)},viewportRowCalculatorOverride:function(e){var i=t.countRows(),r=n.settings.viewportRowRenderingOffset;if("auto"===r&&n.settings.fixedRowsTop&&(r=10),"number"==typeof r&&(e.startRow=Math.max(e.startRow-r,0),e.endRow=Math.min(e.endRow+r,i-1)),"auto"===r){var o=e.startRow+e.endRow-e.startRow,a=Math.ceil(o/i*12);e.startRow=Math.max(e.startRow-a,0),e.endRow=Math.min(e.endRow+a,i-1)}t.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var i=t.countCols(),r=n.settings.viewportColumnRenderingOffset;if("auto"===r&&n.settings.fixedColumnsLeft&&(r=10),"number"==typeof r&&(e.startColumn=Math.max(e.startColumn-r,0),e.endColumn=Math.min(e.endColumn+r,i-1)),"auto"===r){var o=e.startColumn+e.endColumn-e.startColumn,a=Math.ceil(o/i*12);e.startRow=Math.max(e.startColumn-a,0),e.endColumn=Math.min(e.endColumn+a,i-1)}t.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return n.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.runHooks("modifyColumnHeaderHeight");return n.settings.columnHeaderHeight||e}};t.runHooks("beforeInitWalkontable",p),this.wt=new h.default(p),this.activeWt=this.wt,(0,s.isChrome)()||(0,s.isSafari)()||this.eventManager.addEventListener(t.rootElement,"wheel",function(t){t.preventDefault();var e=parseInt((0,a.getComputedStyle)(document.body)["font-size"],10),i=n.wt.wtOverlays.scrollableElement,r=t.wheelDeltaY||t.deltaY,o=t.wheelDeltaX||t.deltaX;switch(t.deltaMode){case 0:i.scrollLeft+=o,i.scrollTop+=r;break;case 1:i.scrollLeft+=o*e,i.scrollTop+=r*e}}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"mousedown",function(t){t.target===n.wt.wtTable.spreader&&3===t.which&&(0,u.stopPropagation)(t)}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"contextmenu",function(t){t.target===n.wt.wtTable.spreader&&3===t.which&&(0,u.stopPropagation)(t)}),this.eventManager.addEventListener(document.documentElement,"click",function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})}e.__esModule=!0;var o=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(0),s=n(27),l=i(n(4)),u=n(11),c=n(13),h=i(c);r.prototype.isTextSelectionAllowed=function(t){if((0,a.isInput)(t))return!0;var e=(0,a.isChildOf)(t,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())},r.prototype.isSelectedOnlyCell=function(){var t=this.instance.getSelected()||[],e=o(t,4),n=e[0],i=e[1],r=e[2],a=e[3];return void 0!==n&&n===r&&i===a},r.prototype.isCellEdited=function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()},r.prototype.beforeRender=function(t,e){t&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,e)},r.prototype.onDraw=function(t){t&&this.instance.runHooks("afterRender",this.instance.forceFullRender)},r.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1},r.prototype.getCellAtCoords=function(t,e){var n=this.wt.getCell(t,e);return 0>n?null:n},r.prototype.scrollViewport=function(t){this.wt.scrollViewport(t)},r.prototype.appendRowHeader=function(t,e){if(e.firstChild){var n=e.firstChild;if(!(0,a.hasClass)(n,"relative"))return(0,a.empty)(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var i=document.createElement("div"),r=document.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,t,this.instance.getRowHeader),i.appendChild(r),e.appendChild(i)}this.instance.runHooks("afterGetRowHeader",t,e)},r.prototype.appendColHeader=function(t,e){if(e.firstChild){var n=e.firstChild;(0,a.hasClass)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),t,this.instance.getColHeader):((0,a.empty)(e),this.appendColHeader(t,e))}else{var i=document.createElement("div"),r=document.createElement("span");i.className="relative",r.className="colHeader",this.updateCellHeader(r,t,this.instance.getColHeader),i.appendChild(r),e.appendChild(i)}this.instance.runHooks("afterGetColHeader",t,e)},r.prototype.updateCellHeader=function(t,e,n){var i=e,r=this.wt.wtOverlays.getParentOverlay(t)||this.wt;t.parentNode&&((0,a.hasClass)(t,"colHeader")?i=r.wtTable.columnFilter.sourceToRendered(e):(0,a.hasClass)(t,"rowHeader")&&(i=r.wtTable.rowFilter.sourceToRendered(e))),i>-1?(0,a.fastInnerHTML)(t,n(e)):((0,a.fastInnerText)(t,String.fromCharCode(160)),(0,a.addClass)(t,"cornerHeader"))},r.prototype.maximumVisibleElementWidth=function(t){var e=this.wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0},r.prototype.maximumVisibleElementHeight=function(t){var e=this.wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0},r.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},r.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()},e.default=r},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(1),o=n(2),a=n(5);e.default=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.hot=e,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return i(t,[{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.data;return t&&(e=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),e}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var e=this,n=[];return(0,o.arrayEach)(this.data,function(i){var o=e.colToProp(t);i="string"==typeof o?(0,r.getProperty)(i,o):i[o],n.push(i)}),n}},{key:"getAtRow",value:function(t){return this.data[t]}},{key:"getAtCell",value:function(t,e){var n=null,i=this.hot.runHooks("modifyRowData",t),o=isNaN(i)?i:this.data[t];if(o){var a=this.colToProp(e);n="string"==typeof a?(0,r.getProperty)(o,a):"function"==typeof a?a(this.data.slice(t,t+1)[0]):o[a]}return n}},{key:"getByRange",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Math.min(t.row,e.row),o=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col),u=[];return(0,a.rangeEach)(r,s,function(t){var e=n.getAtRow(t),r=void 0;"array"===n.dataType?r=e.slice(o,l+1):"object"===n.dataType&&(r=i?[]:{},(0,a.rangeEach)(o,l,function(t){var o=n.colToProp(t);i?r.push(e[o]):r[o]=e[o]})),u.push(r)}),u}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var t=0;return Array.isArray(this.data)&&("array"===this.dataType?t=this.data[0].length:"object"===this.dataType&&(t=Object.keys(this.data[0]).length)),t}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}()},function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}e.__esModule=!0;var r,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7));e.default=(r={languageCode:"en-US"},i(r,o.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),i(r,o.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),i(r,o.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),i(r,o.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),i(r,o.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),i(r,o.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),i(r,o.CONTEXTMENU_ITEMS_UNDO,"Undo"),i(r,o.CONTEXTMENU_ITEMS_REDO,"Redo"),i(r,o.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),i(r,o.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),i(r,o.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),i(r,o.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),i(r,o.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),i(r,o.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),i(r,o.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),i(r,o.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),i(r,o.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),i(r,o.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),i(r,o.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),i(r,o.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),i(r,o.CONTEXTMENU_ITEMS_BORDERS,"Borders"),i(r,o.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),i(r,o.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),i(r,o.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),i(r,o.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),i(r,o.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),i(r,o.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),i(r,o.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),i(r,o.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),i(r,o.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),i(r,o.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),i(r,o.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),i(r,o.CONTEXTMENU_ITEMS_COPY,"Copy"),i(r,o.CONTEXTMENU_ITEMS_CUT,"Cut"),i(r,o.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),i(r,o.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),i(r,o.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),i(r,o.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),i(r,o.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),i(r,o.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),i(r,o.FILTERS_CONDITIONS_NONE,"None"),i(r,o.FILTERS_CONDITIONS_EMPTY,"Is empty"),i(r,o.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),i(r,o.FILTERS_CONDITIONS_EQUAL,"Is equal to"),i(r,o.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),i(r,o.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),i(r,o.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),i(r,o.FILTERS_CONDITIONS_CONTAINS,"Contains"),i(r,o.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),i(r,o.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),i(r,o.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),i(r,o.FILTERS_CONDITIONS_LESS_THAN,"Less than"),i(r,o.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),i(r,o.FILTERS_CONDITIONS_BETWEEN,"Is between"),i(r,o.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),i(r,o.FILTERS_CONDITIONS_AFTER,"After"),i(r,o.FILTERS_CONDITIONS_BEFORE,"Before"),i(r,o.FILTERS_CONDITIONS_TODAY,"Today"),i(r,o.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),i(r,o.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),i(r,o.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),i(r,o.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),i(r,o.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),i(r,o.FILTERS_LABELS_CONJUNCTION,"And"),i(r,o.FILTERS_LABELS_DISJUNCTION,"Or"),i(r,o.FILTERS_BUTTONS_SELECT_ALL,"Select all"),i(r,o.FILTERS_BUTTONS_CLEAR,"Clear"),i(r,o.FILTERS_BUTTONS_OK,"OK"),i(r,o.FILTERS_BUTTONS_CANCEL,"Cancel"),i(r,o.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),i(r,o.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),i(r,o.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),r)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){u(t,e)}function o(){return c()}e.__esModule=!0,e.getPhraseFormatters=e.registerPhraseFormatter=void 0,e.register=r,e.getAll=o;var a=i(n(42)),s=i(n(252)),l=(0,a.default)("phraseFormatters"),u=l.register,c=l.getValues;e.registerPhraseFormatter=r,e.getPhraseFormatters=o,r("pluralize",s.default)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){var e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){var n=this.first(),i=n.data("handsontable");if("string"!=typeof e){var r=e||{};return i?i.updateSettings(r):(i=new t.Core(n[0],r),n.data("handsontable",i),i.init()),n}var o=[],a=void 0;if(arguments.length>1)for(var s=1,l=arguments.length;l>s;s++)o.push(arguments[s]);if(i){if(void 0===i[e])throw Error("Handsontable do not provide action: "+e);a=i[e].apply(i,o),"destroy"===e&&n.removeData()}return a})}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.Base=e.UndoRedo=e.TouchScroll=e.Search=e.PersistentState=e.ObserveChanges=e.MultipleSelectionHandles=e.MergeCells=e.ManualRowResize=e.ManualRowMove=e.ManualColumnResize=e.ManualColumnMove=e.ManualColumnFreeze=e.DragToScroll=e.CustomBorders=e.CopyPaste=e.ContextMenu=e.Comments=e.ColumnSorting=e.AutoRowSize=e.AutoFill=e.AutoColumnSize=void 0;var r=i(n(255)),o=i(n(256)),a=i(n(258)),s=i(n(259)),l=i(n(262)),u=i(n(266)),c=i(n(283)),h=i(n(290)),d=i(n(291)),f=i(n(292)),p=i(n(296)),m=i(n(301)),g=i(n(302)),v=i(n(307)),y=i(n(308)),w=i(n(309)),b=i(n(310)),_=i(n(313)),E=i(n(314)),T=i(n(315)),C=i(n(316)),x=i(n(14));e.AutoColumnSize=r.default,e.AutoFill=o.default,e.AutoRowSize=a.default,e.ColumnSorting=s.default,e.Comments=l.default,e.ContextMenu=u.default,e.CopyPaste=c.default,e.CustomBorders=h.default,e.DragToScroll=d.default,e.ManualColumnFreeze=f.default,e.ManualColumnMove=p.default,e.ManualColumnResize=m.default,e.ManualRowMove=g.default,e.ManualRowResize=v.default,e.MergeCells=y.default,e.MultipleSelectionHandles=w.default,e.ObserveChanges=b.default,e.PersistentState=_.default,e.Search=E.default,e.TouchScroll=T.default,e.UndoRedo=C.default,e.Base=x.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=i(n(14)),l=n(2),u=n(35),c=n(0),h=i(n(87)),d=n(1),f=n(5),p=n(6),m=i(n(180)),g=n(33),v=n(13),y=new WeakMap,w=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y.set(n,{cachedColumnHeaders:[]}),n.widths=[],n.ghostTable=new h.default(n.hot),n.samplesGenerator=new m.default(function(t,e){return n.hot.getDataAtCell(t,e)}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeColumnResize",function(t,e,i){return n.onBeforeColumnResize(t,e,i)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),a(e,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),a(e,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().autoColumnSize;n&&null!=n.useHeaders&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeChange",function(e){return t.onBeforeChange(e)}),this.addHook("beforeRender",function(e){return t.onBeforeRender(e)}),this.addHook("modifyColWidth",function(e,n){return t.getColumnWidth(n,e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&this.clearCache(t),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"number"==typeof t&&(t={from:t,to:t}),"number"==typeof n&&(n={from:n,to:n}),(0,f.rangeEach)(t.from,t.to,function(t){(i||void 0===e.widths[t]&&!e.hot._getColWidthFromSettings(t))&&e.samplesGenerator.generateColumnSamples(t,n).forEach(function(t,n){return e.ghostTable.addColumn(n,t)})}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(t,n){e.widths[t]=n}),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},i=0,r=this.hot.countCols()-1,o=null;this.inProgress=!0,this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},n),this.firstCalculation=!1,i=this.getSyncCalculationLimit()+1),r>i?function a(){if(!t.hot)return(0,u.cancelAnimationFrame)(o),void(t.inProgress=!1);t.calculateColumnsWidth({from:i,to:Math.min(i+e.CALCULATION_STEP,r)},n),r>(i=i+e.CALCULATION_STEP+1)?o=(0,u.requestAnimationFrame)(a):((0,u.cancelAnimationFrame)(o),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoColumnSize,e=t&&(0,d.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,n=t&&(0,d.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&(0,c.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=e.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return(0,d.isObject)(this.hot.getSettings().autoColumnSize)&&(t=this.hot.getSettings().autoColumnSize.syncLimit,(0,g.isPercentValue)(t)?t=(0,f.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}},{key:"getColumnWidth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=2>=arguments.length||void 0===arguments[2]||arguments[2],i=e;return void 0===i&&(i=this.widths[t],n&&"number"==typeof i&&(i=Math.max(i,v.ViewportColumnsCalculator.DEFAULT_WIDTH))),i}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getFirstVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getLastVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),e=y.get(this).cachedColumnHeaders;return(0,l.arrayReduce)(t,function(t,n,i){var r=e.length;return(i>r-1||e[i]!==n)&&t.push(i),i>r-1?e.push(n):e[i]=n,t},[])}},{key:"clearCache",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?(0,l.arrayEach)(e,function(e){t.widths[e]=void 0}):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!(0,l.arrayFilter)(this.widths,function(t){return void 0===t}).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall;this.hot.countRows()&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,t),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){t.hot&&t.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(t){var e=this;this.clearCache((0,l.arrayMap)(t,function(t){var n=r(t,2);return e.hot.propToCol(n[1])}))}},{key:"onBeforeColumnResize",value:function(t,e,n){return n&&(this.calculateColumnsWidth(t,void 0,!0),e=this.getColumnWidth(t,void 0,!1)),e}},{key:"onAfterInit",value:function(){y.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();(0,p.registerPlugin)("autoColumnSize",w),e.default=w},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=i(n(14)),s=i(n(8)),l=n(0),u=i(n(4)),c=n(6),h=n(13),d=n(257);s.default.getSingleton().register("modifyAutofillRange"),s.default.getSingleton().register("beforeAutofill");var f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new u.default(n),n.addingStarted=!1,n.mouseDownOnCellCorner=!1,n.mouseDragOutside=!1,n.handleDraggedCells=0,n.directions=[],n.autoInsertRow=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(e){return t.onAfterCellCornerMouseDown(e)}),this.addHook("afterOnCellCornerDblClick",function(e){return t.onCellCornerDblClick(e)}),this.addHook("beforeOnCellMouseOver",function(e,n,i){return t.onBeforeCellMouseOver(n)}),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var t={from:this.hot.getSelectedRange().from,to:this.hot.getSelectedRange().to};return this.hot.getData(t.from.row,t.from.col,t.to.row,t.to.col)}},{key:"fillIn",value:function(){if(this.hot.view.wt.selections.fill.isEmpty())return!1;var t=this.hot.view.wt.selections.fill.getCorners();this.resetSelectionOfDraggedArea();var e=this.getCornersOfSelectedCells(),n=(0,d.getDragDirectionAndRange)(e,t),i=n.directionOfDrag,r=n.startOfDragCoords,o=n.endOfDragCoords;if(this.hot.runHooks("modifyAutofillRange",e,t),r&&r.row>-1&&r.col>-1){var a=this.getSelectionData(),s=(0,d.getDeltas)(r,o,a,i),l=a;if(this.hot.runHooks("beforeAutofill",r,o,a),["up","left"].indexOf(i)>-1){l=[];var u=null,c=null;if("up"===i){c=(u=o.row-r.row+1)%a.length;for(var h=0;u>h;h++)l.push(a[(h+(a.length-c))%a.length])}else{c=(u=o.col-r.col+1)%a[0].length;for(var f=0;a.length>f;f++){l.push([]);for(var p=0;u>p;p++)l[f].push(a[f][(p+(a[f].length-c))%a[f].length])}}}this.hot.populateFromArray(r.row,r.col,l,o.row,o.col,this.pluginName+".fill",null,i,s),this.setSelection(t)}else this.hot.selection.refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return 0>t.row&&(t.row=0),0>t.col&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e=this.hot.getSelectedRange().getTopLeftCorner(),n=this.hot.getSelectedRange().getBottomRightCorner(),i=void 0;if(this.directions.includes(d.DIRECTIONS.vertical)&&(t.row>n.row||e.row>t.row))i=new h.CellCoords(t.row,n.col);else{if(!this.directions.includes(d.DIRECTIONS.horizontal))return;i=new h.CellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(i)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.alter("insert_row",void 0,1,t.pluginName+".fill"),t.addingStarted=!1},200))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.view.wt.selections.fill.cellRange&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelected(),e=this.hot.view.wt.selections.fill.getCorners(),n=this.hot.countRows();n-1>t[2]&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.view.wt.selections.area.getCorners():this.hot.view.wt.selections.current.getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e=this.hot.getData(),n=this.hot.countRows(),i=void 0,r=t[2]+1;n>r;r++){for(var o=t[1];t[3]>=o;o++)if(e[r][o])return-1;var a=e[r][t[1]-1],s=e[r][t[3]+1];(a||s)&&(i=r)}return i}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.view.wt.selections.fill.clear(),this.hot.view.wt.selections.fill.add(new h.CellCoords(t[0],t[1])),this.hot.view.wt.selections.fill.add(new h.CellCoords(e,t[3]))}},{key:"setSelection",value:function(t){this.hot.selection.setRangeStart(new h.CellCoords(t[0],t[1])),this.hot.selection.setRangeEnd(new h.CellCoords(t[2],t[3]))}},{key:"selectAdjacent",value:function(){var t=this.getCornersOfSelectedCells(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.view.wt.selections.fill.clear()}},{key:"redrawBorders",value:function(t){this.hot.view.wt.selections.fill.clear(),this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().from),this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().to),this.hot.view.wt.selections.fill.add(t),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=(0,l.offset)(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+(0,l.outerHeight)(this.hot.table),n=(0,l.offset)(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+(0,l.outerWidth)(this.hot.table);return t.clientY>e&&n>=t.clientX}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return t.onMouseUp()}),this.eventManager.addEventListener(document.documentElement,"mousemove",function(e){return t.onMouseMove(e)})}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells++,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=(0,d.getMappedFillHandleSetting)(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();(0,c.registerPlugin)("autofill",f),e.default=f},function(t,e,n){"use strict";e.__esModule=!0,e.DIRECTIONS=void 0,e.getDeltas=function(t,e,n,i){var r=n.length,o=n?n[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(-1!==["down","up"].indexOf(i)){for(var u=[],c=0;l>=c;c++){var h=parseInt(n[0][c],10),d=parseInt(n[r-1][c],10);u.push(("down"===i?d-h:h-d)/(r-1)||0)}a.push(u)}if(-1!==["right","left"].indexOf(i))for(var f=0;s>=f;f++){var p=parseInt(n[f][0],10),m=parseInt(n[f][o-1],10),g=("right"===i?m-p:p-m)/(o-1)||0;a.push([g])}return a},e.getDragDirectionAndRange=function(t,e){var n=void 0,i=void 0,r=void 0;return e[0]===t[0]&&t[1]>e[1]?(r="left",n=new o.CellCoords(e[0],e[1]),i=new o.CellCoords(e[2],t[1]-1)):e[0]===t[0]&&e[3]>t[3]?(r="right",n=new o.CellCoords(e[0],t[3]+1),i=new o.CellCoords(e[2],e[3])):t[0]>e[0]&&e[1]===t[1]?(r="up",n=new o.CellCoords(e[0],e[1]),i=new o.CellCoords(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",n=new o.CellCoords(t[2]+1,e[1]),i=new o.CellCoords(e[2],e[3])),{directionOfDrag:r,startOfDragCoords:n,endOfDragCoords:i}},e.getMappedFillHandleSetting=function(t){var e={};return!0===t?(e.directions=Object.keys(a),e.autoInsertRow=!0):(0,i.isObject)(t)?(e.autoInsertRow=!!(0,r.isDefined)(t.autoInsertRow)&&t.direction!==a.horizontal&&t.autoInsertRow,e.directions=(0,r.isDefined)(t.direction)?[t.direction]:Object.keys(a)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e};var i=n(1),r=n(17),o=n(13),a=e.DIRECTIONS={horizontal:"horizontal",vertical:"vertical"}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=i(n(14)),s=n(2),l=n(35),u=n(0),c=i(n(87)),h=n(1),d=n(5),f=n(6),p=i(n(180)),m=n(33),g=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.heights=[],n.ghostTable=new c.default(n.hot),n.samplesGenerator=new p.default(function(t,e){return 0>t?-1===t?n.hot.getColHeader(e):null:n.hot.getDataAtCell(t,e)}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeRowResize",function(t,e,i){return n.onBeforeRowResize(t,e,i)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),o(e,[{key:"isEnabled",value:function(){return!0===this.hot.getSettings().autoRowSize||(0,h.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeChange",function(e){return t.onBeforeChange(e)}),this.addHook("beforeColumnMove",function(){return t.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return t.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return t.clearCache()}),this.addHook("beforeRender",function(e){return t.onBeforeRender(e)}),this.addHook("beforeRowMove",function(e,n){return t.onBeforeRowMove(e,n)}),this.addHook("modifyRowHeight",function(e,n){return t.getRowHeight(n,e)}),this.addHook("modifyColumnHeaderHeight",function(){return t.getColumnHeaderHeight()}),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"number"==typeof t&&(t={from:t,to:t}),"number"==typeof n&&(n={from:n,to:n}),null!==this.hot.getColHeader(0)&&this.ghostTable.addColumnHeadersRow(this.samplesGenerator.generateRowSamples(-1,n).get(-1)),(0,d.rangeEach)(t.from,t.to,function(t){(i||void 0===e.heights[t])&&e.samplesGenerator.generateRowSamples(t,n).forEach(function(t,n){e.ghostTable.addRow(n,t)})}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(t,n){e.heights[t]=n}),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},i=0,r=this.hot.countRows()-1,o=null;this.inProgress=!0,this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},n),this.firstCalculation=!1,i=this.getSyncCalculationLimit()+1),r>i?function a(){if(!t.hot)return(0,l.cancelAnimationFrame)(o),void(t.inProgress=!1);t.calculateRowsHeight({from:i,to:Math.min(i+e.CALCULATION_STEP,r)},n),r>(i=i+e.CALCULATION_STEP+1)?o=(0,l.requestAnimationFrame)(a):((0,l.cancelAnimationFrame)(o),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoRowSize,e=t&&(0,h.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,n=t&&(0,h.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){(0,u.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=e.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return(0,h.isObject)(this.hot.getSettings().autoRowSize)&&(t=this.hot.getSettings().autoRowSize.syncLimit,(0,m.isPercentValue)(t)?t=(0,d.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}},{key:"getRowHeight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e;return void 0!==this.heights[t]&&this.heights[t]>(e||0)&&(n=this.heights[t]),n}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0,this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(t){var e=this;"number"==typeof t&&(t={from:t,to:t}),(0,d.rangeEach)(Math.min(t.from,t.to),Math.max(t.from,t.to),function(t){e.heights[t]=void 0})}},{key:"isNeedRecalculate",value:function(){return!!(0,s.arrayFilter)(this.heights,function(t){return void 0===t}).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,t);var e=this.hot.getSettings().fixedRowsBottom;if(e){var n=this.hot.countRows()-1;this.calculateRowsHeight({from:n-e,to:n})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,n){return n&&(this.calculateRowsHeight(t,void 0,!0),e=this.getRowHeight(t)),e}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){t.hot&&t.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();(0,f.registerPlugin)("autoRowSize",g),e.default=g},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},s=i(n(52)),l=n(0),u=n(2),c=n(17),h=n(1),d=i(n(14)),f=n(6),p=i(n(260)),m=i(n(8));m.default.getSingleton().register("beforeColumnSort"),m.default.getSingleton().register("afterColumnSort");var g=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.sortIndicators=[],n.lastSortedColumn=null,n.sortEmptyCells=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d.default),o(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSorting}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.setPluginOptions();var n=this;this.hot.sortIndex=[],this.hot.sort=function(){var t=Array.prototype.slice.call(arguments);return n.sortByColumn.apply(n,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);t.length>e;e++)n[e]=t[e];return n}return Array.from(t)}(t))},void 0===this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(e){return t.sort()}),this.addHook("afterUntrimRow",function(e){return t.sort()}),this.addHook("modifyRow",function(e){return t.translateRow(e)}),this.addHook("unmodifyRow",function(e){return t.untranslateRow(e)}),this.addHook("afterUpdateSettings",function(){return t.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(e,n){return t.getColHeader(e,n)}),this.addHook("afterOnCellMouseDown",function(e,n){return t.onAfterOnCellMouseDown(e,n)}),this.addHook("afterCreateRow",function(){n.afterCreateRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){n.afterRemoveRow.apply(n,arguments)}),this.addHook("afterInit",function(){return t.sortBySettings()}),this.addHook("afterLoadData",function(){t.hot.sortIndex=[],t.hot.view&&t.sortBySettings()}),this.hot.view&&this.sortBySettings(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.sort=void 0,a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"onAfterUpdateSettings",value:function(){this.sortBySettings()}},{key:"sortBySettings",value:function(){var t=this.hot.getSettings().columnSorting,e=this.loadSortingState(),n=void 0,i=void 0;void 0===e?(n=t.column,i=t.sortOrder):(n=e.sortColumn,i=e.sortOrder),"number"==typeof n&&(this.lastSortedColumn=n,this.sortByColumn(n,i))}},{key:"setSortingColumn",value:function(t,e){if(void 0===t)return this.hot.sortColumn=void 0,void(this.hot.sortOrder=void 0);this.hot.sortOrder=this.hot.sortColumn===t&&void 0===e?!1===this.hot.sortOrder?void 0:!this.hot.sortOrder:void 0===e||e,this.hot.sortColumn=t}},{key:"sortByColumn",value:function(t,e){this.setSortingColumn(t,e),void 0!==this.hot.sortColumn&&(!1!==this.hot.runHooks("beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder)&&this.sort(),this.updateOrderClass(),this.updateSortIndicator(),this.hot.runHooks("afterColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.hot.render(),this.saveSortingState())}},{key:"saveSortingState",value:function(){var t={};void 0!==this.hot.sortColumn&&(t.sortColumn=this.hot.sortColumn),void 0!==this.hot.sortOrder&&(t.sortOrder=this.hot.sortOrder),((0,h.hasOwnProperty)(t,"sortColumn")||(0,h.hasOwnProperty)(t,"sortOrder"))&&this.hot.runHooks("persistentStateSave","columnSorting",t)}},{key:"loadSortingState",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","columnSorting",t),t.value}},{key:"updateOrderClass",value:function(){var t=void 0;!0===this.hot.sortOrder?t="ascending":!1===this.hot.sortOrder&&(t="descending"),this.sortOrderClass=t}},{key:"enableObserveChangesPlugin",value:function(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.updateSettings({observeChanges:!0})},0))}},{key:"defaultSort",value:function(t,e){return function(n,i){return"string"==typeof n[1]&&(n[1]=n[1].toLowerCase()),"string"==typeof i[1]&&(i[1]=i[1].toLowerCase()),n[1]===i[1]?0:(0,c.isEmpty)(n[1])?(0,c.isEmpty)(i[1])?0:e.columnSorting.sortEmptyCells&&t?-1:1:(0,c.isEmpty)(i[1])?(0,c.isEmpty)(n[1])?0:e.columnSorting.sortEmptyCells&&t?1:-1:isNaN(n[1])&&!isNaN(i[1])?t?1:-1:!isNaN(n[1])&&isNaN(i[1])?t?-1:1:(isNaN(n[1])||isNaN(i[1])||(n[1]=parseFloat(n[1]),i[1]=parseFloat(i[1])),i[1]>n[1]?t?-1:1:n[1]>i[1]?t?1:-1:0)}}},{key:"dateSort",value:function(t,e){return function(n,i){if(n[1]===i[1])return 0;if((0,c.isEmpty)(n[1]))return(0,c.isEmpty)(i[1])?0:e.columnSorting.sortEmptyCells&&t?-1:1;if((0,c.isEmpty)(i[1]))return(0,c.isEmpty)(n[1])?0:e.columnSorting.sortEmptyCells&&t?1:-1;var r=(0,s.default)(n[1],e.dateFormat),o=(0,s.default)(i[1],e.dateFormat);return r.isValid()?o.isValid()?o.isAfter(r)?t?-1:1:o.isBefore(r)?t?1:-1:0:-1:1}}},{key:"numericSort",value:function(t,e){return function(n,i){var r=parseFloat(n[1]),o=parseFloat(i[1]);if(r===o||isNaN(r)&&isNaN(o))return 0;if(e.columnSorting.sortEmptyCells){if((0,c.isEmpty)(n[1]))return t?-1:1;if((0,c.isEmpty)(i[1]))return t?1:-1}return isNaN(r)?1:isNaN(o)?-1:o>r?t?-1:1:r>o?t?1:-1:0}}},{key:"sort",value:function(){if(void 0!==this.hot.sortOrder){var t=this.hot.getCellMeta(0,this.hot.sortColumn),e=this.hot.countEmptyRows(),n=void 0;this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0,void 0===t.columnSorting.sortEmptyCells&&(t.columnSorting={sortEmptyCells:this.sortEmptyCells});for(var i=0,r=this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY?this.hot.countRows()-this.hot.getSettings().minSpareRows:this.hot.countRows()-e;r>i;i++)this.hot.sortIndex.push([i,this.hot.getDataAtCell(i,this.hot.sortColumn)]);if(t.sortFunction)n=t.sortFunction;else switch(t.type){case"date":n=this.dateSort;break;case"numeric":n=this.numericSort;break;default:n=this.defaultSort}(0,p.default)(this.hot.sortIndex,n(this.hot.sortOrder,t));for(var o=this.hot.sortIndex.length;o<this.hot.countRows();o++)this.hot.sortIndex.push([o,this.hot.getDataAtCell(o,this.hot.sortColumn)]);this.hot.sortingEnabled=!0}else this.hot.sortIndex.length=0}},{key:"updateSortIndicator",value:function(){void 0!==this.hot.sortOrder&&(this.sortIndicators[this.hot.sortColumn]=this.hot.getCellMeta(0,this.hot.sortColumn).sortIndicator)}},{key:"translateRow",value:function(t){return this.hot.sortingEnabled&&void 0!==this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[t]?this.hot.sortIndex[t][0]:t}},{key:"untranslateRow",value:function(t){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var e=0;this.hot.sortIndex.length>e;e++)if(this.hot.sortIndex[e][0]==t)return e}},{key:"getColHeader",value:function(t,e){if(0>t||!e.parentNode)return!1;var n=e.querySelector(".colHeader"),i=(e.getAttribute("colspan"),e.parentNode.parentNode.childNodes),r=Array.prototype.indexOf.call(i,e.parentNode);r-=i.length,n&&(this.hot.getSettings().columnSorting&&t>=0&&-1===r&&(0,l.addClass)(n,"columnSorting"),(0,l.removeClass)(n,"descending"),(0,l.removeClass)(n,"ascending"),this.sortIndicators[t]&&t===this.hot.sortColumn&&("ascending"===this.sortOrderClass?(0,l.addClass)(n,"ascending"):"descending"===this.sortOrderClass&&(0,l.addClass)(n,"descending")))}},{key:"isSorted",value:function(){return void 0!==this.hot.sortColumn}},{key:"afterCreateRow",value:function(t,e){if(this.isSorted()){for(var n=0;this.hot.sortIndex.length>n;n++)t>this.hot.sortIndex[n][0]||(this.hot.sortIndex[n][0]+=e);for(var i=0;e>i;i++)this.hot.sortIndex.splice(t+i,0,[t+i,this.hot.getSourceData()[t+i][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}}},{key:"afterRemoveRow",value:function(t,e){if(this.isSorted()){var n=this.hot.sortIndex.splice(t,e);n=(0,u.arrayMap)(n,function(t){return t[0]}),this.hot.sortIndex=(0,u.arrayMap)(this.hot.sortIndex,function(t,e){var i=function(t){return(0,u.arrayReduce)(n,function(e,n){return t>n&&e++,e},0)}(t[0]);return i&&(t[0]-=i),t}),this.saveSortingState()}}},{key:"setPluginOptions",value:function(){var t=this.hot.getSettings().columnSorting;this.sortEmptyCells="object"===(void 0===t?"undefined":r(t))&&(t.sortEmptyCells||!1)}},{key:"onAfterOnCellMouseDown",value:function(t,e){e.row>-1||(0,l.hasClass)(t.realTarget,"columnSorting")&&(e.col!==this.lastSortedColumn&&(this.hot.sortOrder=!0),this.lastSortedColumn=e.col,this.sortByColumn(e.col))}}]),e}();(0,f.registerPlugin)("columnSorting",g),e.default=g},function(t,e,n){"use strict";function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(1>=Math.abs(o-n))return[];var s=Math.ceil((n+o)/2);return i(t,e,n,s),i(t,e,s,o),r(t,e,n,s,o)}function r(t,e,n,i,r){for(var a=new o.default,s=new o.default,l=i-n,u=r-i,c=Math.max(l,u),h=r-n,d=0;c>d;d+=1)l>d&&a.push(t[n+d]),u>d&&s.push(t[i+d]);for(var f=0;h>f;)t[n+f]=a.first&&s.first?e(a.first.data,s.first.data)>0?s.shift().data:a.shift().data:a.first?a.shift().data:s.shift().data,f+=1;return t}e.__esModule=!0,e.default=i,e.merge=r;var o=function(t){return t&&t.__esModule?t:{default:t}}(n(261)),a=function(t,e){var n=""+t,i=""+e;return n===i?0:i>n?-1:1}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e){i(this,t),this.data=e,this.next=null,this.prev=null},a=function(){function t(){i(this,t),this.first=null,this.last=null}return r(t,[{key:"push",value:function(t){var e=new o(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.last;this.last=e,e.prev=n,n.next=e}}},{key:"unshift",value:function(t){var e=new o(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.first;this.first=e,e.next=n,n.prev=e}}},{key:"inorder",value:function(t){for(var e=this.first;e;)t(e),e=e.next}},{key:"remove",value:function(t){if(null===this.first)return!1;for(var e=this.first,n=void 0,i=void 0;e;){if(e.data===t)return n=e.next,i=e.prev,n&&(n.prev=i),i&&(i.next=n),e===this.first&&(this.first=n),e===this.last&&(this.last=i),!0;e=e.next}return!1}},{key:"hasCycle",value:function(){for(var t=this.first,e=this.first;;){if(null===t)return!1;if(null===(t=t.next))return!1;if(t=t.next,e=e.next,t===e)return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var t=this.last;return this.last=this.last.prev,t}},{key:"shift",value:function(){if(null===this.first)return null;var t=this.first;return this.first=this.first.next,t}},{key:"recursiveReverse",value:function(){function t(e,n){n&&(t(n,n.next),n.next=e)}if(this.first){t(this.first,this.first.next),this.first.next=null;var e=this.first;this.first=this.last,this.last=e}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var t=this.first.next,e=this.first,n=void 0;t;)n=t.next,t.next=e,e.prev=t,e=t,t=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=e,this.last=n}}}]),t}();e.NodeStructure=o,e.default=a},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}e.__esModule=!0;var o=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},s=n(0),l=n(1),u=i(n(4)),c=n(13),h=n(6),d=i(n(14)),f=i(n(263)),p=n(21),m=i(n(264)),g=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7));n(265);var v=new WeakMap,y=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.editor=null,n.displaySwitch=null,n.eventManager=null,n.range={},n.mouseDown=!1,n.contextMenuEvent=!1,n.timer=null,v.set(n,{tempEditorDimensions:{},cellBelowCursor:null}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d.default),o(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.editor||(this.editor=new f.default),this.eventManager||(this.eventManager=new u.default(this)),this.displaySwitch||(this.displaySwitch=new m.default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(e){return t.addToContextMenu(e)}),this.addHook("afterRenderer",function(e,n,i,r,o,a){return t.onAfterRenderer(e,a)}),this.addHook("afterScrollHorizontally",function(){return t.hide()}),this.addHook("afterScrollVertically",function(){return t.hide()}),this.addHook("afterBeginEditing",function(e){return t.onAfterBeginEditing(e)}),this.displaySwitch.addLocalHook("hide",function(){return t.hide()}),this.displaySwitch.addLocalHook("show",function(e,n){return t.showAtCell(e,n)}),this.registerListeners(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var t=this;this.eventManager.addEventListener(document,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(document,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(document,"mouseup",function(e){return t.onMouseUp(e)}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(e){return t.onEditorBlur(e)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(e){return t.onEditorMouseDown(e)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(e){return t.onEditorMouseUp(e)})}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=(0,s.closest)(t.target,"TD","TBODY");return!!(e&&(0,s.hasClass)(e,"htCommentCell")&&(0,s.closest)(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!=t?n=t:null!=e&&(n=e),this.updateCommentMeta(this.range.from.row,this.range.from.col,r({},"value",n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:new c.CellCoords(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(){var t=0>=arguments.length||void 0===arguments[0]||arguments[0];if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment",void 0),t&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e){var n=2>=arguments.length||void 0===arguments[2]||arguments[2];this.setRange({from:new c.CellCoords(t,e)}),this.removeComment(n)}},{key:"getComment",value:function(){return this.getCommentMeta(this.range.from.row,this.range.from.col,"value")}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,"value")}},{key:"show",value:function(){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(t.comment?t.comment.value:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:new c.CellCoords(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible()){var t=(0,s.getScrollableElement)(this.hot.view.wt.wtTable.TABLE),e=this.hot.view.wt.wtTable.getCell(this.range.from),n=this.range.from.row,i=this.range.from.col,r=(0,s.offset)(e),o=this.hot.view.wt.wtTable.getStretchedColumnWidth(i),a=0>r.top?0:r.top,l=r.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&t!==window&&(a-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition()),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&t!==window&&(l-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var u=l+o,c=a,h=this.getCommentMeta(n,i,"style"),d=this.getCommentMeta(n,i,"readOnly");h?this.editor.setSize(h.width,h.height):this.editor.resetSize(),this.editor.setReadOnlyState(d),this.editor.setPosition(u,c)}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRange();if(!t)return!1;var e=!1,n=t.from;return this.getCommentMeta(n.row,n.col,"value")&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var i=this.hot.getCellMeta(t,e).comment,r=void 0;i?(r=(0,l.deepClone)(i),(0,l.deepExtend)(r,n)):r=n,this.hot.setCellMeta(t,e,"comment",r)}},{key:"getCommentMeta",value:function(t,e,n){var i=this.hot.getCellMeta(t,e);if(i.comment)return i.comment[n]}},{key:"onMouseDown",value:function(t){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(t)){var e=(0,s.closest)(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.view.wt.wtTable.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(t){var e=v.get(this);if(e.cellBelowCursor=document.elementFromPoint(t.clientX,t.clientY),!(this.mouseDown||this.editor.isFocused()||(0,s.hasClass)(t.target,"wtBorder")||e.cellBelowCursor!==t.target)&&this.editor)if(this.targetIsCellWithComment(t)){var n=this.hot.view.wt.wtTable.getCoords(t.target),i={from:new c.CellCoords(n.row,n.col)};this.displaySwitch.show(i)}else(0,s.isChildOf)(t.target,document)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(t){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(t,e){e.comment&&e.comment.value&&(0,s.addClass)(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(t){this.setComment()}},{key:"onEditorMouseDown",value:function(t){v.get(this).tempEditorDimensions={width:(0,s.outerWidth)(t.target),height:(0,s.outerHeight)(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=v.get(this),n=(0,s.outerWidth)(t.target),i=(0,s.outerHeight)(t.target);n===e.tempEditorDimensions.width+1&&i===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,r({},"style",{width:n,height:i}))}},{key:"onContextMenuAddComment",value:function(){var t=this;this.displaySwitch.cancelHiding();var e=this.hot.getSelectedRange();this.contextMenuEvent=!0,this.setRange({from:e.from}),this.show(),setTimeout(function(){t.hot&&(t.hot.deselectCell(),t.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(t){this.contextMenuEvent=!0;for(var e=t.start.row;t.end.row>=e;e++)for(var n=t.start.col;t.end.col>=n;n++)this.removeCommentAtCell(e,n,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(t){this.contextMenuEvent=!0;for(var e=t.start.row;t.end.row>=e;e++)for(var n=t.start.col;t.end.col>=n;n++){var i=!!this.getCommentMeta(e,n,"readOnly");this.updateCommentMeta(e,n,r({},"readOnly",!i))}}},{key:"addToContextMenu",value:function(t){var e=this;t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.hot.getTranslatedPhrase(e.checkSelectionCommentsConsistency()?g.CONTEXTMENU_ITEMS_EDIT_COMMENT:g.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!(this.getSelected()&&!this.selection.selectedHeader.corner)}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(t,n){return e.onContextMenuRemoveComment(n)},disabled:function(){return e.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function(){var t=this,e=this.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return(0,p.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){var i=t.getCellMeta(e,n).comment;if(i&&(i=i.readOnly),i)return!0})&&(e=(0,p.markLabelAsSelected)(e)),e},callback:function(t,n){return e.onContextMenuMakeReadOnly(n)},disabled:function(){return e.hot.selection.selectedHeader.corner||!e.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings().comments;if((0,l.isObject)(t))return t.displayDelay}},{key:"onAfterBeginEditing",value:function(t,e){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();(0,h.registerPlugin)("comments",y),e.default=y},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0);e.default=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return i(t,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),i(t,[{key:"setPosition",value:function(t,e){this.editorStyle.left=t+"px",this.editorStyle.top=e+"px"}},{key:"setSize",value:function(t,e){if(t&&e){var n=this.getInputElement();n.style.width=t+"px",n.style.height=e+"px"}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){this.getInputElement().readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t||"",this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return document.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=document.querySelector("."+t.CLASS_EDITOR_CONTAINER),n=void 0,i=void 0;return e||(e=document.createElement("div"),(0,r.addClass)(e,t.CLASS_EDITOR_CONTAINER),document.body.appendChild(e)),n=document.createElement("div"),(0,r.addClass)(n,t.CLASS_EDITOR),i=document.createElement("textarea"),(0,r.addClass)(i,t.CLASS_INPUT),n.appendChild(i),e.appendChild(n),n}},{key:"getInputElement",value:function(){return this.editor.querySelector("."+t.CLASS_INPUT)}},{key:"destroy",value:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(36),o=n(1),a=function(t){return t&&t.__esModule?t:{default:t}}(n(89)),s=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}return i(t,[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")},250)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=(0,r.debounce)(function(e){t.wasLastActionShow&&t.runLocalHooks("show",e.from.row,e.from.col)},e)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();(0,o.mixin)(s,a.default),e.default=s},function(t,e){},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=i(n(14)),s=i(n(8)),l=n(2),u=i(n(267)),c=i(n(4)),h=i(n(268)),d=i(n(280)),f=n(6),p=n(11),m=n(0),g=n(90);n(282),s.default.getSingleton().register("afterContextMenuDefaultOptions"),s.default.getSingleton().register("afterContextMenuShow"),s.default.getSingleton().register("afterContextMenuHide"),s.default.getSingleton().register("afterContextMenuExecute");var v=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new c.default(n),n.commandExecutor=new u.default(n.hot),n.itemsFactory=null,n.menu=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,null,[{key:"DEFAULT_ITEMS",get:function(){return[g.ROW_ABOVE,g.ROW_BELOW,g.SEPARATOR,g.COLUMN_LEFT,g.COLUMN_RIGHT,g.SEPARATOR,g.REMOVE_ROW,g.REMOVE_COLUMN,g.SEPARATOR,g.UNDO,g.REDO,g.SEPARATOR,g.READ_ONLY,g.SEPARATOR,g.ALIGNMENT]}}]),o(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.itemsFactory=new h.default(this.hot,e.DEFAULT_ITEMS);var n=this.hot.getSettings().contextMenu,i={items:this.itemsFactory.getItems(n)};this.registerEvents(),"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this);var o=function(){if(t.hot){t.hot.runHooks("afterContextMenuDefaultOptions",i),t.itemsFactory.setPredefinedItems(i.items);var e=t.itemsFactory.getItems(n);t.menu=new d.default(t.hot,{className:"htContextMenu",keepInViewport:!0}),t.hot.runHooks("beforeContextMenuSetItems",e),t.menu.setMenuItems(e),t.menu.addLocalHook("afterOpen",function(){return t.onMenuAfterOpen()}),t.menu.addLocalHook("afterClose",function(){return t.onMenuAfterClose()}),t.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,n=Array(e),i=0;e>i;i++)n[i]=arguments[i];return t.executeCommand.apply(t,n)}),(0,l.arrayEach)(e,function(e){return t.commandExecutor.registerCommand(e.key,e)})}};this.callOnPluginsReady(function(){t.isPluginsReady?setTimeout(o,0):o()})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(e){return t.onContextMenu(e)})}},{key:"open",value:function(t){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt((0,p.pageY)(t),10)-(0,m.getWindowScrollTop)(),left:parseInt((0,p.pageX)(t),10)-(0,m.getWindowScrollLeft)()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,e)}},{key:"onContextMenu",value:function(t){var e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders,r=t.realTarget;this.close(),(0,m.hasClass)(r,"handsontableInput")||(t.preventDefault(),(0,p.stopPropagation)(t),(n||i||function(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}(r)||(0,m.hasClass)(r,"current")&&(0,m.hasClass)(r,"wtBorder"))&&this.open(t))}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();v.SEPARATOR={name:g.SEPARATOR},(0,f.registerPlugin)("contextMenu",v),e.default=v},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(2),o=n(1);e.default=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.hot=e,this.commands={},this.commonCallback=null}return i(t,[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,i=Array(n>1?n-1:0),a=1;n>a;a++)i[a-1]=arguments[a];var s=t.split(":");t=s[0];var l=2===s.length?s[1]:null,u=this.commands[t];if(!u)throw Error("Menu command '"+t+"' not exists.");if(l&&u.submenu&&(u=function(t,e){var n=void 0;return(0,r.arrayEach)(e,function(e){var i=e.key?e.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=e,!1}),n}(l,u.submenu.items)),!0!==u.disabled&&("function"!=typeof u.disabled||!0!==u.disabled.call(this.hot))&&!(0,o.hasOwnProperty)(u,"submenu")){var c=[];"function"==typeof u.callback&&c.push(u.callback),"function"==typeof this.commonCallback&&c.push(this.commonCallback),i.unshift(s.join(":")),(0,r.arrayEach)(c,function(t){return t.apply(e.hot,i)})}}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(1),o=n(2),a=n(90);e.default=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.hot=e,this.predefinedItems=(0,a.predefinedItems)(),this.defaultOrderPattern=n}return i(t,[{key:"setPredefinedItems",value:function(t){var e=this,n={};this.defaultOrderPattern.length=0,(0,r.objectEach)(t,function(t,i){var r="";t.name===a.SEPARATOR?(n[a.SEPARATOR]=t,r=a.SEPARATOR):isNaN(parseInt(i,10))?(t.key=void 0===t.key?i:t.key,n[i]=t,r=t.key):(n[t.key]=t,r=t.key),e.defaultOrderPattern.push(r)}),this.predefinedItems=n}},{key:"getItems",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[];return t&&t.items?t=t.items:Array.isArray(t)||(t=e),(0,r.isObject)(t)?(0,r.objectEach)(t,function(t,e){var o=n["string"==typeof t?t:e];o||(o=t),(0,r.isObject)(t)?(0,r.extend)(o,t):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=e),i.push(o)}):(0,o.arrayEach)(t,function(t,e){var o=n[t];(o||0>a.ITEMS.indexOf(t))&&(o||(o={name:t,key:""+e}),(0,r.isObject)(t)&&(0,r.extend)(o,t),void 0===o.key&&(o.key=e),i.push(o))}),i}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}]),t}()},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:a,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)},submenu:{items:[{key:a+":left",name:function(){var t=this,e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){var i=t.getCellMeta(e,n).className;if(i&&-1!==i.indexOf("htLeft"))return!0})&&(e=(0,i.markLabelAsSelected)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=(0,i.getAlignmentClasses)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htLeft"),(0,i.align)(e,"horizontal","htLeft",function(e,n){return t.getCellMeta(e,n)},function(e,n,i,r){return t.setCellMeta(e,n,i,r)}),this.render()},disabled:!1},{key:a+":center",name:function(){var t=this,e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){var i=t.getCellMeta(e,n).className;if(i&&-1!==i.indexOf("htCenter"))return!0})&&(e=(0,i.markLabelAsSelected)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=(0,i.getAlignmentClasses)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htCenter"),(0,i.align)(e,"horizontal","htCenter",function(e,n){return t.getCellMeta(e,n)},function(e,n,i,r){return t.setCellMeta(e,n,i,r)}),this.render()},disabled:!1},{key:a+":right",name:function(){var t=this,e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){var i=t.getCellMeta(e,n).className;if(i&&-1!==i.indexOf("htRight"))return!0})&&(e=(0,i.markLabelAsSelected)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=(0,i.getAlignmentClasses)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htRight"),(0,i.align)(e,"horizontal","htRight",function(e,n){return t.getCellMeta(e,n)},function(e,n,i,r){return t.setCellMeta(e,n,i,r)}),this.render()},disabled:!1},{key:a+":justify",name:function(){var t=this,e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){var i=t.getCellMeta(e,n).className;if(i&&-1!==i.indexOf("htJustify"))return!0})&&(e=(0,i.markLabelAsSelected)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=(0,i.getAlignmentClasses)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htJustify"),(0,i.align)(e,"horizontal","htJustify",function(e,n){return t.getCellMeta(e,n)},function(e,n,i,r){return t.setCellMeta(e,n,i,r)}),this.render()},disabled:!1},{name:r.KEY},{key:a+":top",name:function(){var t=this,e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){var i=t.getCellMeta(e,n).className;if(i&&-1!==i.indexOf("htTop"))return!0})&&(e=(0,i.markLabelAsSelected)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=(0,i.getAlignmentClasses)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htTop"),(0,i.align)(e,"vertical","htTop",function(e,n){return t.getCellMeta(e,n)},function(e,n,i,r){return t.setCellMeta(e,n,i,r)}),this.render()},disabled:!1},{key:a+":middle",name:function(){var t=this,e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){var i=t.getCellMeta(e,n).className;if(i&&-1!==i.indexOf("htMiddle"))return!0})&&(e=(0,i.markLabelAsSelected)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=(0,i.getAlignmentClasses)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htMiddle"),(0,i.align)(e,"vertical","htMiddle",function(e,n){return t.getCellMeta(e,n)},function(e,n,i,r){return t.setCellMeta(e,n,i,r)}),this.render()},disabled:!1},{key:a+":bottom",name:function(){var t=this,e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){var i=t.getCellMeta(e,n).className;if(i&&-1!==i.indexOf("htBottom"))return!0})&&(e=(0,i.markLabelAsSelected)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=(0,i.getAlignmentClasses)(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htBottom"),(0,i.align)(e,"vertical","htBottom",function(e,n){return t.getCellMeta(e,n)},function(e,n,i,r){return t.setCellMeta(e,n,i,r)}),this.render()},disabled:!1}]}}};var i=n(21),r=n(88),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),a=e.KEY="alignment"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:o,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(t,e){var n=e.start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e.start.row,e.end.row),n,"ContextMenu.clearColumn")},disabled:function(){var t=(0,i.getValidSelection)(this);if(!t)return!0;var e=[t[0],0,t[0],this.countCols()-1].join(",")===t.join(",");return 0>t[1]||this.countCols()>=this.getSettings().maxCols||e}}};var i=n(21),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),o=e.KEY="clear_column"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:o,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(t,e){this.alter("insert_col",e.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var t=(0,i.getValidSelection)(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=[t[0],0,t[0],this.countCols()-1].join(",")===t.join(","),n=1===this.countCols();return 0>t[1]||this.countCols()>=this.getSettings().maxCols||!n&&e},hidden:function(){return!this.getSettings().allowInsertColumn}}};var i=n(21),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),o=e.KEY="col_left"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:o,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(t,e){this.alter("insert_col",e.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var t=(0,i.getValidSelection)(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=[t[0],0,t[0],this.countCols()-1].join(",")===t.join(","),n=1===this.countCols();return 0>t[1]||this.countCols()>=this.getSettings().maxCols||!n&&e},hidden:function(){return!this.getSettings().allowInsertColumn}}};var i=n(21),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),o=e.KEY="col_right"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:o,name:function(){var t=this,e=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_READ_ONLY);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,n){return t.getCellMeta(e,n).readOnly})&&(e=(0,i.markLabelAsSelected)(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=(0,i.checkSelectionConsistency)(e,function(e,n){return t.getCellMeta(e,n).readOnly});e.forAll(function(e,i){t.setCellMeta(e,i,"readOnly",!n)}),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)}}};var i=n(21),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),o=e.KEY="make_read_only"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:r,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),r=e.KEY="redo"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0;var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.default=function(){return{key:a,name:function(){var t=this.getSelected(),e=0;if(Array.isArray(t)){var n=i(t,4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback:function(t,e){this.alter("remove_col",e.start.col,e.end.col-e.start.col+1,"ContextMenu.removeColumn")},disabled:function(){var t=(0,r.getValidSelection)(this),e=this.countCols();return!t||this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!e},hidden:function(){return!this.getSettings().allowRemoveColumn}}};var r=n(21),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),a=e.KEY="remove_col"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0;var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.default=function(){return{key:a,name:function(){var t=this.getSelected(),e=0;if(Array.isArray(t)){var n=i(t,3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback:function(t,e){this.alter("remove_row",e.start.row,e.end.row-e.start.row+1,"ContextMenu.removeRow")},disabled:function(){var t=(0,r.getValidSelection)(this),e=this.countRows();return!t||this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!e},hidden:function(){return!this.getSettings().allowRemoveRow}}};var r=n(21),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),a=e.KEY="remove_row"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:o,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(t,e){this.alter("insert_row",e.start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!(0,i.getValidSelection)(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}};var i=n(21),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),o=e.KEY="row_above"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:o,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(t,e){this.alter("insert_row",e.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!(0,i.getValidSelection)(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}};var i=n(21),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),o=e.KEY="row_below"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:r,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),r=e.KEY="undo"},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=i(n(84)),a=n(0),s=n(2),l=i(n(281)),u=i(n(4)),c=n(1),h=n(17),d=n(36),f=n(21),p=n(20),m=i(n(89)),g=n(90),v=n(11),y=function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1},this.eventManager=new u.default(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return r(t,[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){return t.onDocumentMouseDown(e)})}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"setOffset",value:function(t){this.offset[t]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var t=this;this.container.removeAttribute("style"),this.container.style.display="block";var e=(0,d.debounce)(function(e){return t.openSubMenu(e)},300),n=(0,s.arrayFilter)(this.menuItems,function(e){return(0,f.isItemHidden)(e,t.hot)}),i={data:n=(0,f.filterSeparators)(n,g.SEPARATOR),colHeaders:!1,colWidths:[200],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(e,n,i,r,o,a){return t.menuItemRenderer(e,n,i,r,o,a)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(e){return t.onBeforeKeyDown(e)},afterOnCellMouseOver:function(n,i,r){t.isAllSubMenusClosed()?e(i.row):t.openSubMenu(i.row)},rowHeights:function(t){return n[t].name===g.SEPARATOR?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new o.default(this.container,i),this.hotMenu.addHook("afterInit",function(){return t.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(e,n,i,r,o){return t.onAfterSelection(e,n,i,r,o)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!(0,f.hasSubMenu)(n))return!1;var i=this.hotMenu.getSourceDataAtRow(e),r=new t(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,r}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var t=this;(0,s.arrayEach)(this.hotMenu.getData(),function(e,n){return t.closeSubMenu(n)})}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hotMenu.getSelected()){var e=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]);if(this.runLocalHooks("select",e,t),!1!==e.isCommand&&e.name!==g.SEPARATOR){var n=this.hot.getSelectedRange(),i=n?(0,f.normalizeSelection)(n):{},r=!0;(!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(this.hot)||e.submenu)&&(r=!1),this.runLocalHooks("executeCommand",e.key,i,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,i,t),r&&this.close(!0)}}}},{key:"setPosition",value:function(t){var e=new l.default(t);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}},{key:"setPositionAboveCursor",value:function(t){var e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top=e+"px"}},{key:"setPositionBelowCursor",value:function(t){var e=this.offset.below+t.top;this.isSubMenu()&&(e=t.top-1),this.container.style.top=e+"px"}},{key:"setPositionOnRightOfCursor",value:function(t){var e=void 0;e=this.isSubMenu()?1+t.left+t.cellWidth:this.offset.right+1+t.left,this.container.style.left=e+"px"}},{key:"setPositionOnLeftOfCursor",value:function(t){this.container.style.left=this.offset.left+t.left-this.container.offsetWidth+(0,a.getScrollbarWidth)()+4+"px"}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);(0,f.isSeparator)(t)||(0,f.isDisabled)(t)||(0,f.isSelectionDisabled)(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);(0,f.isSeparator)(e)||(0,f.isDisabled)(e)||(0,f.isSelectionDisabled)(e)?this.selectPrevCell(t,0):this.hotMenu.selectCell(t,0)}},{key:"selectNextCell",value:function(t,e){var n=t+1,i=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,e):null;i&&((0,f.isSeparator)(i)||(0,f.isDisabled)(i)||(0,f.isSelectionDisabled)(i)?this.selectNextCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"selectPrevCell",value:function(t,e){var n=t-1,i=0>n?null:this.hotMenu.getCell(n,e);i&&((0,f.isSeparator)(i)||(0,f.isDisabled)(i)||(0,f.isSelectionDisabled)(i)?this.selectPrevCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"menuItemRenderer",value:function(t,e,n,i,r,o){var s=this,l=t.getSourceDataAtRow(n),u=document.createElement("div"),h=function(t){return t.disableSelection};"function"==typeof o&&(o=o.call(this.hot)),(0,a.empty)(e),(0,a.addClass)(u,"htItemWrapper"),e.appendChild(u),function(t){return RegExp(g.SEPARATOR,"i").test(t.name)}(l)?(0,a.addClass)(e,"htSeparator"):"function"==typeof l.renderer?((0,a.addClass)(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,u,n,i,r,o))):(0,a.fastInnerHTML)(u,o),function(t){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(s.hot)}(l)?((0,a.addClass)(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()})):h(l)?((0,a.addClass)(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()})):function(t){return(0,c.hasOwnProperty)(t,"submenu")}(l)?((0,a.addClass)(e,"htSubmenu"),h(l)?this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(e,"mouseenter",function(){return t.selectCell(n,i,void 0,void 0,!1,!1)})):((0,a.removeClass)(e,"htSubmenu"),(0,a.removeClass)(e,"htDisabled"),h(l)?this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(e,"mouseenter",function(){return t.selectCell(n,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=void 0;return t?((0,d.isFunction)(t)&&(t=t.call(this.hot),t=null===t||(0,h.isUndefined)(t)?"":""+t),t=t.replace(/[^A-z0-9]/g,"_"),t=this.options.className+"Sub_"+t,e=document.querySelector("."+this.options.className+"."+t)):e=document.querySelector("."+this.options.className),e||(e=document.createElement("div"),(0,a.addClass)(e,"htMenu "+this.options.className),t&&(0,a.addClass)(e,t),document.getElementsByTagName("body")[0].appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(t){var e=this.hotMenu.getSelected(),n=!1;switch(this.keyEvent=!0,t.keyCode){case p.KEY_CODES.ESCAPE:this.close(),n=!0;break;case p.KEY_CODES.ENTER:e&&(this.hotMenu.getSourceDataAtRow(e[0]).submenu?n=!0:(this.executeCommand(t),this.close(!0)));break;case p.KEY_CODES.ARROW_DOWN:e?this.selectNextCell(e[0],e[1]):this.selectFirstCell(),n=!0;break;case p.KEY_CODES.ARROW_UP:e?this.selectPrevCell(e[0],e[1]):this.selectLastCell(),n=!0;break;case p.KEY_CODES.ARROW_RIGHT:if(e){var i=this.openSubMenu(e[0]);i&&i.selectFirstCell()}n=!0;break;case p.KEY_CODES.ARROW_LEFT:e&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(t.preventDefault(),(0,v.stopImmediatePropagation)(t)),this.keyEvent=!1}},{key:"onAfterInit",value:function(){var t=this.hotMenu.getSettings().data,e=this.hotMenu.view.wt.wtTable.hider.style,n=this.hotMenu.view.wt.wtTable.holder.style,i=parseInt(e.width,10),r=(0,s.arrayReduce)(t,function(t,e){return t+(e.name===g.SEPARATOR?1:26)},0);n.width=i+22+"px",n.height=r+4+"px",e.height=n.height}},{key:"onAfterSelection",value:function(t,e,n,i,r){!1===this.keyEvent&&(r.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.container&&(0,a.isChildOf)(t.target,this.container)&&this.executeCommand(t),this.options.standalone&&this.hotMenu&&!(0,a.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,a.isChildOf)(t.target,".htMenu")&&(0,a.isChildOf)(t.target,document)&&this.close(!0))}}]),t}();(0,c.mixin)(y,m.default),e.default=y},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(11);e.default=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=(0,r.getWindowScrollTop)(),i=(0,r.getWindowScrollLeft)(),a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=void 0;this.type=this.getSourceType(e),"literal"===this.type?(a=parseInt(e.top,10),l=parseInt(e.left,10),c=e.height||0,h=e.width||0,s=a,u=l,a+=n,l+=i):"event"===this.type&&(a=parseInt((0,o.pageY)(e),10),l=parseInt((0,o.pageX)(e),10),c=e.target.clientHeight,h=e.target.clientWidth,s=a-n,u=l-i),this.top=a,this.topRelative=s,this.left=l,this.leftRelative=u,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=c,this.cellWidth=h}return i(t,[{key:"getSourceType",value:function(t){var e="literal";return t instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerHeight)>=this.topRelative+t.offsetHeight}},{key:"fitsOnRight",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerWidth)>=this.leftRelative+this.cellWidth+t.offsetWidth}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}]),t}()},function(t,e){},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},s=i(n(14)),l=i(n(8)),u=i(n(174)),c=n(13),h=n(0),d=n(2),f=n(5),p=n(6),m=i(n(284)),g=i(n(285)),v=i(n(286)),y=i(n(4)),w=i(n(287));n(289),l.default.getSingleton().register("afterCopyLimit"),l.default.getSingleton().register("modifyCopyableRange"),l.default.getSingleton().register("beforeCut"),l.default.getSingleton().register("afterCut"),l.default.getSingleton().register("beforePaste"),l.default.getSingleton().register("afterPaste"),l.default.getSingleton().register("beforeCopy"),l.default.getSingleton().register("afterCopy");var b=1e3,_=1e3,E=new WeakMap,T=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.eventManager=new y.default(n),n.columnsLimit=_,n.copyableRanges=[],n.pasteMode="overwrite",n.rowsLimit=b,n.textarea=void 0,E.set(n,{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),o(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings(),i=E.get(this);this.textarea=m.default.getSingleton(),i.isFragmentSelectionEnabled=n.fragmentSelection,"object"===r(n.copyPaste)&&(this.pasteMode=n.copyPaste.pasteMode||this.pasteMode,this.rowsLimit=n.copyPaste.rowsLimit||this.rowsLimit,this.columnsLimit=n.copyPaste.columnsLimit||this.columnsLimit),this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)}),this.addHook("afterSelectionEnd",function(){return t.onAfterSelectionEnd()}),this.registerEvents(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.textarea&&this.textarea.destroy(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRange();if(t){var e=t.getTopLeftCorner(),n=t.getBottomRightCorner(),i=e.row,r=e.col,o=n.row,a=n.col,s=Math.min(o,i+this.rowsLimit-1),l=Math.min(a,r+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:i,startCol:r,endRow:s,endCol:l}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),o===s&&a===l||this.hot.runHooks("afterCopyLimit",o-i+1,a-r+1,this.rowsLimit,this.columnsLimit)}}},{key:"getRangedCopyableData",value:function(t){var e=this,n=[],i=[],r=[];return(0,d.arrayEach)(t,function(t){(0,f.rangeEach)(t.startRow,t.endRow,function(t){-1===i.indexOf(t)&&i.push(t)}),(0,f.rangeEach)(t.startCol,t.endCol,function(t){-1===r.indexOf(t)&&r.push(t)})}),(0,d.arrayEach)(i,function(t){var i=[];(0,d.arrayEach)(r,function(n){i.push(e.hot.getCopyableData(t,n))}),n.push(i)}),u.default.stringify(n)}},{key:"getRangedData",value:function(t){var e=this,n=[],i=[],r=[];return(0,d.arrayEach)(t,function(t){(0,f.rangeEach)(t.startRow,t.endRow,function(t){-1===i.indexOf(t)&&i.push(t)}),(0,f.rangeEach)(t.startCol,t.endCol,function(t){-1===r.indexOf(t)&&r.push(t)})}),(0,d.arrayEach)(i,function(t){var i=[];(0,d.arrayEach)(r,function(n){i.push(e.hot.getCopyableData(t,n))}),n.push(i)}),n}},{key:"copy",value:function(){E.get(this).isTriggeredByCopy=!0,this.textarea.select(),document.execCommand("copy")}},{key:"cut",value:function(){E.get(this).isTriggeredByCut=!0,this.textarea.select(),document.execCommand("cut")}},{key:"paste",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=new w.default;e.clipboardData.setData("text/plain",t),this.onPaste(e)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.textarea.element,"paste",function(e){return t.onPaste(e)}),this.eventManager.addEventListener(this.textarea.element,"cut",function(e){return t.onCut(e)}),this.eventManager.addEventListener(this.textarea.element,"copy",function(e){return t.onCopy(e)})}},{key:"onCopy",value:function(t){var e=E.get(this);if(this.hot.isListening()||e.isTriggeredByCopy){this.setCopyableText(),e.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges),i="";!!this.hot.runHooks("beforeCopy",n,this.copyableRanges)&&(i=u.default.stringify(n),t&&t.clipboardData?t.clipboardData.setData("text/plain",i):"undefined"==typeof ClipboardEvent&&window.clipboardData.setData("Text",i),this.hot.runHooks("afterCopy",n,this.copyableRanges)),t.preventDefault()}}},{key:"onCut",value:function(t){var e=E.get(this);if(this.hot.isListening()||e.isTriggeredByCut){this.setCopyableText(),e.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges),i=void 0;!!this.hot.runHooks("beforeCut",n,this.copyableRanges)&&(i=u.default.stringify(n),t&&t.clipboardData?t.clipboardData.setData("text/plain",i):"undefined"==typeof ClipboardEvent&&window.clipboardData.setData("Text",i),this.hot.selection.empty(),this.hot.runHooks("afterCut",n,this.copyableRanges)),t.preventDefault()}}},{key:"onPaste",value:function(t){var e=this;if(this.hot.isListening()){t&&t.preventDefault&&t.preventDefault();var n=void 0;if(t&&void 0!==t.clipboardData?this.textarea.setValue(t.clipboardData.getData("text/plain")):"undefined"==typeof ClipboardEvent&&void 0!==window.clipboardData&&this.textarea.setValue(window.clipboardData.getData("Text")),n=u.default.parse(this.textarea.getValue()),this.textarea.setValue(" "),0!==n.length&&this.hot.runHooks("beforePaste",n,this.copyableRanges)){var i=this.hot.getSelected(),r=new c.CellCoords(i[0],i[1]),o=new c.CellCoords(i[2],i[3]),a=new c.CellRange(r,r,o),s=a.getTopLeftCorner(),l=a.getBottomRightCorner(),h=s,f=new c.CellCoords(Math.max(l.row,n.length-1+s.row),Math.max(l.col,n[0].length-1+s.col)),p=o.row-r.row>=n.length-1,m=o.col-r.col>=n[0].length-1;this.hot.addHookOnce("afterChange",function(t){var n=t?t.length:0;if(n){var i={row:0,col:0},r=-1;(0,d.arrayEach)(t,function(e,o){var a=n>o+1?t[o+1]:null;a&&(p||(i.row+=Math.max(a[0]-e[0]-1,0)),!m&&e[1]>r&&(r=e[1],i.col+=Math.max(a[1]-e[1]-1,0)))}),e.hot.selectCell(h.row,h.col,f.row+i.row,f.col+i.col)}}),this.hot.populateFromArray(h.row,h.col,n,f.row,f.col,"CopyPaste.paste",this.pasteMode),this.hot.runHooks("afterPaste",n,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:"---------"},(0,g.default)(this),(0,v.default)(this))}},{key:"onAfterSelectionEnd",value:function(){var t=E.get(this),e=this.hot.getActiveEditor();e&&void 0!==e.isOpened&&e.isOpened()||t.isFragmentSelectionEnabled&&!this.textarea.isActive()&&(0,h.getSelectionText)()||(this.setCopyableText(),this.textarea.select())}},{key:"destroy",value:function(){this.textarea&&this.textarea.destroy(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();(0,p.registerPlugin)("CopyPaste",T),e.default=T},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.element=void 0,this.isAppended=!1,this.refCounter=0}return i(t,null,[{key:"getSingleton",value:function(){return o.append(),o}}]),i(t,[{key:"append",value:function(){this.hasBeenDestroyed()&&this.create(),this.refCounter++,!this.isAppended&&document.body&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))}},{key:"create",value:function(){this.element=document.createElement("textarea"),this.element.id="HandsontableCopyPaste",this.element.className="copyPaste",this.element.tabIndex=-1,this.element.autocomplete="off",this.element.wrap="hard",this.element.value=" "}},{key:"deselect",value:function(){this.element===document.activeElement&&document.activeElement.blur()}},{key:"destroy",value:function(){this.refCounter--,this.refCounter=0>this.refCounter?0:this.refCounter,this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null,this.isAppended=!1)}},{key:"getValue",value:function(){return this.element.value}},{key:"hasBeenDestroyed",value:function(){return 1>this.refCounter}},{key:"isActive",value:function(){return this.element===document.activeElement}},{key:"select",value:function(){this.element.focus(),this.element.select()}},{key:"setValue",value:function(t){this.element.value=t}}]),t}(),o=new r;e.default=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_COPY)},callback:function(){t.copy()},disabled:function(){return!t.hot.getSelected()},hidden:!1}};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7))},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_CUT)},callback:function(){t.cut()},disabled:function(){return!t.hot.getSelected()},hidden:!1}};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7))},function(t,e,n){"use strict";e.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(288));e.default=function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.clipboardData=new i.default}},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.default=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.data={}}return i(t,[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}]),t}()},function(t,e){},function(t,e,n){"use strict";function i(){}e.__esModule=!0;var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t){return t&&t.__esModule?t:{default:t}}(n(8)),s=n(1),l=n(13),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),c=function(t){var e={row:t.row,col:t.col},n=new l.Selection(t,new l.CellRange(e,e,e)),i=function(t){for(var e=0;r.view.wt.selections.length>e;e++)if(r.view.wt.selections[e].settings.className==t)return e;return-1}(t.className);0>i?r.view.wt.selections.push(n):r.view.wt.selections[i]=n},h=function(t,e,n){var i=p(t,e);i=m(i,n),this.setCellMeta(t,e,"borders",i),c(i)},d=function(t){for(var e=t.range,n=e.from.row;e.to.row>=n;n++)for(var i=e.from.col;e.to.col>=i;i++){var r=p(n,i),o=0;n==e.from.row&&(o++,(0,s.hasOwnProperty)(t,"top")&&(r.top=t.top)),n==e.to.row&&(o++,(0,s.hasOwnProperty)(t,"bottom")&&(r.bottom=t.bottom)),i==e.from.col&&(o++,(0,s.hasOwnProperty)(t,"left")&&(r.left=t.left)),i==e.to.col&&(o++,(0,s.hasOwnProperty)(t,"right")&&(r.right=t.right)),o>0&&(this.setCellMeta(n,i,"borders",r),c(r))}},f=function(t,e){return"border_row"+t+"col"+e},p=function(t,e){return{className:f(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}},m=function(t,e){return(0,s.hasOwnProperty)(e,"border")&&(t.border=e.border),(0,s.hasOwnProperty)(e,"top")&&(t.top=e.top),(0,s.hasOwnProperty)(e,"right")&&(t.right=e.right),(0,s.hasOwnProperty)(e,"bottom")&&(t.bottom=e.bottom),(0,s.hasOwnProperty)(e,"left")&&(t.left=e.left),t},g=function(t){for(var e=document.querySelectorAll("."+t),n=0;e.length>n;n++)if(e[n]&&"TD"!=e[n].nodeName){var i=e[n].parentNode;i.parentNode&&i.parentNode.removeChild(i)}},v=function(t,e){var n=f(t,e);g(n),this.removeCellMeta(t,e,"borders")},y=function(t,e,n,i){var r=this.getCellMeta(t,e).borders;r&&void 0!=r.border||(r=p(t,e)),r[n]=i?{hide:!0}:{width:1,color:"#000"},this.setCellMeta(t,e,"borders",r);var o=f(t,e);g(o),c(r),this.render()},w=function(t,e,n){if(t.from.row==t.to.row&&t.from.col==t.to.col)"noBorders"==e?v.call(this,t.from.row,t.from.col):y.call(this,t.from.row,t.from.col,e,n);else switch(e){case"noBorders":for(var i=t.from.col;t.to.col>=i;i++)for(var r=t.from.row;t.to.row>=r;r++)v.call(this,r,i);break;case"top":for(var o=t.from.col;t.to.col>=o;o++)y.call(this,t.from.row,o,e,n);break;case"right":for(var a=t.from.row;t.to.row>=a;a++)y.call(this,a,t.to.col,e);break;case"bottom":for(var s=t.from.col;t.to.col>=s;s++)y.call(this,t.to.row,s,e);break;case"left":for(var l=t.from.row;t.to.row>=l;l++)y.call(this,l,t.from.col,e)}},b=function(t,e){var n=!1;return t.getSelectedRange().forAll(function(i,r){var o=t.getCellMeta(i,r).borders;if(o){if(!e)return n=!0,!1;if(!(0,s.hasOwnProperty)(o[e],"hide"))return n=!0,!1}}),n},_=function(t){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+t};a.default.getSingleton().add("beforeInit",function(){(function(t){return"boolean"==typeof t&&!0===t||"object"===(void 0===t?"undefined":o(t))&&t.length>0})(this.getSettings().customBorders)&&(this.customBorders||(r=this,this.customBorders=new i))}),a.default.getSingleton().add("afterContextMenuDefaultOptions",function(t){this.getSettings().customBorders&&(t.items.push({name:"---------"}),t.items.push({key:"borders",name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS_TOP);return b(this,"top")&&(t=_(t)),t},callback:function(){var t=b(this,"top");w.call(this,this.getSelectedRange(),"top",t)}},{key:"borders:right",name:function(){var t=this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return b(this,"right")&&(t=_(t)),t},callback:function(){var t=b(this,"right");w.call(this,this.getSelectedRange(),"right",t)}},{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return b(this,"bottom")&&(t=_(t)),t},callback:function(){var t=b(this,"bottom");w.call(this,this.getSelectedRange(),"bottom",t)}},{key:"borders:left",name:function(){var t=this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_BORDERS_LEFT);return b(this,"left")&&(t=_(t)),t},callback:function(){var t=b(this,"left");w.call(this,this.getSelectedRange(),"left",t)}},{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(){w.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!b(this)}}]}}))}),a.default.getSingleton().add("afterInit",function(){var t=this.getSettings().customBorders;if(t){for(var e=0;t.length>e;e++)t[e].range?d.call(this,t[e]):h.call(this,t[e].row,t[e].col,t[e]);this.render(),this.view.wt.draw(!0)}}),e.default=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(){this.boundaries=null,this.callback=null}e.__esModule=!0;var o=i(n(8)),a=i(n(4));n(6),r.prototype.setBoundaries=function(t){this.boundaries=t},r.prototype.setCallback=function(t){this.callback=t},r.prototype.check=function(t,e){var n=0,i=0;this.boundaries.top>e?i=e-this.boundaries.top:e>this.boundaries.bottom&&(i=e-this.boundaries.bottom),this.boundaries.left>t?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,i)};var s,l=function(t){t.dragToScrollListening=!1;var e=t.view.wt.wtTable.holder;s=new r,e!==window&&(s.setBoundaries(e.getBoundingClientRect()),s.setCallback(function(t,n){0>t?e.scrollLeft-=50:t>0&&(e.scrollLeft+=50),0>n?e.scrollTop-=20:n>0&&(e.scrollTop+=20)}),t.dragToScrollListening=!0)};o.default.getSingleton().add("afterInit",function(){var t=this,e=new a.default(this);e.addEventListener(document,"mouseup",function(){t.dragToScrollListening=!1}),e.addEventListener(document,"mousemove",function(e){t.dragToScrollListening&&s.check(e.clientX,e.clientY)})}),o.default.getSingleton().add("afterDestroy",function(){new a.default(this).clear()}),o.default.getSingleton().add("afterOnCellMouseDown",function(){l(this)}),o.default.getSingleton().add("afterOnCellCornerMouseDown",function(){l(this)}),e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=i(n(14)),s=n(6),l=n(2),u=i(n(293)),c=i(n(294));n(295);var h=new WeakMap,d=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return h.set(n,{moveByFreeze:!1,afterFirstUse:!1}),n.frozenColumnsBasePositions=[],n.manualColumnMovePlugin=void 0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(e){return t.addContextMenuEntry(e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),this.addHook("beforeColumnMove",function(e,n){return t.onBeforeColumnMove(e,n)}),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=h.get(this);t.afterFirstUse=!1,t.moveByFreeze=!1,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(t){var e=h.get(this),n=this.hot.getSettings();e.afterFirstUse||(e.afterFirstUse=!0),n.fixedColumnsLeft!==this.hot.countCols()&&t>n.fixedColumnsLeft-1&&(e.moveByFreeze=!0,t!==this.getMovePlugin().columnsMapper.getValueByIndex(t)&&(this.frozenColumnsBasePositions[n.fixedColumnsLeft]=t),this.getMovePlugin().moveColumn(t,n.fixedColumnsLeft++))}},{key:"unfreezeColumn",value:function(t){var e=h.get(this),n=this.hot.getSettings();if(e.afterFirstUse||(e.afterFirstUse=!0),n.fixedColumnsLeft>0&&n.fixedColumnsLeft-1>=t){var i=this.getBestColumnReturnPosition(t);e.moveByFreeze=!0,n.fixedColumnsLeft--,this.getMovePlugin().moveColumn(t,i+1)}}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(t){var e=this.getMovePlugin(),n=this.hot.getSettings().fixedColumnsLeft,i=e.columnsMapper.getValueByIndex(n),r=void 0;if(null==this.frozenColumnsBasePositions[t])for(r=e.columnsMapper.getValueByIndex(t);r>i;)n++,i=e.columnsMapper.getValueByIndex(n);else{for(r=this.frozenColumnsBasePositions[t],this.frozenColumnsBasePositions[t]=void 0;r>=i;)n++,i=e.columnsMapper.getValueByIndex(n);n=i}return n-1}},{key:"addContextMenuEntry",value:function(t){t.items.push({name:"---------"},(0,u.default)(this),(0,c.default)(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(t,e){var n=h.get(this);if(n.afterFirstUse&&!n.moveByFreeze){var i=this.hot.getSettings().fixedColumnsLeft,r=i>e;if(r||(0,l.arrayEach)(t,function(t,e,n){if(i>t)return r=!0,!1}),r)return!1}n.moveByFreeze&&(n.moveByFreeze=!1)}},{key:"destroy",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();(0,s.registerPlugin)("manualColumnFreeze",d),e.default=d},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(){var e=this.getSelectedRange().from.col;t.freezeColumn(e),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.from.col===t.to.col&&t.from.col>this.getSettings().fixedColumnsLeft-1||(e=!0),e}}};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7))},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(){var e=this.getSelectedRange().from.col;t.unfreezeColumn(e),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.from.col===t.to.col&&t.from.col<this.getSettings().fixedColumnsLeft||(e=!0),e}}};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7))},function(t,e){},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=i(n(14)),s=i(n(8)),l=n(2),u=n(0),c=n(5),h=i(n(4)),d=n(6),f=i(n(297)),p=i(n(298)),m=i(n(299)),g=n(13);n(300),s.default.getSingleton().register("beforeColumnMove"),s.default.getSingleton().register("afterColumnMove"),s.default.getSingleton().register("unmodifyCol");var v=new WeakMap,y=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v.set(n,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),n.removedColumns=[],n.columnsMapper=new f.default(n),n.eventManager=new h.default(n),n.backlight=new p.default(t),n.guideline=new m.default(t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(e,n,i,r){return t.onBeforeOnCellMouseDown(e,n,i,r)}),this.addHook("beforeOnCellMouseOver",function(e,n,i,r){return t.onBeforeOnCellMouseOver(e,n,i,r)}),this.addHook("afterScrollVertically",function(){return t.onAfterScrollVertically()}),this.addHook("modifyCol",function(e,n){return t.onModifyCol(e,n)}),this.addHook("beforeRemoveCol",function(e,n){return t.onBeforeRemoveCol(e,n)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol()}),this.addHook("afterCreateCol",function(e,n){return t.onAfterCreateCol(e,n)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("unmodifyCol",function(e){return t.onUnmodifyCol(e)}),this.registerEvents(),(0,u.addClass)(this.hot.rootElement,"ht__manualColumnMove"),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)&&this.columnsMapper.clearMap(),(0,u.removeClass)(this.hot.rootElement,"ht__manualColumnMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(t,e){this.moveColumns([t],e)}},{key:"moveColumns",value:function(t,e){var n=this,i=v.get(this),r=this.hot.runHooks("beforeColumnMove",t,e);i.disallowMoving=!r,!1!==r&&((0,l.arrayEach)(t,function(t,e,i){i[e]=n.columnsMapper.getValueByIndex(t)}),(0,l.arrayEach)(t,function(t,i){var r=n.columnsMapper.getIndexByValue(t);r!==e&&n.columnsMapper.moveColumn(r,e+i)}),this.columnsMapper.clearNull()),this.hot.runHooks("afterColumnMove",t,e)}},{key:"changeSelection",value:function(t,e){var n=this.hot.selection,i=this.hot.countRows()-1;n.setRangeStartOnly(new g.CellCoords(0,t)),n.setRangeEnd(new g.CellCoords(i,e),!1)}},{key:"getColumnsWidth",value:function(t,e){for(var n=0,i=t;e>i;i++){n+=0>i?this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(i)||0}return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)?this.moveColumns(t,0):void 0!==t&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(t){return t<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value&&(this.columnsMapper._arrayMap=t.value)}},{key:"prepareColumnsToMoving",value:function(t,e){var n=[];return(0,c.rangeEach)(t,e,function(t){n.push(t)}),n}},{key:"refreshPositions",value:function(){var t=v.get(this),e=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),i=this.hot.view.wt.wtTable,r=this.hot.view.wt.wtOverlays.scrollableElement,o="number"==typeof r.scrollX?r.scrollX:r.scrollLeft,a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.coordsColumn),s=t.target.eventPageX-(t.rootElementOffset-(void 0===r.scrollX?o:0)),l=i.hider.offsetWidth,u=i.TBODY.offsetLeft,c=this.backlight.getOffset().left,h=this.backlight.getSize().width,d=0;if(t.target.eventPageX>t.rootElementOffset+i.holder.offsetWidth+o&&t.countCols>t.coordsColumn&&t.coordsColumn++,t.hasRowHeaders&&(d=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(t.coordsColumn)&&(a+=o),a+=d,0>t.coordsColumn)t.target.col=t.fixedColumns>0?0:e>0?e-1:e;else if(s<t.target.TD.offsetWidth/2+a)(t.target.col=t.coordsColumn)>e||t.fixedColumns>t.target.col||this.hot.scrollViewportTo(void 0,e-1);else{var f=t.countCols>t.coordsColumn?t.coordsColumn:t.countCols-1;t.target.col=f+1,a+=t.target.TD.offsetWidth,t.target.col>n&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}t.target.col>e||t.fixedColumns>t.target.col||this.hot.scrollViewportTo(void 0,e-1);var p=s,m=a;l>s+h+c?u+d>s+c&&(p=u+d+Math.abs(c)):p=l-h-c,l-1>a?0===m?m=1:void 0!==r.scrollX&&t.fixedColumns>t.coordsColumn&&(m-=t.rootElementOffset>r.scrollX?0:t.rootElementOffset):m=l-1,this.backlight.setPosition(null,p),this.guideline.setPosition(null,m)}},{key:"updateColumnsMapper",value:function(){var t=this.hot.countSourceCols(),e=this.columnsMapper._arrayMap.length;if(0===e)this.columnsMapper.createMap(t||this.hot.getSettings().startCols);else if(t>e){var n=t-e;this.columnsMapper.insertItems(e,n)}else if(e>t){var i=t-1,r=[];(0,l.arrayEach)(this.columnsMapper._arrayMap,function(t,e){t>i&&r.push(e)}),this.columnsMapper.removeItems(r)}}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return t.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,i){var r=this.hot.view.wt.wtTable,o=this.hot.selection.selectedHeader.cols,a=this.hot.getSelectedRange(),s=v.get(this),l=t.realTarget.className.indexOf("columnSorting")>-1;if(!a||!o||s.pressed||0!==t.button||l)return s.pressed=!1,s.columnsToMove.length=0,void(0,u.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui"]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&h&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));var d=a.from,f=a.to,p=Math.min(d.col,f.col),m=Math.max(d.col,f.col);if(0<=e.row||e.col<p||m<e.col)(0,u.removeClass)(this.hot.rootElement,"after-selection--columns"),s.pressed=!1,s.columnsToMove.length=0;else{i.column=!0,s.pressed=!0,s.target.eventPageX=t.pageX,s.coordsColumn=e.col,s.target.TD=n,s.target.col=e.col,s.columnsToMove=this.prepareColumnsToMoving(p,m),s.hasRowHeaders=!!this.hot.getSettings().rowHeaders,s.countCols=this.hot.countCols(),s.fixedColumns=this.hot.getSettings().fixedColumnsLeft,s.rootElementOffset=(0,u.offset)(this.hot.rootElement).left;var g=s.hasRowHeaders?-1:0,y=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,w=s.fixedColumns>e.col,b=this.hot.view.wt.wtOverlays.scrollableElement,_=b.scrollX?b.scrollX-s.rootElementOffset:0,E=t.layerX-(w?_:0),T=Math.abs(this.getColumnsWidth(p,e.col)+E);this.backlight.setPosition(y,this.getColumnsWidth(g,p)+T),this.backlight.setSize(this.getColumnsWidth(p,m+1),r.hider.offsetHeight-y),this.backlight.setOffset(null,-1*T),(0,u.addClass)(this.hot.rootElement,"on-moving--columns")}}},{key:"onMouseMove",value:function(t){var e=v.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}e.target.eventPageX=t.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,i){var r=this.hot.getSelectedRange(),o=v.get(this);r&&o.pressed&&(o.columnsToMove.indexOf(e.col)>-1?(0,u.removeClass)(this.hot.rootElement,"show-ui"):(0,u.addClass)(this.hot.rootElement,"show-ui"),i.row=!0,i.column=!0,i.cell=!0,o.coordsColumn=e.col,o.target.TD=n)}},{key:"onMouseUp",value:function(){var t=v.get(this);t.coordsColumn=void 0,t.pressed=!1,t.backlightWidth=0,(0,u.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui","after-selection--columns"]),this.hot.selection.selectedHeader.cols&&(0,u.addClass)(this.hot.rootElement,"after-selection--columns"),t.columnsToMove.length>=1&&void 0!==t.target.col&&-1>=t.columnsToMove.indexOf(t.target.col)&&(this.moveColumns(t.columnsToMove,t.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.disallowMoving||this.changeSelection(this.columnsMapper.getIndexByValue(t.columnsToMove[0]),this.columnsMapper.getIndexByValue(t.columnsToMove[t.columnsToMove.length-1])),t.columnsToMove.length=0)}},{key:"onAfterScrollVertically",value:function(){var t=this.hot.view.wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;this.backlight.setPosition(e),this.backlight.setSize(null,t.hider.offsetHeight-e)}},{key:"onAfterCreateCol",value:function(t,e){this.columnsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveCol",value:function(t,e){var n=this;this.removedColumns.length=0,!1!==t&&(0,c.rangeEach)(t,t+e-1,function(t){n.removedColumns.push(n.hot.runHooks("modifyCol",t,n.pluginName))})}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(t,e){if(e!==this.pluginName){var n=this.columnsMapper.getValueByIndex(t);t=null===n?t:n}return t}},{key:"onUnmodifyCol",value:function(t){var e=this.columnsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();(0,d.registerPlugin)("ManualColumnMove",y),e.default=y},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(n(181)),o=n(2),a=n(1),s=n(5),l=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.manualColumnMove=e}return i(t,[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,(0,s.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=(0,o.arrayFilter)(this._arrayMap,function(t){return null!==t})}}]),t}();(0,a.mixin)(l,r.default),e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(n(182)),o=n(0);e.default=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"build",value:function(){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),(0,o.addClass)(this._element,"ht__manualColumnMove--backlight")}}]),e}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(n(182)),o=n(0);e.default=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"build",value:function(){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),(0,o.addClass)(this._element,"ht__manualColumnMove--guideline")}}]),e}()},function(t,e){},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=i(n(14)),s=n(0),l=i(n(4)),u=n(11),c=n(2),h=n(5),d=n(6),f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.currentTH=null,n.currentCol=null,n.selectedCols=[],n.currentWidth=null,n.newSize=null,n.startY=null,n.startWidth=null,n.startOffset=null,n.handle=document.createElement("DIV"),n.guide=document.createElement("DIV"),n.eventManager=new l.default(n),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualColumnWidths=[],(0,s.addClass)(n.handle,"manualColumnResizer"),(0,s.addClass)(n.guide,"manualColumnResizerGuide"),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.manualColumnWidths=[];var n=this.hot.getSettings().manualColumnResize,i=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(e,n){return t.onModifyColWidth(e,n)}),this.addHook("beforeStretchingColumnWidth",function(e,n){return t.onBeforeStretchingColumnWidth(e,n)}),this.addHook("beforeColumnResize",function(e,n,i){return t.onBeforeColumnResize(e,n,i)}),this.manualColumnWidths=void 0!==i?i:Array.isArray(n)?n:[],this.bindEvents(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualColumnResize;Array.isArray(t)?this.manualColumnWidths=t:t||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;if(!t.parentNode)return!1;this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(t).col,i=(0,s.outerHeight)(this.currentTH);if(n>=0){var r=this.currentTH.getBoundingClientRect();if(this.currentCol=n,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var o=this.hot.getSelectedRange(),a=o.from,l=o.to,u=a.col,c=l.col;c>u||(u=l.col,c=a.col),u>this.currentCol||this.currentCol>c?this.selectedCols.push(this.currentCol):(0,h.rangeEach)(u,c,function(t){return e.selectedCols.push(t)})}else this.selectedCols.push(this.currentCol);this.startOffset=r.left-6,this.startWidth=parseInt(r.width,10),this.handle.style.top=r.top+"px",this.handle.style.left=this.startOffset+this.startWidth+"px",this.handle.style.height=i+"px",this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"}},{key:"setupGuidePosition",value:function(){var t=parseInt((0,s.outerHeight)(this.handle),10),e=parseInt(this.handle.style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,s.addClass)(this.handle,"active"),(0,s.addClass)(this.guide,"active"),this.guide.style.top=e+"px",this.guide.style.left=this.handle.style.left,this.guide.style.height=n-t+"px",this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){(0,s.removeClass)(this.handle,"active"),(0,s.removeClass)(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(t){if(t!=this.hot.rootElement){var e=t.parentNode;return"THEAD"===e.tagName||this.checkIfColumnHeader(e)}return!1}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!=t.tagName?"TH"==t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfColumnHeader(t.target)){var e=this.getTHFromTargetElement(t.target);if(!e)return;var n=e.getAttribute("colspan");!e||null!==n&&1!==n||this.pressed||this.setupHandlePosition(e)}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,i){var r=t.hot.runHooks("beforeColumnResize",n,t.newSize,!0);void 0!==r&&(t.newSize=r),"all"===t.hot.getSettings().stretchH?t.clearManualSize(n):t.setManualSize(n,t.newSize),i&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",n,t.newSize,!0)};this.dblclick>=2&&(this.selectedCols.length>1?((0,c.arrayEach)(this.selectedCols,function(t){n(t)}),e()):(0,c.arrayEach)(this.selectedCols,function(t){n(t,!0)})),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;(0,s.hasClass)(t.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return e.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=(0,u.pageX)(t),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentWidth=this.startWidth+((0,u.pageX)(t)-this.startX),(0,c.arrayEach)(this.selectedCols,function(t){e.newSize=e.setManualSize(t,e.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(t){var e=this,n=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(t,i){e.hot.runHooks("beforeColumnResize",t,e.newSize),i&&n(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",t,e.newSize)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth&&(this.selectedCols.length>1?((0,c.arrayEach)(this.selectedCols,function(t){i(t)}),n()):(0,c.arrayEach)(this.selectedCols,function(t){i(t,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(window,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(window,"mouseup",function(e){return t.onMouseUp(e)})}},{key:"setManualSize",value:function(t,e){return e=Math.max(e,20),t=this.hot.runHooks("modifyCol",t),this.manualColumnWidths[t]=e,e}},{key:"clearManualSize",value:function(t){t=this.hot.runHooks("modifyCol",t),this.manualColumnWidths[t]=void 0}},{key:"onModifyColWidth",value:function(t,e){return this.enabled&&(e=this.hot.runHooks("modifyCol",e),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[e])?this.manualColumnWidths[e]:t}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=this.manualColumnWidths[e];return void 0===n&&(n=t),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}]),e}();(0,d.registerPlugin)("manualColumnResize",f),e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=i(n(14)),s=i(n(8)),l=n(2),u=n(0),c=n(5),h=i(n(4)),d=n(6),f=i(n(303)),p=i(n(304)),m=i(n(305)),g=n(13);n(306),s.default.getSingleton().register("beforeRowMove"),s.default.getSingleton().register("afterRowMove"),s.default.getSingleton().register("unmodifyRow");var v=new WeakMap,y=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v.set(n,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),n.removedRows=[],n.rowsMapper=new f.default(n),n.eventManager=new h.default(n),n.backlight=new p.default(t),n.guideline=new m.default(t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(e,n,i,r){return t.onBeforeOnCellMouseDown(e,n,i,r)}),this.addHook("beforeOnCellMouseOver",function(e,n,i,r){return t.onBeforeOnCellMouseOver(e,n,i,r)}),this.addHook("afterScrollHorizontally",function(){return t.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(e,n){return t.onModifyRow(e,n)}),this.addHook("beforeRemoveRow",function(e,n){return t.onBeforeRemoveRow(e,n)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow()}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeColumnSort",function(e,n){return t.onBeforeColumnSort(e,n)}),this.addHook("unmodifyRow",function(e){return t.onUnmodifyRow(e)}),this.registerEvents(),(0,u.addClass)(this.hot.rootElement,"ht__manualRowMove"),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualRowMove;Array.isArray(t)&&this.rowsMapper.clearMap(),(0,u.removeClass)(this.hot.rootElement,"ht__manualRowMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(t,e){this.moveRows([t],e)}},{key:"moveRows",value:function(t,e){var n=this,i=v.get(this);i.disallowMoving=!1===this.hot.runHooks("beforeRowMove",t,e),i.disallowMoving||((0,l.arrayEach)(t,function(t,e,i){i[e]=n.rowsMapper.getValueByIndex(t)}),(0,l.arrayEach)(t,function(t,i){var r=n.rowsMapper.getIndexByValue(t);r!==e&&n.rowsMapper.moveRow(r,e+i)}),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",t,e)}},{key:"changeSelection",value:function(t,e){var n=this.hot.selection,i=this.hot.countCols()-1;n.setRangeStartOnly(new g.CellCoords(t,0)),n.setRangeEnd(new g.CellCoords(e,i),!1)}},{key:"getRowsHeight",value:function(t,e){for(var n=0,i=t;e>i;i++)n+=this.hot.view.wt.wtTable.getRowHeight(i)||23;return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualRowMove;if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}},{key:"isFixedRowTop",value:function(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(t){return t>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function(){var t=this.hot.getSelectedRange(),e=[];if(!t)return e;var n=t.from,i=t.to,r=Math.min(n.row,i.row),o=Math.max(n.row,i.row);return(0,c.rangeEach)(r,o,function(t){e.push(t)}),e}},{key:"refreshPositions",value:function(){var t=v.get(this),e=t.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),i=this.hot.view.wt.wtTable.getLastVisibleRow(),r=this.hot.getSettings().fixedRowsTop,o=this.hot.countRows();r>e.row&&n>0&&this.hot.scrollViewportTo(n-1),e.row>=i&&o>i&&this.hot.scrollViewportTo(i+1,void 0,!0);var a=this.hot.view.wt.wtTable,s=t.target.TD,l=(0,u.offset)(this.hot.rootElement),c=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row),h=t.target.eventPageY-l.top+a.holder.scrollTop,d=a.hider.offsetHeight,f=a.TBODY.offsetTop,p=this.backlight.getOffset().top,m=this.backlight.getSize().height;this.isFixedRowTop(e.row)&&(c+=a.holder.scrollTop),0>e.row?t.target.row=n>0?n-1:n:s.offsetHeight/2+c>h?t.target.row=e.row:(t.target.row=e.row+1,c+=0===e.row?s.offsetHeight-1:s.offsetHeight);var g=h,y=c;d>h+m+p?f>h+p&&(g=f+Math.abs(p)):g=d-m-p,d-1>c||(y=d-1);var w=0;this.hot.view.wt.wtOverlays.topOverlay&&(w=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),e.row>=r&&w>y-a.holder.scrollTop&&this.hot.scrollViewportTo(e.row),this.backlight.setPosition(g),this.guideline.setPosition(y)}},{key:"updateRowsMapper",value:function(){var t=this.hot.countSourceRows(),e=this.rowsMapper._arrayMap.length;if(0===e)this.rowsMapper.createMap(t||this.hot.getSettings().startRows);else if(t>e){var n=t-e;this.rowsMapper.insertItems(e,n)}else if(e>t){var i=t-1,r=[];(0,l.arrayEach)(this.rowsMapper._arrayMap,function(t,e){t>i&&r.push(e)}),this.rowsMapper.removeItems(r)}}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return t.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(t,e){v.get(this).disallowMoving=void 0!==e}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,i){var r=this.hot.view.wt.wtTable,o=this.hot.selection.selectedHeader.rows,a=this.hot.getSelectedRange(),s=v.get(this);if(!a||!o||s.pressed||0!==t.button)return s.pressed=!1,s.rowsToMove.length=0,void(0,u.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui"]);var l=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&c&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));var h=a.from,d=a.to,f=Math.min(h.row,d.row),p=Math.max(h.row,d.row);if(0<=e.col||e.row<f||p<e.row)(0,u.removeClass)(this.hot.rootElement,"after-selection--rows"),s.pressed=!1,s.rowsToMove.length=0;else{i.row=!0,s.pressed=!0,s.target.eventPageY=t.pageY,s.target.coords=e,s.target.TD=n,s.rowsToMove=this.prepareRowsToMoving();var m=r.holder.scrollLeft+this.hot.view.wt.wtViewport.getRowHeaderWidth();this.backlight.setPosition(null,m),this.backlight.setSize(r.hider.offsetWidth-m,this.getRowsHeight(f,p+1)),this.backlight.setOffset(-1*(this.getRowsHeight(f,e.row)+t.layerY),null),(0,u.addClass)(this.hot.rootElement,"on-moving--rows"),this.refreshPositions()}}},{key:"onMouseMove",value:function(t){var e=v.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}e.target.eventPageY=t.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,i){var r=this.hot.getSelectedRange(),o=v.get(this);r&&o.pressed&&(o.rowsToMove.indexOf(e.row)>-1?(0,u.removeClass)(this.hot.rootElement,"show-ui"):(0,u.addClass)(this.hot.rootElement,"show-ui"),i.row=!0,i.column=!0,i.cell=!0,o.target.coords=e,o.target.TD=n)}},{key:"onMouseUp",value:function(){var t=v.get(this),e=t.target.row,n=t.rowsToMove.length;t.pressed=!1,t.backlightHeight=0,(0,u.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui","after-selection--rows"]),this.hot.selection.selectedHeader.rows&&(0,u.addClass)(this.hot.rootElement,"after-selection--rows"),n>=1&&void 0!==e&&-1>=t.rowsToMove.indexOf(e)&&t.rowsToMove[n-1]!==e-1&&(this.moveRows(t.rowsToMove,e),this.persistentStateSave(),this.hot.render(),t.disallowMoving||this.changeSelection(this.rowsMapper.getIndexByValue(t.rowsToMove[0]),this.rowsMapper.getIndexByValue(t.rowsToMove[n-1])),t.rowsToMove.length=0)}},{key:"onAfterScrollHorizontally",value:function(){var t=this.hot.view.wt.wtTable,e=this.hot.view.wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;this.backlight.setPosition(null,e),this.backlight.setSize(t.hider.offsetWidth-e)}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&(0,c.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(t,e){if(e!==this.pluginName){var n=this.rowsMapper.getValueByIndex(t);t=null===n?t:n}return t}},{key:"onUnmodifyRow",value:function(t){var e=this.rowsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}();(0,d.registerPlugin)("ManualRowMove",y),e.default=y},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(n(181)),o=n(2),a=n(1),s=n(5),l=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.manualRowMove=e}return i(t,[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,(0,s.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=(0,o.arrayFilter)(this._arrayMap,function(t){return null!==t})}}]),t}();(0,a.mixin)(l,r.default),e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(n(183)),o=n(0);e.default=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"build",value:function(){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),(0,o.addClass)(this._element,"ht__manualRowMove--backlight")}}]),e}()},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(n(183)),o=n(0);e.default=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"build",value:function(){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"build",this).call(this),(0,o.addClass)(this._element,"ht__manualRowMove--guideline")}}]),e}()},function(t,e){},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=i(n(14)),s=n(0),l=i(n(4)),u=n(11),c=n(2),h=n(5),d=n(6),f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.currentTH=null,n.currentRow=null,n.selectedRows=[],n.currentHeight=null,n.newSize=null,n.startY=null,n.startHeight=null,n.startOffset=null,n.handle=document.createElement("DIV"),n.guide=document.createElement("DIV"),n.eventManager=new l.default(n),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualRowHeights=[],(0,s.addClass)(n.handle,"manualRowResizer"),(0,s.addClass)(n.guide,"manualRowResizerGuide"),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.manualRowHeights=[];var n=this.hot.getSettings().manualRowResize,i=this.loadManualRowHeights();this.manualRowHeights=void 0!==i?i:Array.isArray(n)?n:[],this.addHook("modifyRowHeight",function(e,n){return t.onModifyRowHeight(e,n)}),this.bindEvents(),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualRowResize;Array.isArray(t)?this.manualRowHeights=t:t||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(t).row,i=(0,s.outerWidth)(this.currentTH);if(n>=0){var r=this.currentTH.getBoundingClientRect();if(this.currentRow=n,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var o=this.hot.getSelectedRange(),a=o.from,l=o.to,u=a.row,c=l.row;c>u||(u=l.row,c=a.row),u>this.currentRow||this.currentRow>c?this.selectedRows.push(this.currentRow):(0,h.rangeEach)(u,c,function(t){return e.selectedRows.push(t)})}else this.selectedRows.push(this.currentRow);this.startOffset=r.top-6,this.startHeight=parseInt(r.height,10),this.handle.style.left=r.left+"px",this.handle.style.top=this.startOffset+this.startHeight+"px",this.handle.style.width=i+"px",this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"}},{key:"setupGuidePosition",value:function(){var t=parseInt((0,s.outerWidth)(this.handle),10),e=parseInt(this.handle.style.left,10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,s.addClass)(this.handle,"active"),(0,s.addClass)(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left=e+"px",this.guide.style.width=n-t+"px",this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){(0,s.removeClass)(this.handle,"active"),(0,s.removeClass)(this.guide,"active")}},{key:"checkIfRowHeader",value:function(t){if(t!=this.hot.rootElement){var e=t.parentNode;return"TBODY"===e.tagName||this.checkIfRowHeader(e)}return!1}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!=t.tagName?"TH"==t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfRowHeader(t.target)){var e=this.getTHFromTargetElement(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,i){var r=t.hot.runHooks("beforeRowResize",n,t.newSize,!0);void 0!==r&&(t.newSize=r),t.setManualSize(n,t.newSize),i&&e(),t.hot.runHooks("afterRowResize",n,t.newSize,!0)};this.dblclick>=2&&(this.selectedRows.length>1?((0,c.arrayEach)(this.selectedRows,function(t){n(t)}),e()):(0,c.arrayEach)(this.selectedRows,function(t){n(t,!0)})),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;(0,s.hasClass)(t.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null==this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return e.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=(0,u.pageY)(t),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentHeight=this.startHeight+((0,u.pageY)(t)-this.startY),(0,c.arrayEach)(this.selectedRows,function(t){e.newSize=e.setManualSize(t,e.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(t){var e=this,n=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(t,i){e.hot.runHooks("beforeRowResize",t,e.newSize),i&&n(),e.saveManualRowHeights(),e.hot.runHooks("afterRowResize",t,e.newSize)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight&&(this.selectedRows.length>1?((0,c.arrayEach)(this.selectedRows,function(t){i(t)}),n()):(0,c.arrayEach)(this.selectedRows,function(t){i(t,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(window,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(window,"mouseup",function(e){return t.onMouseUp(e)})}},{key:"setManualSize",value:function(t,e){return t=this.hot.runHooks("modifyRow",t),this.manualRowHeights[t]=e,e}},{key:"onModifyRowHeight",value:function(t,e){if(this.enabled){var n=this.hot.getPlugin("autoRowSize"),i=n?n.heights[e]:null;e=this.hot.runHooks("modifyRow",e);var r=this.manualRowHeights[e];if(void 0!==r&&(r===i||r>(t||0)))return r}return t}}]),e}();(0,d.registerPlugin)("manualRowResize",f),e.default=f},function(t,e,n){"use strict";function i(){var t=[];return t.getInfo=function(t,e){for(var n=0,i=this.length;i>n;n++)if(!(this[n].row>t||t>this[n].row+this[n].rowspan-1||this[n].col>e||e>this[n].col+this[n].colspan-1))return this[n]},t.setInfo=function(t){for(var e=0,n=this.length;n>e;e++)if(this[e].row===t.row&&this[e].col===t.col)return void(this[e]=t);this.push(t)},t.removeInfo=function(t,e){for(var n=0,i=this.length;i>n;n++)if(this[n].row===t&&this[n].col===e){this.splice(n,1);break}},t}function r(t){if(this.mergedCellInfoCollection=new i,Array.isArray(t))for(var e=0,n=t.length;n>e;e++)this.mergedCellInfoCollection.setInfo(t[e])}e.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(n(8)),a=n(11),s=n(13),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7));r.prototype.canMergeRange=function(t){return!t.isSingle()},r.prototype.mergeRange=function(t){if(this.canMergeRange(t)){var e=t.getTopLeftCorner(),n=t.getBottomRightCorner(),i={};i.row=e.row,i.col=e.col,i.rowspan=n.row-e.row+1,i.colspan=n.col-e.col+1,this.mergedCellInfoCollection.setInfo(i)}},r.prototype.mergeOrUnmergeSelection=function(t){this.mergedCellInfoCollection.getInfo(t.from.row,t.from.col)?this.unmergeSelection(t.from):this.mergeSelection(t)},r.prototype.mergeSelection=function(t){this.mergeRange(t)},r.prototype.unmergeSelection=function(t){var e=this.mergedCellInfoCollection.getInfo(t.row,t.col);this.mergedCellInfoCollection.removeInfo(e.row,e.col)},r.prototype.applySpanProperties=function(t,e,n){var i=this.mergedCellInfoCollection.getInfo(e,n);i?i.row===e&&i.col===n?(t.setAttribute("rowspan",i.rowspan),t.setAttribute("colspan",i.colspan)):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"))},r.prototype.modifyTransform=function(t,e,n){var i={row:n.row,col:n.col};if("modifyTransformStart"==t){var r;this.lastDesiredCoords||(this.lastDesiredCoords=new s.CellCoords(null,null));for(var o=new s.CellCoords(e.highlight.row,e.highlight.col),a=this.mergedCellInfoCollection.getInfo(o.row,o.col),l=0,u=this.mergedCellInfoCollection.length;u>l;l++){var c=this.mergedCellInfoCollection[l];if(c=new s.CellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),e.includes(c))break}if(a){var h=new s.CellCoords(a.row,a.col),d=new s.CellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);new s.CellRange(h,h,d).includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new s.CellCoords(null,null)),i.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-o.row:i.row,i.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-o.col:i.col,n.row>0?i.row=a.row+a.rowspan-1-o.row+n.row:0>n.row&&(i.row=o.row-a.row+n.row),n.col>0?i.col=a.col+a.colspan-1-o.col+n.col:0>n.col&&(i.col=o.col-a.col+n.col)}r=new s.CellCoords(e.highlight.row+i.row,e.highlight.col+i.col);var f=this.mergedCellInfoCollection.getInfo(r.row,r.col);f&&(this.lastDesiredCoords=r,i={row:f.row-o.row,col:f.col-o.col})}else if("modifyTransformEnd"==t)for(var p=0,m=this.mergedCellInfoCollection.length;m>p;p++){var g=this.mergedCellInfoCollection[p],v=new s.CellCoords(g.row,g.col),y=new s.CellCoords(g.row+g.rowspan-1,g.col+g.colspan-1),w=new s.CellRange(v,v,y),b=e.getBordersSharedWith(w);if(w.isEqual(e))e.setDirection("NW-SE");else if(b.length>0){var _=e.highlight.isEqual(w.from);b.indexOf("top")>-1?e.to.isSouthEastOf(w.from)&&_?e.setDirection("NW-SE"):e.to.isSouthWestOf(w.from)&&_&&e.setDirection("NE-SW"):b.indexOf("bottom")>-1&&(e.to.isNorthEastOf(w.from)&&_?e.setDirection("SW-NE"):e.to.isNorthWestOf(w.from)&&_&&e.setDirection("SE-NW"))}var E=function(t,e){return e.row>=t.row&&t.row+t.rowspan-1>=e.row}(g,r=function(t){return new s.CellCoords(e.to.row+t.row,e.to.col+t.col)}(i)),T=function(t,e){return e.col>=t.col&&t.col+t.colspan-1>=e.col}(g,r);e.includesRange(w)&&(w.includes(r)||E||T)&&(E&&(0>i.row?i.row-=g.rowspan-1:i.row>0&&(i.row+=g.rowspan-1)),T&&(0>i.col?i.col-=g.colspan-1:i.col>0&&(i.col+=g.colspan-1)))}0!==i.row&&(n.row=i.row),0!==i.col&&(n.col=i.col)},r.prototype.shiftCollection=function(t,e,n){var i=[0,0];switch(t){case"right":i[0]+=1;break;case"left":i[0]-=1;break;case"down":i[1]+=1;break;case"up":i[1]-=1}for(var r=0;this.mergedCellInfoCollection.length>r;r++){var o=this.mergedCellInfoCollection[r];"right"===t||"left"===t?e>o.col||(o.col+=i[0]):e>o.row||(o.row+=i[1])}};var u=function(t){return function(e){if(this.getSettings().mergeCells){var n=this.getSelectedRange();if(this.mergeCells.modifyTransform(t,n,e),"modifyTransformEnd"===t){var i=this.countRows(),r=this.countCols();0>n.from.row?n.from.row=0:n.from.row>0&&n.from.row>=i&&(n.from.row=n.from-1),0>n.from.col?n.from.col=0:n.from.col>0&&n.from.col>=r&&(n.from.col=r-1)}}}},c=o.default.getSingleton();c.add("beforeInit",function(){var t=this.getSettings().mergeCells;t&&(this.mergeCells||(this.mergeCells=new r(t)))}),c.add("afterInit",function(){var t=this;t.mergeCells&&(t.view.wt.wtTable.getCell=function(e){if(t.getSettings().mergeCells){var n=t.mergeCells.mergedCellInfoCollection.getInfo(e.row,e.col);n&&(e=n)}return s.Table.prototype.getCell.call(this,e)})}),c.add("afterUpdateSettings",function(){var t=this.getSettings().mergeCells;if(t)if(this.mergeCells){if(this.mergeCells.mergedCellInfoCollection=new i,Array.isArray(t))for(var e=0,n=t.length;n>e;e++)this.mergeCells.mergedCellInfoCollection.setInfo(t[e])}else this.mergeCells=new r(t);else this.mergeCells&&(this.mergeCells.mergedCellInfoCollection=new i)}),c.add("beforeKeyDown",function(t){this.mergeCells&&(t.ctrlKey||t.metaKey)&&!t.altKey&&77===t.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),(0,a.stopImmediatePropagation)(t))}),c.add("modifyTransformStart",u("modifyTransformStart")),c.add("modifyTransformEnd",u("modifyTransformEnd")),c.add("beforeSetRangeEnd",function(t){if(this.lastDesiredCoords=null,this.getSettings().mergeCells){var e=this.getSelectedRange();e.highlight=new s.CellCoords(e.highlight.row,e.highlight.col),e.to=t;var n=!1;do{n=!1;for(var i=0,r=this.mergeCells.mergedCellInfoCollection.length;r>i;i++){var o=this.mergeCells.mergedCellInfoCollection[i],a=new s.CellCoords(o.row,o.col),l=new s.CellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);e.expandByRange(new s.CellRange(a,a,l))&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}}),c.add("beforeDrawBorders",function(t,e){if(e&&"area"==e&&this.getSettings().mergeCells)for(var n=this.getSelectedRange(),i=new s.CellRange(n.from,n.from,n.from),r=new s.CellRange(n.to,n.to,n.to),o=0,a=this.mergeCells.mergedCellInfoCollection.length;a>o;o++){var l=this.mergeCells.mergedCellInfoCollection[o],u=new s.CellCoords(l.row,l.col),c=new s.CellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),h=new s.CellRange(u,u,c);i.expandByRange(h)&&(t[0]=i.from.row,t[1]=i.from.col),r.expandByRange(h)&&(t[2]=r.from.row,t[3]=r.from.col)}}),c.add("afterIsMultipleSelection",function(t){if(t&&this.mergeCells){var e=this.mergeCells.mergedCellInfoCollection,n=this.getSelectedRange();for(var i in e)if(n.highlight.row==e[i].row&&n.highlight.col==e[i].col&&n.to.row==e[i].row+e[i].rowspan-1&&n.to.col==e[i].col+e[i].colspan-1)return!1}return t}),c.add("afterRenderer",function(t,e,n,i,r,o){this.mergeCells&&this.mergeCells.applySpanProperties(t,e,n)}),c.add("afterContextMenuDefaultOptions",function(t){this.getSettings().mergeCells&&(t.items.push({name:"---------"}),t.items.push({key:"mergeCells",name:function(){var t=this.getSelected();return this.getTranslatedPhrase(this.mergeCells.mergedCellInfoCollection.getInfo(t[0],t[1])?l.CONTEXTMENU_ITEMS_UNMERGE_CELLS:l.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return this.selection.selectedHeader.corner}}))}),c.add("afterGetCellMeta",function(t,e,n){if(this.getSettings().mergeCells){var i=this.mergeCells.mergedCellInfoCollection.getInfo(t,e);!i||i.row==t&&i.col==e||(n.copyable=!1)}}),c.add("afterViewportRowCalculatorOverride",function t(e){if(this.getSettings().mergeCells)for(var n,i=this.countCols(),r=0;i>r;r++){if((n=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,r))&&e.startRow>n.row)return e.startRow=n.row,t.call(this,e);if(n=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,r)){var o=n.row+n.rowspan-1;if(o>e.endRow)return e.endRow=o,t.call(this,e)}}}),c.add("afterViewportColumnCalculatorOverride",function t(e){if(this.getSettings().mergeCells)for(var n,i=this.countRows(),r=0;i>r;r++){if((n=this.mergeCells.mergedCellInfoCollection.getInfo(r,e.startColumn))&&e.startColumn>n.col)return e.startColumn=n.col,t.call(this,e);if(n=this.mergeCells.mergedCellInfoCollection.getInfo(r,e.endColumn)){var o=n.col+n.colspan-1;if(o>e.endColumn)return e.endColumn=o,t.call(this,e)}}}),c.add("modifyAutofillRange",function(t,e){if(this.getSettings().mergeCells&&!this.selection.isMultiple()){var n=this.mergeCells.mergedCellInfoCollection.getInfo(t[0],t[1]);n&&(t[0]=n.row,t[1]=n.col,t[2]=n.row+n.rowspan-1,t[3]=n.col+n.colspan-1)}}),c.add("afterCreateCol",function(t,e){this.mergeCells&&this.mergeCells.shiftCollection("right",t,e)}),c.add("afterRemoveCol",function(t,e){this.mergeCells&&this.mergeCells.shiftCollection("left",t,e)}),c.add("afterCreateRow",function(t,e){this.mergeCells&&this.mergeCells.shiftCollection("down",t,e)}),c.add("afterRemoveRow",function(t,e){this.mergeCells&&this.mergeCells.shiftCollection("up",t,e)}),e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i(n(8)),n(0)),a=n(27),s=i(n(14)),l=i(n(4)),u=n(6),c=n(13),h=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.dragged=[],n.eventManager=null,n.lastSetCell=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),r(e,[{key:"isEnabled",value:function(){return(0,a.isMobileBrowser)()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new l.default(this)),this.registerListeners(),function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){function t(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;var n=e.dragged.indexOf(t);if(-1==n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1==n&&(e.dragged=e.dragged.slice(-1))}var e=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(t){var n=void 0;return(0,o.hasClass)(t.target,"topLeftSelectionHandle-HitArea")?(n=e.hot.getSelectedRange(),e.dragged.push("topLeft"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):(0,o.hasClass)(t.target,"bottomRightSelectionHandle-HitArea")?(n=e.hot.getSelectedRange(),e.dragged.push("bottomRight"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(n){return(0,o.hasClass)(n.target,"topLeftSelectionHandle-HitArea")?(t.call(e,"topLeft"),e.touchStartRange=void 0,n.preventDefault(),!1):(0,o.hasClass)(n.target,"bottomRightSelectionHandle-HitArea")?(t.call(e,"bottomRight"),e.touchStartRange=void 0,n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(t){var n=(0,o.getWindowScrollTop)(),i=(0,o.getWindowScrollLeft)(),r=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=void 0;0!==e.dragged.length&&(r=document.elementFromPoint(t.touches[0].screenX-i,t.touches[0].screenY-n))&&r!==e.lastSetCell&&("TD"!=r.nodeName&&"TH"!=r.nodeName||(-1==(a=e.hot.getCoords(r)).col&&(a.col=0),s=e.hot.getSelectedRange(),l=s.getWidth(),u=s.getHeight(),c=s.getDirection(),1==l&&1==u&&e.hot.selection.setRangeEnd(a),null!==(h=e.getCurrentRangeCoords(s,a,e.touchStartRange.direction,c,e.dragged[0])).start&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=r),t.preventDefault())})}},{key:"getCurrentRangeCoords",value:function(t,e,n,i,r){var o=t.getTopLeftCorner(),a=t.getBottomRightCorner(),s=t.getBottomLeftCorner(),l=t.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":u="topLeft"==r?{start:new c.CellCoords(e.row,t.highlight.col),end:new c.CellCoords(s.row,e.col)}:{start:new c.CellCoords(t.highlight.row,e.col),end:new c.CellCoords(e.row,o.col)};break;case"SE-NW":"bottomRight"==r&&(u={start:new c.CellCoords(a.row,e.col),end:new c.CellCoords(e.row,o.col)})}break;case"NW-SE":switch(i){case"NE-SW":"topLeft"==r?u={start:e,end:s}:u.end=e;break;case"NW-SE":"topLeft"==r?u={start:e,end:a}:u.end=e;break;case"SE-NW":"topLeft"==r?u={start:e,end:o}:u.end=e;break;case"SW-NE":"topLeft"==r?u={start:e,end:l}:u.end=e}break;case"SW-NE":switch(i){case"NW-SE":u="bottomRight"==r?{start:new c.CellCoords(e.row,o.col),end:new c.CellCoords(s.row,e.col)}:{start:new c.CellCoords(o.row,e.col),end:new c.CellCoords(e.row,a.col)};break;case"SW-NE":u="topLeft"==r?{start:new c.CellCoords(t.highlight.row,e.col),end:new c.CellCoords(e.row,a.col)}:{start:new c.CellCoords(e.row,o.col),end:new c.CellCoords(o.row,e.col)};break;case"SE-NW":"bottomRight"==r?u={start:new c.CellCoords(e.row,l.col),end:new c.CellCoords(o.row,e.col)}:"topLeft"==r&&(u={start:s,end:e})}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==r&&(u.end=e);break;case"SE-NW":"topLeft"==r?u.end=e:u={start:e,end:o}}}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}]),e}();(0,u.registerPlugin)("multipleSelectionHandles",h),e.default=h},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=i(n(14)),s=i((i(n(184)),n(311))),l=n(2),u=n(6),c=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.observer=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.observer||(this.observer=new s.default(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(e){return t.onDataChange(e)}),this.addHook("afterCreateRow",function(){return t.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return t.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return t.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return t.onAfterTableAlter()}),this.addHook("afterChange",function(e,n){return t.onAfterTableAlter(n)}),this.addHook("afterLoadData",function(e){return t.onAfterLoadData(e)}),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(t){var e=this;if(!this.observer.isPaused()){var n=this.pluginName+".change",i={add:function(t){isNaN(t.col)?e.hot.runHooks("afterCreateRow",t.row,1,n):e.hot.runHooks("afterCreateCol",t.col,1,n)},remove:function(t){isNaN(t.col)?e.hot.runHooks("afterRemoveRow",t.row,1,n):e.hot.runHooks("afterRemoveCol",t.col,1,n)},replace:function(t){e.hot.runHooks("afterChange",[t.row,t.col,null,t.value],n)}};(0,l.arrayEach)(t,function(t){i[t.op]&&i[t.op](t)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(t){var e=this;"loadData"!==t&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return e.observer.resume()}))}},{key:"onAfterLoadData",value:function(t){t||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var t=this,e=this.hot;e.pauseObservingChanges=function(){return t.observer.pause()},e.resumeObservingChanges=function(){return t.observer.resume()},e.isPausedObservingChanges=function(){return t.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var t=this.hot;delete t.pauseObservingChanges,delete t.resumeObservingChanges,delete t.isPausedObservingChanges}}]),e}();e.default=c,(0,u.registerPlugin)("observeChanges",c)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=i(n(184)),a=i(n(89)),s=n(1),l=n(312),u=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(e)}return r(t,[{key:"setObservedData",value:function(t){var e=this;this.observer&&o.default.unobserve(this.observedData,this.observer),this.observedData=t,this.observer=o.default.observe(this.observedData,function(t){return e.onChange(t)})}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(t){this.runLocalHooks("change",(0,l.cleanPatches)(t))}},{key:"destroy",value:function(){o.default.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}}]),t}();(0,s.mixin)(u,a.default),e.default=u},function(t,e,n){"use strict";function i(t){var e=t.match(/^\/(\d+)\/?(.*)?$/);if(!e)return null;var n=r(e,3),i=n[1],o=n[2];return{row:parseInt(i,10),col:/^\d*$/.test(o)?parseInt(o,10):o}}e.__esModule=!0;var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.cleanPatches=function(t){var e=[];return t=(0,o.arrayFilter)(t,function(t){return!/[\/]length/gi.test(t.path)&&!!i(t.path)}),t=(0,o.arrayMap)(t,function(t){var e=i(t.path);return t.row=e.row,t.col=e.col,t}),t=(0,o.arrayFilter)(t,function(t){if(-1!==["add","remove"].indexOf(t.op)&&!isNaN(t.col)){if(-1!==e.indexOf(t.col))return!1;e.push(t.col)}return!0}),e.length=0,t},e.parsePath=i;var o=n(2)},function(t,e,n){"use strict";function i(t){var e,n=function(){window.localStorage[t+"__persistentStateKeys"]=JSON.stringify(e)};!function(){var n=window.localStorage[t+"__persistentStateKeys"],i="string"==typeof n?JSON.parse(n):void 0;e=i||[]}(),this.saveValue=function(i,r){window.localStorage[t+"_"+i]=JSON.stringify(r),-1==e.indexOf(i)&&(e.push(i),n())},this.loadValue=function(e,n){e=void 0===e?n:e;var i=window.localStorage[t+"_"+e];return void 0===i?void 0:JSON.parse(i)},this.reset=function(e){window.localStorage.removeItem(t+"_"+e)},this.resetAll=function(){for(var i=0;e.length>i;i++)window.localStorage.removeItem(t+"_"+e[i]);e=[],n()}}function r(){var t=this;this.init=function(){var n=this.getSettings().persistentState;(t.enabled=!!n)?(this.storage||(this.storage=new i(this.rootElement.id)),this.resetState=t.resetValue,function(){for(var t in e)(0,a.hasOwnProperty)(e,t)&&this.addHook(t,e[t])}.call(this)):function(){for(var t in e)(0,a.hasOwnProperty)(e,t)&&this.removeHook(t,e[t])}.call(this)},this.saveValue=function(t,e){this.storage.saveValue(t,e)},this.loadValue=function(t,e){e.value=this.storage.loadValue(t)},this.resetValue=function(t){void 0===t?this.storage.resetAll():this.storage.reset(t)};var e={persistentStateSave:t.saveValue,persistentStateLoad:t.loadValue,persistentStateReset:t.resetValue};for(var n in e)(0,a.hasOwnProperty)(e,n)&&o.default.getSingleton().register(n)}e.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(n(8)),a=(n(6),n(1)),s=new r;o.default.getSingleton().add("beforeInit",s.init),o.default.getSingleton().add("afterUpdateSettings",s.init),e.default=r},function(t,e,n){"use strict";function i(t){this.query=function(e,n,r){var o=t.countRows(),a=t.countCols(),s=[];n||(n=i.global.getDefaultCallback()),r||(r=i.global.getDefaultQueryMethod());for(var l=0;o>l;l++)for(var u=0;a>u;u++){var c=t.getDataAtCell(l,u),h=t.getCellMeta(l,u),d=h.search.callback||n,f=(h.search.queryMethod||r)(e,c);if(f){var p={row:l,col:u,data:c};s.push(p)}d&&d(t,l,u,c,f)}return s}}function r(){this.getSettings().search?this.search=new i(this):delete this.search}e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t){return t&&t.__esModule?t:{default:t}}(n(8)),s=n(0),l=n(9);i.DEFAULT_CALLBACK=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},i.DEFAULT_QUERY_METHOD=function(t,e){return!(void 0===t||null==t||!t.toLowerCase||0===t.length)&&void 0!==e&&null!=e&&-1!=(""+e).toLowerCase().indexOf(t.toLowerCase())},i.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",i.global=function(){var t=i.DEFAULT_CALLBACK,e=i.DEFAULT_QUERY_METHOD,n=i.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return e},setDefaultQueryMethod:function(t){e=t},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(t){n=t}}}();var u=(0,l.getRenderer)("base");(0,l.registerRenderer)("base",function(t,e,n,r,a,l,c){u.apply(this,arguments),function(t,e,n,r,a,l,u){var c=null!==u.search&&"object"==o(u.search)&&u.search.searchResultClass||i.global.getDefaultSearchResultClass();u.isSearchResult?(0,s.addClass)(e,c):(0,s.removeClass)(e,c)}.apply(this,arguments)}),a.default.getSingleton().add("afterInit",r),a.default.getSingleton().add("afterUpdateSettings",r),e.default=i},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=n(0),a=n(2),s=function(t){return t&&t.__esModule?t:{default:t}}(n(14)),l=n(6),u=n(35),c=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.scrollbars=[],n.clones=[],n.lockedCollection=!1,n.freezeOverlays=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),i(e,[{key:"isEnabled",value:function(){return(0,u.isTouchSupported)()}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterRender",function(){return t.onAfterRender()}),this.registerEvents(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.addHook("beforeTouchScroll",function(){return t.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return t.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var t=this.hot.view.wt.wtOverlays,e=t.topOverlay,n=t.bottomOverlay,i=t.leftOverlay,r=t.topLeftCornerOverlay,o=t.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(i),r&&this.scrollbars.push(r),o&&o.clone&&this.scrollbars.push(o),this.clones.length=0,e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,(0,a.arrayEach)(this.clones,function(t){(0,o.addClass)(t,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var t=this;this.freezeOverlays=!1,(0,a.arrayEach)(this.clones,function(t){(0,o.removeClass)(t,"hide-tween"),(0,o.addClass)(t,"show-tween")}),setTimeout(function(){(0,a.arrayEach)(t.clones,function(t){(0,o.removeClass)(t,"show-tween")})},400),(0,a.arrayEach)(this.scrollbars,function(t){t.refresh(),t.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),e}();(0,l.registerPlugin)("touchScroll",c),e.default=c},function(t,e,n){"use strict";function i(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t,n){t&&"UndoRedo.undo"!==n&&"UndoRedo.redo"!==n&&e.done(new i.ChangeAction(t))}),t.addHook("afterCreateRow",function(t,n,r){if("UndoRedo.undo"!==r&&"UndoRedo.undo"!==r&&"auto"!==r){var o=new i.CreateRowAction(t,n);e.done(o)}}),t.addHook("beforeRemoveRow",function(t,n,r,o){if("UndoRedo.undo"!==o&&"UndoRedo.redo"!==o&&"auto"!==o){var a=e.instance.getSourceDataArray();t=(a.length+t)%a.length;var s=(0,c.deepClone)(a.slice(t,t+n));e.done(new i.RemoveRowAction(t,s))}}),t.addHook("afterCreateCol",function(t,n,r){"UndoRedo.undo"!==r&&"UndoRedo.redo"!==r&&"auto"!==r&&e.done(new i.CreateColumnAction(t,n))}),t.addHook("beforeRemoveCol",function(n,r,o,a){if("UndoRedo.undo"!==a&&"UndoRedo.redo"!==a&&"auto"!==a){var s=e.instance.getSourceDataArray();n=(e.instance.countCols()+n)%e.instance.countCols();var l=[],c=[],h=[];(0,u.rangeEach)(s.length-1,function(e){var i=[],o=s[e];(0,u.rangeEach)(n,n+(r-1),function(e){i.push(o[t.runHooks("modifyCol",e)])}),l.push(i)}),(0,u.rangeEach)(r-1,function(e){h.push(t.runHooks("modifyCol",n+e))}),Array.isArray(t.getSettings().colHeaders)&&(0,u.rangeEach)(r-1,function(e){c.push(t.getSettings().colHeaders[t.runHooks("modifyCol",n+e)]||null)});var d=e.instance.getPlugin("manualColumnMove"),f=d.isEnabled()?d.columnsMapper.__arrayMap:[],p=new i.RemoveColumnAction(n,h,l,c,f);e.done(p)}}),t.addHook("beforeCellAlignment",function(t,n,r,o){var a=new i.CellAlignmentAction(t,n,r,o);e.done(a)}),t.addHook("beforeFilter",function(t){e.done(new i.FiltersAction(t))}),t.addHook("beforeRowMove",function(t,n){!1!==t&&e.done(new i.RowMoveAction(t,n))})}function r(){void 0===this.getSettings().undo||this.getSettings().undo?this.undoRedo||(this.undoRedo=new i(this),function(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}(this),this.addHook("beforeKeyDown",o),this.addHook("afterChange",a)):this.undoRedo&&(delete this.undoRedo,function(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}(this),this.removeHook("beforeKeyDown",o),this.removeHook("afterChange",a))}function o(t){(t.ctrlKey||t.metaKey)&&!t.altKey&&(89===t.keyCode||t.shiftKey&&90===t.keyCode?(this.undoRedo.redo(),(0,h.stopImmediatePropagation)(t)):90===t.keyCode&&(this.undoRedo.undo(),(0,h.stopImmediatePropagation)(t)))}function a(t,e){if("loadData"===e)return this.undoRedo.clear()}e.__esModule=!0;var s=function(t){return t&&t.__esModule?t:{default:t}}(n(8)),l=n(2),u=n(5),c=n(1),h=n(11),d=n(13);i.prototype.done=function(t){this.ignoreNewActions||(this.doneActions.push(t),this.undoneActions.length=0)},i.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.pop(),e=(0,c.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeUndo",e))return;this.ignoreNewActions=!0;var i=this;t.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(t)}),n.runHooks("afterUndo",e)}},i.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.pop(),e=(0,c.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeRedo",e))return;this.ignoreNewActions=!0;var i=this;t.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(t)}),n.runHooks("afterRedo",e)}},i.prototype.isUndoAvailable=function(){return this.doneActions.length>0},i.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},i.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},(i.Action=function(){}).prototype.undo=function(){},i.Action.prototype.redo=function(){},i.ChangeAction=function(t){this.changes=t,this.actionType="change"},(0,c.inherit)(i.ChangeAction,i.Action),i.ChangeAction.prototype.undo=function(t,e){for(var n=(0,c.deepClone)(this.changes),i=t.countEmptyRows(!0),r=t.countEmptyCols(!0),o=0,a=n.length;a>o;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtRowProp(n,null,null,"UndoRedo.undo");for(var s=0,l=n.length;l>s;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&i==t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&r==t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},i.ChangeAction.prototype.redo=function(t,e){for(var n=(0,c.deepClone)(this.changes),i=0,r=n.length;r>i;i++)n[i].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtRowProp(n,null,null,"UndoRedo.redo")},i.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},(0,c.inherit)(i.CreateRowAction,i.Action),i.CreateRowAction.prototype.undo=function(t,e){var n=t.countRows(),i=t.getSettings().minSpareRows;this.index>=n&&n>this.index-i&&(this.index-=i),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},i.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},i.RemoveRowAction=function(t,e){this.index=t,this.data=e,this.actionType="remove_row"},(0,c.inherit)(i.RemoveRowAction,i.Action),i.RemoveRowAction.prototype.undo=function(t,e){t.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterRender",e),t.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},i.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},i.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},(0,c.inherit)(i.CreateColumnAction,i.Action),i.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},i.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},i.RemoveColumnAction=function(t,e,n,i,r){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=i,this.columnPositions=r.slice(0),this.actionType="remove_col"},(0,c.inherit)(i.RemoveColumnAction,i.Action),i.RemoveColumnAction.prototype.undo=function(t,e){var n=this,i=void 0,r=this.indexes.slice(0).sort(),o=function(t,e,i){return i[n.indexes.indexOf(r[e])]},a=[];(0,u.rangeEach)(this.data.length-1,function(t){a[t]=(0,l.arrayMap)(n.data[t],o)});var s=[];s=(0,l.arrayMap)(this.headers,o);var c=[];t.runHooks("beforeCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),(0,u.rangeEach)(this.data.length-1,function(e){i=t.getSourceDataAtRow(e),(0,u.rangeEach)(r.length-1,function(t){i.splice(r[t],0,a[e][t]),c.push([e,r[t],null,a[e][t]])})}),t.getPlugin("formulas")&&t.getPlugin("formulas").onAfterSetDataAtCell(c),void 0!==this.headers&&(0,u.rangeEach)(s.length-1,function(e){t.getSettings().colHeaders.splice(r[e],0,s[e])}),t.getPlugin("manualColumnMove")&&(t.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),t.addHookOnce("afterRender",e),t.runHooks("afterCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),t.getPlugin("formulas")&&t.getPlugin("formulas").recalculateFull(),t.render()},i.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},(i.CellAlignmentAction=function(t,e,n,i){this.stateBefore=t,this.range=e,this.type=n,this.alignment=i}).prototype.undo=function(t,e){if(t.getPlugin("contextMenu").isEnabled()){for(var n=this.range.from.row;this.range.to.row>=n;n++)for(var i=this.range.from.col;this.range.to.col>=i;i++)t.setCellMeta(n,i,"className",this.stateBefore[n][i]||" htLeft");t.addHookOnce("afterRender",e),t.render()}},i.CellAlignmentAction.prototype.redo=function(t,e){t.getPlugin("contextMenu").isEnabled()&&(t.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col),t.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase()),t.addHookOnce("afterRender",e),t.render())},i.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},(0,c.inherit)(i.FiltersAction,i.Action),i.FiltersAction.prototype.undo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},i.FiltersAction.prototype.redo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()},i.RowMoveAction=function(t,e){this.rows=t.slice(),this.target=e},(0,c.inherit)(i.RowMoveAction,i.Action),i.RowMoveAction.prototype.undo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e);for(var i=this.target>this.rows[0]?-1*this.rows.length:0,r=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],o=[],a=this.rows.length+i,s=i;a>s;s++)o.push(this.target+s);n.moveRows(o.slice(),r),t.render(),t.selection.setRangeStartOnly(new d.CellCoords(this.rows[0],0)),t.selection.setRangeEnd(new d.CellCoords(this.rows[this.rows.length-1],t.countCols()-1))},i.RowMoveAction.prototype.redo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e),n.moveRows(this.rows.slice(),this.target),t.render();var i=this.target>this.rows[0]?this.target-this.rows.length:this.target;t.selection.setRangeStartOnly(new d.CellCoords(i,0)),t.selection.setRangeEnd(new d.CellCoords(i+this.rows.length-1,t.countCols()-1))};var f=s.default.getSingleton();f.add("afterInit",r),f.add("afterUpdateSettings",r),f.register("beforeUndo"),f.register("afterUndo"),f.register("beforeRedo"),f.register("afterRedo"),e.default=i}]).default}),define("text",["module"],function(t){"use strict";function e(t,e){return void 0===t||""===t?e:t}var n,i,r,o,a,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,h=c&&location.protocol&&location.protocol.replace(/\:/,""),d=c&&location.hostname,f=c&&(location.port||void 0),p={},m=t.config&&t.config()||{};return n={version:"2.0.15",strip:function(t){if(t){var e=(t=t.replace(l,"")).match(u);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var t,e,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){n=s[e];try{t=new ActiveXObject(n)}catch(t){}if(t){s=[n];break}}return t},parseName:function(t){var e,n,i,r=!1,o=t.lastIndexOf("."),a=0===t.indexOf("./")||0===t.indexOf("../");return-1!==o&&(!a||o>1)?(e=t.substring(0,o),n=t.substring(o+1)):e=t,i=n||e,-1!==(o=i.indexOf("!"))&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:e=i),{moduleName:e,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,r,o){var a,s,l,u=n.xdRegExp.exec(t);return!u||(a=u[2],s=u[3],s=s.split(":"),l=s[1],s=s[0],(!a||a===i)&&(!s||s.toLowerCase()===r.toLowerCase())&&(!l&&!s||function(t,n,i,r){if(n===r)return!0;if(t===i){if("http"===t)return e(n,"80")===e(r,"80");if("https"===t)return e(n,"443")===e(r,"443")}return!1}(a,l,i,o)))},finishLoad:function(t,e,i,r){i=e?n.strip(i):i,m.isBuild&&(p[t]=i),r(i)},load:function(t,e,i,r){if(r&&r.isBuild&&!r.inlineText)i();else{m.isBuild=r&&r.isBuild;var o=n.parseName(t),a=o.moduleName+(o.ext?"."+o.ext:""),s=e.toUrl(a),l=m.useXhr||n.useXhr;0!==s.indexOf("empty:")?!c||l(s,h,d,f)?n.get(s,function(e){n.finishLoad(t,o.strip,e,i)},function(t){i.error&&i.error(t)}):e([a],function(t){n.finishLoad(o.moduleName+"."+o.ext,o.strip,t,i)}):i()}},write:function(t,e,i,r){if(p.hasOwnProperty(e)){var o=n.jsEscape(p[e]);i.asModule(t+"!"+e,"define(function () { return '"+o+"';});\n")}},writeFile:function(t,e,i,r,o){var a=n.parseName(e),s=a.ext?"."+a.ext:"",l=a.moduleName+s,u=i.toUrl(a.moduleName+s)+".js";n.load(l,i,function(e){var i=function(t){return r(u,t)};i.asModule=function(t,e){return r.asModule(t,u,e)},n.write(t,l,i,o)},o)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),n.get=function(t,e,n){try{var r=i.readFileSync(t,"utf8");"\ufeff"===r[0]&&(r=r.substring(1)),e(r)}catch(t){n&&n(t)}}):"xhr"===m.env||!m.env&&n.createXhr()?n.get=function(t,e,i,r){var o,a=n.createXhr();if(a.open("GET",t,!0),r)for(o in r)r.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),r[o]);m.onXhr&&m.onXhr(a,t),a.onreadystatechange=function(n){var r,o;4===a.readyState&&((r=a.status||0)>399&&r<600?((o=new Error(t+" HTTP status: "+r)).xhr=a,i&&i(o)):e(a.responseText),m.onXhrComplete&&m.onXhrComplete(a,t))},a.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(t,e){var n,i,r=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),s="";try{for(n=new java.lang.StringBuffer,(i=a.readLine())&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(o),n.append(i);s=String(n.toString())}finally{a.close()}e(s)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,o=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in r,n.get=function(t,e){var n,i,s,l={};a&&(t=t.replace(/\//g,"\\")),s=new FileUtils.File(t);try{(n=r["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream)).init(s,1,0,!1),(i=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream)).init(n,"utf-8",n.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),l),i.close(),n.close(),e(l.value)}catch(t){throw new Error((s&&s.path||"")+": "+t)}}),n}),define("text!lib/css/handsontable.min.css",[],function(){return'/*!\n * (The MIT License)\n * \n * Copyright (c) 2012-2014 Marcin Warpechowski\n * Copyright (c) 2015 Handsoncode sp. z o.o. <hello@handsoncode.net>\n * \n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \'Software\'), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n * \n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \'AS IS\', WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Version: 0.35.0\n * Release date: 06/12/2017 (built at 06/12/2017 09:46:21)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0 4px}.col-lg-1.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-md-1.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable.htAutoSize{visibility:hidden;left:-99000px;position:absolute;top:-99000px}.handsontable .wtHider{width:0}.handsontable .wtSpreader{position:relative;width:0;height:auto}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:0}.handsontable table.htCore{border-collapse:separate;border-spacing:0;margin:0;border-width:0;table-layout:fixed;width:0;outline-width:0;max-width:none;max-height:none}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{border-top-width:0;border-left-width:0;border-right:1px solid #ccc;border-bottom:1px solid #ccc;height:22px;empty-cells:show;line-height:21px;padding:0 4px;background-color:#fff;vertical-align:top;overflow:hidden;outline-width:0;white-space:pre-line;background-clip:padding-box}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}.handsontable th:last-child{border-right:1px solid #ccc;border-bottom:1px solid #ccc}.handsontable th.htNoFrame,.handsontable th:first-child.htNoFrame,.handsontable tr:first-child th.htNoFrame{border-left-width:0;background-color:#fff;border-color:#fff}.handsontable .htNoFrame+td,.handsontable .htNoFrame+th,.handsontable.htRowHeaders thead tr th:nth-child(2),.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,.ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable tbody tr th{border-right-width:0}.ht_master:not(.innerBorderTop) thead tr.lastChild th,.ht_master:not(.innerBorderTop) thead tr:last-child th,.ht_master:not(.innerBorderTop)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f3f3f3;color:#222;text-align:center;font-weight:400;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable.ht__selection--columns thead th.ht__highlight,.handsontable.ht__selection--rows tbody th.ht__highlight{background-color:#8eb0e7;color:#000}#hot-display-license-info{font-size:9px;color:#323232;padding:5px 0 3px;font-family:Helvetica,Arial,sans-serif;text-align:left}.handsontable .manualColumnResizer{position:fixed;top:0;cursor:col-resize;z-index:6;width:5px;height:25px}.handsontable .manualRowResizer{position:fixed;left:0;cursor:row-resize;z-index:6;height:5px;width:50px}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#aab}.handsontable .manualColumnResizerGuide{position:fixed;right:0;top:0;background-color:#aab;display:none;width:0;border-right:1px dashed #777;margin-left:5px}.handsontable .manualRowResizerGuide{position:fixed;left:0;bottom:0;background-color:#aab;display:none;height:0;border-bottom:1px dashed #777;margin-top:5px}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:7}.handsontable .columnSorting{position:relative}.handsontable .columnSorting:hover{text-decoration:underline;cursor:pointer}.handsontable .columnSorting.ascending:after{content:"\\25B2";color:#5f5f5f;position:absolute;right:-15px}.handsontable .columnSorting.descending:after{content:"\\25BC";color:#5f5f5f;position:absolute;right:-15px}.handsontable .wtBorder{position:absolute;font-size:0}.handsontable .wtBorder.hidden{display:none!important}.handsontable td.area{background:linear-gradient(180deg,rgba(181,209,255,.34) 0,rgba(181,209,255,.34));filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#57b5d1ff",endColorstr="#57b5d1ff",GradientType=0);background-color:#fff}.handsontable .wtBorder.corner{font-size:0;cursor:crosshair}.handsontable .htBorder.htFillBorder{background:red;width:1px;height:1px}.handsontableInput{border:none;outline-width:0;margin:0;padding:1px 5px 0;font-family:inherit;line-height:21px;font-size:inherit;box-shadow:inset 0 0 0 2px #5292f7;resize:none;display:block;color:#000;border-radius:0;background-color:#fff}.handsontableInputHolder{position:absolute;top:0;left:0;z-index:1}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{content:"\\25B6";color:#777;position:absolute;right:5px}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable .htAutocompleteArrow{float:right;font-size:10px;color:#eee;cursor:default;width:16px;text-align:center}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block;vertical-align:middle}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{cursor:pointer;display:inline-block;width:100%}@-webkit-keyframes a{0%{opacity:1}to{opacity:0}}@keyframes a{0%{opacity:1}to{opacity:0}}@-webkit-keyframes b{0%{opacity:0}to{opacity:1}}@keyframes b{0%{opacity:0}to{opacity:1}}.handsontable .handsontable.ht_clone_top .wtHider{padding:0 0 5px}.handsontable .autocompleteEditor.handsontable{padding-right:17px}.handsontable .autocompleteEditor.handsontable.htMacScroll{padding-right:15px}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{border:1px solid #ccc;border-collapse:separate;background:#fff}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent}.handsontable.listbox td,.handsontable.listbox th{white-space:nowrap;text-overflow:ellipsis}.handsontable.listbox td.htDimmed{cursor:default;color:inherit;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr:hover td,.handsontable.listbox tr td.current{background:#eee}.ht_clone_top{z-index:2}.ht_clone_left{z-index:3}.ht_clone_bottom_left_corner,.ht_clone_debug,.ht_clone_top_left_corner{z-index:4}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.htBordered{border-width:1px}.htBordered.htTopBorderSolid{border-top-style:solid;border-top-color:#000}.htBordered.htRightBorderSolid{border-right-style:solid;border-right-color:#000}.htBordered.htBottomBorderSolid{border-bottom-style:solid;border-bottom-color:#000}.htBordered.htLeftBorderSolid{border-left-style:solid;border-left-color:#000}.handsontable tbody tr th:nth-last-child(2){border-right:1px solid #ccc}.handsontable thead tr:nth-last-child(2) th.htGroupIndicatorContainer{border-bottom:1px solid #ccc;padding-bottom:5px}.ht_clone_top_left_corner thead tr th:nth-last-child(2){border-right:1px solid #ccc}.htCollapseButton{width:10px;height:10px;line-height:10px;text-align:center;border-radius:5px;border:1px solid #f3f3f3;box-shadow:1px 1px 3px rgba(0,0,0,.4);cursor:pointer;margin-bottom:3px;position:relative}.htCollapseButton:after{content:"";height:300%;width:1px;display:block;background:#ccc;margin-left:4px;position:absolute;bottom:10px}thead .htCollapseButton{right:5px;position:absolute;top:5px;background:#fff}thead .htCollapseButton:after{height:1px;width:700%;right:10px;top:4px}.handsontable tr th .htExpandButton{position:absolute;width:10px;height:10px;line-height:10px;text-align:center;border-radius:5px;border:1px solid #f3f3f3;box-shadow:1px 1px 3px rgba(0,0,0,.4);cursor:pointer;top:0;display:none}.handsontable thead tr th .htExpandButton{top:5px}.handsontable tr th .htExpandButton.clickable{display:block}.collapsibleIndicator{position:absolute;top:50%;transform:translateY(-50%);right:5px;border:1px solid #a6a6a6;line-height:10px;color:#222;border-radius:10px;font-size:10px;width:10px;height:10px;cursor:pointer;box-shadow:0 0 0 6px #eee;background:#eee}.handsontable col.hidden{width:0!important}.handsontable table tr th.lightRightBorder{border-right:1px solid #e6e6e6}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_left,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.ht_clone_left .wtHolder{overflow-x:hidden;overflow-y:auto}.ht_clone_bottom .wtHolder,.ht_clone_top .wtHolder{overflow-x:auto;overflow-y:hidden}.wtDebugHidden{display:none}.wtDebugVisible{display:block;-webkit-animation-duration:.5s;-webkit-animation-name:c;animation-duration:.5s;animation-name:c}@keyframes c{0%{display:none;opacity:0}1%{display:block;opacity:0}to{display:block;opacity:1}}@-webkit-keyframes c{0%{display:none;opacity:0}1%{display:block;opacity:0}to{display:block;opacity:1}}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch}.htMobileEditorContainer{display:none;position:absolute;top:0;width:70%;height:54pt;background:#f8f8f8;border-radius:20px;border:1px solid #ebebeb;z-index:8;box-sizing:border-box;-webkit-box-sizing:border-box;-webkit-text-size-adjust:none}.topLeftSelectionHandle-HitArea:not(.ht_master .topLeftSelectionHandle-HitArea),.topLeftSelectionHandle:not(.ht_master .topLeftSelectionHandle){z-index:11}.bottomRightSelectionHandle,.bottomRightSelectionHandle-HitArea,.topLeftSelectionHandle,.topLeftSelectionHandle-HitArea{left:-10000px;top:-10000px}.htMobileEditorContainer.active{display:block}.htMobileEditorContainer .inputs{position:absolute;right:210pt;bottom:10pt;top:10pt;left:14px;height:34pt}.htMobileEditorContainer .inputs textarea{font-size:13pt;border:1px solid #a1a1a1;-webkit-appearance:none;box-shadow:none;position:absolute;left:14px;right:14px;top:0;bottom:0;padding:7pt}.htMobileEditorContainer .cellPointer{position:absolute;top:-13pt;height:0;width:0;left:30px;border-left:13pt solid transparent;border-right:13pt solid transparent;border-bottom:13pt solid #ebebeb}.htMobileEditorContainer .cellPointer.hidden{display:none}.htMobileEditorContainer .cellPointer:before{content:"";display:block;position:absolute;top:2px;height:0;width:0;left:-13pt;border-left:13pt solid transparent;border-right:13pt solid transparent;border-bottom:13pt solid #f8f8f8}.htMobileEditorContainer .moveHandle{position:absolute;top:10pt;left:5px;width:30px;bottom:0;cursor:move;z-index:11}.htMobileEditorContainer .moveHandle:after{content:"..\\A..\\A..\\A..";white-space:pre;line-height:10px;font-size:20pt;display:inline-block;margin-top:-8px;color:#ebebeb}.htMobileEditorContainer .positionControls{width:205pt;position:absolute;right:5pt;top:0;bottom:0}.htMobileEditorContainer .positionControls>div{width:50pt;height:100%;float:left}.htMobileEditorContainer .positionControls>div:after{content:" ";display:block;width:15pt;height:15pt;text-align:center;line-height:50pt}.htMobileEditorContainer .downButton:after,.htMobileEditorContainer .leftButton:after,.htMobileEditorContainer .rightButton:after,.htMobileEditorContainer .upButton:after{transform-origin:5pt 5pt;-webkit-transform-origin:5pt 5pt;margin:21pt 0 0 21pt}.htMobileEditorContainer .leftButton:after{border-top:2px solid #288ffe;border-left:2px solid #288ffe;-webkit-transform:rotate(-45deg)}.htMobileEditorContainer .leftButton:active:after{border-color:#cfcfcf}.htMobileEditorContainer .rightButton:after{border-top:2px solid #288ffe;border-left:2px solid #288ffe;-webkit-transform:rotate(135deg)}.htMobileEditorContainer .rightButton:active:after{border-color:#cfcfcf}.htMobileEditorContainer .upButton:after{border-top:2px solid #288ffe;border-left:2px solid #288ffe;-webkit-transform:rotate(45deg)}.htMobileEditorContainer .upButton:active:after{border-color:#cfcfcf}.htMobileEditorContainer .downButton:after{border-top:2px solid #288ffe;border-left:2px solid #288ffe;-webkit-transform:rotate(225deg)}.htMobileEditorContainer .downButton:active:after{border-color:#cfcfcf}.handsontable.hide-tween{-webkit-animation:a .3s;animation:a .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:b .3s;animation:b .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.htCommentCell{position:relative}.htCommentCell:after{content:"";position:absolute;top:0;right:0;border-left:6px solid transparent;border-top:6px solid #000}.htComments{display:none;z-index:9;position:absolute}.htCommentTextArea{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216);box-sizing:border-box;border:none;border-left:3px solid #ccc;background-color:#fff;width:215px;height:90px;font-size:12px;padding:5px;outline:0!important;-webkit-appearance:none}.htCommentTextArea:focus{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216),inset 0 0 0 1px #5292f7;border-left:3px solid #5292f7}\n/*!\n * Handsontable ContextMenu\n */.htContextMenu{display:none;position:absolute;z-index:10}.htContextMenu .ht_clone_corner,.htContextMenu .ht_clone_debug,.htContextMenu .ht_clone_left,.htContextMenu .ht_clone_top{display:none}.htContextMenu table.htCore{border:1px solid #ccc;border-bottom-width:2px;border-right-width:2px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htContextMenu table tbody tr td:first-child{border:0}.htContextMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #bbb;height:0;padding:0;cursor:default}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}.htContextMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea#HandsontableCopyPaste{position:fixed!important;top:0!important;right:100%!important;overflow:hidden;opacity:0;outline:0 none!important}.htRowHeaders .ht_master.innerBorderLeft~.ht_clone_left td:first-of-type,.htRowHeaders .ht_master.innerBorderLeft~.ht_clone_top_left_corner th:nth-child(2){border-left:0 none}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{position:absolute;height:100%;display:none}.handsontable .ht__manualColumnMove--guideline{background:#757575;width:2px;top:0;margin-left:-1px;z-index:5}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:5;pointer-events:none}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{position:absolute;width:100%;display:none}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:5}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:5;pointer-events:none}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}'}),define("HandsontableWrapper",["Handsontable","jquery","text!lib/css/handsontable.min.css"],function(t,e,n){return e("head").append("<style type='text/css'>"+n+"</style>"),t}),define("dataFlow/UI/tableValueEnterer",["jquery","underscore","dataFlow/dataTree","HandsontableWrapper","dataFlow/enums"],function(t,e,n,i,r){function o(t,e,n,i,r,o){this.init.apply(this,arguments)}var a={};return a[r.OUTPUT_TYPES.NUMBER]={type:"numeric"},a[r.OUTPUT_TYPES.STRING]={type:"text"},a[r.OUTPUT_TYPES.BOOLEAN]={type:"checkbox"},o.prototype.init=function(t,n,i,r,o,a){this.callback=r,this.data=t,this.dataType=o,this.readOnly=!!a,e.bindAll(this,"dataAsArrayOfArrays","initializeTable","cleanDataArray"),this.overlay=this.createOverlay(),this.$tableContainer=this.insertTable(n,i);var s=this.dataAsArrayOfArrays(t);this.dataArray=s[0],this.dataHeaderArray=s[1],this.initializeTable()},o.prototype.initializeTable=function(){var t=this;this.table=new i(this.$tableContainer.find("#editableTable").get(0),{data:t.dataArray,contextMenu:!0,colWidths:100,minSpareRows:50,rowHeaders:!t.readOnly||function(e){return t.dataHeaderArray[e]||""},columns:[a[t.dataType]]})},o.prototype.dataAsArrayOfArrays=function(t){var n=[],i=[];return t.recurseTree(function(t,r){var o="{"+r.getPath().join(";")+"}";e.each(t,function(t,e){n.push([t.toString()]),i.push(o+" ("+e+")")})}),[n,i]},o.prototype.createOverlay=function(){var e="overlay_"+Math.floor(1e4*Math.random()),n=t("<div id='"+e+"' class='TOP workspaceOverlay'></div>");t("body").append(n);var i=this;return n.on("click",function(){i.overlay.off(),i.overlay.remove(),i.destroy()}),n},o.prototype.cleanDataArray=function(){return this.dataType===r.OUTPUT_TYPES.NUMBER?e.map(e.filter(this.dataArray,function(t){return!(e.isEmpty(t)||e.isUndefined(t[0])||e.isNull(t[0])||e.isNaN(Number(t[0])))}),function(t){return Number(t[0])}):this.dataType===r.OUTPUT_TYPES.STRING?e.map(e.filter(this.dataArray,function(t){return!e.isEmpty(t)&&!e.isEmpty(t[0])}),function(t){return t[0]}):this.dataType===r.OUTPUT_TYPES.BOOLEAN?(console.warn("NOT IMPLEMENTED: PARSING FOR BOOLEANS"),!0):void 0},o.prototype.destroy=function(){this.table.deselectCell();var t=this;e.delay(function(){t.table.destroy(),t.$tableContainer.remove(),"function"!=typeof t.callback||t.readOnly||(t.data.setDataAtPath(t.cleanDataArray(),[0]),t.callback(t.data))},10)},o.prototype.insertTable=function(e,n){var i=t("<div class='tableView'><div id='editableTable' style='position:relative; overflow: hidden; height: 200px;'></div></div>");return i.css({top:n,left:e,height:200,width:150,"z-index":102,position:"absolute",display:"block"}),t("body").append(i),i},o}),define("dataFlow/UI/inputOutputView",["dataFlow/dataFlow_loader","dataFlow/UI/workspaceView","underscore","dataFlow/enums","threejs"],function(t,e,n,i){function r(t,r,o){if(n.isUndefined(t)||n.isUndefined(r)||n.isUndefined(o))throw new Error("IOView must be passed a model and associated GL and CSS Views");this.model=t,this.glObject=r,this.cssObject=o,this.model.IOView=this,this.glObject.IOView=this,this.cssObject.IOView=this,n.extend(this,Backbone.Events),this._remove=function(){this.stopListening(),this.stretchy.parent.remove(this.stretchy),this.glObject.parent.remove(this.glObject),this.cssObject.parent.remove(this.cssObject),delete this.glObject.IOView,delete this.cssObject.IOView,delete this.model.IOView,delete this.model,delete this.glObject,delete this.cssObject},this.setupStretchyWire=function(){this.glObject.setHomePosition(),this.stretchy=e.getWorkspaceSingleton().drawCurveFromPointToPoint(this.glObject.getHomePosition(),this.glObject.position),this.glObject.parent.add(this.stretchy),this.stretchyCurveArguments=[r.position,r.getHomePosition()],this.listenTo(this.glObject,"changePosition",function(){e.getWorkspaceSingleton().drawCurveFromPointToPoint(this.stretchyCurveArguments[0],this.stretchyCurveArguments[1],this.stretchy)})},this.doubleclick=function(){this.model.getTree().log()};var a=this;this.click=function(t,e){if(a.model.type===i.OUTPUT_TYPES.NUMBER||a.model.type===i.OUTPUT_TYPES.BOOLEAN||a.model.type===i.OUTPUT_TYPES.STRING){var n=a.model.get("persistedData")||new DataTree,r=function(t){a.model.assignPersistedData(t)};require(["dataFlow/UI/tableValueEnterer"],function(i){new i(n,t,e,r,a.model.type)})}},e.getWorkspaceSingleton().setupDraggableView(this),this.setupStretchyWire()}function o(t,e,o){r.call(this,t,e,o),this.connectedOutputViews=[],this.connectionWires=[];var a=this;this.listenTo(this.glObject.parent,"changePosition",function(){n.each(this.connectedOutputViews,function(t,e){a.redrawWireForConnectedOutput(t,a.connectionWires[e])})}),this.listenTo(this.cssObject,"drop",function(t,e){!0===e[i.KEYS.SHIFT]?this.model.connectAdditionalOutput(t.IOView.model,!0):this.model.connectOutput(t.IOView.model)}),this.listenTo(this.model,"connectedOutput",this.connectToOutput),this.listenTo(this.model,"disconnectedOutput",this.disconnectFromOutput)}function a(t,e,n){r.call(this,t,e,n),this.stretchyCurveArguments.reverse()}return o.prototype.remove=function(){var t=this;n.each(this.connectionWires,function(e){t.glObject.parent.parent.remove(e)}),this._remove()},o.prototype.connectToOutput=function(t){var n=t.IOView;e.getWorkspaceSingleton().render();var i=this;this.connectedOutputViews.push(n);var r=this.redrawWireForConnectedOutput(n);this.glObject.parent.parent.add(r),this.connectionWires.push(r),this.listenTo(n.glObject.parent,"changePosition",function(){i.redrawWireForConnectedOutput(n,r)}),e.getWorkspaceSingleton().render()},o.prototype.disconnectFromOutput=function(t){var i=t.IOView,r=n.indexOf(this.connectedOutputViews,i),o=this.connectionWires[r];this.connectionWires=n.without(this.connectionWires,o),this.connectedOutputViews=n.without(this.connectedOutputViews,i),o.parent.remove(o),e.getWorkspaceSingleton().render()},o.prototype.removeAllWires=function(){var t=this;n.each(this.connectionWires,function(t){t.parent.remove(t)}),n.each(this.connectedOutputViews,function(e){t.stopListening(e.glObject.parent,"changePosition")}),this.connectionWires=[],this.connectedOutputViews=[]},o.prototype.drawAllConnections=function(){var t=this,e=this.model._listeningTo;n.isEmpty(e)||n.each(n.values(e),function(e){t.connectToOutput.call(t,e)})},o.prototype.redrawWireForConnectedOutput=function(t,n){t.glObject.updateMatrixWorld(),this.glObject.updateMatrixWorld();var i=(new THREE.Vector3).setFromMatrixPosition(this.glObject.matrixWorld),r=(new THREE.Vector3).setFromMatrixPosition(t.glObject.matrixWorld);return e.getWorkspaceSingleton().drawCurveFromPointToPoint(r,i,n)},a.prototype.remove=function(){this._remove()},{InputView:o,OutputView:a}}),define("dataFlow/UI/spreadsheetView",["jquery","underscore","dataFlow/dataTree","HandsontableWrapper","dataFlow/enums","dataFlow/UI/tableValueEnterer"],function(t,e,n,i,r,o){function a(t){this.initSpreadsheet.apply(this,arguments)}return a.prototype.createOverlay=o.prototype.createOverlay,a.prototype.destroy=o.prototype.destroy,a.prototype.initSpreadsheet=function(t,n,i,r,o,a){this.callback=r,this.data=t,this.dataType=o,this.readOnly=!0,e.bindAll(this,"initializeTable"),this.overlay=this.createOverlay(),this.$tableContainer=this.insertTable();var s=e.keys(this.data),l=e.map(this.data,function(t){return t}),u=e.keys(this.data[s[0]]),c=e.map(u,function(t){return e.pluck(l,t)});this.dataArray=c,this.initializeTable()},a.prototype.initializeTable=function(){var t=e.keys(this.data);this.table=new i(this.$tableContainer.find("#editableTable").get(0),{data:this.dataArray,colWidths:100,minSpareRows:50,minSpareCols:15,readOnly:!0,colHeaders:t,rowHeaders:e.keys(this.data[t[0]])})},a.prototype.insertTable=function(){var e=t(window).height(),n=t("<div class='tableView'><div id='editableTable' style='position:relative; height:"+(e-60)+"px; overflow: hidden;'></div></div>");return n.css({top:50,left:10,right:10,bottom:10,"z-index":102,position:"fixed",display:"block"}),t("body").append(n),n},a}),function(t,e){if("function"==typeof define&&define.amd)define("bootstrap-slider",["jquery"],e);else if("object"==typeof module&&module.exports){var n;try{n=require("jquery")}catch(t){n=null}module.exports=e(n)}else t.Slider=e(t.jQuery)}(this,function(t){var e;return function(t){"use strict";function e(){}var n=Array.prototype.slice;!function(t){if(t){var i="undefined"==typeof console?e:function(t){console.error(t)};t.bridget=function(e,r){(function(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})})(r),function(e,r){t.fn[e]=function(o){if("string"==typeof o){for(var a=n.call(arguments,1),s=0,l=this.length;l>s;s++){var u=this[s],c=t.data(u,e);if(c)if(t.isFunction(c[o])&&"_"!==o.charAt(0)){var h=c[o].apply(c,a);if(void 0!==h&&h!==c)return h}else i("no such method '"+o+"' for "+e+" instance");else i("cannot call methods on "+e+" prior to initialization; attempted to call '"+o+"'")}return this}var d=this.map(function(){var n=t.data(this,e);return n?(n.option(o),n._init()):(n=new r(this,o),t.data(this,e,n)),t(this)});return!d||d.length>1?d:d[0]}}(e,r)},t.bridget}}(t)}(t),function(t){function n(e,n){function i(t,e){var n="data-slider-"+e,i=t.getAttribute(n);try{return JSON.parse(i)}catch(t){return i}}"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e);var r,o,a,s=this.element.style.width,l=!1,u=this.element.parentNode;if(this.sliderElem)l=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var c=document.createElement("div");c.className="slider-track",(r=document.createElement("div")).className="slider-selection",(o=document.createElement("div")).className="slider-handle min-slider-handle",(a=document.createElement("div")).className="slider-handle max-slider-handle",c.appendChild(r),c.appendChild(o),c.appendChild(a);var h=function(t){var e=document.createElement("div");e.className="tooltip-arrow";var n=document.createElement("div");n.className="tooltip-inner",t.appendChild(e),t.appendChild(n)},d=document.createElement("div");d.className="tooltip tooltip-main",h(d);var f=document.createElement("div");f.className="tooltip tooltip-min",h(f);var p=document.createElement("div");p.className="tooltip tooltip-max",h(p),this.sliderElem.appendChild(c),this.sliderElem.appendChild(d),this.sliderElem.appendChild(f),this.sliderElem.appendChild(p),u.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}t&&(this.$element=t(this.element),this.$sliderElem=t(this.sliderElem)),n=n||{};for(var m=Object.keys(this.defaultOptions),g=0;g<m.length;g++){var v=m[g],y=n[v];y=null!==(y=void 0!==y?y:i(this.element,v))?y:this.defaultOptions[v],this.options||(this.options={}),this.options[v]=y}this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),!0===l&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","top","width","height"].forEach(function(t){this._removeProperty(this.trackSelection,t)},this),[this.handle1,this.handle2].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"top"),this._removeProperty(t,"margin-left"),this._removeProperty(t,"margin-top"),this._removeClass(t,"right"),this._removeClass(t,"top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this._addClass(this.tooltip,"right"),this.tooltip.style.left="100%",this._addClass(this.tooltip_min,"right"),this.tooltip_min.style.left="100%",this._addClass(this.tooltip_max,"right"),this.tooltip_max.style.left="100%"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=s,this.options.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this._addClass(this.tooltip,"top"),this.tooltip.style.top=-this.tooltip.outerHeight-14+"px",this._addClass(this.tooltip_min,"top"),this.tooltip_min.style.top=-this.tooltip_min.outerHeight-14+"px",this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=-this.tooltip_max.outerHeight-14+"px"),this.options.value instanceof Array?this.options.range=!0:this.options.range&&(this.options.value=[this.options.value,this.options.max]),this.trackSelection=r||this.trackSelection,"none"===this.options.selection&&this._addClass(this.trackSelection,"hide"),this.handle1=o||this.handle1,this.handle2=a||this.handle2,!0===l&&(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"));-1!==["round","triangle","custom"].indexOf(this.options.handle)&&(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle)),this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos],this.setValue(this.options.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.touchCapable?(this.mousedown=this._mousedown.bind(this),this.sliderElem.addEventListener("touchstart",this.mousedown,!1)):(this.mousedown=this._mousedown.bind(this),this.sliderElem.addEventListener("mousedown",this.mousedown,!1)),"hide"===this.options.tooltip?(this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide")):"always"===this.options.tooltip?(this._showTooltip(),this._alwaysShowTooltip=!0):(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1),this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)),this.options.enabled?this.enable():this.disable()}var i=function(t){return"Invalid input value '"+t+"' passed in"};if(e=function(t,e){return n.call(this,t,e),this},e.prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,enabled:!0,formatter:function(t){return t instanceof Array?t[0]+" : "+t[1]:t},natural_arrow_keys:!1},over:!1,inDrag:!1,getValue:function(){return this.options.range?this.options.value:this.options.value[0]},setValue:function(t,e){t||(t=0);var n=this.getValue();this.options.value=this._validateInputValue(t);var i=this._applyPrecision.bind(this);this.options.range?(this.options.value[0]=i(this.options.value[0]),this.options.value[1]=i(this.options.value[1]),this.options.value[0]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[0])),this.options.value[1]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[1]))):(this.options.value=i(this.options.value),this.options.value=[Math.max(this.options.min,Math.min(this.options.max,this.options.value))],this._addClass(this.handle2,"hide"),this.options.value[1]="after"===this.options.selection?this.options.max:this.options.min),this.diff=this.options.max-this.options.min,this.percentage=this.diff>0?[100*(this.options.value[0]-this.options.min)/this.diff,100*(this.options.value[1]-this.options.min)/this.diff,100*this.options.step/this.diff]:[0,0,100],this._layout();var r=this.options.range?this.options.value:this.options.value[0];return!0===e&&this._trigger("slide",r),n!==r&&this._trigger("change",{oldValue:n,newValue:r}),this._setDataVal(r),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),t&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this.options.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this.options.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this.options.enabled?this.disable():this.enable(),this},isEnabled:function(){return this.options.enabled},on:function(e,n){return t?(this.$element.on(e,n),this.$sliderElem.on(e,n)):this._bindNonQueryEventHandler(e,n),this},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(){return this._removeSliderEventHandlers(),n.call(this,this.element,this.options),t&&t.data(this.element,"slider",this),this},_removeSliderEventHandlers:function(){this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.handle2.removeEventListener("focus",this.handle2Keydown,!1),this.handle2.removeEventListener("blur",this.handle2Keydown,!1),this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.mousedown,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var n=t[e];this.eventToCallbackMap[n]=null}},_showTooltip:function(){!1===this.options.tooltip_split?this._addClass(this.tooltip,"in"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in")),this.over=!0},_hideTooltip:function(){!1===this.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this.over=!1},_layout:function(){var t;if(t=this.options.reversed?[100-this.percentage[0],this.percentage[1]]:[this.percentage[0],this.percentage[1]],this.handle1.style[this.stylePos]=t[0]+"%",this.handle2.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation)this.trackSelection.style.top=Math.min(t[0],t[1])+"%",this.trackSelection.style.height=Math.abs(t[0]-t[1])+"%";else{this.trackSelection.style.left=Math.min(t[0],t[1])+"%",this.trackSelection.style.width=Math.abs(t[0]-t[1])+"%";var e=this.tooltip_min.getBoundingClientRect(),n=this.tooltip_max.getBoundingClientRect();e.right>n.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="-30px")}var i;if(this.options.range){i=this.options.formatter(this.options.value),this._setText(this.tooltipInner,i),this.tooltip.style[this.stylePos]=(t[1]+t[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px"),"vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px");var r=this.options.formatter(this.options.value[0]);this._setText(this.tooltipInner_min,r);var o=this.options.formatter(this.options.value[1]);this._setText(this.tooltipInner_max,o),this.tooltip_min.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-top",-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-left",-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-top",-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-left",-this.tooltip_max.offsetWidth/2+"px")}else i=this.options.formatter(this.options.value[0]),this._setText(this.tooltipInner,i),this.tooltip.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px")},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this.options.enabled)return!1;this._triggerFocusOnHandle(),this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos];var e=this._getPercentage(t);if(this.options.range){var n=Math.abs(this.percentage[0]-e),i=Math.abs(this.percentage[1]-e);this.dragged=i>n?0:1}else this.dragged=0;this.percentage[this.dragged]=this.options.reversed?100-e:e,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this.inDrag=!0;var r=this._calculateValue();return this._trigger("slideStart",r),this._setDataVal(r),this.setValue(r),this._pauseEvent(t),!0},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this.options.enabled)return!1;var n;switch(e.keyCode){case 37:case 40:n=-1;break;case 39:case 38:n=1}if(n){if(this.options.natural_arrow_keys){var i="vertical"===this.options.orientation&&!this.options.reversed,r="horizontal"===this.options.orientation&&this.options.reversed;(i||r)&&(n*=-1)}var o=n*this.percentage[2],a=this.percentage[t]+o;a>100?a=100:0>a&&(a=0),this.dragged=t,this._adjustPercentageForRangeSliders(a),this.percentage[this.dragged]=a,this._layout();var s=this._calculateValue();return this._trigger("slideStart",s),this._setDataVal(s),this.setValue(s,!0),this._trigger("slideStop",s),this._setDataVal(s),this._pauseEvent(e),!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this.options.enabled)return!1;var e=this._getPercentage(t);this._adjustPercentageForRangeSliders(e),this.percentage[this.dragged]=this.options.reversed?100-e:e,this._layout();var n=this._calculateValue();return this.setValue(n,!0),!1},_adjustPercentageForRangeSliders:function(t){this.options.range&&(0===this.dragged&&this.percentage[1]<t?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>t&&(this.percentage[1]=this.percentage[0],this.dragged=0))},_mouseup:function(){if(!this.options.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),this.inDrag=!1,!1===this.over&&this._hideTooltip();var t=this._calculateValue();return this._layout(),this._trigger("slideStop",t),this._setDataVal(t),!1},_calculateValue:function(){var t;return this.options.range?(t=[this.options.min,this.options.max],0!==this.percentage[0]&&(t[0]=Math.max(this.options.min,this.options.min+Math.round(this.diff*this.percentage[0]/100/this.options.step)*this.options.step),t[0]=this._applyPrecision(t[0])),100!==this.percentage[1]&&(t[1]=Math.min(this.options.max,this.options.min+Math.round(this.diff*this.percentage[1]/100/this.options.step)*this.options.step),t[1]=this._applyPrecision(t[1]))):((t=this.options.min+Math.round(this.diff*this.percentage[0]/100/this.options.step)*this.options.step)<this.options.min?t=this.options.min:t>this.options.max&&(t=this.options.max),t=parseFloat(t),t=this._applyPrecision(t)),t},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){var n=t.toFixed(e);return parseFloat(n)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type||(t=t.touches[0]);var e=100*(t[this.mousePos]-this.offset[this.stylePos])/this.size;return e=Math.round(e/this.percentage[2])*this.percentage[2],Math.max(0,Math.min(100,e))},_validateInputValue:function(t){if("number"==typeof t)return t;if(t instanceof Array)return this._validateArray(t),t;throw new Error(i(t))},_validateArray:function(t){for(var e=0;e<t.length;e++){var n=t[e];if("number"!=typeof n)throw new Error(i(n))}},_setDataVal:function(t){var e="value: '"+t+"'";this.element.setAttribute("data",e),this.element.setAttribute("value",t)},_trigger:function(e,n){n=n||0===n?n:void 0;var i=this.eventToCallbackMap[e];if(i&&i.length)for(var r=0;r<i.length;r++){(0,i[r])(n)}t&&this._triggerJQueryEvent(e,n)},_triggerJQueryEvent:function(t,e){var n={type:t,value:e};this.$element.trigger(n),this.$sliderElem.trigger(n)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.innerText?t.innerText=e:void 0!==t.textContent&&(t.textContent=e)},_removeClass:function(t,e){for(var n=e.split(" "),i=t.className,r=0;r<n.length;r++){var o=n[r],a=new RegExp("(?:\\s|^)"+o+"(?:\\s|$)");i=i.replace(a," ")}t.className=i.trim()},_addClass:function(t,e){for(var n=e.split(" "),i=t.className,r=0;r<n.length;r++){var o=n[r];new RegExp("(?:\\s|^)"+o+"(?:\\s|$)").test(i)||(i+=" "+o)}t.className=i.trim()},_offset:function(t){var e=0,n=0;if(t.offsetParent)do{e+=t.offsetLeft,n+=t.offsetTop}while(t=t.offsetParent);return{left:e,top:n}},_css:function(e,n,i){if(t)t.style(e,n,i);else{var r=n.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()});e.style[r]=i}}},t){var r=t.fn.slider?"bootstrapSlider":"slider";t.bridget(r,e)}}(t),e}),define("dataFlow/UI/sliderView",["jquery","bootstrap-slider"],function(t){function e(t,e,n,i,r,o){this.init.apply(this,arguments)}return e.prototype.init=function(e,n,i,r,o,a,s){var l=this.createOverlay(),u="slider_"+Math.floor(1e4*Math.random()),c=t("<input id='"+u+"'></input>");t("body").append(c),c.slider({min:n,max:i,step:r?1:.01,value:e,selection:"none",tooltip:"always",id:"a"+u}),t("#a"+u).css({top:a+"px",left:o+"px"}),c.on("slide slideStop",function(){s(c.slider("getValue"))}),this.sliderInput=c,this.overlay=l},e.prototype.createOverlay=function(){var e="overlay_"+Math.floor(1e4*Math.random()),n=t("<input id='"+e+"' class='TOP workspaceOverlay'></input>");t("body").append(n);var i=this;return n.on("click",function(){i.sliderInput.slider("destroy"),i.sliderInput.remove(),i.overlay.off(),i.overlay.remove()}),n},e}),define("dataFlow/UI/componentView",["jquery","dataFlow/dataFlow_loader","dataFlow/UI/workspaceView","dataFlow/UI/inputOutputView","underscore","backbone","dataFlow/dataTree"],function(t,e,n,i,r,o,a){function s(t){this.init(t)}return s.prototype.init=function(t){this.component=t,r.extend(this,o.Events),r.bindAll(this,"processIOViews","createGLElementToMatch"),this.cssObject=this.createComponentWithNamePosition(this.component.get("componentPrettyName"),this.component.position.x,this.component.position.y),r.defer(function(){this.glObject=this.createGLElementToMatch(this.cssObject),n.getWorkspaceSingleton().setupDraggableView(this),1==this.component.get("sufficient")&&this.changeSufficiency(),this.listenTo(this.glObject,"changePosition",function(){t.position=this.glObject.position})}.bind(this)),t.componentView=this,this.inputViews={},this.outputViews={},this.processIOViews(this.component.inputs,this.inputViews,!0),this.processIOViews(this.component.outputs,this.outputViews,!1),n.getWorkspaceSingleton().render(),this.listenTo(this.component,"change:preview",this.changePreviewState),this.listenTo(this.component,"change:sufficient",this.changeSufficiency),this.listenTo(this.component,"change:componentPrettyName",this.displayVals),this.listenTo(this.component,"removed",this.remove),this.changePreviewState(),this.changeSufficiency()},s.prototype.displayVals=function(){this.setDisplayLabel(this.component.get("componentPrettyName"))},s.prototype.doubleclick=function(){this.component.getOutput().getTree().log()},s.prototype.changeSufficiency=function(){var t,e=this.component.get("sufficient");t=!0===e?"sufficient":"error"===e?"error":"insufficient";var n=this.getDisplayDiv();n.classList.remove("sufficient"),n.classList.remove("insufficient"),n.classList.remove("error"),n.classList.add(t)},s.prototype.changePreviewState=function(){var t=this.component.get("preview"),e=this.getDisplayDiv();e.classList.remove("previewOff"),!1===t&&e.classList.add("previewOff")},s.prototype.getDisplayDiv=function(){return this.cssObject.element.firstChild},s.prototype.setDisplayLabel=function(t){this.getDisplayDiv().textContent=t},s.prototype.createComponentWithNamePosition=function(t,e,i){var r=document.createElement("div");r.className="draggable";var o=document.createElement("div");o.className="componentLabel",o.textContent=t,r.appendChild(o),r.width="240px",r.height="80px";var a=new THREE.CSS3DObject(r);return a.position.x=e||0,a.position.y=i||0,a.position.z=0,n.getWorkspaceSingleton().scene.add(a),r.uuid=a.uuid,a},s.prototype.remove=function(){this.stopListening(),r.each(this.component.inputs,function(t){r.isEmpty(t.IOView)||t.IOView.remove()}),r.each(this.component.outputs,function(t){r.isEmpty(t.IOView)||t.IOView.remove()}),n.getWorkspaceSingleton().scene.remove(this.cssObject),n.getWorkspaceSingleton().glscene.remove(this.glObject),delete this.component.componentView,delete this.component,n.getWorkspaceSingleton().render()},s.prototype.processIOViews=function(t,n,o){var a=r.filter(t,function(t){return!0===t.get("invisible")}).length,s=60*(r.keys(t).length-1-a)/2,l=this.cssObject,u=o?i.InputView:i.OutputView,c=this.component.componentName;r.each(t,function(t,i){if(t.type!==e.OUTPUT_TYPES.NULL&&!0!==t.get("invisible")){var a=t.shortName,h=this._createIOWithNameAndParent(a,c,l,s-60*i,o,t.type),d=this;r.defer(function(){var e=d.createGLElementToMatch(h);n[a]=new u(t,e,h)})}},this)},s.prototype._createIOWithNameAndParent=function(t,e,n,i,r,o){var a=document.createElement("div");a.className="draggable IO "+e,a.textContent=t,n.element.appendChild(a);var s=new THREE.CSS3DObject(a);n.add(s);var l=150;try{l=parseInt(n.element.width.replace("px",""))/2+40}catch(t){console.warn("Could not parse 'width' attribute of the component's main CSS Element. This should be set both in code and in CSS, so that element size can be determined (and GL dopplegangers placed) without first rendering the element")}return s.position.z=0,s.position.y=i,s.position.x=r?-l:l,s.element.className+=r?" inputIO":" outputIO",s.addDraggableScopes([r?"input":"output",o]),s.addDroppableScopes([r?"output":"input",o]),s},s.prototype.createGLElementToMatch=function(t){var e=t.element.clientWidth,i=t.element.clientHeight;if(0===e||0===i)throw new Error("CSS Element Must be allowed to render before polling for its size.");var o=new THREE.Shape;o.moveTo(0,0),o.lineTo(0,i),o.lineTo(e,i),o.lineTo(e,0),o.lineTo(0,0);var a=new THREE.ShapeGeometry(o);a.applyMatrix((new THREE.Matrix4).makeTranslation(-e/2,-i/2,0));var s=new THREE.Mesh(a,new THREE.MeshBasicMaterial({color:16711680,wireframe:!0,transparent:!0,opacity:0}));s.position.set(t.position.x,t.position.y,0),t.element.uuid=t.uuid;return(r.isUndefined(this.glObject)?n.getWorkspaceSingleton().glscene:this.glObject).add(s),s},function(t){if(r.isUndefined(t)||r.isUndefined(t.recalculate)&&r.isUndefined(t.recalculateTrees))throw new Error("ComponentView objects must be instantiated with the DataFlow.Component which they represent");return"SliderComponent"===t.componentName?new function(t){var e=this;r.extend(this,s.prototype,{click:function(e,n){var i=t.getOutput("N").getFirstValueOrDefault(),r=t.getInput("S").getFirstValueOrDefault(),o=t.getInput("E").getFirstValueOrDefault(),a=t.getInput("I").getFirstValueOrDefault(),s=this.sliderUpdateValue;require(["dataFlow/UI/sliderView"],function(t){new t(i,r,o,a,e,n,s)})},sliderUpdateValue:function(n){t.storeUserData(n),e.displayVals()},displayVals:function(){r.isEmpty(this.component.getOutput("N").getTree().dataAtPath([0]))?this.setDisplayLabel(this.component.get("componentPrettyName")):this.setDisplayLabel(this.component.getOutput("N").getTree().dataAtPath([0]).toString())}}),r.bindAll(this,"click","sliderUpdateValue"),this.init(t)}(t):"BooleanToggleComponent"===t.componentName?(console.log("creating toggler"),new function(t){var e=this;r.extend(this,s.prototype,{doubleclick:function(t,n){var i=e.component.getInput("B").getTree();i.setDataAtPath(!i.dataAtPath([0])[0],[0])},displayVals:function(){r.isEmpty(this.component.getOutput("B").getTree().dataAtPath([0]))?this.setDisplayLabel(this.component.get("componentPrettyName")):this.setDisplayLabel(this.component.getOutput("B").getTree().dataAtPath([0]).toString())}}),this.init(t),this.listenTo(this.component.getOutput("B"),"change",this.displayVals)}(t)):"PrintComponent"===t.componentName?new function(t){var e=this,i=r.template("<div class='pathNodeTitle'>{<%= path %>}</div>"),o=r.template("<div class='dataRow'><%= text %></div>");r.extend(this,s.prototype,{displayVals:function(){var t="",n=[];e.component.getOutput("D").getTree().recurseTree(function(t,e){n.push(e),r.each(t,function(t){n.push(t)})}),Promise.all(n).then(function(n){r.each(n,function(e,n){"Node"===e.constructor.name?t+=i({path:e.getPath()}):(console.log(e),t+=o({text:e.text.replace(/\n/g,"<br />")}))}),e.printArea.innerHTML=t})},createComponentWithNamePosition:function(t,i,r){var o=document.createElement("div");o.className="draggable PrintComponent freezeZooming";var a=document.createElement("div");a.className="printComponentTextArea",e.printArea=a,o.appendChild(a),o.width="700px",o.height="320px";var s=new THREE.CSS3DObject(o);return s.position.x=i||0,s.position.y=r||0,s.position.z=0,n.getWorkspaceSingleton().scene.add(s),o.uuid=s.uuid,s}}),e.init(t),e.listenTo(e.component.getOutput("D"),"change",e.displayVals)}(t):"SpreadsheetComponent"===t.componentName?new function(t){var e=this;r.extend(this,s.prototype,{click:function(t,e){this.displayVals()},displayVals:function(){console.log("displayvals on spreadsheetcomponentview is called");var t=[];e.component.getOutput("D").getTree().recurseTree(function(e,n){t.push(n),r.each(e,function(e){t.push(e)})}),Promise.all(t).then(function(t){r.each(t,function(t,e){if("Node"!==t.constructor.name)return require(["dataFlow/UI/spreadsheetView"],function(e){new e(JSON.parse(t.text))}),void console.warn("TODO: MULTIPLE SPREADSHEETS SHOULD IDEALLY BE HANDLED")})})}}),e.init(t)}(t):"LinePlot"===t.componentName?new function(t){var e=this,i=r.template("<div class='pathNodeTitle'>{<%= path %>}</div>"),o=(r.template("<div class='dataRow'><%= text %></div>"),r.template("<div class='dataRow'><img src='data:image/png;base64,<%= pngdata %>' /></div>"));r.extend(this,s.prototype,{displayVals:function(){var t="",n=[];e.component.getOutput("D").getTree().recurseTree(function(t,e){n.push(e),r.each(t,function(t){n.push(t)})}),Promise.all(n).then(function(n){r.each(n,function(e,n){"Node"===e.constructor.name?t+=i({path:e.getPath()}):r.each(e,function(e){t+=o({pngdata:e})})}),e.printArea.innerHTML=t})},createComponentWithNamePosition:function(t,i,r){var o=document.createElement("div");o.className="draggable PrintComponent freezeZooming";var a=document.createElement("div");a.className="printComponentTextArea",e.printArea=a,o.appendChild(a),o.width="700px",o.height="320px";var s=new THREE.CSS3DObject(o);return s.position.x=i||0,s.position.y=r||0,s.position.z=0,n.getWorkspaceSingleton().scene.add(s),o.uuid=s.uuid,s}}),e.init(t),e.listenTo(e.component.outputs[0],"change",e.displayVals)}(t):new s(t)}}),define("dataFlow/project",["underscore","backbone","dataFlow/dataFlow_loader"],function(t,e,n){return e.Model.extend({defaults:function(){return{authorName:"anonymous",authorId:"",title:"",description:"",projectId:"",createdAt:new Date,updatedAt:new Date,components:[]}},initialize:function(e){t.bindAll(this,"destroy"),e&&e.components&&this.loadComponentsFromJSON(e.components)},addComponentToProject:function(t){var e=this.get("components");return e.push(t),this.listenTo(t,"removed",this.removeComponent),this.set("components",e),this.trigger("change",this),this},createComponent:function(t,e){var i,r=e||{x:0,y:0};return i=n.createComponentByName(t,{position:r}),this.addComponentToProject(i),this},removeComponent:function(e){this.stopListening(e);var n=t.without(this.get("components"),e);this.set("components",n),this.trigger("change",this)},destroy:function(){console.warn("DESTROY on project isn't really a good idea. I should just remove VIEW stuff, not DATA stuff.")},toJSON:function(){var e=t.clone(this.attributes);return e.components=t.map(e.components,function(t){return t.toJSON()}),e},loadComponentsFromJSON:function(e){var i={},r=[],o=[],a=this,s=0,l=function(t){var e=parseInt(t.replace("c",""));e>s&&(s=e)};for(t.each(e,function(e){l(e.id),e.output&&(e.outputs=e.output,delete e.output);var s=n.createComponentByName(e.componentName,t.clone(e));o.push(s),a.addComponentToProject.call(a,s),t.each(e.inputs,function(e){l(e.id),e.connections.length>0&&(i[e.id]=s[e.shortName],t.each(e.connections,function(t){!function(t){var n={};n[e.id]=t,r.push(n)}(t)}))}),t.each(s.outputs,function(t){i[t.id]=t})});parseInt(t.uniqueId("c").replace("c",""))<s;);t.each(r,function(n){var r=t.keys(n)[0],o=n[r],a=i[r],s=i[o];t.isUndefined(a.connectAdditionalOutput)||t.isUndefined(s)?(console.trace(),console.warn("COULD NOT MAKE CONNECTION!! INVESTIGATE THIS!",a,s),console.log(n),console.log(e)):a.connectAdditionalOutput(s)}),this.set("components",o)}})}),define("text!src/css/orchestra.css",[],function(){return'\na {\n    cursor: pointer;\n}\nbody {\n    margin: 0px;\n    overflow: hidden;\n}\ncanvas {\n    position:  absolute;\n    top: 0px;\n    left: 0px;\n    opacity: 0.9;\n}\n.TOP {\n    position: absolute;\n    z-index: 101;\n    /*background-color: rgba(255,255,255,0.2);*/\n    top: 0px;\n    left: 0px;\n}\n/*  TODO: These styles are needed for orchestra3d, but conflict in Jupyter-Orchestra (they make Jupyter\'s nav buttons appear above its dropdown menus, such as file, edit, etc.\n    These should be moved to a separate style sheet in orchestra, so that bootstrap conflicts can be avoided.\n */\n/*.navbar {*/\n    /*z-index: 102;*/\n    /*border-radius: 0px !important;*/\n/*}*/\n/*.navbar-project-title {*/\n    /*!*text-transform: capitalize;*!*/\n    /*float: left;*/\n    /*height: 50px;*/\n    /*padding: 15px 15px;*/\n    /*font-size: 17px;*/\n    /*line-height: 20px;*/\n    /*font-style: italic;*/\n/*}*/\n.titleChangerWidget {display: none;}\n#titleChanger {width: 400px;}\n\n/* Main Component Styling */\ndiv.componentLabel {\n    border: 1px solid black;\n    border-radius: 60px;\n    height: 80px;\n    width: 240px;\n    text-align: center;\n    font-size: 30px;\n    line-height: 80px;\n    text-transform: capitalize;\n    cursor: pointer;\n\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\n/* Print Component Styling */\ndiv.draggable.PrintComponent {\n    /*left: 240px;*/\n}\ndiv.draggable.PrintComponent.IO {\n    /*left: -240px;*/\n}\ndiv.printComponentTextArea {\n    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;\n    border: 1px solid black;\n    border-radius: 5px;\n    height: 320px;\n    width: 700px;\n    text-align: left;\n    font-size: 15px;\n    padding: 0;\n    line-height: 30px;\n    cursor: pointer;\n\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n\n    /*margin-left: 480px;*/\n    background-color: whitesmoke;\n    box-shadow: 9px 9px 19px 0px #444;\n    overflow-y: scroll;\n}\ndiv.printComponentTextArea div {\n    padding: 0 15px;\n}\n\n\n\ndiv.printComponentTextArea .pathNodeTitle {\n    background-color: #999;\n}\n\ndiv.printComponentTextArea div.dataRow  {\n    white-space: pre;\n}\ndiv.printComponentTextArea div.dataRow:nth-child(odd)  {\n    background-color: white;\n}\ndiv.printComponentTextArea div.dataRow:nth-child(even)  {\n    background-color: #dedede;\n}\n\n/*\nSupport for mixing status colors for separate properties: Preview, Sufficiency/Error, Selection\nhttps://css-tricks.com/tinted-images-multiple-backgrounds/\nPreview / Not = grey or white solid alpha image\nSufficiency / Error = clear, orange, or red transparent .TOP.workspaceOverlay\nSelection = Thick green border\n*/\n\ndiv.componentLabel.insufficient {background-color: #ffca3d;}\ndiv.componentLabel.sufficient {background-color: #e8e8e8;}\ndiv.componentLabel.error {background-color: orangered;}\n\n/*div.componentLabel.previewOff.insufficient {background-color: lightgray;}*/\ndiv.componentLabel.previewOff.sufficient {background-color:#999999;}\ndiv.componentLabel.previewOff.error {background-color:orangered}\n\ndiv.IO {\n    box-sizing: content-box;\n    position: absolute;\n    display: block;\n    background-color: #ff870c;\n    top: 0px;\n    left: 0px;\n    height: 50px;\n    width: 50px;\n    border-radius: 50px;\n\n    color: white;\n    font-size: 35px;\n    line-height: 50px;\n    text-align: center;\n    font-weight: bold;\n\n    -webkit-user-select: none;       \n    -moz-user-select: none; \n    -ms-user-select: none; \n    -o-user-select: none;\n    user-select: none;\n}\ndiv.IO:hover {\n    box-sizing: content-box;\n    border: 5px solid orange;\n    cursor: pointer;\n}\ndiv.IO.glHover {\n    background-color: red;\n}\n\n.glHover input {\n    border: 10px solid red;\n}\n.dragging {\n    pointer-events: none;\n}\n\n/* Help Tooltip / Popovers */\n.io_tooltip {\n    margin: -9px -14px;\n    list-style: none;\n    padding-left: 0;\n}\n.io_tooltip .io_description {\n    font-style: italic;\n    margin: 9px;\n    display: inline-block;\n    font-size: 17px;\n    font-weight: bold;\n}\n.io_tooltip .io_isRequired {\n    width: 80px;\n    display: inline-block;\n    margin: 0px 9px;\n    color: #999;\n    font-size: 11px;\n    vertical-align: middle;\n}\n.io_tooltip li {\n    max-width: 180px;\n    display: block;\n}\n.io_tooltip_field_title {\n    width: 80px;\n    line-height: 16px;\n    display: inline-block;\n    margin: 9px;\n    color: #999;\n    font-size: 11px;\n    vertical-align: middle;\n}\n.io_tooltip_field_value {\n    color: #333;\n    font-weight: bold;\n    font-size: 16px;\n    width: 60px;\n    text-align: left;\n    line-height: 16px;\n    vertical-align: middle;\n    display: inline-block;\n}\n.cmpt_tooltip_title_modulename {\n    font-weight: normal;\n    color: #999;\n    font-size: 10px;\n}\n.cmpt_error_line {\n    color: red;\n    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;\n    width: 600px;\n    font-size: 12px;\n}\n.cmpt_error_line .err_type {\n    width: 75px;\n    text-align: left;\n    font-weight: bold;\n}\n.cmpt_error_line .err_msg {\n    text-align: left;\n    width: 525px;\n}\n.cmpt_tooltip .cmpt_description {\n    font-weight: normal;\n    font-size: 20px;\n    margin-bottom: 10px;\n}\n.cmpt_tooltip .cmpt_io_container {\n\n}\n.cmpt_tooltip .cmpt_io_container .cmpt_io_title{\n    font-weight: bold;\n    color: #333;\n    margin-left: 50px;\n}\n.cmpt_tooltip .cmpt_io_container .cmpt_io{\n    margin-left: 70px;\n    display: block;\n}\n.cmpt_tooltip .cmpt_io_container .cmpt_io .cmpt_io_name {\n    font-weight: bold;\n    font-size: 12px;\n    vertical-align: top;\n}\n.cmpt_tooltip .cmpt_io_container .cmpt_io .cmpt_io_details {\n    color: #666;\n    font-size: 12px;\n    max-width: 250px;\n    display: inline-block;\n    margin-left: 8px;\n}\n.cmpt_tooltip  .cmpt_io_required_legend {\n    font-size: 11px;\n    color: #999;\n}\n\n\n\n\n/* Slider custom overrides. Can be copied to slider\'s CSS eventually */\n.slider {\n    z-index: 102; /* Make sure the tooltip comes above bootstrap nav items */\n    margin-left: -100px;\n    margin-top: -50px;\n}\n.slider .tooltip {\n    background-color: transparent;\n}\n.TOP.workspaceOverlay {\n    z-index: 101;\n    background-color: rgba(0,0,0,0.5);\n    width: 100%;\n    height: 100%;\n    border: none;\n}\n\n/* Context menu stuff */\n.context-menu {\n    position: absolute;\n    display: none;\n}\n.context-menu .dropdown-menu {\n    top: 0;\n    display: block;\n}\n.context-menu .icongutter {\n    width: 30px;\n    display: inline-block;\n}\n.context-menu input {\n    border-radius: 17px;\n    border: 1px solid lightgray;\n    padding-left: 23px;\n}\n.context-menu input:focus {\n    outline-width: 0;\n}\n.context-menu .comp_Name {\n    height: 40px;\n    vertical-align: middle;\n    line-height: 40px;\n    margin-left: 20px;\n    font-weight: bold;\n    font-style: italic;\n}\n\n/* Roaming component searchbar / typeahead */\n.mobileComponentSearchInput {\n    z-index: 102;\n    position: absolute;\n    display: block;\n    width: 310px;\n    line-height: 30px;\n    padding: 4px 19px;\n    border-radius: 10px;\n    outline: none;\n    border: 1px solid #CCC;\n    font-size: 20px;\n    font-weight: bold;\n}\n'}),define("app",["jquery","underscore","backbone","dataFlow/dataFlow_loader","dataFlow/UI/workspaceView","dataFlow/UI/componentView","dataFlow/project","dataFlow/components/engine","dataFlow/pulse","dataFlow/freezeCalculations","text!src/css/orchestra.css"],function(t,e,n,i,r,o,a,s,l,u,c){function h(t){t?this.setupEngine(t):console.error("Python Engine Not Initialized. All Python Functions will Error."),e.extend(this,n.Events),this.init()}t("head").append("<style type='text/css'>"+c+"</style");var d=0,f=[];return window.LOG_TIME_EVENT=function(t,e){var n=(new Date).getTime(),i={};i[t]=n-d,f.push(i),d=n,e&&(d=0,f=[])},h.prototype.init=function(){this.currentProject=null,e.bindAll(this,"newProject","clearWorkspace","loadJSON","initializePulses"),this.workspace=new r.Workspace,this.workspace.createWorkspace(),this.currentProject=new a;var t=this;this.workspace.on("createNewComponent",function(e){t.newComponent.call(t,e)})},h.prototype.newComponent=function(t){var e=this,n=t.position||this.workspace.getCurrentVisibleCenterPoint(),r=i.createComponentByName(t.functionName,{position:n});this.currentProject.addComponentToProject(r),r.on("requestFileExport",function(t){e.exporter.export(t)}),new o(r)},h.prototype.newProject=function(){this.clearWorkspace(),this.loadWorkspace(this.currentProject)},h.prototype.clearWorkspace=function(){u.setFrozen(!0),console.warn("DO SOME TESTS TO MAKE SURE THAT ZOMBIES DONT REMAIN"),this.stopListening(),e.isNull(this.currentProject)||e.each(this.currentProject.get("components").slice(0),function(t){t.componentView.remove()}),this.currentProject=new a,this.workspace.render()},h.prototype.getDisplayState=function(){return{workspace:this.workspace.toJSON()}},h.prototype.loadJSON=function(t){this.clearWorkspace();var e=this;require(["dataFlow/project"],function(n){e.loadWorkspace(new n(t))})},h.prototype.loadWorkspace=function(t){u.setFrozen(!0);var n=this;this.currentProject=t,this.listenTo(this.currentProject,"change",function(t){n.trigger("change",t.toJSON())}),e.each(t.get("components"),function(t){t.on("requestFileExport",function(t){n.exporter.export(t)}),new o(t)}),e.defer(function(){e.each(t.get("components"),function(t){e.each(t.inputs,function(t){var e=t.IOView;e&&e.drawAllConnections()})})}),t.get("contextData")&&this.workspace.fromJSON(t.get("contextData").workspace),this.initializePulses(t)},h.prototype.initializePulses=function(t){u.setFrozen(!1),e.each(t.get("components"),function(t){var n=0;if(e.each(t.inputs,function(t){0!==e.keys(t._listeningTo).length||t.getTree().isEmpty()?!0===t.get("invisible")&&n++:n++}),n===t.inputs.length){var i=t.inputs[0];i.trigger("pulse",new l({startPoint:i}))}})},h.prototype.setupEngine=function(t){console.warn("SETUP ENGINE NEEDS TO BE IMPLEMENTED NOW"),s.setup(t),s.resetTranscript()},h.prototype.getTranscript=function(){return s.getTranscript()},h.prototype.close=function(){console.warn("Orchestra.Close() not yet implemented. It needs to clean up and remove UI."),this.workspace.destroy(),this.trigger("closed",this.currentProject.toJSON()),this.off()},h}),require.config({baseUrl:"/nbextensions/orchestra-jupyter/",urlArgs:"bust="+(new Date).getTime(),shim:{backbone:{deps:["underscore","jquery"],exports:"Backbone"},"parse-lib":{deps:["jquery"],exports:"Parse"},underscore:{exports:"_"},jquery:{exports:"$"},bootstrap3:{deps:["jquery"]},"bootstrap-slider":{deps:["bootstrap"]},"bootstrap3-typeahead":{deps:["bootstrap"]},OrbitControls:{deps:["threejs"]},SVGRenderer:{deps:["threejs"]},Projector:{deps:["threejs"]},CSS3DRenderer:{deps:["threejs"]},threemin:{exports:"THREE"}},paths:{viewer:"src/viewer",threejs:"src/viewer/three.wrapper",threemin:"src/viewer/three.min",OrbitControls:"src/viewer/OrbitControls",SVGRenderer:"src/viewer/SVGRenderer",Projector:"src/viewer/Projector",navbar:"src/application/navbar",componentSearcher:"src/application/componentSearcher",jquery:"lib/jquery-2.1.1.min",backbone:"lib/backbone-min","parse-lib":"lib/parse-1.5.0.min",underscore:"lib/underscore-min",bootstrap3:"lib/bootstrap.min","bootstrap3-typeahead":"lib/bootstrap3-typeahead.min","bootstrap-slider":"lib/bootstrap-slider.min",Handsontable:"lib/handsontable.min",HandsontableWrapper:"lib/handsontable.wrapper",numbro:"lib/numbro",pikaday:"lib/pikaday",moment:"lib/moment",text:"lib/text",dataFlow:"src/dataFlow",CSS3DRenderer:"src/dataFlow/UI/CSS3DRenderer"}}),define("main",["base/js/namespace","./app","jquery","base/js/dialog"],function(t,e,n,i){function r(i){console.log("Opening Orchestra Visual Flow Programming"),console.warn("Disabling Jupyter Keyboard Shortcuts for Orchestra"),t.notebook.keyboard_manager.disable();var r=new e(t);r.loadJSON(i.metadata[a]),i.orchestra_application=r,r.on("change",function(t){i.metadata[a]=t}),r.on("closed",function(e){i.metadata[a]=e,console.warn("Enabling Jupyter Keyboard Shortcuts"),t.notebook.keyboard_manager.enable()});var s=n('<button class="btn btn-large closeOrchestraButton" style="z-index:500;position: absolute;top: 10px;left: 10px;">Return to Jupyter</button>');n("body").append(s),s.on("click",function(){var t=r.getTranscript();if("#"==t.charAt(0)){var e=t.split("\n");e.splice(1,0,o),t=e.join("\n")}i.code_mirror.setValue(t),r.close(),s.off(),s.hide(250,function(){s.remove()})})}var o="### This cell contains Orchestra Visual Flow Programming Project Data. \n### Output variables will be defined here for use lower in your notebook. \n### Please do not edit this cell's contents directly, as your changes may be overwritten.\n###\n### If You do not have the Orchestra VFP Extension Installed, please visit:\n### https://OrchestraMachineLearning.com/install-jupyter-extension/\n",a="orchestraData";return{load_ipython_extension:function(){var e={icon:"fa-cubes",help:"Orchestra Visual Flow Programming",help_index:"orchestra",handler:function(t){require(["HandsontableWrapper"]);var e=t.notebook.get_selected_cell();if("object"==typeof e.metadata[a])r(e);else{function n(){e.metadata[a]={},e.code_mirror.setValue(o),r(e)}i.modal({buttons:{OK:{class:"btn btn-primary btn-lg",click:n},Cancel:{class:"btn btn-lg",click:function(){}}},title:"Convert Cell?",body:"<span style='font-size:15px;'>This cell does not have any Orchestra data associated with it. Convert cell now?<br /><br />Cell contents will be overwritten!</span>",sanitize:!1})}}},n=t.notebook.keyboard_manager.actions.register(e,"run-orchestra-vfp","auto");t.toolbar.add_buttons_group([n])}}});