(function(){var t=this,e=t._,n={},i=Array.prototype,o=Object.prototype,r=Function.prototype,s=i.push,a=i.slice,l=i.concat,c=o.toString,h=o.hasOwnProperty,u=i.forEach,p=i.map,d=i.reduce,f=i.reduceRight,m=i.filter,b=i.every,g=i.some,y=i.indexOf,v=i.lastIndexOf,T=Array.isArray,w=Object.keys,_=r.bind,x=function(t){return t instanceof x?t:this instanceof x?void(this._wrapped=t):new x(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):t._=x,x.VERSION="1.6.0";var N=x.each=x.forEach=function(t,e,i){if(null==t)return t;if(u&&t.forEach===u)t.forEach(e,i);else if(t.length===+t.length){for(var o=0,r=t.length;r>o;o++)if(e.call(i,t[o],o,t)===n)return}else{var s=x.keys(t);for(o=0,r=s.length;r>o;o++)if(e.call(i,t[s[o]],s[o],t)===n)return}return t};x.map=x.collect=function(t,e,n){var i=[];return null==t?i:p&&t.map===p?t.map(e,n):(N(t,function(t,o,r){i.push(e.call(n,t,o,r))}),i)};var O="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return i&&(e=x.bind(e,i)),o?t.reduce(e,n):t.reduce(e);if(N(t,function(t,r,s){o?n=e.call(i,n,t,r,s):(n=t,o=!0)}),!o)throw new TypeError(O);return n},x.reduceRight=x.foldr=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return i&&(e=x.bind(e,i)),o?t.reduceRight(e,n):t.reduceRight(e);var r=t.length;if(r!==+r){var s=x.keys(t);r=s.length}if(N(t,function(a,l,c){l=s?s[--r]:--r,o?n=e.call(i,n,t[l],l,c):(n=t[l],o=!0)}),!o)throw new TypeError(O);return n},x.find=x.detect=function(t,e,n){var i;return E(t,function(t,o,r){return e.call(n,t,o,r)?(i=t,!0):void 0}),i},x.filter=x.select=function(t,e,n){var i=[];return null==t?i:m&&t.filter===m?t.filter(e,n):(N(t,function(t,o,r){e.call(n,t,o,r)&&i.push(t)}),i)},x.reject=function(t,e,n){return x.filter(t,function(t,i,o){return!e.call(n,t,i,o)},n)},x.every=x.all=function(t,e,i){e||(e=x.identity);var o=!0;return null==t?o:b&&t.every===b?t.every(e,i):(N(t,function(t,r,s){return(o=o&&e.call(i,t,r,s))?void 0:n}),!!o)};var E=x.some=x.any=function(t,e,i){e||(e=x.identity);var o=!1;return null==t?o:g&&t.some===g?t.some(e,i):(N(t,function(t,r,s){return o||(o=e.call(i,t,r,s))?n:void 0}),!!o)};x.contains=x.include=function(t,e){return null!=t&&(y&&t.indexOf===y?-1!=t.indexOf(e):E(t,function(t){return t===e}))},x.invoke=function(t,e){var n=a.call(arguments,2),i=x.isFunction(e);return x.map(t,function(t){return(i?e:t[e]).apply(t,n)})},x.pluck=function(t,e){return x.map(t,x.property(e))},x.where=function(t,e){return x.filter(t,x.matches(e))},x.findWhere=function(t,e){return x.find(t,x.matches(e))},x.max=function(t,e,n){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var i=-1/0,o=-1/0;return N(t,function(t,r,s){var a=e?e.call(n,t,r,s):t;a>o&&(i=t,o=a)}),i},x.min=function(t,e,n){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var i=1/0,o=1/0;return N(t,function(t,r,s){var a=e?e.call(n,t,r,s):t;o>a&&(i=t,o=a)}),i},x.shuffle=function(t){var e,n=0,i=[];return N(t,function(t){e=x.random(n++),i[n-1]=i[e],i[e]=t}),i},x.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=x.values(t)),t[x.random(t.length-1)]):x.shuffle(t).slice(0,Math.max(0,e))};var S=function(t){return null==t?x.identity:x.isFunction(t)?t:x.property(t)};x.sortBy=function(t,e,n){return e=S(e),x.pluck(x.map(t,function(t,i,o){return{value:t,index:i,criteria:e.call(n,t,i,o)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var P=function(t){return function(e,n,i){var o={};return n=S(n),N(e,function(r,s){var a=n.call(i,r,s,e);t(o,a,r)}),o}};x.groupBy=P(function(t,e,n){x.has(t,e)?t[e].push(n):t[e]=[n]}),x.indexBy=P(function(t,e,n){t[e]=n}),x.countBy=P(function(t,e){x.has(t,e)?t[e]++:t[e]=1}),x.sortedIndex=function(t,e,n,i){for(var o=(n=S(n)).call(i,e),r=0,s=t.length;s>r;){var a=r+s>>>1;n.call(i,t[a])<o?r=a+1:s=a}return r},x.toArray=function(t){return t?x.isArray(t)?a.call(t):t.length===+t.length?x.map(t,x.identity):x.values(t):[]},x.size=function(t){return null==t?0:t.length===+t.length?t.length:x.keys(t).length},x.first=x.head=x.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:a.call(t,0,e)},x.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},x.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},x.rest=x.tail=x.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},x.compact=function(t){return x.filter(t,x.identity)};var C=function(t,e,n){return e&&x.every(t,x.isArray)?l.apply(n,t):(N(t,function(t){x.isArray(t)||x.isArguments(t)?e?s.apply(n,t):C(t,e,n):n.push(t)}),n)};x.flatten=function(t,e){return C(t,e,[])},x.without=function(t){return x.difference(t,a.call(arguments,1))},x.partition=function(t,e){var n=[],i=[];return N(t,function(t){(e(t)?n:i).push(t)}),[n,i]},x.uniq=x.unique=function(t,e,n,i){x.isFunction(e)&&(i=n,n=e,e=!1);var o=n?x.map(t,n,i):t,r=[],s=[];return N(o,function(n,i){(e?i&&s[s.length-1]===n:x.contains(s,n))||(s.push(n),r.push(t[i]))}),r},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(t){var e=a.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(e,function(e){return x.contains(e,t)})})},x.difference=function(t){var e=l.apply(i,a.call(arguments,1));return x.filter(t,function(t){return!x.contains(e,t)})},x.zip=function(){for(var t=x.max(x.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=x.pluck(arguments,""+n);return e},x.object=function(t,e){if(null==t)return{};for(var n={},i=0,o=t.length;o>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},x.indexOf=function(t,e,n){if(null==t)return-1;var i=0,o=t.length;if(n){if("number"!=typeof n)return i=x.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,o+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;o>i;i++)if(t[i]===e)return i;return-1},x.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(v&&t.lastIndexOf===v)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var o=i?n:t.length;o--;)if(t[o]===e)return o;return-1},x.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=0,r=new Array(i);i>o;)r[o++]=t,t+=n;return r};var I=function(){};x.bind=function(t,e){var n,i;if(_&&t.bind===_)return _.apply(t,a.call(arguments,1));if(!x.isFunction(t))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));I.prototype=t.prototype;var o=new I;I.prototype=null;var r=t.apply(o,n.concat(a.call(arguments)));return Object(r)===r?r:o}},x.partial=function(t){var e=a.call(arguments,1);return function(){for(var n=0,i=e.slice(),o=0,r=i.length;r>o;o++)i[o]===x&&(i[o]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},x.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return N(e,function(e){t[e]=x.bind(t[e],t)}),t},x.memoize=function(t,e){var n={};return e||(e=x.identity),function(){var i=e.apply(this,arguments);return x.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},x.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},x.defer=function(t){return x.delay.apply(x,[t,1].concat(a.call(arguments,1)))},x.throttle=function(t,e,n){var i,o,r,s=null,a=0;n||(n={});var l=function(){a=!1===n.leading?0:x.now(),s=null,r=t.apply(i,o),i=o=null};return function(){var c=x.now();a||!1!==n.leading||(a=c);var h=e-(c-a);return i=this,o=arguments,0>=h?(clearTimeout(s),s=null,a=c,r=t.apply(i,o),i=o=null):s||!1===n.trailing||(s=setTimeout(l,h)),r}},x.debounce=function(t,e,n){var i,o,r,s,a,l=function(){var c=x.now()-s;e>c?i=setTimeout(l,e-c):(i=null,n||(a=t.apply(r,o),r=o=null))};return function(){r=this,o=arguments,s=x.now();var c=n&&!i;return i||(i=setTimeout(l,e)),c&&(a=t.apply(r,o),r=o=null),a}},x.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},x.wrap=function(t,e){return x.partial(e,t)},x.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},x.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},x.keys=function(t){if(!x.isObject(t))return[];if(w)return w(t);var e=[];for(var n in t)x.has(t,n)&&e.push(n);return e},x.values=function(t){for(var e=x.keys(t),n=e.length,i=new Array(n),o=0;n>o;o++)i[o]=t[e[o]];return i},x.pairs=function(t){for(var e=x.keys(t),n=e.length,i=new Array(n),o=0;n>o;o++)i[o]=[e[o],t[e[o]]];return i},x.invert=function(t){for(var e={},n=x.keys(t),i=0,o=n.length;o>i;i++)e[t[n[i]]]=n[i];return e},x.functions=x.methods=function(t){var e=[];for(var n in t)x.isFunction(t[n])&&e.push(n);return e.sort()},x.extend=function(t){return N(a.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},x.pick=function(t){var e={},n=l.apply(i,a.call(arguments,1));return N(n,function(n){n in t&&(e[n]=t[n])}),e},x.omit=function(t){var e={},n=l.apply(i,a.call(arguments,1));for(var o in t)x.contains(n,o)||(e[o]=t[o]);return e},x.defaults=function(t){return N(a.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,e){return e(t),t};var U=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof x&&(t=t._wrapped),e instanceof x&&(e=e._wrapped);var o=c.call(t);if(o!=c.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=n.length;r--;)if(n[r]==t)return i[r]==e;var s=t.constructor,a=e.constructor;if(s!==a&&!(x.isFunction(s)&&s instanceof s&&x.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;n.push(t),i.push(e);var l=0,h=!0;if("[object Array]"==o){if(l=t.length,h=l==e.length)for(;l--&&(h=U(t[l],e[l],n,i)););}else{for(var u in t)if(x.has(t,u)&&(l++,!(h=x.has(e,u)&&U(t[u],e[u],n,i))))break;if(h){for(u in e)if(x.has(e,u)&&!l--)break;h=!l}}return n.pop(),i.pop(),h};x.isEqual=function(t,e){return U(t,e,[],[])},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var e in t)if(x.has(t,e))return!1;return!0},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=T||function(t){return"[object Array]"==c.call(t)},x.isObject=function(t){return t===Object(t)},N(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(t){return!(!t||!x.has(t,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(t){return"function"==typeof t}),x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!=+t},x.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==c.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,e){return h.call(t,e)},x.noConflict=function(){return t._=e,this},x.identity=function(t){return t},x.constant=function(t){return function(){return t}},x.property=function(t){return function(e){return e[t]}},x.matches=function(t){return function(e){if(e===t)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0}},x.times=function(t,e,n){for(var i=Array(Math.max(0,t)),o=0;t>o;o++)i[o]=e.call(n,o);return i},x.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},x.now=Date.now||function(){return(new Date).getTime()};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};A.unescape=x.invert(A.escape);var R={escape:new RegExp("["+x.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(A.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(e){return null==e?"":(""+e).replace(R[t],function(e){return A[t][e]})}}),x.result=function(t,e){if(null!=t){var n=t[e];return x.isFunction(n)?n.call(t):n}},x.mixin=function(t){N(x.functions(t),function(e){var n=x[e]=t[e];x.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),L.call(this,n.apply(x,t))}})};var k=0;x.uniqueId=function(t){var e=++k+"";return t?t+e:e},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(t,e,n){var i;n=x.defaults({},n,x.templateSettings);var o=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g"),r=0,s="__p+='";t.replace(o,function(e,n,i,o,a){return s+=t.slice(r,a).replace(j,function(t){return"\\"+M[t]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),r=a+e.length,e}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(n.variable||"obj","_",s)}catch(t){throw t.source=s,t}if(e)return i(e,x);var a=function(t){return i.call(this,t,x)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},x.chain=function(t){return x(t).chain()};var L=function(t){return this._chain?x(t).chain():t};x.mixin(x),N(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];x.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],L.call(this,n)}}),N(["concat","join","slice"],function(t){var e=i[t];x.prototype[t]=function(){return L.call(this,e.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}).call(this),function(t,e){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,o){t.Backbone=e(t,o,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,n,i){var o=t.Backbone,r=[],s=r.slice;e.VERSION="1.1.2",e.$=i,e.noConflict=function(){return t.Backbone=o,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(t,e,n){if(!c(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});return(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,i){if(!c(this,"once",t,[e,i])||!e)return this;var o=this,r=n.once(function(){o.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,i)},off:function(t,e,i){var o,r,s,a,l,h,u,p;if(!this._events||!c(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(l=0,h=(a=t?[t]:n.keys(this._events)).length;l<h;l++)if(t=a[l],s=this._events[t]){if(this._events[t]=o=[],e||i)for(u=0,p=s.length;u<p;u++)r=s[u],(e&&e!==r.callback&&e!==r.callback._callback||i&&i!==r.context)&&o.push(r);o.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!c(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&h(n,e),i&&h(i,arguments),this},stopListening:function(t,e,i){var o=this._listeningTo;if(!o)return this;var r=!e&&!i;i||"object"!=typeof e||(i=this),t&&((o={})[t._listenId]=t);for(var s in o)(t=o[s]).off(e,i,this),(r||n.isEmpty(t._events))&&delete this._listeningTo[s];return this}},l=/\s+/,c=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)t[e].apply(t,[o,n[o]].concat(i));return!1}if(l.test(n)){for(var r=n.split(l),s=0,a=r.length;s<a;s++)t[e].apply(t,[r[s]].concat(i));return!1}return!0},h=function(t,e){var n,i=-1,o=t.length,r=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++i<o;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=t[i]).callback.call(n.ctx,r);return;case 2:for(;++i<o;)(n=t[i]).callback.call(n.ctx,r,s);return;case 3:for(;++i<o;)(n=t[i]).callback.call(n.ctx,r,s,a);return;default:for(;++i<o;)(n=t[i]).callback.apply(n.ctx,e);return}};n.each({listenTo:"on",listenToOnce:"once"},function(t,e){a[e]=function(e,i,o){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=n.uniqueId("l"))]=e,o||"object"!=typeof i||(o=this),e[t](i,o,this),this}}),a.bind=a.on,a.unbind=a.off,n.extend(e,a);var u=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(u.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var o,r,s,a,l,c,h,u;if(null==t)return this;if("object"==typeof t?(r=t,i=e):(r={})[t]=e,i||(i={}),!this._validate(r,i))return!1;s=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),u=this.attributes,h=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(o in r)e=r[o],n.isEqual(u[o],e)||a.push(o),n.isEqual(h[o],e)?delete this.changed[o]:this.changed[o]=e,s?delete u[o]:u[o]=e;if(!l){a.length&&(this._pending=i);for(var p=0,d=a.length;p<d;p++)this.trigger("change:"+a[p],this,u[a[p]],i)}if(c)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e,i=!1,o=this._changing?this._previousAttributes:this.attributes;for(var r in t)n.isEqual(o[r],e=t[r])||((i||(i={}))[r]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){void 0===(t=t?n.clone(t):{}).parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){if(!e.set(e.parse(n,t),t))return!1;i&&i(e,n,t),e.trigger("sync",e,n,t)},A(this,t),this.sync("read",this,t)},save:function(t,e,i){var o,r,s,a=this.attributes;if(null==t||"object"==typeof t?(o=t,i=e):(o={})[t]=e,i=n.extend({validate:!0},i),o&&!i.wait){if(!this.set(o,i))return!1}else if(!this._validate(o,i))return!1;o&&i.wait&&(this.attributes=n.extend({},a,o)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(t){l.attributes=a;var e=l.parse(t,i);if(i.wait&&(e=n.extend(o||{},e)),n.isObject(e)&&!l.set(e,i))return!1;c&&c(l,t,i),l.trigger("sync",l,t,i)},A(this,i),"patch"===(r=this.isNew()?"create":i.patch?"patch":"update")&&(i.attrs=o),s=this.sync(r,this,i),o&&i.wait&&(this.attributes=a),s},destroy:function(t){var e=this,i=(t=t?n.clone(t):{}).success,o=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&o(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;A(this,t);var r=this.sync("delete",this,t);return t.wait||o(),r},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||U();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1)}});n.each(["keys","values","pairs","invert","pick","omit"],function(t){u.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}});var p=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},d={add:!0,remove:!0,merge:!0},f={add:!0,remove:!1};n.extend(p.prototype,a,{model:u,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,f))},remove:function(t,e){var i=!n.isArray(t);t=i?[t]:n.clone(t),e||(e={});var o,r,s,a;for(o=0,r=t.length;o<r;o++)(a=t[o]=this.get(t[o]))&&(delete this._byId[a.id],delete this._byId[a.cid],s=this.indexOf(a),this.models.splice(s,1),this.length--,e.silent||(e.index=s,a.trigger("remove",a,this,e)),this._removeReference(a,e));return i?t[0]:t},set:function(t,e){(e=n.defaults({},e,d)).parse&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?t?[t]:[]:n.clone(t);var o,r,s,a,l,c,h,p=e.at,f=this.model,m=this.comparator&&null==p&&!1!==e.sort,b=n.isString(this.comparator)?this.comparator:null,g=[],y=[],v={},T=e.add,w=e.merge,_=e.remove,x=!(m||!T||!_)&&[];for(o=0,r=t.length;o<r;o++){if(l=t[o]||{},s=l instanceof u?a=l:l[f.prototype.idAttribute||"id"],c=this.get(s))_&&(v[c.cid]=!0),w&&(l=l===a?a.attributes:l,e.parse&&(l=c.parse(l,e)),c.set(l,e),m&&!h&&c.hasChanged(b)&&(h=!0)),t[o]=c;else if(T){if(!(a=t[o]=this._prepareModel(l,e)))continue;g.push(a),this._addReference(a,e)}a=c||a,!x||!a.isNew()&&v[a.id]||x.push(a),v[a.id]=!0}if(_){for(o=0,r=this.length;o<r;++o)v[(a=this.models[o]).cid]||y.push(a);y.length&&this.remove(y,e)}if(g.length||x&&x.length)if(m&&(h=!0),this.length+=g.length,null!=p)for(o=0,r=g.length;o<r;o++)this.models.splice(p+o,0,g[o]);else{x&&(this.models.length=0);var N=x||g;for(o=0,r=N.length;o<r;o++)this.models.push(N[o])}if(h&&this.sort({silent:!0}),!e.silent){for(o=0,r=g.length;o<r;o++)(a=g[o]).trigger("add",a,this,e);(h||x&&x.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,o=this.models.length;i<o;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){void 0===(t=t?n.clone(t):{}).parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var o=t.reset?"reset":"set";i[o](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},A(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,o=e.success;return e.success=function(t,n){e.wait&&i.add(t,e),o&&o(t,n,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof u)return t;(e=e?n.clone(e):{}).collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});n.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"],function(t){p.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}});n.each(["groupBy","countBy","sortBy","indexBy"],function(t){p.prototype[t]=function(e,i){var o=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,o,i)}});var m=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,g)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,g=["model","collection","el","id","attributes","className","tagName","events"];n.extend(m.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==n&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var o=e.match(b),r=o[1],s=o[2];i=n.bind(i,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,i):this.$el.on(r,s,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t.class=n.result(this,"className"));var i=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,o){var r=v[t];n.defaults(o||(o={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=n.result(i,"url")||U()),null!=o.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||i.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",r),a)return a.apply(this,arguments)}}"GET"===s.type||o.emulateJSON||(s.processData=!1),"PATCH"===s.type&&y&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=o.xhr=e.ajax(n.extend(s,o));return i.trigger("request",i,l,o),l};var y=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),v={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var T=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},w=/\((.*?)\)/g,_=/(\(\?)?:\w+/g,x=/\*\w+/g,N=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(T.prototype,a,{initialize:function(){},route:function(t,i,o){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(o=i,i=""),o||(o=this[i]);var r=this;return e.history.route(t,function(n){var s=r._extractParameters(t,n);r.execute(o,s),r.trigger.apply(r,["route:"+i].concat(s)),r.trigger("route",i,s),e.history.trigger("route",r,i,s)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(N,"\\$&").replace(w,"(?:$1)?").replace(_,function(t,e){return e?t:"([^/?]+)"}).replace(x,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var O=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,S=/^\/+|\/+$/g,P=/msie [\w.]+/,C=/\/$/,I=/#.*$/;O.started=!1,n.extend(O.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(C,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(E,"")},start:function(t){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),o=document.documentMode,r=P.exec(navigator.userAgent.toLowerCase())&&(!o||o<=7);if(this.root=("/"+this.root+"/").replace(S,"/"),r&&this._wantsHashChange){var s=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),O.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(t,e){if(!O.started)return!1;e&&!0!==e||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(I,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new O;u.extend=p.extend=T.extend=m.extend=O.extend=function(t,e){var i,o=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},n.extend(i,o,e);var r=function(){this.constructor=i};return r.prototype=o.prototype,i.prototype=new r,t&&n.extend(i.prototype,t),i.__super__=o.prototype,i};var U=function(){throw new Error('A "url" property or function must be specified')},A=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}};return e}),define("dataFlow/dataTree",["underscore"],function(t){function e(e){this.init(),delete this.pathId,delete this.data,t.isUndefined(e)||this.addChildAtPath(e,[0]),t.bindAll(this,"dataAtPath","setDataAtPath","recurseTree","flattenedTree","graftedTree","remappedTree")}function n(t,e){this.init(t,e)}return e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.objectType="DataTree",e.prototype.recurseTree=function(e){if("function"!=typeof e)throw new Error("recurseTree must be called with an iterator: function(data[,node])");!function n(i){t.isEmpty(i.data)||e(i.data,i);var o=t.keys(i.children);o.length>0&&t.each(o,function(t){n(i.children[t])})}(this)},e.prototype.fromJSON=function(e){var n=this;t.each(e,function(e,i){var o=t.map(i.split(";"),function(t){return Number(t)});n.setDataAtPath(e,o)})},e.prototype.toJSON=function(){var t={};return this.recurseTree(function(e,n){var i=n.getPath().join(";");t[i]=e}),t},e.prototype.flattenedTree=function(n){var i=[];if(this.recurseTree(function(e){t.each(e,function(t){i.push(t)})}),!n)return new e(i);this.data=i},e.prototype.dataAtPath=function(t,e){try{for(var n=t.slice(),i=this;n.length>0;)i=i.children[n.shift()];return!0===e?i.getFilteredData():i.data}catch(t){return[]}},e.prototype.copy=function(){return this.map()},e.prototype.map=function(n){var i=new e;return this.recurseTree(function(e,o){if("function"==typeof n){var r=t.map(e,function(t){return n(t)});r.length>0&&t.isArray(r[0])?t.each(r,function(t,e){var n=o.getPath();n.push(e),i.addChildAtPath(t,n,!0)}):i.addChildAtPath(r,o.getPath(),!0)}else i.addChildAtPath(e,o.getPath(),!0)}),i},e.prototype.setDataAtPath=function(t,e){return this.addChildAtPath(t,e,!0)},e.prototype.log=function(){var t=!0;this.recurseTree(function(e,n){t=!1,console.log("Path: ",n.getPath(),"      Data: ",e)}),t&&console.log("(Tree has no data)")},e.prototype.getMaxPathLength=function(){var e=1;return function n(i){var o=t.keys(i.children);o.length>0?t.each(o,function(t){n(i.children[t])}):e=Math.max(e,i.getPath().length)}(this),e},e.prototype.isEmpty=function(){var e=!0;return this.recurseTree(function(n){t.isEmpty(n)||(e=!1)}),e},e.prototype.graftedTree=function(){var n=new e;return this.recurseTree(function(e,i){var o=i.getPath().slice();t.each(e,function(t,e){var i=o.slice();i.push(e),n.addChildAtPath([t],i)})}),n},e.prototype.remappedTree=function(n,i){function o(t){return t.match(/(^.*\})/)[0].replace(/[^A-Za-z]/g," ").trim().split(" ")}function r(t){return t.match(/(\(.*$)/)[0].replace(/[^A-Za-z]/g," ").trim().split(" ")[0]}-1===n.indexOf("(")&&(n+="(i)"),-1===i.indexOf("(")&&(i+="(i)");var s=o(n),a=o(i),l=r(n),c=r(i),h=l!==c,u=t.map(s,function(e){var n=t.indexOf(s,e);return t.indexOf(a,e)-n}).slice(),p=new e;return h?(s.push(l),a.push(c),this.recurseTree(function(e,n){var i=n.getPath();t.each(n.data,function(e,n){var o=i.slice();o.push(n);var r={};t.each(s,function(t,e){r[t]=o[e]});var l=[];t.each(a,function(t,e){l[e]=r[t]});var c=l.pop();p.addSingleDataItemAtPathAndIndex(e,l,c)})})):this.recurseTree(function(t,e){for(var n=e.getPath().slice(),i=[],o=0;o<n.length;o++)i[o]=n[o+u[o]];p.addChildAtPath(e.data,i)}),p},n.prototype.init=function(e,n){var i=!t.isUndefined(e),o=t.isArray(e);if(i&&!o)throw new Error("Tried to assign a non-array to a Node in a Data Tree");i||(e=[]),this.data=e,this.children={},this.parent=n},n.prototype.objectType="Node",n.prototype.isRoot=function(){return t.isUndefined(this.parent)},n.prototype.addChildAtPath=function(e,i,o){if(!t.isArray(i))throw new Error("must pass pathArray to addChildAtPath");var r=i.slice();t.each(r,function(t){if(parseInt(t)!==t)throw new Error("Encountered non-integer array path: "+t)});return function t(i,r){var s=r.shift(),a=i.children[s]||new n([],i);return i.children[s]=a,a.pathId=s,r.length>0?t(a,r):(a.data=!0===o?e:a.data.concat(e),a)}(this,r)},n.prototype.addSingleDataItemAtPathAndIndex=function(t,e,n){var i=this.addChildAtPath([],e);return i.data[parseInt(n)]=t,i},n.prototype.getChildAtPath=function(e){var n=e.slice(0);return n.reverse(),function e(i){var o=n.pop();return t.isUndefined(o)?i:e(i.children[o])}(this)},n.prototype.getPathForChildNode=function(e){var n=this;t.each(t.keys(this.children),function(t){if(n.children[t]===e)return t})},n.prototype.getPath=function(){var e=[];return function n(i){t.isUndefined(i.pathId)||e.push(i.pathId),i.isRoot()||n(i.parent)}(this),e.reverse()},n.prototype.getFilteredData=function(){return t.filter(this.data,function(e){return!t.isNaN(e)&&!t.isNull(e)&&!t.isUndefined(e)})},e}),define("dataFlow/enums",[],function(){return{INTERPRET_AS:{ITEM:0,LIST:1,TREE:2},OUTPUT_TYPES:{NUMBER:0,BOOLEAN:1,NUMPY_ARR:2,STRING:3,DATAFRAME:4,WILD:5,NULL:6,UNUSED1:7,ARRAY:8},KEYS:{SHIFT:16},DISPLAY_NAMES:{INTERPRET_AS:{0:"Item",1:"List",2:"Tree"},OUTPUT_TYPES:{0:"Number",1:"Boolean",2:"Numpy Array",3:"String",4:"Pandas Dataframe",5:"(Any Data Type)",6:"Null",7:"Unused",8:"List / Array"}}}}),define("dataFlow/pulse",["underscore","backbone","dataFlow/enums"],function(t,e,n){return e.Model.extend({defaults:function(){return{pathsOpened:0,pathsClosed:0,state:"GRAPH_DISCOVERY",componentPulseCounts:{}}},shouldPropagate:function(e){return!t.contains(t.keys(this.get("componentPulseCounts")),e.cid)},updatePathCounts:function(t){var e=!1,n=this.get("componentPulseCounts");if("GRAPH_DISCOVERY"==this.get("state")){if(this.set("pathsClosed",this.get("pathsClosed")+1),(e=this.shouldPropagate(t))?(this.setOpenPathCountBasedOnComponentOutputs(t),n[t.cid]=1):n[t.cid]=n[t.cid]+1,this.get("pathsClosed")===this.get("pathsOpened")){this.set("state","RECALCULATION");var i=this.get("startPoint");"function"==typeof i.processIncomingChange?i.processIncomingChange(this):i.trigger("pulse",this)}}else"RECALCULATION"==this.get("state")&&(n[t.cid]=n[t.cid]-1,0===n[t.cid]&&(e=!0));return e},setOpenPathCountBasedOnComponentOutputs:function(e){var n=0;t.each(e.outputs,function(e){"object"==typeof e._events&&t.isArray(e._events.pulse)&&(n+=e._events.pulse.length)}),this.set("pathsOpened",this.get("pathsOpened")+n)},cancel:function(){this.set("state","CANCELLED")},initialize:function(e){if(t.bindAll(this,"cancel","updatePathCounts","shouldPropagate","setOpenPathCountBasedOnComponentOutputs"),!e||!e.startPoint)throw new Error("Pulse must be initialized with a starting Input, Output, or Component");"Input"===e.startPoint.modelType&&this.set("pathsOpened",1)}})}),define("dataFlow/core_IOModels",["underscore","backbone","dataFlow/dataTree","dataFlow/enums","dataFlow/pulse"],function(t,e,n,i,o){var r=e.Model.extend({defaults:function(){return{persistedData:new n,invisible:!1}},initialize:function(e){var o=t.extend(e||{},{});if(t.isUndefined(o.type))throw new Error("No type specified for Output");if(!t.has(t.values(i.OUTPUT_TYPES),o.type))throw new Error("Invalid Output Type Specified: "+o.type);if(t.isUndefined(o.shortName))throw new Error("No shortName specified for Output");this.required=!!t.isUndefined(o.required)||o.required,this.type=o.type,this.default=t.isUndefined(o.default)?null:o.default,this.containsNewData=!!t.isUndefined(o.containsNewData),this.shortName=o.shortName,this.values=new n([]),this.desc=o.desc,t.isUndefined(o.invisible)||this.set({invisible:o.invisible});var r=i.INTERPRET_AS.ITEM;if(t.isUndefined(o.interpretAs)||(t.has(t.keys(i.INTERPRET_AS),o.interpretAs)?r=o.interpretAs:console.warn("Invalid list interpretation type passed to an input. Using default ITEM interpretation. See ENUMS.INTERPRET_AS")),this.interpretAs=r,this.isMaster=o.isMaster,!t.isUndefined(o.persistedData)){var s=new n;s.fromJSON(o.persistedData),this.assignPersistedData(s)}"function"==typeof this._initialize&&this._initialize()},replaceData:function(t){if("DataTree"!==t.objectType)throw new Error("Attempt to replace Data Tree with something that's not a Data Tree.");this.clearValues(),this.values=t},assignPersistedData:function(t){throw new Error("Cannot call assignPersistedData() on base io class")},getTree:function(){if(this.hasConnectedOutputs())return this.applyTreeTransform(this.values);if(t.isUndefined(this.get("persistedData"))||this.get("persistedData").isEmpty()){if(t.isNull(this.default))return new n;var e=new n;return e.setDataAtPath([this.default],[0]),e}return this.applyTreeTransform(this.get("persistedData"))},applyTreeTransform:function(t){return t.copy()},getDefaultValue:function(){return console.warn("getDefaultValue() is deprecated. Use getTree() instead, but assume that the default value will appear inside a data tree."),this.default},getFirstValueOrDefault:function(){return this.getTree().dataAtPath([0])[0]},clearValues:function(){"Output"===this.modelType&&!0===this.containsNewData&&this.values.recurseTree(function(e,n){t.each(e,function(e){t.isEmpty(e)||"function"!=typeof e.destroy?t.isEmpty(e)||t.isNumber(e)||t.isArray(e)||console.warn("Can't destroy object type: "+typeof e+" / constructor: "+e.constructor.name):e.destroy()}),n.data=[]}),this.values=new n},_destroy:function(){this.disconnectAll(),this.stopListening()},toJSON:function(){var e={shortName:this.shortName,desc:this.desc,default:this.default,required:this.required,interpretAs:this.interpretAs,id:this.id||this.cid,connections:t.map(this._listeningTo,function(t){return t.id||t.cid}),type:this.type};return t.isUndefined(this.get("persistedData"))||this.get("persistedData").isEmpty()||(e.persistedData=this.get("persistedData").toJSON()),e}}),s=r.extend({modelType:"Input",validateOutput:function(t){var e=i.OUTPUT_TYPES.WILD;if(this.type!==t.type&&this.type!==e&&t.type!==e)throw new Error("Incongruent output connected to an input");return!0},connectOutput:function(t){this.disconnectAll(!0);try{this.connectAdditionalOutput(t,!1)}catch(t){this.trigger("pulse",new o({startPoint:this})),console.warn("Caught an error during connection: ",t.message,t.stack)}},disconnectOutput:function(t,e){this.stopListening(t),this.trigger("disconnectedOutput",t),!0!==e&&this.trigger("pulse",new o({startPoint:this}))},disconnectAll:function(e){var n=this;t.each(t.clone(this._listeningTo),function(t){n.disconnectOutput.call(n,t,!0)}),!0!==e&&(this.trigger("pulse",new o({startPoint:this})),this.trigger("disconnectAll",this))},processIncomingChange:function(e){var n=!1,i=e||new o({startPoint:this}),r=this;"RECALCULATION"===i.get("state")&&t.each(this._listeningTo,function(t){!1===n?(r.values=t.getTree().copy(),n=!0):t.getTree().recurseTree(function(t,e){var n=e.getPath(),i=r.values.dataAtPath(n).concat(t);r.values.setDataAtPath(i,n)})}),this.trigger("pulse",i)},connectAdditionalOutput:function(e,n){!1!==n&&this.validateOutput(e);var i=this;t.each(this._listeningTo,function(t){e===t&&i.disconnectOutput.call(i,t)}),this.listenTo(e,"pulse",function(t){i.processIncomingChange.call(i,t)}),this.listenTo(e,"disconnectAll",function(t){i.disconnectOutput.call(i,t)}),this.trigger("connectedOutput",e),this.processIncomingChange()},assignPersistedData:function(e){var i=e;t.isArray(e)&&(i=new n).setDataAtPath(e,[0]),this.set("persistedData",i),this.trigger("pulse",new o({startPoint:this}))},hasConnectedOutputs:function(){return!(0===t.keys(this._listeningTo).length)},destroy:function(){this._destroy()}});return{Output:r.extend({_initialize:function(){},modelType:"Output",destroy:function(){this.clearValues(),this._destroy()},disconnectAll:function(){this.trigger("disconnectAll",this)},assignPersistedData:function(t){this.set("persistedData",t),this.trigger("pulse",new o({startPoint:this}))},hasConnectedOutputs:function(){return!0}}),Input:s}}),define("dataFlow/dataMatcher",["underscore","dataFlow/dataTree","dataFlow/enums"],function(t,e,n){function i(i,r,s,a,l){var c=new e,h=t.isObject(a)?t.keys(a):void 0,u=!1,p=[],d=t.indexOf(i,r);t.each(i,function(t){p.push(function(t){var e=[],i=t.getTree().copy();return t.interpretAs===n.INTERPRET_AS.LIST&&(t.isMaster&&(u=!0),t.getTree().recurseTree(function(t,e){i.setDataAtPath([t],e.getPath())})),i.recurseTree(function(t,n){e.push(n)}),e}(t))}),p=o(p);for(var f=[],m=!1,b=0;b<p[0].length;b++){var g,y,v=[];!0===m||t.isEqual(p[d][b].getPath(),f)?(f=y=function(t){var e=t.slice(0);return e[e.length-1]=e[e.length-1]+1,e}(f),m=!0):f=y=p[d][b].getPath();for(var T=0;T<p.length;T++)v.push(p[T][b].data);v=o(v);try{g=function(e,n){for(var i=[],o=0;o<e[0].length;o++){var r=t.map(e,function(t){return t[o]});i[o]=n.apply(this,r)}return i}(v,s)}catch(t){g=null,l.push(t.stack)}c.setDataAtPath(g,y)}return u&&a[h[0]].interpretAs!==n.INTERPRET_AS.LIST&&c.copy().recurseTree(function(t,e){c.setDataAtPath(t[0],e.getPath())}),t.each(a,function(t,e){t.replaceData(c.map(function(t){return t[e]}))}),c}function o(e){var n=[],i=t.max(t.map(e,function(t){return t.length}));return t.each(e,function(t){for(var e=[],o=0;o<i;)o<t.length?e[o]=t[o]:e[o]=e[o-1],o++;n.push(e)}),n}return function(e,o,r){if(!t.isFunction(o))throw new Error("DataMatcher requires a calculation function");if(!t.isArray(e))throw new Error("DataMatcher expects an array of inputs");if(!t.isArray(r))throw new Error("'outputs' parameter for dataMatcher must be an array of outputs corresponding to each result generated by .recalculate()");var s={};t.each(r,function(t){s[t.shortName]=t});var a=[],l=function(e){var i;if(t.each(e,function(t){!0===t.isMaster&&(i=t)}),i)return i;var o=t.map(e,function(e){return t.isNull(e.getTree())?1:e.getTree().getMaxPathLength()}),r=t.max(o),s=[];if(t.each(o,function(t,n){t===r&&s.push(e[n])}),1===s.length)return s[0];var a=t.filter(s,function(t){return t.interpretAs===n.INTERPRET_AS.ITEM});if(1===a.length)return a[0];if(0===a.length){var l=t.filter(s,function(t){return t.interpretAs===n.INTERPRET_AS.LIST});return 0===l.length?s[0]:(l.length,l[0])}return a[0]}(e);return{errors:a,tree:i(e,l,o,s,a),masterInput:l}}}),define("dataFlow/components/engine",[],function(){return new function(){this.setupComplete=!1,this.Jupyter=null,this.executionQueue=[],this.transcript="";var t=this,e="import numpy as np\nimport pandas as pd\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\n%matplotlib inline\n";this.resetTranscript=function(){t.transcript=e},this.getTranscript=function(){var e=t.transcript.match(/# (GET|POST|DELETE|PUT) \/.*\n/g);return e&&(t.transcript=e[0]+t.transcript),t.transcript},this.setup=function(n){t.Jupyter=n,t.execute(e,{success:function(){console.log("Python Engine Successfully Initialized"),t.setupComplete=!0,t.executionQueue.length>0&&t._executeNext()},error:function(t){throw console.error("ERROR IMPORTING REQUIRED PYTHON LIBRARIES."),new Error(t)}},{force:!0})},this._executeNext=function(){console.warn("EXECUTE NEXT IS PROBABLY BROKEN. IT HAS NOT BEEN TESTED YET");var e=t.executionQueue.shift();t.execute.apply(this,e)},this.execute=function(e,n,i){var o=n.statusSet||function(){},r=n.success||function(){},s=n.error||function(){},a=n.setOutput||function(){},l=i&&!0===i.force;t.setupComplete||!0===l?(o("RUNNING"),console.log("Executing Python: ",e),t.transcript+=e,Jupyter.notebook.kernel.execute(e,{shell:{reply:function(t){"ok"===t.content.status?(o("DONE"),r(t.content)):"error"===t.content.status&&(o("ERROR"),s(t.content))}},iopub:{output:function(t){a(t.content)}}},{silent:!1,store_history:!1,stop_on_error:!1})):t.executionQueue.push(arguments)}}}),define("dataFlow/freezeCalculations",[],function(){var t=!1;return{setFrozen:function(e){t=e},getFrozen:function(){return t}}}),define("dataFlow/core_ComponentModel",["underscore","backbone","dataFlow/core_IOModels","dataFlow/pulse","dataFlow/enums","dataFlow/dataMatcher","dataFlow/components/engine","dataFlow/freezeCalculations"],function(t,e,n,i,o,r,s,a){return e.Model.extend({modelType:"Component",initialize:function(){var t="function"==typeof this.recalculateTrees,e="function"==typeof this.recalculate;if(!t&&!e||t&&e)throw new Error(this.get("componentPrettyName")+" needs either .recalculate() or .recalculateTrees(), but not both!");this.base_init.apply(this,arguments)},createIObjectsFromJSON:function(e,i,o){var r=[],s=(o="output"===o?"outputs":o,{outputs:n.Output,inputs:n.Input}),a=this,l=t.isUndefined(i)?{}:t.isUndefined(i[o])?{}:i[o];return t.each(t.values(e),function(e){var n=t.findWhere(l,{shortName:e.shortName});t.isEmpty(n)||n.type===e.type||console.warn("Datatype mismatch between persisted datatype and "+a.componentName+" definition. This indicates a namespace collision, or a change to a component's definition after it was used to persist data. Saved connections to this component may fail!");var i=new s[o](t.extend(n||{},e));r.push(i)}),r},base_init:function(e){if(t.isUndefined(e)||t.isUndefined(e.inputs)||t.isUndefined(e.output)&&t.isUndefined(e.outputs))throw new Error("Insufficient specifications for a Component");this._sufficient=!1,t.bindAll(this,"_handleInputChange","_propagatePulse","recalculate","getOutputVariableName","validatePythonTemplate"),this.outputs=this.initializeOutputs(t.isUndefined(e.outputs)?[e.output]:e.outputs),this.inputs=this.initializeInputs(e.inputs),this.position=e.position||{x:0,y:0},this.set("componentPrettyName",e.componentPrettyName),this.set("preview",e.preview||!1),this.set("pythonTemplate",e.pythonTemplate),e.pythonTemplate&&(this.validatePythonTemplate(e.pythonTemplate),this.pythonTemplateFn=t.template(e.pythonTemplate),t.bindAll(this,"pythonTemplateFn")),this.previews=[],this.on("change:preview",function(){this.clearPreviews(),!0===this.get("preview")&&this.drawPreviews()})},validatePythonTemplate:function(){var e=[],n=this;t.each(this.inputs,function(t){e.push("IN_"+t.shortName)}),e.push("RESULT"),t.each(e,function(t){if(n.get("pythonTemplate").indexOf(t)<0)throw new Error("Component is badly coded. Its inputs and outputs are not referenced by its python template, so they'll never be used.")})},getOutputVariableName:function(){var e=this.get("componentPrettyName");return e.length<1&&(e=this.componentName),e+="_",t.uniqueId(e.toLowerCase().replace(/[^a-z]/g,"_"))},initializeOutputs:function(e){var n=this;return t.each(e,function(t){n.on("pulse",function(e){t.trigger("pulse",e)})}),e},initializeInputs:function(e){var n=this;return t.each(e,function(t){n[t.shortName]=t,n.listenTo(t,"pulse",n._propagatePulse)}),e},_propagatePulse:function(t){if("GRAPH_DISCOVERY"===t.get("state"))t.updatePathCounts(this)&&this.trigger("pulse",t);else if("RECALCULATION"===t.get("state")){t.updatePathCounts(this)&&(this._handleInputChange(),this.trigger("pulse",t))}},assignInput:function(e,n){if(t.isUndefined(e)||t.isUndefined(n))throw new Error("Unspecified Input");if(!t.has(this,e))throw new Error("Tried to specify an input that does not exist");if(this[e].type!==n.type)throw new Error("Tried to specify an input of the wrong type");this[e].connectOutput(n)},getOutput:function(e){return e&&1!==this.outputs.length?t.findWhere(this.outputs,{shortName:e}):this.outputs[0]},getInput:function(e){return t.findWhere(this.inputs,{shortName:e})},destroy:function(){t.each(this.outputs,function(t){t.destroy()}),this.trigger("removed",this),t.each(this.inputs,function(t){t.destroy()}),this.off(),this.stopListening(),delete this.inputs,delete this.outputs},_windowFrozenWarnOnce:t.throttle(function(){console.warn("WINDOW FROZEN. CALCULATION SKIPPED.")},5e3),_handleInputChange:function(){if(!0===a.getFrozen())return this._windowFrozenWarnOnce();var e=!t.every(this.inputs,function(t){return!0!==t.getTree().isEmpty()});if(this.set({sufficient:!e}),this.errors=[],!e)if(this.simulatedRecalculate(),"function"==typeof this.recalculateTrees)this.recalculateTrees();else{var n=r(this.inputs,this.recalculate,this.outputs);n.errors.length>0&&(this.set({sufficient:"error"}),console.log(n.errors))}!0===this.get("preview")&&(e?this.clearPreviews():this.drawPreviews()),e&&this.clear(!1)},clear:function(e){if(t.each(this.outputs,function(t){t.clearValues()}),!0===e){var n=new i({startPoint:this,pathsOpened:1});this.trigger("pulse",n)}},isNull:function(){return t.every(this.outputs,function(t){return t.getTree().isEmpty()})},recalculate:function(){var e=this,n=[],i=t.map(arguments,function(e){var i=t.isArray(e);return i?t.each(e,function(t){n.push(t)}):n.push(e),i?e.length:0});n=t.map(n,function(t){return"string"==typeof t?'"'+t+'"':t});var o=Promise.all(n).then(function(e){return new Promise(function(n,o){var r=[];t.each(i,function(t){0===t?r.push(e.shift()):(r.push(e.slice(0,t)),e=e.slice(t))}),n(r)})}).then(function(){var n=arguments[0];return new Promise(function(i,o){var r=e.getOutputVariableName(),a={RESULT:r};t.each(e.inputs,function(t,e){a["IN_"+t.shortName]=n[e]});var l=e.pythonTemplateFn(a);s.execute(l,{statusSet:function(t){},success:function(){i(r)},error:function(t){o(t)},setOutput:function(t){}})})}),r={};return 1===this.outputs.length?r[this.outputs[0].shortName]=o.catch(function(t){e.set({sufficient:"error"})}):t.each(this.outputs,function(t,n){r[t.shortName]=o.catch(function(t){e.set({sufficient:"error"})}).then(function(t){return new Promise(function(e){return e(t+"["+n+"]")})})}),o.catch(function(t){e.errors.push({type:t.ename,message:t.evalue}),e.set({sufficient:"error"})}),r},simulatedRecalculate:function(){},fetchOutputs:function(){return this.getOutput().getTree().flattenedTree().dataAtPath([0])},getPreviewOutputs:function(){return[this.getOutput()]},drawPreviews:function(){var e=this.getGeometry(),n=this.getPreviewOutputs()[0].type,i={};if(i[o.OUTPUT_TYPES.CURVE]="CurveListPreview",i[o.OUTPUT_TYPES.POINT]="PointListPreview",n===o.OUTPUT_TYPES.WILD&&(e[0].constructor===Geometry.Curve?(n=o.OUTPUT_TYPES.CURVE,e=t.filter(e,function(t){return t.constructor===Geometry.Curve})):e[0].constructor===Geometry.Point&&(n=o.OUTPUT_TYPES.POINT,e=t.filter(e,function(t){return t.constructor===Geometry.Point}))),this.previews[0]&&this.previews[0].constructor===Preview[i[n]])this.previews[0].updateGeometry(e);else{console.warn("New preview type mismatches previous preview type. Destroy old previews?");var r=Preview[i[n]];"function"==typeof r&&(this.previews[0]=new r(e))}},exportGeometry:function(e){if(!t.contains(["SVG"],e))throw new Error("Unrecognized export type: "+e);this.trigger("requestFileExport",{type:e,geometry:this.getGeometry()})},getGeometry:function(){var t=this.getPreviewOutputs(),e=t[0].getTree().flattenedTree().dataAtPath([0]);if(t.length>1)for(var n=1;n<t.length;n++)e=e.concat(t[n].getTree().flattenedTree().dataAtPath([0]));return e},destroyPreviews:function(){this.clearPreviews(),this.previews.splice(0,this.previews.length)},clearPreviews:function(){t.each(this.previews,function(t){t.hide()})},toJSON:function(){var e=[],n=[];return t.each(this.inputs,function(t){e.push(t.toJSON())}),t.each(this.outputs,function(t){n.push(t.toJSON())}),{componentPrettyName:this.attributes.componentPrettyName,componentName:this.componentName,position:this.position,preview:this.attributes.preview,inputs:e,outputs:n,id:this.id||this.cid}}})}),define("dataFlow/core",["dataFlow/core_IOModels","dataFlow/core_ComponentModel","dataFlow/enums","dataFlow/pulse"],function(t,e,n,i){var o={};return o.OUTPUT_TYPES=n.OUTPUT_TYPES,o.INTERPRET_AS=n.INTERPRET_AS,o.Output=t.Output,o.Input=t.Input,o.Component=e,o.Pulse=i,o}),define("dataFlow/components/outputComponents",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher","dataFlow/components/engine"],function(t,e,n,i,o){var r={};return r.PrintComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.WILD,desc:"Data to be viewed"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),r=t.extend({componentPrettyName:"Print"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = print(<%= IN_D %>)\n"});this.base_init(r)},recalculate:function(){var e=this,n=Promise.all(arguments).then(function(){var n=arguments[0];return new Promise(function(i,r){var s={RESULT:e.getOutputVariableName()};t.each(e.inputs,function(t,e){s["IN_"+t.shortName]=n[e]});var a=e.pythonTemplateFn(s);o.execute(a,{statusSet:function(t){},success:function(){},error:function(t){console.log("python status ERROR: ",t),r()},setOutput:function(t){e.getOutput("D").trigger("change"),i(t)}})})}).catch(function(t){console.warn("Some inputs resolved as errors. This behavior should be defined... it can either 'show what we have' or error out, in which case prior data should be cleared.")}),i={};return 1===this.outputs.length?i[this.outputs[0].shortName]=n:t.each(this.outputs,function(t,e){i[t.shortName]=n.then(function(t){return new Promise(function(n){return n(t+"["+e+"]")})})}),i}},{label:"Print",desc:"View the value of a variable"}),r.LinePlot=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"X",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"X-Axis Values",interpretAs:e.INTERPRET_AS.LIST},{required:!0,shortName:"Y",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Y-Axis Values",interpretAs:e.INTERPRET_AS.LIST}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"P",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),r=t.extend({componentPrettyName:"LinePlot"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = plt.figure()\n<% _.each(IN_X , function(x,index) { %>plt.plot(<%= x %>, <%= IN_Y[index] %>)\n<% }) %>"});this.base_init(r)},recalculate:function(){var e=this,n=Promise.all(arguments).then(function(t){var e=Promise.all(t[0]),n=Promise.all(t[1]);return new Promise(function(t,i){var o;e.then(function(t){return o=t,n}).then(function(e){for(;o.length<e.length;)o.push(o[o.length-1]);t({x:o,y:e})})})}).then(function(n){var i=[n.x,n.y];return new Promise(function(n,r){var s=[],a={RESULT:e.getOutputVariableName()};t.each(e.inputs,function(t,e){a["IN_"+t.shortName]=i[e]});var l=e.pythonTemplateFn(a);o.execute(l,{statusSet:function(t){},error:function(t){console.log("python status ERROR: ",t),r()},success:function(t){e.getOutput("P").trigger("change"),n(s)},setOutput:function(t){t.data&&t.data["image/png"]&&s.push(t.data["image/png"])}})})}).catch(function(t){console.warn("Some inputs resolved as errors. This behavior should be defined... it can either 'show what we have' or error out, in which case prior data should be cleared.")}),i={};return 1===this.outputs.length?i[this.outputs[0].shortName]=n:t.each(this.outputs,function(t,e){i[t.shortName]=n.then(function(t){return new Promise(function(n){return n(t+"["+e+"]")})})}),i}},{label:"Line Plot",desc:"Plot two variables against each other using connecting lines"}),r.ExportPythonVariable=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.WILD,desc:"Data for export"},{required:!0,shortName:"N",type:e.OUTPUT_TYPES.STRING,desc:"Variable Names"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"P",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),r=t.extend({componentPrettyName:"Export Vars"},n||{},{inputs:i,outputs:o,pythonTemplate:"<% print(IN_N.replace(/[\"]+/g, '')); %> = <%= IN_D %> #<%= RESULT %>\n"});this.base_init(r)}},{label:"Export a variable for use in your Jupyter Document",desc:"Makes a Python object available in the Jupyter Context"}),r.ExportCSVFile=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe for export"},{required:!0,shortName:"P",type:e.OUTPUT_TYPES.STRING,desc:"Output path (use absolute paths)"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"P",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),r=t.extend({componentPrettyName:"Export CSV"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_D %>.to_csv(<%= IN_P %>)\n"});this.base_init(r)}},{label:"Export a Dataframe as a CSV File",desc:"Serialize a Pandas Dataframe into CSV format, and save the file to a local path on your computer"}),r.ExposeAPIEndpoint=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"E",type:e.OUTPUT_TYPES.STRING,desc:"Endpoint Name"},{required:!0,shortName:"A",type:e.OUTPUT_TYPES.STRING,desc:"Arguments for endpoint",interpretAs:e.INTERPRET_AS.LIST},{required:!1,default:"",shortName:"T",type:e.OUTPUT_TYPES.STRING,desc:"Argument Test Values",interpretAs:e.INTERPRET_AS.LIST}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.STRING,desc:"Argument Values"}],n,"output"),r=t.extend({componentPrettyName:"API"},n||{},{inputs:i,outputs:o,pythonTemplate:"# GET /<% print(IN_E.replace(/[\"]+/g, '')); %>\nimport json\ntry:\n  req = json.loads(REQUEST)\n  args = req['args']\n  <%= RESULT %> = (<% _.each(IN_A , function(argVariable,idx) { %>  <% if (idx != 0) { print(','); } %>  args[<%= argVariable %>][0]  <% }) %>)\nexcept:\n  <%= RESULT %> = (<% _.each(IN_A , function(argVariable,idx) { %>  <% if (idx != 0) { print(','); } %>  <% if (IN_T[idx] && typeof IN_T[idx] == 'string' && IN_T[idx].length > 2) { %><%= IN_T[idx] %> <% }  else { print(argVariable); } %>  <% }) %>)\n"});this.base_init(r)}},{label:"Expose this Orchestra Definition as an API via Jupyter Kernel Gateway",desc:"Create a web microservice based on your Jupyter definition. Accept inputs using this component, and include a single 'print' component to send output to the response."}),r.SpreadsheetComponent=r.PrintComponent.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe for viewing"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.WILD,invisible:!0}],n,"output"),r=t.extend({componentPrettyName:"Spreadsheet"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = print(<%= IN_D %>.to_json())\n"});this.base_init(r)}},{label:"View a Pandas Dataframe in a Spreadsheet",desc:"To conveniently view a whole dataframe in the browser, regardless of size, plug it into this component and single-click the component."}),r}),define("dataFlow/components/number",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var o={};return o.NumberComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{shortName:"N",type:e.OUTPUT_TYPES.NUMBER}],n,"output"),o=this.createIObjectsFromJSON([{required:!1,shortName:"N",type:e.OUTPUT_TYPES.NUMBER}],n,"inputs"),r=t.extend({componentPrettyName:"Number"},n||{},{inputs:o,outputs:i,pythonTemplate:"<%= RESULT %> = <%= IN_N %>\n"});this.base_init(r)}},{label:"Number",desc:"Holds a list of numbers. For short lists, you can enter the numbers directly into the component"}),o.SeriesComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{shortName:"S",type:e.OUTPUT_TYPES.NUMBER,desc:"Series"}],n,"output"),o=this.createIObjectsFromJSON([{shortName:"S",required:!1,default:0,type:e.OUTPUT_TYPES.NUMBER,desc:"First number in series"},{shortName:"N",required:!1,default:1,type:e.OUTPUT_TYPES.NUMBER,desc:"Step size"},{shortName:"C",required:!1,default:10,type:e.OUTPUT_TYPES.NUMBER,desc:"Count of numbers in series"}],n,"inputs"),r=t.extend({componentPrettyName:"Series",preview:!1},n||{},{inputs:o,outputs:i});this.base_init(r),this.recalculate()},recalculate:function(t,e,n){for(var i=[],o=0;o<n;)i.push(t+e*o),o++;return{S:i}}},{label:"Series",desc:"Generates a list of numbers. You can control the start of the list, the increment, and the number of values"}),o.SliderComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{shortName:"N",type:e.OUTPUT_TYPES.NUMBER,desc:"Value"}],n,"output"),o=this.createIObjectsFromJSON([{shortName:"S",required:!1,default:0,type:e.OUTPUT_TYPES.NUMBER,desc:"Start"},{shortName:"E",required:!1,default:1,type:e.OUTPUT_TYPES.NUMBER,desc:"End"},{shortName:"I",required:!1,default:!1,type:e.OUTPUT_TYPES.BOOLEAN,desc:"Integers"},{shortName:"N",required:!1,default:.5,type:e.OUTPUT_TYPES.NUMBER,invisible:!0,desc:"Value"}],n,"inputs"),r=t.extend({componentPrettyName:"Slider",preview:!1},n||{},{inputs:o,outputs:i});this.base_init(r)},storeUserData:function(t){var e=new n;e.setDataAtPath([t],[0]),this.getInput("N").assignPersistedData(e)},recalculateTrees:function(){var t=this.getInput("N").getFirstValueOrDefault(),e=this.getInput("S").getFirstValueOrDefault(),n=this.getInput("E").getFirstValueOrDefault();!0===this.getInput("I").getFirstValueOrDefault()&&Math.floor(t)!=t&&(t=Math.floor(t)),t>n&&(t=n),t<e&&(t=e),this.getOutput("N").values.setDataAtPath([t],[0])}},{label:"Slider",desc:"A convenient way to change numerical values on the fly. Shows a touch/mouse-enabled slider"}),o}),define("dataFlow/components/simplemath",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var o={};return o.NumberAdditionComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMBER},{required:!0,shortName:"B",type:e.OUTPUT_TYPES.NUMBER}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"N",type:e.OUTPUT_TYPES.NUMBER}],n,"output"),r=t.extend({componentPrettyName:"Number Addition"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_A %> + <%= IN_B %>\n"});this.base_init(r)}},{label:"Add",desc:"Add two numbers together"}),o.NumberSubtractComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMBER},{required:!0,shortName:"B",type:e.OUTPUT_TYPES.NUMBER}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"N",type:e.OUTPUT_TYPES.NUMBER}],n,"output"),r=t.extend({componentPrettyName:"Number Subtraction"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_A %> - <%= IN_B %>\n"});this.base_init(r)}},{label:"Subtract",desc:"Subtract A - B"}),o}),define("dataFlow/components/treeComponents",["underscore","dataFlow/core","dataFlow/dataMatcher"],function(t,e,n){var i={};return i.GraftComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Graft"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"T",type:e.OUTPUT_TYPES.WILD}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"T",type:e.OUTPUT_TYPES.WILD,containsNewData:!1}],n,"output")}))},recalculateTrees:function(){this.getOutput("T").replaceData(this.getInput("T").getTree().graftedTree())}},{label:"Graft Tree",desc:"Creates a separate branch for each data item in the supplied tree"}),i.ShiftComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Shift"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0},{required:!1,shortName:"S",default:1,type:e.OUTPUT_TYPES.NUMBER},{required:!1,shortName:"W",default:!0,type:e.OUTPUT_TYPES.BOOLEAN}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(t,e,n){var i=t.slice(e);return n&&(i=i.concat(t.slice(0,e))),{L:i}}},{label:"Shift List",desc:"Removes items from the beginning of a data list, and optionally tacks them back onto the end"}),i.CullIndexComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Cull i"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"List to Cull"},{required:!0,shortName:"i",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Culling indices"},{required:!1,shortName:"W",default:!0,type:e.OUTPUT_TYPES.BOOLEAN,desc:"Wrap indices to list range"}],n,"inputs"),outputs:output=this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n,i){var o=[];return t.each(e,function(e,i){t.contains(n,i)||o.push(e)}),{L:o}}},{label:"Cull Index",desc:"Cull (remove) indexed elements from a list"}),i.CullPatternComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Cull"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"List to Cull"},{required:!0,shortName:"P",type:e.OUTPUT_TYPES.BOOLEAN,interpretAs:e.INTERPRET_AS.LIST,desc:"Culling pattern"}],n,"inputs"),outputs:output=this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n){var i=n.length;return{L:t.filter(e,function(t,e){return n[e%i]})}}},{label:"Cull Pattern",desc:"Cull (remove) indexed elements from a list using a repeating bit mask"}),i.CullFrequencyComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({componentPrettyName:"CullN",preview:!1},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"List to Cull"},{required:!1,default:2,shortName:"N",type:e.OUTPUT_TYPES.NUMBER,desc:"Cull frequency"}],n,"inputs"),outputs:output=this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n){return{L:t.filter(e,function(t,e){return(e+1)%n!=0})}}},{label:"Cull Nth",desc:"Cull (remove) every Nth element in a list"}),i.InsertItemsComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Ins"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"List to modify"},{required:!0,shortName:"I",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST,isMaster:!0,desc:"Items to insert. If no items are supplied, nulls will be inserted"},{required:!0,shortName:"i",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Insertion index for each item"},{required:!1,shortName:"W",default:!0,type:e.OUTPUT_TYPES.BOOLEAN,desc:"If true, indices will be wrapped"}],n,"inputs"),outputs:output=this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n,i,o){console.warn("TODO: Support 'wrap' option on insert-items component");var r=e.slice(0),s=n.slice(0).reverse();return t.each(i.slice(0).reverse(),function(t,e){r.splice(t,0,s[e])}),{L:r}}},{label:"Insert Items",desc:"Insert a collection of items into a list"}),i.FlattenComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Flatten"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"T",type:e.OUTPUT_TYPES.WILD},{required:!1,shortName:"P",default:[0],type:e.OUTPUT_TYPES.ARRAY}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"T",type:e.OUTPUT_TYPES.WILD,containsNewData:!1}],n,"output")}))},recalculateTrees:function(){console.warn("PATH input is ignored for now");var t=this.getInput("T").getTree().flattenedTree(!1);this.getOutput("T").replaceData(t)}},{label:"Flatten Tree Data",desc:"Flatten a data tree by removing all branching information"}),i.ListItemComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Item"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST},{required:!1,shortName:"i",default:0,type:e.OUTPUT_TYPES.NUMBER},{required:!1,shortName:"W",default:!0,type:e.OUTPUT_TYPES.BOOLEAN}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"i",type:e.OUTPUT_TYPES.WILD,containsNewData:!1}],n,"output")}))},recalculate:function(e,n,i){return t.isArray(e)?!i&&e.length<=n?null:{i:e[n%e.length]}:null}},{label:"Extract Item from List",desc:"Retrieve a specific item from a list"}),i.DuplicateDataComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Dup"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST},{required:!1,shortName:"N",default:2,type:e.OUTPUT_TYPES.NUMBER},{required:!1,shortName:"O",default:!0,type:e.OUTPUT_TYPES.BOOLEAN}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.WILD,containsNewData:!1,interpretAs:e.INTERPRET_AS.LIST}],n,"output")}))},recalculate:function(e,n,i){if(!t.isArray(e))return null;console.warn("RETAIN ORDER FALSE NOT SUPPORTED");for(var o=[],r=0;r<n;r++)o=o.concat(e);return{D:o}}},{label:"Duplicate Data",desc:"Duplicate data a predefined number of times"}),i.ListLengthComponent=e.Component.extend({initialize:function(n){this.base_init(t.extend({preview:!1,componentPrettyName:"Lng"},n||{},{inputs:this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.WILD,interpretAs:e.INTERPRET_AS.LIST}],n,"inputs"),outputs:this.createIObjectsFromJSON([{shortName:"L",type:e.OUTPUT_TYPES.NUMBER}],n,"output")}))},recalculate:function(e){return t.isArray(e)?{L:e.length}:null}},{label:"List Length",desc:"Measure the length of a List"}),i}),define("dataFlow/components/numpy_create",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var o={};return o.NumpyZeros=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 0 Length"},{required:!1,default:0,shortName:"R",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 1 Length"},{required:!1,default:0,shortName:"W",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 2 Length"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"Zeros"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = np.zeros((<%= IN_C %><% if (IN_R) { %>, <%= IN_R %><% } %><% if (IN_W) { %>, <%= IN_W %><% } %> ))\n"});this.base_init(r)}},{label:"Zeros Array",desc:"Create a NumPy Zeros Array, up to 3 dimensions"}),o.NumpyFullNDimensions=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Dimensions of numpy array"},{required:!1,default:0,shortName:"V",type:e.OUTPUT_TYPES.NUMBER,desc:"Value to fill the array with"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"Full N-D Array"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = np.full((<%= IN_D %>), <%= IN_V %>)\n"});this.base_init(r)}},{label:"Full N-Dimensional Array",desc:"Create a full Numpy array of unlimited dimensions"}),o.NumpyFullRandom=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Shape of Numpy Array"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"Random Array"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = np.random.rand(<%= IN_D %>)\n"});this.base_init(r)}},{label:"Create a Numpy Array Full of Random Values",desc:"Create a new Numpy Array (of shape specified) full of random values"}),o.NumpyFull=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 0 Length"},{required:!1,default:0,shortName:"R",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 1 Length"},{required:!1,default:0,shortName:"W",type:e.OUTPUT_TYPES.NUMBER,desc:"Axis 2 Length"},{required:!1,default:0,shortName:"V",type:e.OUTPUT_TYPES.NUMBER,desc:"Value"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"Full"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = np.full((<%= IN_C %><% if (IN_R) { %>, <%= IN_R %><% } %><% if (IN_W) { %>, <%= IN_W %><% } %>), <%= IN_V %>)\n"});this.base_init(r)}},{label:"Full Array",desc:"Create a NumPy Array with every value set to a particular value"}),o.NumpyRange=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!1,default:0,shortName:"S",type:e.OUTPUT_TYPES.NUMBER,desc:"Start"},{required:!1,default:10,shortName:"E",type:e.OUTPUT_TYPES.NUMBER,desc:"End"},{required:!1,default:1,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Step"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"Range"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = np.arange(<%= IN_S %>, <%= IN_E %>, <%= IN_C %> )\n"});this.base_init(r)}},{label:"Range",desc:"Create a 1D NumPy Range Array"}),o.NumpyLinspace=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!1,default:0,shortName:"S",type:e.OUTPUT_TYPES.NUMBER,desc:"Start, the array's first value"},{required:!1,default:10,shortName:"E",type:e.OUTPUT_TYPES.NUMBER,desc:"End, the array's last value"},{required:!1,default:1,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Count, number of items in the array"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"Linspace"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = np.linspace(<%= IN_S %>, <%= IN_E %>, <%= IN_C %>)\n"});this.base_init(r)}},{label:"Linspace",desc:"Create a 1D NumPy Linear Space as a function of Start, End, and Count of Values"}),o}),define("dataFlow/components/numpy_simplemath",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var o={};return o.NumpySin=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"sin(A)"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = np.sin(<%= IN_A %>)\n"});this.base_init(r)}},{label:"Numpy Vectorized Sin(x)",desc:"Return a numpy array whose members are the sine of the values of the members of the input array"}),o.NumpyCos=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"cos(A)"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = np.cos(<%= IN_A %>)\n"});this.base_init(r)}},{label:"Numpy Vectorized Cos(x)",desc:"Return a numpy array whose members are the cosine of the values of the members of the input array"}),o}),define("dataFlow/components/numpy_basics",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var o={};return o.NumpySlice=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array to Slice"},{required:!1,default:"null",shortName:"S",type:e.OUTPUT_TYPES.NUMBER,desc:"Start Index of Slice"},{required:!1,default:"null",shortName:"E",type:e.OUTPUT_TYPES.NUMBER,desc:"End Index of Slice"},{required:!1,default:"null",shortName:"N",type:e.OUTPUT_TYPES.NUMBER,desc:"Step"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"1D Sub Array"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_A %>[ <% if (IN_S != 'null'){ %><%= IN_S %><% } %> : <% if (IN_E != 'null'){ %><%= IN_E %><% } %> : <% if (IN_N != 'null'){ %><%= IN_N %><% } %>]\n"});this.base_init(r)}},{label:"Slice a Numpy Array",desc:"Create a slice (sub-array) of a numpy array based on a start index, end index, and number of steps between each index."}),o.NumpyExtractItem=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array"},{required:!1,default:0,shortName:"I",type:e.OUTPUT_TYPES.NUMBER,interpretAs:e.INTERPRET_AS.LIST,desc:"Index of Item to Extract, <= Array Dimension"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR},{shortName:"N",type:e.OUTPUT_TYPES.WILD}],n,"output"),r=t.extend({componentPrettyName:"Extract Item"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = (<%= IN_A %>[<%= IN_I %>], <%= IN_A %>[<%= IN_I %>])\n"});this.base_init(r)}},{label:"Extract an Item from a Numpy Array",desc:"Extract an Item from Numpy array using Indexing. Position in a multi-dimensional array can be specified by subsequent items in the 'Index' input, which will be interpreted as a list."}),o.NumpyExtractColumn=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array, 2+ Dimensions"},{required:!1,default:0,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Index of Column to Extract"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"Extract Column"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_A %>[:,<%= IN_C %>]\n"});this.base_init(r)}},{label:"Extract the first column of a Numpy Array With 2 or more dimensions",desc:"Extract the first column of a Numpy array using a combination of index and slice methods eg, array[:,(column number)]"}),o.NumpyExtractRow=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array, 2+ Dimensions"},{required:!1,default:0,shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Index of Row to Extract"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR}],n,"output"),r=t.extend({componentPrettyName:"Extract Row"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_A %>[<%= IN_C %>,:]\n"});this.base_init(r)}},{label:"Extract the first row of a Numpy Array With 2 or more dimensions",desc:"Extract the first row of a Numpy array using a combination of index and slice methods eg, array[(row number),:]"}),o.NumpyShape=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"A",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Numpy Array"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"S",type:e.OUTPUT_TYPES.ARRAY,desc:"Shape"},{shortName:"N",type:e.OUTPUT_TYPES.NUMBER,desc:"Number of Dimensions"},{shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Size"},{shortName:"D",type:e.OUTPUT_TYPES.STRING,desc:"Data Type"}],n,"output"),r=t.extend({componentPrettyName:"Shape"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = (<%= IN_A %>.shape, <%= IN_A %>.ndim, <%= IN_A %>.size, <%= IN_A %>.dtype)\n"});this.base_init(r)}},{label:"Shape of a Numpy Array",desc:"Retrieve the dimensions and data type of a Numpy Array"}),o}),define("dataFlow/components/dataframe_create",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var o={};return o.DataFrameFromCSV=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"L",type:e.OUTPUT_TYPES.STRING,desc:"Location of the source CSV"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME}],n,"output"),r=t.extend({componentPrettyName:"Read CSV"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = pd.read_csv(<%= IN_L %>)\n"});this.base_init(r)}},{label:"Pandas DataFrame From CSV",desc:"Read a CSV from a local file path or URL. Accepts http, s3, file, and ftp URLs. For file, a host is expected."}),o}),define("dataFlow/components/dataframe_basics",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var o={};return o.DataframeExtractColumn=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe from which columns should be selected"},{required:!0,shortName:"I",type:e.OUTPUT_TYPES.STRING,desc:"Indexes of Column to Extract",interpretAs:e.INTERPRET_AS.LIST}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME}],n,"output"),r=t.extend({componentPrettyName:"Extract Columns"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_D %>[[<%= IN_I %>]]\n"});this.base_init(r)}},{label:"Extract Named Columns from a Pandas Dataframe",desc:"Supply a list of column names (strings) to extract from a dataframe for more convenient manipulation."}),o.DataframeInsertColumn=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe into which a new column will be inserted"},{required:!1,shortName:"I",default:0,type:e.OUTPUT_TYPES.NUMBER,desc:"Index of location of new Column. Must be 0 <= Index <= len(columns)"},{required:!1,shortName:"L",default:"0",type:e.OUTPUT_TYPES.STRING,desc:"Label / name of the new column"},{required:!0,shortName:"V",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Values to insert"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME}],n,"output"),r=t.extend({componentPrettyName:"Insert Columns"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_D %>.copy()\n<%= RESULT %>.insert(<%= IN_I %>, <%= IN_L %>, <%= IN_V %>, allow_duplicates=False)\n"});this.base_init(r)}},{label:"Insert a new column into a pandas dataframe",desc:"Supply the position, label, and values for a new column that will be inserted into an existing Pandas Dataframe"}),o.DataframeShape=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe to learn the shape of"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"S",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Shape, a touple representing the dimensionality of the data frame"},{shortName:"N",type:e.OUTPUT_TYPES.NUMPY_ARR,desc:"Number of Dimensions in each axis"},{shortName:"C",type:e.OUTPUT_TYPES.NUMBER,desc:"Size, the number of elements in the dataframe"},{shortName:"D",type:e.OUTPUT_TYPES.STRING,desc:"Data Types"}],n,"output"),r=t.extend({componentPrettyName:"Shape"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = (<%= IN_D %>.shape, <%= IN_D %>.ndim, <%= IN_D %>.size, <%= IN_D %>.dtypes)\n"});this.base_init(r)}},{label:"Shape of a Pandas Dataframe",desc:"Retrieve the dimensions and data types of a Dataframe"}),o.DataframeCopy=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{required:!0,shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"Dataframe to copy"}],n,"inputs"),o=this.createIObjectsFromJSON([{shortName:"D",type:e.OUTPUT_TYPES.DATAFRAME,desc:"A copy of the data frame"}],n,"output"),r=t.extend({componentPrettyName:"DF Copy"},n||{},{inputs:i,outputs:o,pythonTemplate:"<%= RESULT %> = <%= IN_D %>.copy()\n"});this.base_init(r)}},{label:"Copy a Pandas Dataframe",desc:"Make a copy of a pandas dataframe"}),o}),define("dataFlow/components/string",["underscore","dataFlow/core","dataFlow/dataTree","dataFlow/dataMatcher"],function(t,e,n,i){var o={};return o.StringComponent=e.Component.extend({initialize:function(n){var i=this.createIObjectsFromJSON([{shortName:"S",type:e.OUTPUT_TYPES.STRING,required:!0}],n,"output"),o=this.createIObjectsFromJSON([{required:!1,shortName:"S",type:e.OUTPUT_TYPES.STRING}],n,"inputs"),r=t.extend({componentPrettyName:"String"},n||{},{inputs:o,outputs:i,pythonTemplate:"<%= RESULT %> = <%= IN_S %>\n"});this.base_init(r)}},{label:"String",desc:"Holds a list of strings. You can use this to copy/paste string data from Google Docs or Excel"}),o}),define("dataFlow/dataFlow_loader",["underscore","dataFlow/core","dataFlow/components/outputComponents","dataFlow/components/number","dataFlow/components/simplemath","dataFlow/components/treeComponents","dataFlow/components/numpy_create","dataFlow/components/numpy_simplemath","dataFlow/components/numpy_basics","dataFlow/components/dataframe_create","dataFlow/components/dataframe_basics","dataFlow/components/string"],function(t,e,n,i,o,r,s,a,l,c,h,u){function p(e,n){t.each(e,function(t,e){t.module=n}),d.components[n]=d.components[n]||{},t.extend(d.components[n],e)}var d={};return d=t.extend(d,e),d.components={},p(r,"tree"),p(i,"number"),p(o,"simplemath"),p(s,"numpy_create"),p(n,"outputComponents"),p(a,"numpy_simplemath"),p(l,"numpy_basics"),p(c,"dataframe_create"),p(h,"dataframe_basics"),p(u,"string"),d.iterateComponents=function(e){return function n(i){for(var o=t.keys(i),r=0;r<o.length;r++){var s=o[r];"function"==typeof i[s]?e(s,i[s]):n(i[s])}}(d.components)},d.findComponentConstructorByName=function(t){var e=null;return d.iterateComponents(function(n,i){t===n&&(e=i)}),e},d.createComponentByName=function(e,n){var i=d.findComponentConstructorByName(e);return t.isNull(i)?(console.warn("Couldn't find component by name: "+e),null):new i(n)},d.iterateComponents(function(t,e){e.prototype.componentName=t}),d}),define("dataFlow/UI/contextMenuJupyter",["jquery","underscore","backbone","dataFlow/dataFlow_loader"],function(t,e,n,i){var o=null,r=e.template('<div class="context-menu">        <ul class="dropdown-menu" role="menu">        <li class="comp_Name"><span><%= componentName %></span></li>        <li><a tabindex="-1"><input type="text" placeholder="Component Name" value="<%= componentPrettyName %>"/></a></li>        <li class="divider"></li>            <li><a class="deleteComponent" tabindex="-1"><span class="fa fa-remove icongutter"></span>Delete</a></li>            <li><a class="helpTooltip" tabindex="-1"><span class="fa fa-question-circle icongutter"></span>Help: <%= componentName %> </a></li>        </ul>        </div>');return n.View.extend({events:{"click input":"keepMenu","contextmenu input":"keepMenu","click a.previewToggle":"togglePreview","click a.deleteComponent":"deleteComponent","keyup input":"editComponentPrettyName"},template:r,initialize:function(t){e.isNull(o)||o.destroy(),o=this;var n=t.x,i=t.y;this.registerCleanup(),this.render(n,i)},registerCleanup:function(){e.bindAll(this,"destroy"),this.hideEventHandlers={click:this.destroy,contextmenu:this.destroy,mousewheel:this.destroy},t(document).on(this.hideEventHandlers)},keepMenu:function(t){t.stopPropagation()},editComponentPrettyName:function(e){this.model.set("componentPrettyName",t(e.target).val())},togglePreview:function(){this.model.set("preview",!this.model.get("preview"))},deleteComponent:function(){this.model.destroy()},exportSVG:function(){this.model.exportGeometry("SVG")},render:function(e,n){var i=this.template(this.model.toJSON());t("body").append(this.$el),this.$el.append(t(i)).find("div.context-menu").css({display:"block",top:n+"px",left:e+"px"})},destroy:function(){t(document).off(this.hideEventHandlers),this.$el.empty(),this.remove(),o=null}})}),define("dataFlow/UI/helpTooltips",["jquery","underscore","dataFlow/enums","backbone"],function(t,e,n,i){function o(){l&&(l.popover&&l.popover("destroy"),l.off("show.bs.popover"),l.remove(),l=null)}function r(){this.mouseDown=0,e.bindAll(this,"incrementMousedown","decrementMousedown","mouseEnter"),t(a).on("mouseenter","div.draggable",this.mouseEnter),t(a).on("mousedown",this.incrementMousedown),t(a).on("mouseup",this.decrementMousedown)}function s(t){var i=t.toJSON();return i.defaultValue=e.isUndefined(i.default)||e.isNull(i.default)?"(none)":i.default,i.desc=e.isUndefined(i.desc)?"":i.desc,i.interpretAs=n.DISPLAY_NAMES.INTERPRET_AS[i.interpretAs]||"Item",i.required=!!e.isUndefined(i.required)||i.required,i.type=n.DISPLAY_NAMES.OUTPUT_TYPES[t.get("type")],i}var a="div.TOP",l=null;e.once(function(){document.addEventListener("mousewheel",o,!1),document.addEventListener("DOMMouseScroll",o,!1)})(),r.prototype.incrementMousedown=function(){o(),this.mouseDown=this.mouseDown+1},r.prototype.decrementMousedown=function(){this.mouseDown=this.mouseDown-1};e.template("<ul class='io_tooltip'><% if (desc != '') { %><li><span class='io_description'><%= desc %><% if (required) { %>*<% } %></span></li><% } %><li><span class='io_isRequired'><% if (required) { %>*<% } %>(<% if (!required) { %>Not <% } %>Required)</span></li><% if (defaultValue != '(none)') { %><li><span class='io_tooltip_field_title'>Default Value: </span> <span class='io_tooltip_field_value'><%= defaultValue %></span></li><% } %><li><span class='io_tooltip_field_title'>Interpreted as: </span><span class='io_tooltip_field_value'><%= interpretAs %></span></li></ul>"),e.template("<ul class='io_tooltip'><% if (desc == '') { %><li><span class='io_tooltip_field_title'>(no description)</span></li><% } else { %><li><span class='io_description'><%= desc %></span></li><% } %></ul>"),e.template("<%= shortName %>: <%= type %>");var c=e.template("<%= componentPrettyName %> <span class='cmpt_tooltip_title_modulename'>(<%= module %>.<%= componentName %>)</span>"),h=e.template("<% _.each(errors,function(e,idx){ %>        <div class='cmpt_error_line'>           <span class='err_type'><%= e.type %>:</span>           <span class='err_msg'><%= e.message %></span>       <div> <% }) %>"),u=e.template("<div class='cmpt_tooltip'>   <div class='cmpt_description'><%= description %></div>        <div class='cmpt_io_container'>           <span class='cmpt_io_title'>Inputs:</span><% _.each(inputs,function(i){ %>        <div class='cmpt_io'>           <span class='cmpt_io_name'><%= i.shortName %><% if (i.required) { %>*<% } %></span>           <span class='cmpt_io_details'>(<%= i.type %>, as <%= i.interpretAs %>) <%= i.desc %>               <% if (i.defaultValue != '(none)') { %>Default: <%= i.defaultValue %><% } %>           </span></span>       </div> <% }) %>           <span class='cmpt_io_title'>Outputs:</span><% _.each(outputs,function(i){ %>        <div class='cmpt_io'>           <span class='cmpt_io_name'><%= i.shortName %></span>           <span class='cmpt_io_details'>(<%= i.type %>, as <%= i.interpretAs %>) <%= i.desc %></span>       </div> <% }) %>           <span class='cmpt_io_required_legend'>* = required</span>       </div> </div>");return r.prototype.mouseEnter=function(n){if(0===this.mouseDown){n.stopPropagation(),n.preventDefault();try{var i=t(n.currentTarget).data("viewObject"),r=i.objectType}catch(n){return}o();var a=t(i.cssObject.element),p=(a=a.find(".componentLabel").size()>0?a.find(".componentLabel").get(0):a.get(0)).getBoundingClientRect(),d=e.template("<div class='locationAnchor' style='position: absolute;z-index:0; opacity: 0; width: <%= width %>px; height: <%= height %>px;top: <%= top %>px; left: <%= left %>px;'></div>");if(l=t(d(p)),t("body").append(l),!r||"OutputView"!=r&&"InputView"!=r){if(r&&r.indexOf("ComponentView")>-1){var f=function(t){var n=t.toJSON();return n.errors=t.errors,n.description=t.constructor.desc,n.label=t.constructor.label,n.module=t.constructor.module,n.inputs=e.map(t.inputs,function(t){return s(t)}),n.outputs=e.map(t.outputs,function(t){return s(t)}),n}(i.component),m="error"===i.component.get("sufficient");!function(e,n,i,r,s){var a=setTimeout(function(){l&&(r&&l.on("show.bs.popover",function(){t(this).data("bs.popover").tip().css(r)}),l.popover({title:e,html:!0,content:n,trigger:"manual",container:"body",placement:"auto "+i}).popover("show"),t(s).one("mouseleave",o))},600);t(s).one("mouseleave",function(){clearTimeout(a)})}(c(f),m?h(f):u(f),"top",{"max-width":"600px"},n.currentTarget)}}else;}},r.prototype.destroy=function(){o(),t(a).off("mouseenter","div.draggable",this.mouseEnter),t(a).off("mousedown",this.incrementMousedown),t(a).off("mouseup",this.decrementMousedown)},r}),define("CSS3DRenderer",["three"],function(t){t.CSS3DObject=function(e){t.Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(t){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},t.CSS3DObject.prototype=Object.create(t.Object3D.prototype),t.CSS3DObject.prototype.constructor=t.CSS3DObject,t.CSS3DSprite=function(e){t.CSS3DObject.call(this,e)},t.CSS3DSprite.prototype=Object.create(t.CSS3DObject.prototype),t.CSS3DSprite.prototype.constructor=t.CSS3DSprite,t.CSS3DRenderer=function(){console.log("THREE.CSS3DRenderer",t.REVISION);var e,n,i,o,r=new t.Matrix4,s={camera:{fov:0,style:""},objects:{}},a=document.createElement("div");a.style.overflow="hidden",a.style.WebkitTransformStyle="preserve-3d",a.style.MozTransformStyle="preserve-3d",a.style.oTransformStyle="preserve-3d",a.style.transformStyle="preserve-3d",this.domElement=a;var l=document.createElement("div");l.style.WebkitTransformStyle="preserve-3d",l.style.MozTransformStyle="preserve-3d",l.style.oTransformStyle="preserve-3d",l.style.transformStyle="preserve-3d",a.appendChild(l),this.setClearColor=function(){},this.getSize=function(){return{width:e,height:n}},this.setSize=function(t,r){i=(e=t)/2,o=(n=r)/2,a.style.width=t+"px",a.style.height=r+"px",l.style.width=t+"px",l.style.height=r+"px"};var c=function(t){return Math.abs(t)<Number.EPSILON?0:t},h=function(t){var e=t.elements;return"translate3d(-50%,-50%,0) matrix3d("+c(e[0])+","+c(e[1])+","+c(e[2])+","+c(e[3])+","+c(-e[4])+","+c(-e[5])+","+c(-e[6])+","+c(-e[7])+","+c(e[8])+","+c(e[9])+","+c(e[10])+","+c(e[11])+","+c(e[12])+","+c(e[13])+","+c(e[14])+","+c(e[15])+")"},u=function(e,n){if(e instanceof t.CSS3DObject){var i;e instanceof t.CSS3DSprite?(r.copy(n.matrixWorldInverse),r.transpose(),r.copyPosition(e.matrixWorld),r.scale(e.scale),r.elements[3]=0,r.elements[7]=0,r.elements[11]=0,r.elements[15]=1,i=h(r)):i=h(e.matrixWorld);var o=e.element,a=s.objects[e.id];void 0!==a&&a===i||(o.style.WebkitTransform=i,o.style.MozTransform=i,o.style.oTransform=i,o.style.transform=i,s.objects[e.id]=i),o.parentNode!==l&&l.appendChild(o)}for(var c=0,p=e.children.length;c<p;c++)u(e.children[c],n)};this.render=function(e,r){var h=.5/Math.tan(t.Math.degToRad(.5*r.getEffectiveFOV()))*n;s.camera.fov!==h&&(a.style.WebkitPerspective=h+"px",a.style.MozPerspective=h+"px",a.style.oPerspective=h+"px",a.style.perspective=h+"px",s.camera.fov=h),e.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),r.matrixWorldInverse.getInverse(r.matrixWorld);var p="translate3d(0,0,"+h+"px)"+function(t){var e=t.elements;return"matrix3d("+c(e[0])+","+c(-e[1])+","+c(e[2])+","+c(e[3])+","+c(e[4])+","+c(-e[5])+","+c(e[6])+","+c(e[7])+","+c(e[8])+","+c(-e[9])+","+c(e[10])+","+c(e[11])+","+c(e[12])+","+c(-e[13])+","+c(e[14])+","+c(e[15])+")"}(r.matrixWorldInverse)+" translate3d("+i+"px,"+o+"px, 0)";s.camera.style!==p&&(l.style.WebkitTransform=p,l.style.MozTransform=p,l.style.oTransform=p,l.style.transform=p,s.camera.style=p),u(e,r)}}}),define("OrbitControls",["three"],function(t){t.OrbitControls=function(e,n){function i(){return 2*Math.PI/60/60*c.autoRotateSpeed}function o(){return Math.pow(.95,c.zoomSpeed)}function r(t){if(!1!==c.enabled){if(0===t.button){if(!0===c.noRotate)return;P=S.ROTATE,h.set(t.clientX,t.clientY)}else if(1===t.button){if(!0===c.noZoom)return;t.preventDefault(),P=S.DOLLY,y.set(t.clientX,t.clientY)}else if(2===t.button){if(!0===c.noPan)return;t.preventDefault(),P=S.PAN,d.set(t.clientX,t.clientY)}document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",a,!1),c.dispatchEvent(A)}}function s(t){if(!1!==c.enabled){t.preventDefault();var e=c.domElement===document?c.domElement.body:c.domElement;if(P===S.ROTATE){if(!0===c.noRotate)return;u.set(t.clientX,t.clientY),p.subVectors(u,h),c.rotateLeft(2*Math.PI*p.x/e.clientWidth*c.rotateSpeed),c.rotateUp(2*Math.PI*p.y/e.clientHeight*c.rotateSpeed),h.copy(u)}else if(P===S.DOLLY){if(!0===c.noZoom)return;v.set(t.clientX,t.clientY),T.subVectors(v,y),T.y>0?c.dollyIn():c.dollyOut(),y.copy(v)}else if(P===S.PAN){if(!0===c.noPan)return;f.set(t.clientX,t.clientY),m.subVectors(f,d),c.pan(m.x,m.y),d.copy(f)}c.update()}}function a(){!1!==c.enabled&&(document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",a,!1),c.dispatchEvent(R),P=S.NONE)}function l(t){if(!(c.domElement.className.indexOf("freezeZooming")>-1)&&!1!==c.enabled&&!0!==c.noZoom){var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?c.dollyOut():c.dollyIn(),c.update(),c.dispatchEvent(A),c.dispatchEvent(R)}}this.object=e,this.domElement=void 0!==n?n:document,this.enabled=!0,this.target=new t.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=400,this.maxDistance=3e4,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var c=this,h=new t.Vector2,u=new t.Vector2,p=new t.Vector2,d=new t.Vector2,f=new t.Vector2,m=new t.Vector2,b=new t.Vector3,g=new t.Vector3,y=new t.Vector2,v=new t.Vector2,T=new t.Vector2,w=0,_=0,x=1,N=new t.Vector3,O=new t.Vector3,E=new t.Quaternion,S={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},P=S.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var C=(new t.Quaternion).setFromUnitVectors(e.up,new t.Vector3(0,1,0)),I=C.clone().inverse(),U={type:"change"},A={type:"start"},R={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=i()),_-=t},this.rotateUp=function(t){void 0===t&&(t=i()),w-=t},this.panLeft=function(t){var e=this.object.matrix.elements;b.set(e[0],e[1],e[2]),b.multiplyScalar(-t),N.add(b)},this.panUp=function(t){var e=this.object.matrix.elements;b.set(e[4],e[5],e[6]),b.multiplyScalar(t),N.add(b)},this.pan=function(t,e){var n=c.domElement===document?c.domElement.body:c.domElement;if(void 0!==c.object.fov){var i=c.object.position.clone().sub(c.target).length();i*=Math.tan(c.object.fov/2*Math.PI/180),c.panLeft(2*t*i/n.clientHeight),c.panUp(2*e*i/n.clientHeight)}else void 0!==c.object.top?(c.panLeft(t*(c.object.right-c.object.left)/n.clientWidth),c.panUp(e*(c.object.top-c.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=o()),x/=t},this.dollyOut=function(t){void 0===t&&(t=o()),x*=t},this.update=function(){var t=this.object.position;g.copy(t).sub(this.target),g.applyQuaternion(C);var e=Math.atan2(g.x,g.z),n=Math.atan2(Math.sqrt(g.x*g.x+g.z*g.z),g.y);this.autoRotate&&this.rotateLeft(i()),e+=_,n+=w,n=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,n)),n=Math.max(1e-6,Math.min(Math.PI-1e-6,n));var o=g.length()*x;o=Math.max(this.minDistance,Math.min(this.maxDistance,o)),this.target.add(N),g.x=o*Math.sin(n)*Math.sin(e),g.y=o*Math.cos(n),g.z=o*Math.sin(n)*Math.cos(e),g.applyQuaternion(I),t.copy(this.target).add(g),this.object.lookAt(this.target),_=0,w=0,x=1,N.set(0,0,0),(O.distanceToSquared(this.object.position)>1e-6||8*(1-E.dot(this.object.quaternion))>1e-6)&&(this.dispatchEvent(U),O.copy(this.object.position),E.copy(this.object.quaternion))},this.reset=function(){P=S.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault(),r(t)},!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",l,!1),this.domElement.addEventListener("DOMMouseScroll",l,!1),this.domElement.addEventListener("touchstart",function(t){if(!1!==c.enabled){switch(t.touches.length){case 1:if(!0===c.noRotate)return;P=S.TOUCH_ROTATE,h.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===c.noZoom)return;P=S.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);y.set(0,i);break;case 3:if(!0===c.noPan)return;P=S.TOUCH_PAN,d.set(t.touches[0].pageX,t.touches[0].pageY);break;default:P=S.NONE}c.dispatchEvent(A)}},!1),this.domElement.addEventListener("touchend",function(){!1!==c.enabled&&(c.dispatchEvent(R),P=S.NONE)},!1),this.domElement.addEventListener("touchmove",function(t){if(!1!==c.enabled){t.preventDefault(),t.stopPropagation();var e=c.domElement===document?c.domElement.body:c.domElement;switch(t.touches.length){case 1:if(!0===c.noRotate)return;if(P!==S.TOUCH_ROTATE)return;u.set(t.touches[0].pageX,t.touches[0].pageY),p.subVectors(u,h),c.rotateLeft(2*Math.PI*p.x/e.clientWidth*c.rotateSpeed),c.rotateUp(2*Math.PI*p.y/e.clientHeight*c.rotateSpeed),h.copy(u),c.update();break;case 2:if(!0===c.noZoom)return;if(P!==S.TOUCH_DOLLY)return;var n=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,o=Math.sqrt(n*n+i*i);v.set(0,o),T.subVectors(v,y),T.y>0?c.dollyOut():c.dollyIn(),y.copy(v),c.update();break;case 3:if(!0===c.noPan)return;if(P!==S.TOUCH_PAN)return;f.set(t.touches[0].pageX,t.touches[0].pageY),m.subVectors(f,d),c.pan(m.x,m.y),d.copy(f),c.update();break;default:P=S.NONE}}},!1),this.update()},t.OrbitControls.prototype=Object.create(t.EventDispatcher.prototype)}),function(t,e){"use strict";"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define("bootstrap3-typeahead",["jquery"],function(t){return e(t)}):e(t.jQuery)}(this,function(t){"use strict";var e=function(e,n){this.$element=t(e),this.options=t.extend({},t.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"!=typeof this.options.autoSelect||this.options.autoSelect,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.source=this.options.source,this.delay=this.options.delay,this.$menu=t(this.options.menu),this.$appendTo=this.options.appendTo?t(this.options.appendTo):null,this.shown=!1,this.listen(),this.showHintOnFocus="boolean"==typeof this.options.showHintOnFocus&&this.options.showHintOnFocus,this.afterSelect=this.options.afterSelect,this.addItem=!1};e.prototype={constructor:e,select:function(){var t=this.$menu.find(".active").data("value");if(this.$element.data("active",t),this.autoSelect||t){var e=this.updater(t);this.$element.val(this.displayText(e)||e).change(),this.afterSelect(e)}return this.hide()},updater:function(t){return t},setSource:function(t){this.source=t},show:function(){var e,n=t.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return e="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight,(this.$appendTo?this.$menu.appendTo(this.$appendTo):this.$menu.insertAfter(this.$element)).css({top:n.top+n.height+e,left:n.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(e){if(this.query=void 0!==e&&null!==e?e:this.$element.val()||"",this.query.length<this.options.minLength)return this.shown?this.hide():this;var n=t.proxy(function(){t.isFunction(this.source)?this.source(this.query,t.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(n,this.delay)},process:function(e){var n=this;return e=t.grep(e,function(t){return n.matcher(t)}),(e=this.sorter(e)).length||this.options.addItem?(e.length>0?this.$element.data("active",e[0]):this.$element.data("active",null),this.options.addItem&&e.push(this.options.addItem),"all"==this.options.items?this.render(e).show():this.render(e.slice(0,this.options.items)).show()):this.shown?this.hide():this},matcher:function(t){return~this.displayText(t).toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var e,n=[],i=[],o=[];e=t.shift();){var r=this.displayText(e);r.toLowerCase().indexOf(this.query.toLowerCase())?~r.indexOf(this.query)?i.push(e):o.push(e):n.push(e)}return n.concat(i,o)},highlighter:function(e){var n,i,o,r,s,a=t("<div></div>"),l=this.query,c=e.toLowerCase().indexOf(l.toLowerCase());if(0===(n=l.length))return a.text(e).html();for(;c>-1;)i=e.substr(0,c),o=e.substr(c,n),r=e.substr(c+n),s=t("<strong></strong>").text(o),a.append(document.createTextNode(i)).append(s),e=r,c=e.toLowerCase().indexOf(l.toLowerCase());return a.append(document.createTextNode(e)).html()},render:function(e){var n=this,i=this,o=!1;return e=t(e).map(function(e,r){var s=i.displayText(r);return(e=t(n.options.item).data("value",r)).find("a").html(n.highlighter(s)),s==i.$element.val()&&(e.addClass("active"),i.$element.data("active",r),o=!0),e[0]}),this.autoSelect&&!o&&(e.first().addClass("active"),this.$element.data("active",e.first().data("value"))),this.$menu.html(e),this},displayText:function(t){return t.name||t},next:function(){var e=this.$menu.find(".active").removeClass("active").next();e.length||(e=t(this.$menu.find("li")[0])),e.addClass("active")},prev:function(){var t=this.$menu.find(".active").removeClass("active").prev();t.length||(t=this.$menu.find("li").last()),t.addClass("active")},listen:function(){this.$element.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("keypress",t.proxy(this.keypress,this)).on("keyup",t.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",t.proxy(this.keydown,this)),this.$menu.on("click",t.proxy(this.click,this)).on("mouseenter","li",t.proxy(this.mouseenter,this)).on("mouseleave","li",t.proxy(this.mouseleave,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.off("focus").off("blur").off("keypress").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove()},eventSupported:function(t){var e=t in this.$element;return e||(this.$element.setAttribute(t,"return;"),e="function"==typeof this.$element[t]),e},move:function(t){if(this.shown){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:if(t.shiftKey)return;t.preventDefault(),this.prev();break;case 40:if(t.shiftKey)return;t.preventDefault(),this.next()}t.stopPropagation()}},keydown:function(e){this.suppressKeyPressRepeat=~t.inArray(e.keyCode,[40,38,9,13,27]),this.shown||40!=e.keyCode?this.move(e):this.lookup()},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.stopPropagation(),t.preventDefault()},focus:function(){this.focused||(this.focused=!0,this.options.showHintOnFocus&&this.lookup(""))},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(e){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),t(e.currentTarget).addClass("active")},mouseleave:function(){}};var n=t.fn.typeahead;t.fn.typeahead=function(n){var i=arguments;return"string"==typeof n&&"getActive"==n?this.data("active"):this.each(function(){var o=t(this),r=o.data("typeahead"),s="object"==typeof n&&n;r||o.data("typeahead",r=new e(this,s)),"string"==typeof n&&(i.length>1?r[n].apply(r,Array.prototype.slice.call(i,1)):r[n]())})},t.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a href="#" role="option"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:t.noop,delay:0,addItem:!1},t.fn.typeahead.Constructor=e,t.fn.typeahead.noConflict=function(){return t.fn.typeahead=n,this},t(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(){var e=t(this);e.data("typeahead")||e.typeahead(e.data())})}),define("componentSearcher",["dataFlow/dataFlow_loader","underscore","jquery","bootstrap","bootstrap3-typeahead"],function(t,e,n){function i(t){this.$input=t,this.init()}var o=[];return t.iterateComponents(function(t,e){o.push({functionName:t,name:e.label,shortDescription:e.desc}),e.label&&e.desc||console&&console.warn(t+" lacks a name or description field. It will not be searchable.")}),i.prototype.init=function(){var t=this.$input,e=this,i=function(t,e){var n=new RegExp(this.query||e,"i");return(t.name+" "+t.shortDescription).search(n)>-1};t.on("submit",function(t){t.preventDefault()}),t.keyup(function(e){27===e.keyCode&&(t.val(""),t.data("active",null))}),t.typeahead({source:o,highlighter:function(t){var e=t.name+" / "+t.shortDescription,n=new RegExp(this.query,"gi");return e.replace(n,function(t){return"<strong>"+t+"</strong>"})},displayText:function(t){return t},matcher:i,sorter:function(t){for(var e,n=[],i=[],o=[],r=new RegExp(this.query,"i");e=t.pop();)0===e.name.search(r)?n.splice(0,0,e):e.name.search(r)>-1?n.push(e):e.shortDescription.search(r)>-1?i.push(e):o.push(e);return n.concat(i,o)},afterSelect:function(){var o=t.typeahead("getActive");o&&!0===i(o,t.val())&&n(e).trigger("selectedComponent",[o]),t.val("")}})},i.prototype.destroy=function(){this.$input.typeahead("destroy"),this.$input.remove()},i}),define("dataFlow/UI/workspaceView",["jquery","dataFlow/UI/contextMenuJupyter","dataFlow/enums","dataFlow/UI/helpTooltips","three","CSS3DRenderer","OrbitControls","underscore","backbone"],function(t,e,n,i,o){function r(){s=this,this.init()}_.extend(o.CSS3DObject.prototype,Backbone.Events,{addDraggableScopes:function(t){this.draggableScopes=_.union(this.draggableScopes||[],t)},addDroppableScopes:function(t){this.dropableScopes=_.union(this.dropableScopes||[],t)},getDroppableScopes:function(){return this.dropableScopes||[]},getDraggableScopes:function(){return this.draggableScopes||[]},isDroppableForScopes:function(t){return(-1===this.getDroppableScopes().indexOf("input")||-1!==t.indexOf("input"))&&((-1===this.getDroppableScopes().indexOf("output")||-1!==t.indexOf("output"))&&(t.indexOf(n.OUTPUT_TYPES.WILD)>-1||this.getDraggableScopes().indexOf(n.OUTPUT_TYPES.WILD)>-1||_.without(_.intersection(this.getDroppableScopes(),t),"input","output").length>0))},dropObject:function(t,e){this.trigger("drop",t,e)}}),_.extend(o.Mesh.prototype,Backbone.Events,{setHomePosition:function(){this.homePosition=this.position.clone()},getHomePosition:function(){return this.homePosition}});var s=null;r.prototype.init=function(){_.extend(this,Backbone.Events),_.bindAll(this,"destroy","drag","render","mouseUp","clearHover","setupDraggableView","startDraggingObject","getCurrentVisibleCenterPoint","hideChooser"),this.dragObject=null,this.dragOffset=[0,0],this.width=window.innerWidth,this.height=window.innerHeight,this.camera=new o.PerspectiveCamera(70,this.width/this.height,1,1e6),this.camera.position.z=1200},r.prototype.createWorkspace=function(){this.glscene=new o.Scene,this.glrenderer=new o.WebGLRenderer,this.glrenderer.setSize(this.width,this.height),document.body.appendChild(this.glrenderer.domElement),this.glrenderer.domElement.className="TOP",this.scene=new o.Scene,this.renderer=new o.CSS3DRenderer({alpha:!0}),this.renderer.setSize(this.width,this.height),document.body.appendChild(this.renderer.domElement),this.renderer.domElement.className="TOP",this.attachControls(),this.setupContextMenu(),this.helpTooltips=new i,this.setupDraggableEventHandlers(),l()},r.prototype.destroy=function(){this.helpTooltips.destroy(),delete this.helpTooltips,t(this.renderer.domElement).off().remove(),t(this.glrenderer.domElement).off().remove(),delete this.controls,delete this.scene,delete this.camera};var a={},l=_.once(function(){a[n.KEYS.SHIFT]=!1;window.onkeydown=function(t){t||(t=window.event),t.keyCode===n.KEYS.SHIFT&&(a[n.KEYS.SHIFT]=!0)},window.onkeyup=function(t){t||(t=window.event),t.keyCode===n.KEYS.SHIFT&&(a[n.KEYS.SHIFT]=!1)}});return r.prototype.toJSON=function(){var t=this.camera;return window.camera=this.camera,{camera:{position:t.position.toArray(),rotation:t.rotation.toArray()},controls:{target:this.controls.target.toArray()}}},r.prototype.fromJSON=function(t){if(t){if(t.camera){var e=["position","rotation","scale"],n=this.camera;_.each(e,function(e){t.camera[e]&&n[e].fromArray(t.camera[e])}),n.updateMatrixWorld(!0)}t.controls&&t.controls.target&&(this.controls.target.fromArray(t.controls.target),this.controls.target0.fromArray(t.controls.target),this.controls.update()),this.render()}},r.prototype.render=function(){this.renderer.render(this.scene,this.camera),this.glrenderer.render(this.glscene,this.camera)},r.prototype.attachControls=function(){this.controls=new o.OrbitControls(this.camera,this.renderer.domElement);var e=t(this.renderer.domElement);e.on("mouseleave",".freezeZooming",function(){e.removeClass("freezeZooming")}),e.on("mouseenter",".freezeZooming",function(){e.addClass("freezeZooming")}),this.controls.noRotate=!0,this.controls.zoomSpeed=.8,this.controls.addEventListener("change",this.render),t(this.controls.domElement).on("dblclick",{workspace:this},this.showChooser),t(this.controls.domElement).on("click",{workspace:this},this.hideChooser),this.render()},r.prototype.showChooser=function(e){var n=e.data.workspace,i={x:e.clientX,y:e.clientY},o=n.unprojectMouse(e.clientX,e.clientY),r=n.mouseWorldXYPosition(o),s=t('<input id="mobileSearcher" class="mobileComponentSearchInput"/>');t("body").append(s),s.css({top:i.y,left:i.x}).focus(),require(["componentSearcher"],function(e){n.searcher=new e(s),t(n.searcher).on("selectedComponent",function(t,e){e.position=r,n.trigger("createNewComponent",e),n.hideChooser()})})},r.prototype.hideChooser=function(){this.searcher&&this.searcher.destroy()},r.prototype.enableControls=function(t){this.controls.enabled=t},r.prototype.getCurrentVisibleCenterPoint=function(){return{x:this.camera.position.x,y:this.camera.position.y}},r.prototype.mouseUp=function(t){if(!_.isNull(this.dragObject)){var e=this.glDragObject.getHomePosition();if(_.isUndefined(e)||(this.dragObject.position.set(e.x,e.y,0),this.glDragObject.position.set(e.x,e.y,0),this.glDragObject.updateMatrixWorld(),this.glDragObject.trigger("changePosition"),this.render()),!_.isNull(this.hoverObject)){var n=a;-1!==this.hoverObject.getDroppableScopes().indexOf("output")?this.hoverObject.dropObject(this.dragObject,n):this.dragObject.dropObject(this.hoverObject,n)}this.dragObject=null,this.glDragObject=null,this.dragOffset={},this.renderer.domElement.removeEventListener("mousemove",this.drag),this.renderer.domElement.removeEventListener("mouseup",this.mouseUp)}_.isNull(this.hoverObject)||this.clearHover()},r.prototype.startDraggingObject=function(t){this.renderer.domElement.addEventListener("mousemove",this.drag),this.renderer.domElement.addEventListener("mouseup",this.mouseUp);var e=this.unprojectMouse(t.clientX,t.clientY),n=this.mouseWorldXYPosition(e);this.dragObject=t.object.cssObject,this.glDragObject=t.object.glObject,this.hoverObject=null,this.glHoverObject=null,this.dragOffset={x:n.x-this.dragObject.position.x,y:n.y-this.dragObject.position.y},this.intersectionObjects=this.computeDroppableObjects()},r.prototype.setupContextMenu=function(){t("div.TOP").on("contextmenu","div.draggable",function(n){n.stopPropagation(),n.preventDefault();var i=t(n.currentTarget).data("viewObject"),o=n.clientX,r=n.clientY;_.isUndefined(i.component)||new e({x:o,y:r,model:i.component})})},r.prototype.setupDraggableEventHandlers=function(){var e,n=this;t("div.TOP").on("mousedown","div.draggable",function(l){0===l.button&&!1!==n.controls.enabled&&(e=t(l.currentTarget).data("viewObject"),l.object=e,n.startDraggingObject(l),a++,_.isNull(i)&&(i=setTimeout(function(){clearTimeout(i),i=null,r=!0},o)),s||(s=setTimeout(function(){clearTimeout(s),s=null,!0===r?console.log("drag"):1===a&&function(t){"function"!=typeof e.click||_.isUndefined(t)||e.click(t.clientX,t.clientY)}(l),a=0},o)))}).on("mouseup","div.draggable",function(t){_.isNull(i)||(clearTimeout(i),i=null,r=!1)}).on("mouseout","div.draggable",function(){}).on("dblclick","div.draggable",function(t){t.stopPropagation(),"function"==typeof e.doubleclick?e.doubleclick():console.log("No doubleclick handler for view: ",e)});var i=null,o=200,r=!1,s=null,a=0},r.prototype.setupDraggableView=function(e){if(_.isUndefined(e.cssObject)||_.isUndefined(e.glObject))throw new Error("Draggable views must have both cssObject and glObject properties");t(e.cssObject.element).data("viewObject",e)},r.prototype.computeDroppableObjects=function(){function t(o){o===i.glDragObject||o===i.glscene||_.isUndefined(o.IOView)||o.IOView.cssObject.isDroppableForScopes(n)&&e.push(o),_.each(o.children,t)}var e=[],n=this.dragObject.getDraggableScopes(),i=this;return t(i.glscene),e},r.prototype.drag=function(t){event.preventDefault();var e=this.unprojectMouse(t.clientX,t.clientY),n=this.mouseWorldXYPosition(e);this.dragObject.position.set(n.x-this.dragOffset.x,n.y-this.dragOffset.y,0),this.glDragObject.position.set(n.x-this.dragOffset.x,n.y-this.dragOffset.y,0),this.glDragObject.trigger("changePosition"),this.findIntersections(e),this.render()},r.prototype.unprojectMouse=function(t,e){var n=new o.Vector3(t/this.glrenderer.domElement.clientWidth*2-1,-e/this.glrenderer.domElement.clientHeight*2+1,.5);return n.unproject(this.camera),n},r.prototype.mouseWorldXYPosition=function(t){if(void 0!==this.camera.fov){var e=t.clone().sub(this.camera.position).normalize(),n=-this.camera.position.z/e.z;return this.camera.position.clone().add(e.multiplyScalar(n))}},r.prototype.findIntersections=function(t){var e=new o.Raycaster(this.camera.position,t.clone().sub(this.camera.position).normalize()).intersectObjects(this.intersectionObjects,!0);if(e.length>0&&_.isNull(this.hoverObject)){var n=e[0];this.glHoverObject=n.object,this.hoverObject=n.object.IOView.cssObject,this.hoverObject.element.className+=" glHover"}_.isNull(this.hoverObject)||0!==e.length&&e[0].object===this.glHoverObject||this.clearHover()},r.prototype.clearHover=function(){this.hoverObject.element.className=this.hoverObject.element.className.replace(" glHover",""),this.glHoverObject=null,this.hoverObject=null},r.prototype.drawCurveFromPointToPoint=function(t,e,n){for(var i=Math.min(200,Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),r=new o.Vector3(Math.max(t.x+i,t.x+2*(e.x-t.x)/3),t.y,0),s=new o.Vector3(Math.min(e.x-i,e.x-2*(e.x-t.x)/3),e.y,0),a=new o.CubicBezierCurve3(t,r,s,e),l=_.isUndefined(n),c=l?new o.Geometry:n.geometry,h=a.getPoints(30),u=0;u<h.length;u++)c.vertices[u]=h[u];if(c.verticesNeedUpdate=!0,l){var p=new o.LineBasicMaterial({color:16777215});(n=new o.Line(c,p)).frustumCulled=!1}return n},{getWorkspaceSingleton:function(){return s},Workspace:r}}),define("text",["module"],function(t){"use strict";function e(t,e){return void 0===t||""===t?e:t}var n,i,o,r,s,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,h="undefined"!=typeof location&&location.href,u=h&&location.protocol&&location.protocol.replace(/\:/,""),p=h&&location.hostname,d=h&&(location.port||void 0),f={},m=t.config&&t.config()||{};return n={version:"2.0.15",strip:function(t){if(t){var e=(t=t.replace(l,"")).match(c);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var t,e,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){n=a[e];try{t=new ActiveXObject(n)}catch(t){}if(t){a=[n];break}}return t},parseName:function(t){var e,n,i,o=!1,r=t.lastIndexOf("."),s=0===t.indexOf("./")||0===t.indexOf("../");return-1!==r&&(!s||r>1)?(e=t.substring(0,r),n=t.substring(r+1)):e=t,i=n||e,-1!==(r=i.indexOf("!"))&&(o="strip"===i.substring(r+1),i=i.substring(0,r),n?n=i:e=i),{moduleName:e,ext:n,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,o,r){var s,a,l,c=n.xdRegExp.exec(t);return!c||(s=c[2],a=c[3],a=a.split(":"),l=a[1],a=a[0],(!s||s===i)&&(!a||a.toLowerCase()===o.toLowerCase())&&(!l&&!a||function(t,n,i,o){if(n===o)return!0;if(t===i){if("http"===t)return e(n,"80")===e(o,"80");if("https"===t)return e(n,"443")===e(o,"443")}return!1}(s,l,i,r)))},finishLoad:function(t,e,i,o){i=e?n.strip(i):i,m.isBuild&&(f[t]=i),o(i)},load:function(t,e,i,o){if(o&&o.isBuild&&!o.inlineText)i();else{m.isBuild=o&&o.isBuild;var r=n.parseName(t),s=r.moduleName+(r.ext?"."+r.ext:""),a=e.toUrl(s),l=m.useXhr||n.useXhr;0!==a.indexOf("empty:")?!h||l(a,u,p,d)?n.get(a,function(e){n.finishLoad(t,r.strip,e,i)},function(t){i.error&&i.error(t)}):e([s],function(t){n.finishLoad(r.moduleName+"."+r.ext,r.strip,t,i)}):i()}},write:function(t,e,i,o){if(f.hasOwnProperty(e)){var r=n.jsEscape(f[e]);i.asModule(t+"!"+e,"define(function () { return '"+r+"';});\n")}},writeFile:function(t,e,i,o,r){var s=n.parseName(e),a=s.ext?"."+s.ext:"",l=s.moduleName+a,c=i.toUrl(s.moduleName+a)+".js";n.load(l,i,function(e){var i=function(t){return o(c,t)};i.asModule=function(t,e){return o.asModule(t,c,e)},n.write(t,l,i,r)},r)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),n.get=function(t,e,n){try{var o=i.readFileSync(t,"utf8");"\ufeff"===o[0]&&(o=o.substring(1)),e(o)}catch(t){n&&n(t)}}):"xhr"===m.env||!m.env&&n.createXhr()?n.get=function(t,e,i,o){var r,s=n.createXhr();if(s.open("GET",t,!0),o)for(r in o)o.hasOwnProperty(r)&&s.setRequestHeader(r.toLowerCase(),o[r]);m.onXhr&&m.onXhr(s,t),s.onreadystatechange=function(n){var o,r;4===s.readyState&&((o=s.status||0)>399&&o<600?((r=new Error(t+" HTTP status: "+o)).xhr=s,i&&i(r)):e(s.responseText),m.onXhrComplete&&m.onXhrComplete(s,t))},s.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(t,e){var n,i,o=new java.io.File(t),r=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),"utf-8")),a="";try{for(n=new java.lang.StringBuffer,(i=s.readLine())&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=s.readLine());)n.append(r),n.append(i);a=String(n.toString())}finally{s.close()}e(a)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(o=Components.classes,r=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in o,n.get=function(t,e){var n,i,a,l={};s&&(t=t.replace(/\//g,"\\")),a=new FileUtils.File(t);try{(n=o["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream)).init(a,1,0,!1),(i=o["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream)).init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),l),i.close(),n.close(),e(l.value)}catch(t){throw new Error((a&&a.path||"")+": "+t)}}),n}),define("text!lib/css/handsontable.min.css",[],function(){return'/*!\n * (The MIT License)\n * \n * Copyright (c) 2012-2014 Marcin Warpechowski\n * Copyright (c) 2015 Handsoncode sp. z o.o. <hello@handsoncode.net>\n * \n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \'Software\'), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n * \n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \'AS IS\', WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Version: 0.35.0\n * Release date: 06/12/2017 (built at 06/12/2017 09:46:21)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0 4px}.col-lg-1.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-md-1.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable.htAutoSize{visibility:hidden;left:-99000px;position:absolute;top:-99000px}.handsontable .wtHider{width:0}.handsontable .wtSpreader{position:relative;width:0;height:auto}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:0}.handsontable table.htCore{border-collapse:separate;border-spacing:0;margin:0;border-width:0;table-layout:fixed;width:0;outline-width:0;max-width:none;max-height:none}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{border-top-width:0;border-left-width:0;border-right:1px solid #ccc;border-bottom:1px solid #ccc;height:22px;empty-cells:show;line-height:21px;padding:0 4px;background-color:#fff;vertical-align:top;overflow:hidden;outline-width:0;white-space:pre-line;background-clip:padding-box}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}.handsontable th:last-child{border-right:1px solid #ccc;border-bottom:1px solid #ccc}.handsontable th.htNoFrame,.handsontable th:first-child.htNoFrame,.handsontable tr:first-child th.htNoFrame{border-left-width:0;background-color:#fff;border-color:#fff}.handsontable .htNoFrame+td,.handsontable .htNoFrame+th,.handsontable.htRowHeaders thead tr th:nth-child(2),.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,.ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable tbody tr th{border-right-width:0}.ht_master:not(.innerBorderTop) thead tr.lastChild th,.ht_master:not(.innerBorderTop) thead tr:last-child th,.ht_master:not(.innerBorderTop)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f3f3f3;color:#222;text-align:center;font-weight:400;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable.ht__selection--columns thead th.ht__highlight,.handsontable.ht__selection--rows tbody th.ht__highlight{background-color:#8eb0e7;color:#000}#hot-display-license-info{font-size:9px;color:#323232;padding:5px 0 3px;font-family:Helvetica,Arial,sans-serif;text-align:left}.handsontable .manualColumnResizer{position:fixed;top:0;cursor:col-resize;z-index:6;width:5px;height:25px}.handsontable .manualRowResizer{position:fixed;left:0;cursor:row-resize;z-index:6;height:5px;width:50px}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#aab}.handsontable .manualColumnResizerGuide{position:fixed;right:0;top:0;background-color:#aab;display:none;width:0;border-right:1px dashed #777;margin-left:5px}.handsontable .manualRowResizerGuide{position:fixed;left:0;bottom:0;background-color:#aab;display:none;height:0;border-bottom:1px dashed #777;margin-top:5px}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:7}.handsontable .columnSorting{position:relative}.handsontable .columnSorting:hover{text-decoration:underline;cursor:pointer}.handsontable .columnSorting.ascending:after{content:"\\25B2";color:#5f5f5f;position:absolute;right:-15px}.handsontable .columnSorting.descending:after{content:"\\25BC";color:#5f5f5f;position:absolute;right:-15px}.handsontable .wtBorder{position:absolute;font-size:0}.handsontable .wtBorder.hidden{display:none!important}.handsontable td.area{background:linear-gradient(180deg,rgba(181,209,255,.34) 0,rgba(181,209,255,.34));filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#57b5d1ff",endColorstr="#57b5d1ff",GradientType=0);background-color:#fff}.handsontable .wtBorder.corner{font-size:0;cursor:crosshair}.handsontable .htBorder.htFillBorder{background:red;width:1px;height:1px}.handsontableInput{border:none;outline-width:0;margin:0;padding:1px 5px 0;font-family:inherit;line-height:21px;font-size:inherit;box-shadow:inset 0 0 0 2px #5292f7;resize:none;display:block;color:#000;border-radius:0;background-color:#fff}.handsontableInputHolder{position:absolute;top:0;left:0;z-index:1}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{content:"\\25B6";color:#777;position:absolute;right:5px}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable .htAutocompleteArrow{float:right;font-size:10px;color:#eee;cursor:default;width:16px;text-align:center}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block;vertical-align:middle}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{cursor:pointer;display:inline-block;width:100%}@-webkit-keyframes a{0%{opacity:1}to{opacity:0}}@keyframes a{0%{opacity:1}to{opacity:0}}@-webkit-keyframes b{0%{opacity:0}to{opacity:1}}@keyframes b{0%{opacity:0}to{opacity:1}}.handsontable .handsontable.ht_clone_top .wtHider{padding:0 0 5px}.handsontable .autocompleteEditor.handsontable{padding-right:17px}.handsontable .autocompleteEditor.handsontable.htMacScroll{padding-right:15px}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{border:1px solid #ccc;border-collapse:separate;background:#fff}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent}.handsontable.listbox td,.handsontable.listbox th{white-space:nowrap;text-overflow:ellipsis}.handsontable.listbox td.htDimmed{cursor:default;color:inherit;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr:hover td,.handsontable.listbox tr td.current{background:#eee}.ht_clone_top{z-index:2}.ht_clone_left{z-index:3}.ht_clone_bottom_left_corner,.ht_clone_debug,.ht_clone_top_left_corner{z-index:4}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.htBordered{border-width:1px}.htBordered.htTopBorderSolid{border-top-style:solid;border-top-color:#000}.htBordered.htRightBorderSolid{border-right-style:solid;border-right-color:#000}.htBordered.htBottomBorderSolid{border-bottom-style:solid;border-bottom-color:#000}.htBordered.htLeftBorderSolid{border-left-style:solid;border-left-color:#000}.handsontable tbody tr th:nth-last-child(2){border-right:1px solid #ccc}.handsontable thead tr:nth-last-child(2) th.htGroupIndicatorContainer{border-bottom:1px solid #ccc;padding-bottom:5px}.ht_clone_top_left_corner thead tr th:nth-last-child(2){border-right:1px solid #ccc}.htCollapseButton{width:10px;height:10px;line-height:10px;text-align:center;border-radius:5px;border:1px solid #f3f3f3;box-shadow:1px 1px 3px rgba(0,0,0,.4);cursor:pointer;margin-bottom:3px;position:relative}.htCollapseButton:after{content:"";height:300%;width:1px;display:block;background:#ccc;margin-left:4px;position:absolute;bottom:10px}thead .htCollapseButton{right:5px;position:absolute;top:5px;background:#fff}thead .htCollapseButton:after{height:1px;width:700%;right:10px;top:4px}.handsontable tr th .htExpandButton{position:absolute;width:10px;height:10px;line-height:10px;text-align:center;border-radius:5px;border:1px solid #f3f3f3;box-shadow:1px 1px 3px rgba(0,0,0,.4);cursor:pointer;top:0;display:none}.handsontable thead tr th .htExpandButton{top:5px}.handsontable tr th .htExpandButton.clickable{display:block}.collapsibleIndicator{position:absolute;top:50%;transform:translateY(-50%);right:5px;border:1px solid #a6a6a6;line-height:10px;color:#222;border-radius:10px;font-size:10px;width:10px;height:10px;cursor:pointer;box-shadow:0 0 0 6px #eee;background:#eee}.handsontable col.hidden{width:0!important}.handsontable table tr th.lightRightBorder{border-right:1px solid #e6e6e6}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_left,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.ht_clone_left .wtHolder{overflow-x:hidden;overflow-y:auto}.ht_clone_bottom .wtHolder,.ht_clone_top .wtHolder{overflow-x:auto;overflow-y:hidden}.wtDebugHidden{display:none}.wtDebugVisible{display:block;-webkit-animation-duration:.5s;-webkit-animation-name:c;animation-duration:.5s;animation-name:c}@keyframes c{0%{display:none;opacity:0}1%{display:block;opacity:0}to{display:block;opacity:1}}@-webkit-keyframes c{0%{display:none;opacity:0}1%{display:block;opacity:0}to{display:block;opacity:1}}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch}.htMobileEditorContainer{display:none;position:absolute;top:0;width:70%;height:54pt;background:#f8f8f8;border-radius:20px;border:1px solid #ebebeb;z-index:8;box-sizing:border-box;-webkit-box-sizing:border-box;-webkit-text-size-adjust:none}.topLeftSelectionHandle-HitArea:not(.ht_master .topLeftSelectionHandle-HitArea),.topLeftSelectionHandle:not(.ht_master .topLeftSelectionHandle){z-index:11}.bottomRightSelectionHandle,.bottomRightSelectionHandle-HitArea,.topLeftSelectionHandle,.topLeftSelectionHandle-HitArea{left:-10000px;top:-10000px}.htMobileEditorContainer.active{display:block}.htMobileEditorContainer .inputs{position:absolute;right:210pt;bottom:10pt;top:10pt;left:14px;height:34pt}.htMobileEditorContainer .inputs textarea{font-size:13pt;border:1px solid #a1a1a1;-webkit-appearance:none;box-shadow:none;position:absolute;left:14px;right:14px;top:0;bottom:0;padding:7pt}.htMobileEditorContainer .cellPointer{position:absolute;top:-13pt;height:0;width:0;left:30px;border-left:13pt solid transparent;border-right:13pt solid transparent;border-bottom:13pt solid #ebebeb}.htMobileEditorContainer .cellPointer.hidden{display:none}.htMobileEditorContainer .cellPointer:before{content:"";display:block;position:absolute;top:2px;height:0;width:0;left:-13pt;border-left:13pt solid transparent;border-right:13pt solid transparent;border-bottom:13pt solid #f8f8f8}.htMobileEditorContainer .moveHandle{position:absolute;top:10pt;left:5px;width:30px;bottom:0;cursor:move;z-index:11}.htMobileEditorContainer .moveHandle:after{content:"..\\A..\\A..\\A..";white-space:pre;line-height:10px;font-size:20pt;display:inline-block;margin-top:-8px;color:#ebebeb}.htMobileEditorContainer .positionControls{width:205pt;position:absolute;right:5pt;top:0;bottom:0}.htMobileEditorContainer .positionControls>div{width:50pt;height:100%;float:left}.htMobileEditorContainer .positionControls>div:after{content:" ";display:block;width:15pt;height:15pt;text-align:center;line-height:50pt}.htMobileEditorContainer .downButton:after,.htMobileEditorContainer .leftButton:after,.htMobileEditorContainer .rightButton:after,.htMobileEditorContainer .upButton:after{transform-origin:5pt 5pt;-webkit-transform-origin:5pt 5pt;margin:21pt 0 0 21pt}.htMobileEditorContainer .leftButton:after{border-top:2px solid #288ffe;border-left:2px solid #288ffe;-webkit-transform:rotate(-45deg)}.htMobileEditorContainer .leftButton:active:after{border-color:#cfcfcf}.htMobileEditorContainer .rightButton:after{border-top:2px solid #288ffe;border-left:2px solid #288ffe;-webkit-transform:rotate(135deg)}.htMobileEditorContainer .rightButton:active:after{border-color:#cfcfcf}.htMobileEditorContainer .upButton:after{border-top:2px solid #288ffe;border-left:2px solid #288ffe;-webkit-transform:rotate(45deg)}.htMobileEditorContainer .upButton:active:after{border-color:#cfcfcf}.htMobileEditorContainer .downButton:after{border-top:2px solid #288ffe;border-left:2px solid #288ffe;-webkit-transform:rotate(225deg)}.htMobileEditorContainer .downButton:active:after{border-color:#cfcfcf}.handsontable.hide-tween{-webkit-animation:a .3s;animation:a .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:b .3s;animation:b .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.htCommentCell{position:relative}.htCommentCell:after{content:"";position:absolute;top:0;right:0;border-left:6px solid transparent;border-top:6px solid #000}.htComments{display:none;z-index:9;position:absolute}.htCommentTextArea{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216);box-sizing:border-box;border:none;border-left:3px solid #ccc;background-color:#fff;width:215px;height:90px;font-size:12px;padding:5px;outline:0!important;-webkit-appearance:none}.htCommentTextArea:focus{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216),inset 0 0 0 1px #5292f7;border-left:3px solid #5292f7}\n/*!\n * Handsontable ContextMenu\n */.htContextMenu{display:none;position:absolute;z-index:10}.htContextMenu .ht_clone_corner,.htContextMenu .ht_clone_debug,.htContextMenu .ht_clone_left,.htContextMenu .ht_clone_top{display:none}.htContextMenu table.htCore{border:1px solid #ccc;border-bottom-width:2px;border-right-width:2px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htContextMenu table tbody tr td:first-child{border:0}.htContextMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #bbb;height:0;padding:0;cursor:default}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}.htContextMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea#HandsontableCopyPaste{position:fixed!important;top:0!important;right:100%!important;overflow:hidden;opacity:0;outline:0 none!important}.htRowHeaders .ht_master.innerBorderLeft~.ht_clone_left td:first-of-type,.htRowHeaders .ht_master.innerBorderLeft~.ht_clone_top_left_corner th:nth-child(2){border-left:0 none}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{position:absolute;height:100%;display:none}.handsontable .ht__manualColumnMove--guideline{background:#757575;width:2px;top:0;margin-left:-1px;z-index:5}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:5;pointer-events:none}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{position:absolute;width:100%;display:none}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:5}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:5;pointer-events:none}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}'}),define("HandsontableWrapper",["Handsontable","jquery","text!lib/css/handsontable.min.css"],function(t,e,n){return e("head").append("<style type='text/css'>"+n+"</style>"),t}),define("dataFlow/UI/tableValueEnterer",["jquery","underscore","dataFlow/dataTree","HandsontableWrapper","dataFlow/enums"],function(t,e,n,i,o){function r(t,e,n,i,o,r){this.init.apply(this,arguments)}var s={};return s[o.OUTPUT_TYPES.NUMBER]={type:"numeric"},s[o.OUTPUT_TYPES.STRING]={type:"text"},s[o.OUTPUT_TYPES.BOOLEAN]={type:"checkbox"},r.prototype.init=function(t,n,i,o,r,s){this.callback=o,this.data=t,this.dataType=r,this.readOnly=!!s,e.bindAll(this,"dataAsArrayOfArrays","initializeTable","cleanDataArray"),this.overlay=this.createOverlay(),this.$tableContainer=this.insertTable(n,i);var a=this.dataAsArrayOfArrays(t);this.dataArray=a[0],this.dataHeaderArray=a[1],this.initializeTable()},r.prototype.initializeTable=function(){var t=this;this.table=new i(this.$tableContainer.find("#editableTable").get(0),{data:t.dataArray,contextMenu:!0,colWidths:100,minSpareRows:50,rowHeaders:!t.readOnly||function(e){return t.dataHeaderArray[e]||""},columns:[s[t.dataType]]})},r.prototype.dataAsArrayOfArrays=function(t){var n=[],i=[];return t.recurseTree(function(t,o){var r="{"+o.getPath().join(";")+"}";e.each(t,function(t,e){n.push([t.toString()]),i.push(r+" ("+e+")")})}),[n,i]},r.prototype.createOverlay=function(){var e="overlay_"+Math.floor(1e4*Math.random()),n=t("<div id='"+e+"' class='TOP workspaceOverlay'></div>");t("body").append(n);var i=this;return n.on("click",function(){i.overlay.off(),i.overlay.remove(),i.destroy()}),n},r.prototype.cleanDataArray=function(){return this.dataType===o.OUTPUT_TYPES.NUMBER?e.map(e.filter(this.dataArray,function(t){return!(e.isEmpty(t)||e.isUndefined(t[0])||e.isNull(t[0])||e.isNaN(Number(t[0])))}),function(t){return Number(t[0])}):this.dataType===o.OUTPUT_TYPES.STRING?e.map(e.filter(this.dataArray,function(t){return!e.isEmpty(t)&&!e.isEmpty(t[0])}),function(t){return t[0]}):this.dataType===o.OUTPUT_TYPES.BOOLEAN?(console.warn("NOT IMPLEMENTED: PARSING FOR BOOLEANS"),!0):void 0},r.prototype.destroy=function(){this.table.deselectCell();var t=this;e.delay(function(){t.table.destroy(),t.$tableContainer.remove(),"function"!=typeof t.callback||t.readOnly||(t.data.setDataAtPath(t.cleanDataArray(),[0]),t.callback(t.data))},10)},r.prototype.insertTable=function(e,n){var i=t("<div class='tableView'><div id='editableTable' style='position:relative; overflow: hidden; height: 200px;'></div></div>");return i.css({top:n,left:e,height:200,width:150,"z-index":102,position:"absolute",display:"block"}),t("body").append(i),i},r}),define("dataFlow/UI/inputOutputView",["dataFlow/dataFlow_loader","dataFlow/UI/workspaceView","underscore","dataFlow/enums","three"],function(t,e,n,i,o){function r(t,o,r){if(n.isUndefined(t)||n.isUndefined(o)||n.isUndefined(r))throw new Error("IOView must be passed a model and associated GL and CSS Views");this.model=t,this.glObject=o,this.cssObject=r,this.model.IOView=this,this.glObject.IOView=this,this.cssObject.IOView=this,n.extend(this,Backbone.Events),this._remove=function(){this.stopListening(),this.stretchy.parent.remove(this.stretchy),this.glObject.parent.remove(this.glObject),this.cssObject.parent.remove(this.cssObject),delete this.glObject.IOView,delete this.cssObject.IOView,delete this.model.IOView,delete this.model,delete this.glObject,delete this.cssObject},this.setupStretchyWire=function(){this.glObject.setHomePosition(),this.stretchy=e.getWorkspaceSingleton().drawCurveFromPointToPoint(this.glObject.getHomePosition(),this.glObject.position),this.glObject.parent.add(this.stretchy),this.stretchyCurveArguments=[o.position,o.getHomePosition()],this.listenTo(this.glObject,"changePosition",function(){e.getWorkspaceSingleton().drawCurveFromPointToPoint(this.stretchyCurveArguments[0],this.stretchyCurveArguments[1],this.stretchy)})},this.doubleclick=function(){this.model.getTree().log()};var s=this;this.click=function(t,e){if(s.model.type===i.OUTPUT_TYPES.NUMBER||s.model.type===i.OUTPUT_TYPES.BOOLEAN||s.model.type===i.OUTPUT_TYPES.STRING){var n=s.model.get("persistedData")||new DataTree,o=function(t){s.model.assignPersistedData(t)};require(["dataFlow/UI/tableValueEnterer"],function(i){new i(n,t,e,o,s.model.type)})}},e.getWorkspaceSingleton().setupDraggableView(this),this.setupStretchyWire()}function s(t,e,o){r.call(this,t,e,o),this.connectedOutputViews=[],this.connectionWires=[];var s=this;this.listenTo(this.glObject.parent,"changePosition",function(){n.each(this.connectedOutputViews,function(t,e){s.redrawWireForConnectedOutput(t,s.connectionWires[e])})}),this.listenTo(this.cssObject,"drop",function(t,e){!0===e[i.KEYS.SHIFT]?this.model.connectAdditionalOutput(t.IOView.model,!0):this.model.connectOutput(t.IOView.model)}),this.listenTo(this.model,"connectedOutput",this.connectToOutput),this.listenTo(this.model,"disconnectedOutput",this.disconnectFromOutput)}function a(t,e,n){r.call(this,t,e,n),this.stretchyCurveArguments.reverse()}return s.prototype.objectType="InputView",s.prototype.remove=function(){var t=this;n.each(this.connectionWires,function(e){t.glObject.parent.parent.remove(e)}),this._remove()},s.prototype.connectToOutput=function(t){var n=t.IOView;e.getWorkspaceSingleton().render();var i=this;this.connectedOutputViews.push(n);var o=this.redrawWireForConnectedOutput(n);this.glObject.parent.parent.add(o),this.connectionWires.push(o),this.listenTo(n.glObject.parent,"changePosition",function(){i.redrawWireForConnectedOutput(n,o)}),e.getWorkspaceSingleton().render()},s.prototype.disconnectFromOutput=function(t){var i=t.IOView,o=n.indexOf(this.connectedOutputViews,i),r=this.connectionWires[o];this.connectionWires=n.without(this.connectionWires,r),this.connectedOutputViews=n.without(this.connectedOutputViews,i),r.parent.remove(r),e.getWorkspaceSingleton().render()},s.prototype.removeAllWires=function(){var t=this;n.each(this.connectionWires,function(t){t.parent.remove(t)}),n.each(this.connectedOutputViews,function(e){t.stopListening(e.glObject.parent,"changePosition")}),this.connectionWires=[],this.connectedOutputViews=[]},s.prototype.drawAllConnections=function(){var t=this,e=this.model._listeningTo;n.isEmpty(e)||n.each(n.values(e),function(e){t.connectToOutput.call(t,e)})},s.prototype.redrawWireForConnectedOutput=function(t,n){t.glObject.updateMatrixWorld(),this.glObject.updateMatrixWorld();var i=(new o.Vector3).setFromMatrixPosition(this.glObject.matrixWorld),r=(new o.Vector3).setFromMatrixPosition(t.glObject.matrixWorld);return e.getWorkspaceSingleton().drawCurveFromPointToPoint(r,i,n)},a.prototype.remove=function(){this._remove()},a.prototype.objectType="OutputView",{InputView:s,OutputView:a}}),define("dataFlow/UI/spreadsheetView",["jquery","underscore","dataFlow/dataTree","HandsontableWrapper","dataFlow/enums","dataFlow/UI/tableValueEnterer"],function(t,e,n,i,o,r){function s(t){this.initSpreadsheet.apply(this,arguments)}return s.prototype.createOverlay=r.prototype.createOverlay,s.prototype.destroy=r.prototype.destroy,s.prototype.initSpreadsheet=function(t,n,i,o,r,s){this.callback=o,this.data=t,this.dataType=r,this.readOnly=!0,e.bindAll(this,"initializeTable"),this.overlay=this.createOverlay(),this.$tableContainer=this.insertTable();var a=e.keys(this.data),l=e.map(this.data,function(t){return t}),c=e.keys(this.data[a[0]]),h=e.map(c,function(t){return e.pluck(l,t)});this.dataArray=h,this.initializeTable()},s.prototype.initializeTable=function(){var t=e.keys(this.data);this.table=new i(this.$tableContainer.find("#editableTable").get(0),{data:this.dataArray,colWidths:100,minSpareRows:50,minSpareCols:15,readOnly:!0,colHeaders:t,rowHeaders:e.keys(this.data[t[0]])})},s.prototype.insertTable=function(){var e=t(window).height(),n=t("<div class='tableView'><div id='editableTable' style='position:relative; height:"+(e-60)+"px; overflow: hidden;'></div></div>");return n.css({top:50,left:10,right:10,bottom:10,"z-index":102,position:"fixed",display:"block"}),t("body").append(n),n},s}),function(t,e){if("function"==typeof define&&define.amd)define("bootstrap-slider",["jquery"],e);else if("object"==typeof module&&module.exports){var n;try{n=require("jquery")}catch(t){n=null}module.exports=e(n)}else t.Slider=e(t.jQuery)}(this,function(t){var e;return function(t){"use strict";function e(){}var n=Array.prototype.slice;!function(t){if(t){var i="undefined"==typeof console?e:function(t){console.error(t)};t.bridget=function(e,o){(function(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})})(o),function(e,o){t.fn[e]=function(r){if("string"==typeof r){for(var s=n.call(arguments,1),a=0,l=this.length;l>a;a++){var c=this[a],h=t.data(c,e);if(h)if(t.isFunction(h[r])&&"_"!==r.charAt(0)){var u=h[r].apply(h,s);if(void 0!==u&&u!==h)return u}else i("no such method '"+r+"' for "+e+" instance");else i("cannot call methods on "+e+" prior to initialization; attempted to call '"+r+"'")}return this}var p=this.map(function(){var n=t.data(this,e);return n?(n.option(r),n._init()):(n=new o(this,r),t.data(this,e,n)),t(this)});return!p||p.length>1?p:p[0]}}(e,o)},t.bridget}}(t)}(t),function(t){function n(e,n){function i(t,e){var n="data-slider-"+e,i=t.getAttribute(n);try{return JSON.parse(i)}catch(t){return i}}"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e);var o,r,s,a=this.element.style.width,l=!1,c=this.element.parentNode;if(this.sliderElem)l=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var h=document.createElement("div");h.className="slider-track",(o=document.createElement("div")).className="slider-selection",(r=document.createElement("div")).className="slider-handle min-slider-handle",(s=document.createElement("div")).className="slider-handle max-slider-handle",h.appendChild(o),h.appendChild(r),h.appendChild(s);var u=function(t){var e=document.createElement("div");e.className="tooltip-arrow";var n=document.createElement("div");n.className="tooltip-inner",t.appendChild(e),t.appendChild(n)},p=document.createElement("div");p.className="tooltip tooltip-main",u(p);var d=document.createElement("div");d.className="tooltip tooltip-min",u(d);var f=document.createElement("div");f.className="tooltip tooltip-max",u(f),this.sliderElem.appendChild(h),this.sliderElem.appendChild(p),this.sliderElem.appendChild(d),this.sliderElem.appendChild(f),c.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}t&&(this.$element=t(this.element),this.$sliderElem=t(this.sliderElem)),n=n||{};for(var m=Object.keys(this.defaultOptions),b=0;b<m.length;b++){var g=m[b],y=n[g];y=null!==(y=void 0!==y?y:i(this.element,g))?y:this.defaultOptions[g],this.options||(this.options={}),this.options[g]=y}this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),!0===l&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","top","width","height"].forEach(function(t){this._removeProperty(this.trackSelection,t)},this),[this.handle1,this.handle2].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"top"),this._removeProperty(t,"margin-left"),this._removeProperty(t,"margin-top"),this._removeClass(t,"right"),this._removeClass(t,"top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this._addClass(this.tooltip,"right"),this.tooltip.style.left="100%",this._addClass(this.tooltip_min,"right"),this.tooltip_min.style.left="100%",this._addClass(this.tooltip_max,"right"),this.tooltip_max.style.left="100%"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=a,this.options.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this._addClass(this.tooltip,"top"),this.tooltip.style.top=-this.tooltip.outerHeight-14+"px",this._addClass(this.tooltip_min,"top"),this.tooltip_min.style.top=-this.tooltip_min.outerHeight-14+"px",this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=-this.tooltip_max.outerHeight-14+"px"),this.options.value instanceof Array?this.options.range=!0:this.options.range&&(this.options.value=[this.options.value,this.options.max]),this.trackSelection=o||this.trackSelection,"none"===this.options.selection&&this._addClass(this.trackSelection,"hide"),this.handle1=r||this.handle1,this.handle2=s||this.handle2,!0===l&&(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"));-1!==["round","triangle","custom"].indexOf(this.options.handle)&&(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle)),this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos],this.setValue(this.options.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.touchCapable?(this.mousedown=this._mousedown.bind(this),this.sliderElem.addEventListener("touchstart",this.mousedown,!1)):(this.mousedown=this._mousedown.bind(this),this.sliderElem.addEventListener("mousedown",this.mousedown,!1)),"hide"===this.options.tooltip?(this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide")):"always"===this.options.tooltip?(this._showTooltip(),this._alwaysShowTooltip=!0):(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1),this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)),this.options.enabled?this.enable():this.disable()}var i=function(t){return"Invalid input value '"+t+"' passed in"};if(e=function(t,e){return n.call(this,t,e),this},e.prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,enabled:!0,formatter:function(t){return t instanceof Array?t[0]+" : "+t[1]:t},natural_arrow_keys:!1},over:!1,inDrag:!1,getValue:function(){return this.options.range?this.options.value:this.options.value[0]},setValue:function(t,e){t||(t=0);var n=this.getValue();this.options.value=this._validateInputValue(t);var i=this._applyPrecision.bind(this);this.options.range?(this.options.value[0]=i(this.options.value[0]),this.options.value[1]=i(this.options.value[1]),this.options.value[0]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[0])),this.options.value[1]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[1]))):(this.options.value=i(this.options.value),this.options.value=[Math.max(this.options.min,Math.min(this.options.max,this.options.value))],this._addClass(this.handle2,"hide"),this.options.value[1]="after"===this.options.selection?this.options.max:this.options.min),this.diff=this.options.max-this.options.min,this.percentage=this.diff>0?[100*(this.options.value[0]-this.options.min)/this.diff,100*(this.options.value[1]-this.options.min)/this.diff,100*this.options.step/this.diff]:[0,0,100],this._layout();var o=this.options.range?this.options.value:this.options.value[0];return!0===e&&this._trigger("slide",o),n!==o&&this._trigger("change",{oldValue:n,newValue:o}),this._setDataVal(o),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),t&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this.options.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this.options.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this.options.enabled?this.disable():this.enable(),this},isEnabled:function(){return this.options.enabled},on:function(e,n){return t?(this.$element.on(e,n),this.$sliderElem.on(e,n)):this._bindNonQueryEventHandler(e,n),this},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(){return this._removeSliderEventHandlers(),n.call(this,this.element,this.options),t&&t.data(this.element,"slider",this),this},_removeSliderEventHandlers:function(){this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.handle2.removeEventListener("focus",this.handle2Keydown,!1),this.handle2.removeEventListener("blur",this.handle2Keydown,!1),this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.mousedown,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var n=t[e];this.eventToCallbackMap[n]=null}},_showTooltip:function(){!1===this.options.tooltip_split?this._addClass(this.tooltip,"in"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in")),this.over=!0},_hideTooltip:function(){!1===this.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this.over=!1},_layout:function(){var t;if(t=this.options.reversed?[100-this.percentage[0],this.percentage[1]]:[this.percentage[0],this.percentage[1]],this.handle1.style[this.stylePos]=t[0]+"%",this.handle2.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation)this.trackSelection.style.top=Math.min(t[0],t[1])+"%",this.trackSelection.style.height=Math.abs(t[0]-t[1])+"%";else{this.trackSelection.style.left=Math.min(t[0],t[1])+"%",this.trackSelection.style.width=Math.abs(t[0]-t[1])+"%";var e=this.tooltip_min.getBoundingClientRect(),n=this.tooltip_max.getBoundingClientRect();e.right>n.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="-30px")}var i;if(this.options.range){i=this.options.formatter(this.options.value),this._setText(this.tooltipInner,i),this.tooltip.style[this.stylePos]=(t[1]+t[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px"),"vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px");var o=this.options.formatter(this.options.value[0]);this._setText(this.tooltipInner_min,o);var r=this.options.formatter(this.options.value[1]);this._setText(this.tooltipInner_max,r),this.tooltip_min.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-top",-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-left",-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-top",-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-left",-this.tooltip_max.offsetWidth/2+"px")}else i=this.options.formatter(this.options.value[0]),this._setText(this.tooltipInner,i),this.tooltip.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px")},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this.options.enabled)return!1;this._triggerFocusOnHandle(),this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos];var e=this._getPercentage(t);if(this.options.range){var n=Math.abs(this.percentage[0]-e),i=Math.abs(this.percentage[1]-e);this.dragged=i>n?0:1}else this.dragged=0;this.percentage[this.dragged]=this.options.reversed?100-e:e,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this.inDrag=!0;var o=this._calculateValue();return this._trigger("slideStart",o),this._setDataVal(o),this.setValue(o),this._pauseEvent(t),!0},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this.options.enabled)return!1;var n;switch(e.keyCode){case 37:case 40:n=-1;break;case 39:case 38:n=1}if(n){if(this.options.natural_arrow_keys){var i="vertical"===this.options.orientation&&!this.options.reversed,o="horizontal"===this.options.orientation&&this.options.reversed;(i||o)&&(n*=-1)}var r=n*this.percentage[2],s=this.percentage[t]+r;s>100?s=100:0>s&&(s=0),this.dragged=t,this._adjustPercentageForRangeSliders(s),this.percentage[this.dragged]=s,this._layout();var a=this._calculateValue();return this._trigger("slideStart",a),this._setDataVal(a),this.setValue(a,!0),this._trigger("slideStop",a),this._setDataVal(a),this._pauseEvent(e),!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this.options.enabled)return!1;var e=this._getPercentage(t);this._adjustPercentageForRangeSliders(e),this.percentage[this.dragged]=this.options.reversed?100-e:e,this._layout();var n=this._calculateValue();return this.setValue(n,!0),!1},_adjustPercentageForRangeSliders:function(t){this.options.range&&(0===this.dragged&&this.percentage[1]<t?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>t&&(this.percentage[1]=this.percentage[0],this.dragged=0))},_mouseup:function(){if(!this.options.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),this.inDrag=!1,!1===this.over&&this._hideTooltip();var t=this._calculateValue();return this._layout(),this._trigger("slideStop",t),this._setDataVal(t),!1},_calculateValue:function(){var t;return this.options.range?(t=[this.options.min,this.options.max],0!==this.percentage[0]&&(t[0]=Math.max(this.options.min,this.options.min+Math.round(this.diff*this.percentage[0]/100/this.options.step)*this.options.step),t[0]=this._applyPrecision(t[0])),100!==this.percentage[1]&&(t[1]=Math.min(this.options.max,this.options.min+Math.round(this.diff*this.percentage[1]/100/this.options.step)*this.options.step),t[1]=this._applyPrecision(t[1]))):((t=this.options.min+Math.round(this.diff*this.percentage[0]/100/this.options.step)*this.options.step)<this.options.min?t=this.options.min:t>this.options.max&&(t=this.options.max),t=parseFloat(t),t=this._applyPrecision(t)),t},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){var n=t.toFixed(e);return parseFloat(n)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type||(t=t.touches[0]);var e=100*(t[this.mousePos]-this.offset[this.stylePos])/this.size;return e=Math.round(e/this.percentage[2])*this.percentage[2],Math.max(0,Math.min(100,e))},_validateInputValue:function(t){if("number"==typeof t)return t;if(t instanceof Array)return this._validateArray(t),t;throw new Error(i(t))},_validateArray:function(t){for(var e=0;e<t.length;e++){var n=t[e];if("number"!=typeof n)throw new Error(i(n))}},_setDataVal:function(t){var e="value: '"+t+"'";this.element.setAttribute("data",e),this.element.setAttribute("value",t)},_trigger:function(e,n){n=n||0===n?n:void 0;var i=this.eventToCallbackMap[e];if(i&&i.length)for(var o=0;o<i.length;o++){(0,i[o])(n)}t&&this._triggerJQueryEvent(e,n)},_triggerJQueryEvent:function(t,e){var n={type:t,value:e};this.$element.trigger(n),this.$sliderElem.trigger(n)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.innerText?t.innerText=e:void 0!==t.textContent&&(t.textContent=e)},_removeClass:function(t,e){for(var n=e.split(" "),i=t.className,o=0;o<n.length;o++){var r=n[o],s=new RegExp("(?:\\s|^)"+r+"(?:\\s|$)");i=i.replace(s," ")}t.className=i.trim()},_addClass:function(t,e){for(var n=e.split(" "),i=t.className,o=0;o<n.length;o++){var r=n[o];new RegExp("(?:\\s|^)"+r+"(?:\\s|$)").test(i)||(i+=" "+r)}t.className=i.trim()},_offset:function(t){var e=0,n=0;if(t.offsetParent)do{e+=t.offsetLeft,n+=t.offsetTop}while(t=t.offsetParent);return{left:e,top:n}},_css:function(e,n,i){if(t)t.style(e,n,i);else{var o=n.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()});e.style[o]=i}}},t){var o=t.fn.slider?"bootstrapSlider":"slider";t.bridget(o,e)}}(t),e}),define("dataFlow/UI/sliderView",["jquery","bootstrap-slider"],function(t){function e(t,e,n,i,o,r){this.init.apply(this,arguments)}return e.prototype.init=function(e,n,i,o,r,s,a){var l=this.createOverlay(),c="slider_"+Math.floor(1e4*Math.random()),h=t("<input id='"+c+"'></input>");t("body").append(h),h.slider({min:n,max:i,step:o?1:.01,value:e,selection:"none",tooltip:"always",id:"a"+c}),t("#a"+c).css({top:s+"px",left:r+"px"}),h.on("slide slideStop",function(){a(h.slider("getValue"))}),this.sliderInput=h,this.overlay=l},e.prototype.createOverlay=function(){var e="overlay_"+Math.floor(1e4*Math.random()),n=t("<input id='"+e+"' class='TOP workspaceOverlay'></input>");t("body").append(n);var i=this;return n.on("click",function(){i.sliderInput.slider("destroy"),i.sliderInput.remove(),i.overlay.off(),i.overlay.remove()}),n},e}),define("dataFlow/UI/componentView",["jquery","dataFlow/dataFlow_loader","dataFlow/UI/workspaceView","dataFlow/UI/inputOutputView","underscore","backbone","three","dataFlow/dataTree"],function(t,e,n,i,o,r,s,a){function l(t){var e=this;o.extend(this,d.prototype,{click:function(t,e){this.displayVals()},displayVals:function(){console.log("displayvals on spreadsheetcomponentview is called");var t=[];e.component.getOutput("D").getTree().recurseTree(function(e,n){t.push(n),o.each(e,function(e){t.push(e)})}),Promise.all(t).then(function(t){o.each(t,function(t,e){if("Node"!==t.objectType)return require(["dataFlow/UI/spreadsheetView"],function(e){new e(JSON.parse(t.text))}),void console.warn("TODO: MULTIPLE SPREADSHEETS SHOULD IDEALLY BE HANDLED")})})}}),e.init(t)}function c(t){var e=this,i=o.template("<div class='pathNodeTitle'>{<%= path %>}</div>"),r=o.template("<div class='dataRow'><%= text %></div>");o.extend(this,d.prototype,{displayVals:function(){var t="",n=[];e.component.getOutput("D").getTree().recurseTree(function(t,e){n.push(e),o.each(t,function(t){n.push(t)})}),Promise.all(n).then(function(n){o.each(n,function(e,n){"Node"===e.objectType?t+=i({path:e.getPath()}):(console.log(e),t+=r({text:e.text.replace(/\n/g,"<br />")}))}),e.printArea.innerHTML=t})},createComponentWithNamePosition:function(t,i,o){var r=document.createElement("div");r.className="draggable PrintComponent freezeZooming";var a=document.createElement("div");a.className="printComponentTextArea",e.printArea=a,r.appendChild(a),r.width="700px",r.height="320px";var l=new s.CSS3DObject(r);return l.position.x=i||0,l.position.y=o||0,l.position.z=0,n.getWorkspaceSingleton().scene.add(l),r.uuid=l.uuid,l}}),e.init(t),e.listenTo(e.component.getOutput("D"),"change",e.displayVals)}function h(t){var e=this,i=o.template("<div class='pathNodeTitle'>{<%= path %>}</div>"),r=(o.template("<div class='dataRow'><%= text %></div>"),o.template("<div class='dataRow'><img src='data:image/png;base64,<%= pngdata %>' /></div>"));o.extend(this,d.prototype,{displayVals:function(){var t="",n=[];e.component.getOutput("D").getTree().recurseTree(function(t,e){n.push(e),o.each(t,function(t){n.push(t)})}),Promise.all(n).then(function(n){o.each(n,function(e,n){"Node"===e.objectType?t+=i({path:e.getPath()}):o.each(e,function(e){t+=r({pngdata:e})})}),e.printArea.innerHTML=t})},createComponentWithNamePosition:function(t,i,o){var r=document.createElement("div");r.className="draggable PrintComponent freezeZooming";var a=document.createElement("div");a.className="printComponentTextArea",e.printArea=a,r.appendChild(a),r.width="700px",r.height="320px";var l=new s.CSS3DObject(r);return l.position.x=i||0,l.position.y=o||0,l.position.z=0,n.getWorkspaceSingleton().scene.add(l),r.uuid=l.uuid,l}}),e.init(t),e.listenTo(e.component.outputs[0],"change",e.displayVals)}function u(t){var e=this;o.extend(this,d.prototype,{doubleclick:function(t,n){var i=e.component.getInput("B").getTree();i.setDataAtPath(!i.dataAtPath([0])[0],[0])},displayVals:function(){o.isEmpty(this.component.getOutput("B").getTree().dataAtPath([0]))?this.setDisplayLabel(this.component.get("componentPrettyName")):this.setDisplayLabel(this.component.getOutput("B").getTree().dataAtPath([0]).toString())}}),this.init(t),this.listenTo(this.component.getOutput("B"),"change",this.displayVals)}function p(t){var e=this;o.extend(this,d.prototype,{click:function(e,n){var i=t.getOutput("N").getFirstValueOrDefault(),o=t.getInput("S").getFirstValueOrDefault(),r=t.getInput("E").getFirstValueOrDefault(),s=t.getInput("I").getFirstValueOrDefault(),a=this.sliderUpdateValue;require(["dataFlow/UI/sliderView"],function(t){new t(i,o,r,s,e,n,a)})},sliderUpdateValue:function(n){t.storeUserData(n),e.displayVals()},displayVals:function(){o.isEmpty(this.component.getOutput("N").getTree().dataAtPath([0]))?this.setDisplayLabel(this.component.get("componentPrettyName")):this.setDisplayLabel(this.component.getOutput("N").getTree().dataAtPath([0]).toString())}}),o.bindAll(this,"click","sliderUpdateValue"),this.init(t)}function d(t){this.init(t)}return l.prototype.objectType="SpreadsheetComponentView",c.prototype.objectType="PrintComponentView",h.prototype.objectType="MatPlotLibComponentView",u.prototype.objectType="BooleanToggleComponentView",p.prototype.objectType="SliderComponentView",d.prototype.init=function(t){this.component=t,o.extend(this,r.Events),o.bindAll(this,"processIOViews","createGLElementToMatch"),this.cssObject=this.createComponentWithNamePosition(this.component.get("componentPrettyName"),this.component.position.x,this.component.position.y),o.defer(function(){this.glObject=this.createGLElementToMatch(this.cssObject),n.getWorkspaceSingleton().setupDraggableView(this),1==this.component.get("sufficient")&&this.changeSufficiency(),this.listenTo(this.glObject,"changePosition",function(){t.position=this.glObject.position})}.bind(this)),t.componentView=this,this.inputViews={},this.outputViews={},this.processIOViews(this.component.inputs,this.inputViews,!0),this.processIOViews(this.component.outputs,this.outputViews,!1),n.getWorkspaceSingleton().render(),this.listenTo(this.component,"change:preview",this.changePreviewState),this.listenTo(this.component,"change:sufficient",this.changeSufficiency),this.listenTo(this.component,"change:componentPrettyName",this.displayVals),this.listenTo(this.component,"removed",this.remove),this.changePreviewState(),this.changeSufficiency()},d.prototype.displayVals=function(){this.setDisplayLabel(this.component.get("componentPrettyName"))},d.prototype.doubleclick=function(){this.component.getOutput().getTree().log()},d.prototype.changeSufficiency=function(){var t,e=this.component.get("sufficient");t=!0===e?"sufficient":"error"===e?"error":"insufficient";var n=this.getDisplayDiv();n.classList.remove("sufficient"),n.classList.remove("insufficient"),n.classList.remove("error"),n.classList.add(t)},d.prototype.changePreviewState=function(){var t=this.component.get("preview"),e=this.getDisplayDiv();e.classList.remove("previewOff"),!1===t&&e.classList.add("previewOff")},d.prototype.getDisplayDiv=function(){return this.cssObject.element.firstChild},d.prototype.setDisplayLabel=function(t){this.getDisplayDiv().textContent=t},d.prototype.createComponentWithNamePosition=function(t,e,i){var o=document.createElement("div");o.className="draggable";var r=document.createElement("div");r.className="componentLabel",r.textContent=t,o.appendChild(r),o.width="240px",o.height="80px";var a=new s.CSS3DObject(o);return a.position.x=e||0,a.position.y=i||0,a.position.z=0,n.getWorkspaceSingleton().scene.add(a),o.uuid=a.uuid,a},d.prototype.remove=function(){this.stopListening(),o.each(this.component.inputs,function(t){o.isEmpty(t.IOView)||t.IOView.remove()}),o.each(this.component.outputs,function(t){o.isEmpty(t.IOView)||t.IOView.remove()}),n.getWorkspaceSingleton().scene.remove(this.cssObject),n.getWorkspaceSingleton().glscene.remove(this.glObject),delete this.component.componentView,delete this.component,n.getWorkspaceSingleton().render()},d.prototype.processIOViews=function(t,n,r){var s=o.filter(t,function(t){return!0===t.get("invisible")}).length,a=60*(o.keys(t).length-1-s)/2,l=this.cssObject,c=r?i.InputView:i.OutputView,h=this.component.componentName;o.each(t,function(t,i){if(t.type!==e.OUTPUT_TYPES.NULL&&!0!==t.get("invisible")){var s=t.shortName,u=this._createIOWithNameAndParent(s,h,l,a-60*i,r,t.type),p=this;o.defer(function(){var e=p.createGLElementToMatch(u);n[s]=new c(t,e,u)})}},this)},d.prototype._createIOWithNameAndParent=function(t,e,n,i,o,r){var a=document.createElement("div");a.className="draggable IO "+e,a.textContent=t,n.element.appendChild(a);var l=new s.CSS3DObject(a);n.add(l);var c=150;try{c=parseInt(n.element.width.replace("px",""))/2+40}catch(t){console.warn("Could not parse 'width' attribute of the component's main CSS Element. This should be set both in code and in CSS, so that element size can be determined (and GL dopplegangers placed) without first rendering the element")}return l.position.z=0,l.position.y=i,l.position.x=o?-c:c,l.element.className+=o?" inputIO":" outputIO",l.addDraggableScopes([o?"input":"output",r]),l.addDroppableScopes([o?"output":"input",r]),l},d.prototype.createGLElementToMatch=function(t){var e=t.element.clientWidth,i=t.element.clientHeight;if(0===e||0===i)throw new Error("CSS Element Must be allowed to render before polling for its size.");var r=new s.Shape;r.moveTo(0,0),r.lineTo(0,i),r.lineTo(e,i),r.lineTo(e,0),r.lineTo(0,0);var a=new s.ShapeGeometry(r);a.applyMatrix((new s.Matrix4).makeTranslation(-e/2,-i/2,0));var l=new s.Mesh(a,new s.MeshBasicMaterial({color:16711680,wireframe:!0,transparent:!0,opacity:0}));l.position.set(t.position.x,t.position.y,0),t.element.uuid=t.uuid;return(o.isUndefined(this.glObject)?n.getWorkspaceSingleton().glscene:this.glObject).add(l),l},d.prototype.objectType="ComponentView",function(t){if(o.isUndefined(t)||o.isUndefined(t.recalculate)&&o.isUndefined(t.recalculateTrees))throw new Error("ComponentView objects must be instantiated with the DataFlow.Component which they represent");return"SliderComponent"===t.componentName?new p(t):"BooleanToggleComponent"===t.componentName?(console.log("creating toggler"),new u(t)):"PrintComponent"===t.componentName?new c(t):"SpreadsheetComponent"===t.componentName?new l(t):"LinePlot"===t.componentName?new h(t):new d(t)}}),define("dataFlow/project",["underscore","backbone","dataFlow/dataFlow_loader"],function(t,e,n){return e.Model.extend({defaults:function(){return{authorName:"anonymous",authorId:"",title:"",description:"",projectId:"",createdAt:new Date,updatedAt:new Date,components:[]}},initialize:function(e){t.bindAll(this,"destroy"),e&&e.components&&this.loadComponentsFromJSON(e.components)},addComponentToProject:function(t){var e=this.get("components");return e.push(t),this.listenTo(t,"removed",this.removeComponent),this.set("components",e),this.trigger("change",this),this},createComponent:function(t,e){var i,o=e||{x:0,y:0};return i=n.createComponentByName(t,{position:o}),this.addComponentToProject(i),this},removeComponent:function(e){this.stopListening(e);var n=t.without(this.get("components"),e);this.set("components",n),this.trigger("change",this)},destroy:function(){console.warn("DESTROY on project isn't really a good idea. I should just remove VIEW stuff, not DATA stuff.")},toJSON:function(){var e=t.clone(this.attributes);return e.components=t.map(e.components,function(t){return t.toJSON()}),e},loadComponentsFromJSON:function(e){var i={},o=[],r=[],s=this,a=0,l=function(t){var e=parseInt(t.replace("c",""));e>a&&(a=e)};for(t.each(e,function(e){l(e.id),e.output&&(e.outputs=e.output,delete e.output);var a=n.createComponentByName(e.componentName,t.clone(e));r.push(a),s.addComponentToProject.call(s,a),t.each(e.inputs,function(e){l(e.id),e.connections.length>0&&(i[e.id]=a[e.shortName],t.each(e.connections,function(t){!function(t){var n={};n[e.id]=t,o.push(n)}(t)}))}),t.each(a.outputs,function(t){i[t.id]=t})});parseInt(t.uniqueId("c").replace("c",""))<a;);t.each(o,function(n){var o=t.keys(n)[0],r=n[o],s=i[o],a=i[r];t.isUndefined(s.connectAdditionalOutput)||t.isUndefined(a)?(console.trace(),console.warn("COULD NOT MAKE CONNECTION!! INVESTIGATE THIS!",s,a),console.log(n),console.log(e)):s.connectAdditionalOutput(a)}),this.set("components",r)}})}),define("text!src/css/orchestra.css",[],function(){return'\na {\n    cursor: pointer;\n}\nbody {\n    margin: 0px;\n    overflow: hidden;\n}\ncanvas {\n    position:  absolute;\n    top: 0px;\n    left: 0px;\n    opacity: 0.9;\n}\n.TOP {\n    position: absolute;\n    z-index: 101;\n    /*background-color: rgba(255,255,255,0.2);*/\n    top: 0px;\n    left: 0px;\n}\n/*  TODO: These styles are needed for orchestra3d, but conflict in Jupyter-Orchestra (they make Jupyter\'s nav buttons appear above its dropdown menus, such as file, edit, etc.\n    These should be moved to a separate style sheet in orchestra, so that bootstrap conflicts can be avoided.\n */\n/*.navbar {*/\n    /*z-index: 102;*/\n    /*border-radius: 0px !important;*/\n/*}*/\n/*.navbar-project-title {*/\n    /*!*text-transform: capitalize;*!*/\n    /*float: left;*/\n    /*height: 50px;*/\n    /*padding: 15px 15px;*/\n    /*font-size: 17px;*/\n    /*line-height: 20px;*/\n    /*font-style: italic;*/\n/*}*/\n.titleChangerWidget {display: none;}\n#titleChanger {width: 400px;}\n\n/* Main Component Styling */\ndiv.componentLabel {\n    border: 1px solid black;\n    border-radius: 60px;\n    height: 80px;\n    width: 240px;\n    text-align: center;\n    font-size: 30px;\n    line-height: 80px;\n    text-transform: capitalize;\n    cursor: pointer;\n\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\n/* Print Component Styling */\ndiv.draggable.PrintComponent {\n    /*left: 240px;*/\n}\ndiv.draggable.PrintComponent.IO {\n    /*left: -240px;*/\n}\ndiv.printComponentTextArea {\n    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;\n    border: 1px solid black;\n    border-radius: 5px;\n    height: 320px;\n    width: 700px;\n    text-align: left;\n    font-size: 15px;\n    padding: 0;\n    line-height: 30px;\n    cursor: pointer;\n\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n\n    /*margin-left: 480px;*/\n    background-color: whitesmoke;\n    box-shadow: 9px 9px 19px 0px #444;\n    overflow-y: scroll;\n}\ndiv.printComponentTextArea div {\n    padding: 0 15px;\n}\n\n\n\ndiv.printComponentTextArea .pathNodeTitle {\n    background-color: #999;\n}\n\ndiv.printComponentTextArea div.dataRow  {\n    white-space: pre;\n}\ndiv.printComponentTextArea div.dataRow:nth-child(odd)  {\n    background-color: white;\n}\ndiv.printComponentTextArea div.dataRow:nth-child(even)  {\n    background-color: #dedede;\n}\n\n/*\nSupport for mixing status colors for separate properties: Preview, Sufficiency/Error, Selection\nhttps://css-tricks.com/tinted-images-multiple-backgrounds/\nPreview / Not = grey or white solid alpha image\nSufficiency / Error = clear, orange, or red transparent .TOP.workspaceOverlay\nSelection = Thick green border\n*/\n\ndiv.componentLabel.insufficient {background-color: #ffca3d;}\ndiv.componentLabel.sufficient {background-color: #e8e8e8;}\ndiv.componentLabel.error {background-color: orangered;}\n\n/*div.componentLabel.previewOff.insufficient {background-color: lightgray;}*/\ndiv.componentLabel.previewOff.sufficient {background-color:#999999;}\ndiv.componentLabel.previewOff.error {background-color:orangered}\n\ndiv.IO {\n    box-sizing: content-box;\n    position: absolute;\n    display: block;\n    background-color: #ff870c;\n    top: 0px;\n    left: 0px;\n    height: 50px;\n    width: 50px;\n    border-radius: 50px;\n\n    color: white;\n    font-size: 35px;\n    line-height: 50px;\n    text-align: center;\n    font-weight: bold;\n\n    -webkit-user-select: none;       \n    -moz-user-select: none; \n    -ms-user-select: none; \n    -o-user-select: none;\n    user-select: none;\n}\ndiv.IO:hover {\n    box-sizing: content-box;\n    border: 5px solid orange;\n    cursor: pointer;\n}\ndiv.IO.glHover {\n    background-color: red;\n}\n\n.glHover input {\n    border: 10px solid red;\n}\n.dragging {\n    pointer-events: none;\n}\n\n/* Help Tooltip / Popovers */\n.io_tooltip {\n    margin: -9px -14px;\n    list-style: none;\n    padding-left: 0;\n}\n.io_tooltip .io_description {\n    font-style: italic;\n    margin: 9px;\n    display: inline-block;\n    font-size: 17px;\n    font-weight: bold;\n}\n.io_tooltip .io_isRequired {\n    width: 80px;\n    display: inline-block;\n    margin: 0px 9px;\n    color: #999;\n    font-size: 11px;\n    vertical-align: middle;\n}\n.io_tooltip li {\n    max-width: 180px;\n    display: block;\n}\n.io_tooltip_field_title {\n    width: 80px;\n    line-height: 16px;\n    display: inline-block;\n    margin: 9px;\n    color: #999;\n    font-size: 11px;\n    vertical-align: middle;\n}\n.io_tooltip_field_value {\n    color: #333;\n    font-weight: bold;\n    font-size: 16px;\n    width: 60px;\n    text-align: left;\n    line-height: 16px;\n    vertical-align: middle;\n    display: inline-block;\n}\n.cmpt_tooltip_title_modulename {\n    font-weight: normal;\n    color: #999;\n    font-size: 10px;\n}\n.cmpt_error_line {\n    color: red;\n    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;\n    width: 600px;\n    font-size: 12px;\n}\n.cmpt_error_line .err_type {\n    width: 75px;\n    text-align: left;\n    font-weight: bold;\n}\n.cmpt_error_line .err_msg {\n    text-align: left;\n    width: 525px;\n}\n.cmpt_tooltip .cmpt_description {\n    font-weight: normal;\n    font-size: 20px;\n    margin-bottom: 10px;\n}\n.cmpt_tooltip .cmpt_io_container {\n\n}\n.cmpt_tooltip .cmpt_io_container .cmpt_io_title{\n    font-weight: bold;\n    color: #333;\n    margin-left: 50px;\n}\n.cmpt_tooltip .cmpt_io_container .cmpt_io{\n    margin-left: 70px;\n    display: block;\n}\n.cmpt_tooltip .cmpt_io_container .cmpt_io .cmpt_io_name {\n    font-weight: bold;\n    font-size: 12px;\n    vertical-align: top;\n}\n.cmpt_tooltip .cmpt_io_container .cmpt_io .cmpt_io_details {\n    color: #666;\n    font-size: 12px;\n    max-width: 250px;\n    display: inline-block;\n    margin-left: 8px;\n}\n.cmpt_tooltip  .cmpt_io_required_legend {\n    font-size: 11px;\n    color: #999;\n}\n\n\n\n\n/* Slider custom overrides. Can be copied to slider\'s CSS eventually */\n.slider {\n    z-index: 102; /* Make sure the tooltip comes above bootstrap nav items */\n    margin-left: -100px;\n    margin-top: -50px;\n}\n.slider .tooltip {\n    background-color: transparent;\n}\n.TOP.workspaceOverlay {\n    z-index: 101;\n    background-color: rgba(0,0,0,0.5);\n    width: 100%;\n    height: 100%;\n    border: none;\n}\n\n/* Context menu stuff */\n.context-menu {\n    position: absolute;\n    display: none;\n}\n.context-menu .dropdown-menu {\n    top: 0;\n    display: block;\n}\n.context-menu .icongutter {\n    width: 30px;\n    display: inline-block;\n}\n.context-menu input {\n    border-radius: 17px;\n    border: 1px solid lightgray;\n    padding-left: 23px;\n}\n.context-menu input:focus {\n    outline-width: 0;\n}\n.context-menu .comp_Name {\n    height: 40px;\n    vertical-align: middle;\n    line-height: 40px;\n    margin-left: 20px;\n    font-weight: bold;\n    font-style: italic;\n}\n\n/* Roaming component searchbar / typeahead */\n.mobileComponentSearchInput {\n    z-index: 102;\n    position: absolute;\n    display: block;\n    width: 310px;\n    line-height: 30px;\n    padding: 4px 19px;\n    border-radius: 10px;\n    outline: none;\n    border: 1px solid #CCC;\n    font-size: 20px;\n    font-weight: bold;\n}\n'}),define("orchestraApp",["jquery","underscore","backbone","dataFlow/dataFlow_loader","dataFlow/UI/workspaceView","dataFlow/UI/componentView","dataFlow/project","dataFlow/components/engine","dataFlow/pulse","dataFlow/freezeCalculations","text!src/css/orchestra.css"],function(t,e,n,i,o,r,s,a,l,c,h){function u(t){t?this.setupEngine(t):console.error("Python Engine Not Initialized. All Python Functions will Error."),e.extend(this,n.Events),this.init()}t("head").append("<style type='text/css'>"+h+"</style");var p=0,d=[];return window.LOG_TIME_EVENT=function(t,e){var n=(new Date).getTime(),i={};i[t]=n-p,d.push(i),p=n,e&&(p=0,d=[])},u.prototype.init=function(){this.currentProject=null,e.bindAll(this,"newProject","clearWorkspace","loadJSON","initializePulses"),this.workspace=new o.Workspace,this.workspace.createWorkspace(),this.currentProject=new s;var t=this;this.workspace.on("createNewComponent",function(e){t.newComponent.call(t,e)})},u.prototype.newComponent=function(t){var e=this,n=t.position||this.workspace.getCurrentVisibleCenterPoint(),o=i.createComponentByName(t.functionName,{position:n});this.currentProject.addComponentToProject(o),o.on("requestFileExport",function(t){e.exporter.export(t)}),new r(o)},u.prototype.newProject=function(){this.clearWorkspace(),this.loadWorkspace(this.currentProject)},u.prototype.clearWorkspace=function(){c.setFrozen(!0),console.warn("DO SOME TESTS TO MAKE SURE THAT ZOMBIES DONT REMAIN"),this.stopListening(),e.isNull(this.currentProject)||e.each(this.currentProject.get("components").slice(0),function(t){t.componentView.remove()}),this.currentProject=new s,this.workspace.render()},u.prototype.getDisplayState=function(){return{workspace:this.workspace.toJSON()}},u.prototype.loadJSON=function(t){this.clearWorkspace();var e=this;require(["dataFlow/project"],function(n){e.loadWorkspace(new n(t))})},u.prototype.loadWorkspace=function(t){c.setFrozen(!0);var n=this;this.currentProject=t,this.listenTo(this.currentProject,"change",function(t){n.trigger("change",t.toJSON())}),e.each(t.get("components"),function(t){t.on("requestFileExport",function(t){n.exporter.export(t)}),new r(t)}),e.defer(function(){e.each(t.get("components"),function(t){e.each(t.inputs,function(t){var e=t.IOView;e&&e.drawAllConnections()})})}),t.get("contextData")&&this.workspace.fromJSON(t.get("contextData").workspace),this.initializePulses(t)},u.prototype.initializePulses=function(t){c.setFrozen(!1),e.each(t.get("components"),function(t){var n=0;if(e.each(t.inputs,function(t){0!==e.keys(t._listeningTo).length||t.getTree().isEmpty()?!0===t.get("invisible")&&n++:n++}),n===t.inputs.length){var i=t.inputs[0];i.trigger("pulse",new l({startPoint:i}))}})},u.prototype.setupEngine=function(t){console.warn("SETUP ENGINE NEEDS TO BE IMPLEMENTED NOW"),a.setup(t),a.resetTranscript()},u.prototype.getTranscript=function(){return a.getTranscript()},u.prototype.close=function(){console.warn("Orchestra.Close() not yet implemented. It needs to clean up and remove UI."),this.workspace.destroy(),this.trigger("closed",this.currentProject.toJSON()),this.off()},u}),require.config({baseUrl:"/nbextensions/orchestra-jupyter/",urlArgs:"bust="+(new Date).getTime(),shim:{backbone:{deps:["underscore","jquery"],exports:"Backbone"},"parse-lib":{deps:["jquery"],exports:"Parse"},underscore:{exports:"_"},jquery:{exports:"$"},bootstrap3:{deps:["jquery"]},"bootstrap-slider":{deps:["bootstrap"]},"bootstrap3-typeahead":{deps:["bootstrap"]},OrbitControls:{deps:["three"]},SVGRenderer:{deps:["three"]},Projector:{deps:["three"]},CSS3DRenderer:{deps:["three"]}},paths:{viewer:"src/viewer",three:"https://cdn.rawgit.com/strandedcity/orchestra-jupyter/master/src/viewer/three.min",OrbitControls:"src/viewer/OrbitControls",SVGRenderer:"src/viewer/SVGRenderer",Projector:"src/viewer/Projector",navbar:"src/application/navbar",componentSearcher:"src/application/componentSearcher",jquery:"lib/jquery-2.1.1.min",backbone:"lib/backbone-min","parse-lib":"lib/parse-1.5.0.min",underscore:"lib/underscore-min",bootstrap3:"lib/bootstrap.min","bootstrap3-typeahead":"lib/bootstrap3-typeahead.min","bootstrap-slider":"lib/bootstrap-slider.min",Handsontable:"https://cdn.rawgit.com/strandedcity/orchestra-jupyter/master/lib/handsontable.min",HandsontableWrapper:"lib/handsontable.wrapper",numbro:"lib/numbro",pikaday:"lib/pikaday",moment:"lib/moment",text:"lib/text",dataFlow:"src/dataFlow",CSS3DRenderer:"src/dataFlow/UI/CSS3DRenderer",orchestraApp:"app"}}),define(["base/js/namespace","orchestraApp","jquery","base/js/dialog"],function(t,e,n,i){function o(i){console.log("Opening Orchestra Visual Flow Programming"),console.warn("Disabling Jupyter Keyboard Shortcuts for Orchestra"),t.notebook.keyboard_manager.disable();var o=new e(t);o.loadJSON(i.metadata[s]),i.orchestra_application=o,o.on("change",function(t){i.metadata[s]=t}),o.on("closed",function(e){i.metadata[s]=e,console.warn("Enabling Jupyter Keyboard Shortcuts"),t.notebook.keyboard_manager.enable()});var a=n('<button class="btn btn-large closeOrchestraButton" style="z-index:500;position: absolute;top: 10px;left: 10px;">Return to Jupyter</button>');n("body").append(a),a.on("click",function(){var t=o.getTranscript();if("#"==t.charAt(0)){var e=t.split("\n");e.splice(1,0,r),t=e.join("\n")}i.code_mirror.setValue(t),o.close(),a.off(),a.hide(250,function(){a.remove()})})}var r="### This cell contains Orchestra Visual Flow Programming Project Data. \n### Output variables will be defined here for use lower in your notebook. \n### Please do not edit this cell's contents directly, as your changes may be overwritten.\n###\n### If You do not have the Orchestra VFP Extension Installed, please visit:\n### https://OrchestraMachineLearning.com/install-jupyter-extension/\n",s="orchestraData";return{load_ipython_extension:function(){var e={icon:"fa-cubes",help:"Orchestra Visual Flow Programming",help_index:"orchestra",handler:function(t){require(["HandsontableWrapper"]);var e=t.notebook.get_selected_cell();if("object"==typeof e.metadata[s])o(e);else{function n(){e.metadata[s]={},e.code_mirror.setValue(r),o(e)}i.modal({buttons:{OK:{class:"btn btn-primary btn-lg",click:n},Cancel:{class:"btn btn-lg",click:function(){}}},title:"Convert Cell?",body:"<span style='font-size:15px;'>This cell does not have any Orchestra data associated with it. Convert cell now?<br /><br />Cell contents will be overwritten!</span>",sanitize:!1})}}},n=t.notebook.keyboard_manager.actions.register(e,"run-orchestra-vfp","auto");t.toolbar.add_buttons_group([n])}}});